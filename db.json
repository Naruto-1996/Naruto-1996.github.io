{"meta":{"version":1,"warehouse":"4.0.0"},"models":{"Asset":[{"_id":"themes/freemind/source/favicon.png","path":"favicon.png","modified":1,"renderable":1},{"_id":"themes/freemind/source/css/bootstrap-responsive.css","path":"css/bootstrap-responsive.css","modified":1,"renderable":1},{"_id":"themes/freemind/source/css/bootstrap.min.css","path":"css/bootstrap.min.css","modified":1,"renderable":1},{"_id":"themes/freemind/source/css/bootstrap.css.map","path":"css/bootstrap.css.map","modified":1,"renderable":1},{"_id":"themes/freemind/source/css/font-awesome.css","path":"css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/freemind/source/css/highlight.css","path":"css/highlight.css","modified":1,"renderable":1},{"_id":"themes/freemind/source/css/google-fonts.css","path":"css/google-fonts.css","modified":1,"renderable":1},{"_id":"themes/freemind/source/css/prism.css","path":"css/prism.css","modified":1,"renderable":1},{"_id":"themes/freemind/source/css/responsive.css","path":"css/responsive.css","modified":1,"renderable":1},{"_id":"themes/freemind/source/fancybox/blank.gif","path":"fancybox/blank.gif","modified":1,"renderable":1},{"_id":"themes/freemind/source/css/style.css","path":"css/style.css","modified":1,"renderable":1},{"_id":"themes/freemind/source/fancybox/fancybox_loading.gif","path":"fancybox/fancybox_loading.gif","modified":1,"renderable":1},{"_id":"themes/freemind/source/fancybox/fancybox_loading@2x.gif","path":"fancybox/fancybox_loading@2x.gif","modified":1,"renderable":1},{"_id":"themes/freemind/source/fancybox/jquery.fancybox.css","path":"fancybox/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/freemind/source/fancybox/fancybox_sprite@2x.png","path":"fancybox/fancybox_sprite@2x.png","modified":1,"renderable":1},{"_id":"themes/freemind/source/fancybox/fancybox_overlay.png","path":"fancybox/fancybox_overlay.png","modified":1,"renderable":1},{"_id":"themes/freemind/source/fancybox/fancybox_sprite.png","path":"fancybox/fancybox_sprite.png","modified":1,"renderable":1},{"_id":"themes/freemind/source/fancybox/jquery.fancybox.pack.js","path":"fancybox/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/freemind/source/fonts/fontawesome-webfont.eot","path":"fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/freemind/source/fonts/FontAwesome.otf","path":"fonts/FontAwesome.otf","modified":1,"renderable":1},{"_id":"themes/freemind/source/fonts/FiraCode.ttf","path":"fonts/FiraCode.ttf","modified":1,"renderable":1},{"_id":"themes/freemind/source/fonts/fontawesome-webfont.svg","path":"fonts/fontawesome-webfont.svg","modified":1,"renderable":1},{"_id":"themes/freemind/source/fonts/fontawesome-webfont.ttf","path":"fonts/fontawesome-webfont.ttf","modified":1,"renderable":1},{"_id":"themes/freemind/source/js/bootstrap.min.js","path":"js/bootstrap.min.js","modified":1,"renderable":1},{"_id":"themes/freemind/source/fonts/fontawesome-webfont.woff","path":"fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/freemind/source/js/gallery.js","path":"js/gallery.js","modified":1,"renderable":1},{"_id":"themes/freemind/source/js/jquery-2.0.3.min.js","path":"js/jquery-2.0.3.min.js","modified":1,"renderable":1},{"_id":"themes/freemind/source/js/jquery.imagesloaded.min.js","path":"js/jquery.imagesloaded.min.js","modified":1,"renderable":1},{"_id":"themes/freemind/source/js/main.js","path":"js/main.js","modified":1,"renderable":1},{"_id":"themes/freemind/source/js/md5.min.js","path":"js/md5.min.js","modified":1,"renderable":1},{"_id":"themes/freemind/source/js/search.js","path":"js/search.js","modified":1,"renderable":1},{"_id":"themes/freemind/source/css/fonts/FiraCode.ttf","path":"css/fonts/FiraCode.ttf","modified":1,"renderable":1},{"_id":"themes/freemind/source/css/fonts/Fixedsys500c.otf","path":"css/fonts/Fixedsys500c.otf","modified":1,"renderable":1},{"_id":"themes/freemind/source/css/fonts/Fixedsys500c.svg","path":"css/fonts/Fixedsys500c.svg","modified":1,"renderable":1},{"_id":"themes/freemind/source/css/fonts/Fixedsys500c.eot","path":"css/fonts/Fixedsys500c.eot","modified":1,"renderable":1},{"_id":"themes/freemind/source/css/fonts/Fixedsys500c.woff","path":"css/fonts/Fixedsys500c.woff","modified":1,"renderable":1},{"_id":"themes/freemind/source/css/fonts/Fixedsys500c.ttf","path":"css/fonts/Fixedsys500c.ttf","modified":1,"renderable":1},{"_id":"themes/freemind/source/fonts/google-fonts/0AKsP294HTD-nvJgucYTaIbN6UDyHWBl620a-IRfuBk.woff","path":"fonts/google-fonts/0AKsP294HTD-nvJgucYTaIbN6UDyHWBl620a-IRfuBk.woff","modified":1,"renderable":1},{"_id":"themes/freemind/source/fonts/google-fonts/0XxGQsSc1g4rdRdjJKZrNBsxEYwM7FgeyaSgU71cLG0.woff","path":"fonts/google-fonts/0XxGQsSc1g4rdRdjJKZrNBsxEYwM7FgeyaSgU71cLG0.woff","modified":1,"renderable":1},{"_id":"themes/freemind/source/fonts/google-fonts/2UX7WLTfW3W8TclTUvlFyQ.woff","path":"fonts/google-fonts/2UX7WLTfW3W8TclTUvlFyQ.woff","modified":1,"renderable":1},{"_id":"themes/freemind/source/fonts/google-fonts/LKf8nhXsWg5ybwEGXk8UBQ.woff","path":"fonts/google-fonts/LKf8nhXsWg5ybwEGXk8UBQ.woff","modified":1,"renderable":1},{"_id":"themes/freemind/source/fonts/google-fonts/PIPMHY90P7jtyjpXuZ2cLD8E0i7KZn-EPnyo3HZu7kw.woff","path":"fonts/google-fonts/PIPMHY90P7jtyjpXuZ2cLD8E0i7KZn-EPnyo3HZu7kw.woff","modified":1,"renderable":1},{"_id":"themes/freemind/source/fonts/google-fonts/cj2hUnSRBhwmSPr9kS5899kZXW4sYc4BjuAIFc1SXII.woff","path":"fonts/google-fonts/cj2hUnSRBhwmSPr9kS5899kZXW4sYc4BjuAIFc1SXII.woff","modified":1,"renderable":1},{"_id":"themes/freemind/source/fonts/google-fonts/UyYrYy3ltEffJV9QueSi4RdbPw3QSf9R-kE0EsQUn2A.woff","path":"fonts/google-fonts/UyYrYy3ltEffJV9QueSi4RdbPw3QSf9R-kE0EsQUn2A.woff","modified":1,"renderable":1},{"_id":"themes/freemind/source/fonts/google-fonts/lILlYDvubYemzYzN7GbLkHhCUOGz7vYGh680lGh-uXM.woff","path":"fonts/google-fonts/lILlYDvubYemzYzN7GbLkHhCUOGz7vYGh680lGh-uXM.woff","modified":1,"renderable":1}],"Cache":[{"_id":"source/_data/friends.json","hash":"93061f196a60daf05aeb287a0fda7d399c5ccb67","modified":1602813254408},{"_id":"source/friends/index.md","hash":"f5f44512b94d9add7f732bd7a251181e641cbc23","modified":1602813178751},{"_id":"source/categories/index.md","hash":"a2d13980adcbebd1b86d8a461964f824d0351031","modified":1602812901798},{"_id":"source/.DS_Store","hash":"6a5f5f95b1a5cdd5e126a6a55ac06f38ee5f8df5","modified":1634261443423},{"_id":"source/contact/index.md","hash":"ecdf25b2a3c4e4406c6b035df5499c8dea29c6e3","modified":1602813057397},{"_id":"source/about/index.md","hash":"031eb3c503d4d706c3952746d432aa7940bd3df4","modified":1602813004295},{"_id":"source/tags/index.md","hash":"08d3e50f9567b001d91b5b5f93dd4b8c2c8da7ec","modified":1602812960231},{"_id":"source/_posts/Android-ImageView设置background和src的区别.md","hash":"e4748452a198e2e2d3e451a4eb0c43755f4725a1","modified":1603271782392},{"_id":"source/_posts/Android-RecycleView内部item点击事件.md","hash":"cd9a9c3fb30ed7a44682860040df2f8797f32825","modified":1603268978800},{"_id":"source/_posts/.hexo-github搭建一个博客.md.swp","hash":"e51c71b6637eb9a1e9c7fa36a687304f6c59a7c8","modified":1720060512055},{"_id":"source/_posts/Android-intent-setFlags方法中参数值的含义.md","hash":"28e151d18baf001e0bc1ac9947624b77053f57b0","modified":1603272410698},{"_id":"source/_posts/Android-tablayout-viewpager2-fragment-你可能用错了.md","hash":"993991fb536ee183e6473e15645435dd3c0703de","modified":1625017641153},{"_id":"source/_posts/Android-中的单例模式.md","hash":"eb10e6278c6c11f6e35f4b90e5d2519d4da42909","modified":1624348849914},{"_id":"source/_posts/Android-如何监听前后台.md","hash":"74f3df54da0b06f8d0579984c203d5f7097fab72","modified":1603270730246},{"_id":"source/_posts/Android-知识总结.md","hash":"ac02aa8c820c8b88ae5d4f9a08956f12d2b00efe","modified":1624349272319},{"_id":"source/_posts/Android-逆向工程.md","hash":"1c2763eeaf0b48baeeaf63b2ea5ac0b4caf1dbc9","modified":1621419416069},{"_id":"source/_posts/Android一些常用的背景图.md","hash":"d21a43e919de40a45e63e8c93c86d6893d7d1ef3","modified":1608282433710},{"_id":"source/_posts/Android自定义EditText一键清除和密文查看.md","hash":"8f4a5fd82101ea1496ae2e19ed8af358f7104569","modified":1608281455507},{"_id":"source/_posts/IDEA-破解.md","hash":"80233e63e3b51c24f7b54f5b5dca78844e7208f6","modified":1603257046645},{"_id":"source/_posts/Linux-运维方面的知识.md","hash":"4d17d97b3183fb2a48f10b6fc4a1c0a9f28d3257","modified":1606881905798},{"_id":"source/_posts/Rust-琐碎知识记录板.md","hash":"ab2e15e8f3c6a103e7b0018264f5e380ce4a83c5","modified":1603250143965},{"_id":"source/_posts/ETH智能合约开发.md","hash":"ba81de1bb7f0fa9a1796a28c58b1d06e2471b55d","modified":1616641790048},{"_id":"source/_posts/Ubuntu权限详解.md","hash":"aa592df096338e855e66d5394ed25a6543d6f04b","modified":1617008930055},{"_id":"source/_posts/appium自动化测试.md","hash":"a9c4b0e2da4be02d30f39febc503418706f9042c","modified":1634029413987},{"_id":"source/_posts/Rust-闭包.md","hash":"899a9524fecd9f5454cc72ed5fa90b61fc42ad95","modified":1603267359164},{"_id":"source/_posts/hello-world.md","hash":"24215ed69b7994024a58bcef21acff95cd852a5b","modified":1602845772252},{"_id":"source/_posts/hexo-github搭建一个博客.md","hash":"a60e12ae2d73cf7b4718f521daabf337f68784f6","modified":1603015106292},{"_id":"source/_posts/rails-连接多个数据库.md","hash":"75951987e305b766191847cdec37aad46fe5c10b","modified":1606814743729},{"_id":"source/_posts/linux-ubuntu-使用fail2ban-为nginx保驾护航.md","hash":"9517f00eae045a8406ca8254e82d8eca31c9d267","modified":1607507223565},{"_id":"source/_posts/deploy-a-nft-art-and-transfer-in-eth-testnet.md","hash":"8e0f05447c66b12530719c9cffb0692246e88797","modified":1634262400006},{"_id":"source/_posts/redis使用心得.md","hash":"881faf3fdfcfff43cf72aa2f7f9c7b8e564528f2","modified":1607418801886},{"_id":"source/_posts/recycleView去掉滑动边界阴影.md","hash":"f1385965f1eb0d222b8d65bc495b623660eef283","modified":1634262615333},{"_id":"source/_posts/picture-bed.md","hash":"64a7a30a41c446426d4cd395bb488aab20e9f190","modified":1603009521317},{"_id":"source/_posts/rust-0u8在rust中是什么意思.md","hash":"57670bd879ce11d2f4352d5db12b8b08e3ecab06","modified":1603250143974},{"_id":"source/_posts/ubuntu下安装mysql.md","hash":"1cb1554effa3fe65d089e54164ea5912d5a4b224","modified":1612238960759},{"_id":"source/_data/musics.json","hash":"d73d2b981e806c9eb9fd42bc2f31818da06ff9b2","modified":1602826659712},{"_id":"source/_posts/ubuntu下安装redis.md","hash":"0e26c4f4aae055a16f90852f3a60c26ef4ed6a1c","modified":1612245780728},{"_id":"source/_posts/ubuntu下彻底卸载mysql.md","hash":"da29990f7ff02bc7aa3b27cff1703f75017932ca","modified":1612230102679},{"_id":"source/_posts/zsh-permission-denied-解决办法.md","hash":"eb7c6d67a2479ac8a81a89dded3d26ac2f0faf68","modified":1605692666503},{"_id":"source/_posts/在linux服务器上安装Ruby-On-Rails.md","hash":"0a820f286808031a10e240eda9858fa2342a829f","modified":1634262494550},{"_id":"source/_posts/常用命令.md","hash":"71c467a0dbd3fecd86fafaf6a3c8fd07ece3b76c","modified":1603250143978},{"_id":"source/_posts/什么是运行时-Runtime.md","hash":"307794267446a2943adad7bc1e495ec35db8e602","modified":1603250143970},{"_id":"source/_posts/给Linux安装nginx.md","hash":"36501ef0b929022f2a2ed3d6ca8f2ee28b045cbc","modified":1607497154719},{"_id":"source/_posts/搭建服务器ubuntu系统.md","hash":"623cd7cf81d2858115ae2764e6637c5521d8cbf3","modified":1609322865957},{"_id":"source/_posts/在linux服务器上安装vim.md","hash":"95d05e1838154164849b8e5f6140a3961e41d971","modified":1616752589078},{"_id":"source/_posts/服务器安装oh-my-zsh.md","hash":"d1f7cc8cf006cea2376dacb2cd0c5f7979688474","modified":1616983942479},{"_id":"source/_posts/给Linux服务器设置登录提示.md","hash":"4950de25e3243b60db68c6887c12bacac8697f22","modified":1607424772700},{"_id":"source/_posts/给服务器设置ssh免密码登录.md","hash":"383464eeb8b121d906bbd6a4231472c5c1cf48e0","modified":1607482038624},{"_id":"source/_posts/解决服务器连不上github的问题.md","hash":"5d9c65002fe1895be00839c4911c171acab3a2da","modified":1616981825099},{"_id":"source/_posts/记一次被钓鱼网站盗走eth的经历.md","hash":"baeb5c40afbe51ac6e4d1d81d54a40dbba7cc92f","modified":1625106887606},{"_id":"themes/freemind/LICENSE","hash":"f26ce5333bd73ee6f0f9bb2c97fcf5707c1c7715","modified":1719993816343},{"_id":"themes/freemind/README.md","hash":"3a909f6b12a1d6f4dbca74cae212d2195ae6edfa","modified":1719993816343},{"_id":"themes/freemind/.gitignore","hash":"7d65523f2a5afb69d76824dd1dfa62a34faa3197","modified":1719993816343},{"_id":"themes/freemind/languages/default.yml","hash":"175fa1bd6f3744f81326b8e7c9a3dfad07199270","modified":1719993816344},{"_id":"themes/freemind/languages/pt-BR.yml","hash":"e58d02636dc47f698cc6c2045edffc1a08772639","modified":1719993816344},{"_id":"themes/freemind/_config.yml","hash":"387cebe0de2b62a1b28657efc268f962ee202cd7","modified":1719993816344},{"_id":"themes/freemind/languages/zh-CN.yml","hash":"37b0b97471e646caf67404b447474b6da9fae564","modified":1719993816345},{"_id":"themes/freemind/layout/archive.ejs","hash":"c97be36b33bb44957778587f00c978f2d28016f8","modified":1719993816376},{"_id":"themes/freemind/languages/zh-TW.yml","hash":"633a09b238cfadcf3c6f3dbec58cf60822d23a44","modified":1719993816345},{"_id":"themes/freemind/layout/layout.ejs","hash":"cd333c7859008552037659012011990a9b32d2c4","modified":1719993816377},{"_id":"themes/freemind/layout/post.ejs","hash":"8535eadbfcb7e52325f16da412ecc04cd1426203","modified":1719993816378},{"_id":"themes/freemind/layout/page.ejs","hash":"21612a42b29cb20f106bc2716c598e69db142750","modified":1719993816378},{"_id":"themes/freemind/layout/categories.ejs","hash":"75931cf16ce89871f53d09e918109bcb0c7741a1","modified":1719993816377},{"_id":"themes/freemind/layout/index.ejs","hash":"8f6e482aad2d33fbc9407eb6a47a526940946c3d","modified":1719993816377},{"_id":"themes/freemind/layout/tags.ejs","hash":"4a39d2fe5cd2b005b9a18b30a11566d631a977fe","modified":1719993816379},{"_id":"themes/freemind/layout/_partial/archive.ejs","hash":"6eeb24ae52e46343ba6e9fd7cfa56ee79589f421","modified":1719993816346},{"_id":"themes/freemind/layout/_partial/after_footer.ejs","hash":"59b4ade0400f04b19bc73a1ae7e66ea5cdef48fc","modified":1719993816346},{"_id":"themes/freemind/layout/_partial/footer.ejs","hash":"8e6f5cd6bf962357793748a724a6140b62d497b0","modified":1719993816347},{"_id":"themes/freemind/layout/_partial/article.ejs","hash":"c77bede0efcd2d74efdcb8cd87ba893a87949580","modified":1719993816347},{"_id":"themes/freemind/layout/_partial/head.ejs","hash":"0866714a3ca6bb5369d681532c6b1e7d725f22a8","modified":1719993816347},{"_id":"themes/freemind/layout/_partial/index.ejs","hash":"0bd770f5281919857f9bd913f61851e5555201d3","modified":1719993816347},{"_id":"themes/freemind/source/favicon.png","hash":"61c2eabaf46078d39a745a6c0f69e8fe33aa8775","modified":1719993816400},{"_id":"themes/freemind/layout/_partial/index_pagination.ejs","hash":"64741f67cbcd03a3a203fa9c080e7239710eddd9","modified":1719993816348},{"_id":"themes/freemind/layout/_partial/sidebar.ejs","hash":"0574610968679984f6aec4b31fbba655df972d28","modified":1719993816371},{"_id":"themes/freemind/layout/_partial/search.ejs","hash":"f00bcd7cdef50a727600960de1d8b6a9e9b360b4","modified":1719993816370},{"_id":"themes/freemind/layout/_widget/links.ejs","hash":"209f60bec33c1179dff9bd09c66dc2c036246b40","modified":1719993816373},{"_id":"themes/freemind/layout/_widget/category.ejs","hash":"7452e116d550f8a5c5beff8cac3ac56645f035ae","modified":1719993816372},{"_id":"themes/freemind/layout/_widget/search.ejs","hash":"cc322c98ca8420d1b5a31a7337249b403c661b80","modified":1719993816375},{"_id":"themes/freemind/layout/_widget/recent_posts.ejs","hash":"a9333350df895e2bc85c60c17c47a6a1dfa846e7","modified":1719993816374},{"_id":"themes/freemind/layout/_widget/tagcloud.ejs","hash":"4d592eb23466383f3224e36474b2e4dfe85e4d42","modified":1719993816376},{"_id":"themes/freemind/source/css/highlight.css","hash":"cd30b0c288cd09890125723fe2356f58c1503080","modified":1719993816394},{"_id":"themes/freemind/source/css/bootstrap-responsive.css","hash":"b668e794bc3f24fd718d24304605000c5a8be0f9","modified":1719993816380},{"_id":"themes/freemind/source/css/google-fonts.css","hash":"06db66e315b47f844fb208b50e5710606360b142","modified":1719993816394},{"_id":"themes/freemind/source/css/font-awesome.css","hash":"5eca1a5aef2ef4fb845f7e5a96c27f74a5bd1763","modified":1719993816385},{"_id":"themes/freemind/source/css/prism.css","hash":"4c53536a9051b13afc4c1f1082923c6b48ea3db1","modified":1719993816395},{"_id":"themes/freemind/source/fancybox/blank.gif","hash":"4ffebfc1255c0da73aab342450a9ee09fcaccb86","modified":1719993816397},{"_id":"themes/freemind/source/css/responsive.css","hash":"30f6a26aa0a5368d24a68575eb3fe254de7b92d2","modified":1719993816395},{"_id":"themes/freemind/source/css/style.css","hash":"84708c3e9a48f1fd022e375840eb73df1a7a288d","modified":1719993816396},{"_id":"themes/freemind/source/fancybox/fancybox_loading.gif","hash":"4fbaf63664f65a42bef60289c887cd61a925ce4c","modified":1719993816397},{"_id":"themes/freemind/layout/_partial/navigation.ejs","hash":"e4d9af8d4cae60541a8e8f0f8caeeb28aaf5ca33","modified":1719993816348},{"_id":"themes/freemind/source/fancybox/fancybox_loading@2x.gif","hash":"381e91e67e85bfda09ce8b88205d93d9a7d20d4d","modified":1719993816398},{"_id":"themes/freemind/source/fancybox/fancybox_overlay.png","hash":"beb714da455e5dbdbf7b2ed466ff4308c103addb","modified":1719993816398},{"_id":"themes/freemind/source/fancybox/fancybox_sprite@2x.png","hash":"ecf1523aefe416a4cc901ab4cda5d488e3d9cd76","modified":1719993816399},{"_id":"themes/freemind/source/fancybox/fancybox_sprite.png","hash":"0657b6b574bafc4c819c7d6c3bc5dd7205c8eee7","modified":1719993816398},{"_id":"themes/freemind/source/fancybox/jquery.fancybox.css","hash":"cbb69ef9748bf92edc3eb4b269b77ad25465d049","modified":1719993816399},{"_id":"themes/freemind/source/fancybox/jquery.fancybox.pack.js","hash":"ae6318aeb62ad4ce7a7e9a4cdacd93ffb004f0fb","modified":1719993816400},{"_id":"themes/freemind/source/fonts/fontawesome-webfont.eot","hash":"0183979056f0b87616cd99d5c54a48f3b771eee6","modified":1719993816404},{"_id":"themes/freemind/source/js/bootstrap.min.js","hash":"9933cdc70c0047a3ea1a196f9320c36737b93c2a","modified":1719993816412},{"_id":"themes/freemind/source/fonts/fontawesome-webfont.woff","hash":"7d65e0227d0d7cdc1718119cd2a7dce0638f151c","modified":1719993816407},{"_id":"themes/freemind/source/js/gallery.js","hash":"10cad81731825178f3d30b80a2694a377c1fb7a6","modified":1719993816412},{"_id":"themes/freemind/source/js/jquery.imagesloaded.min.js","hash":"3eb6381d2ed4b706020e4be5aff024aab4bcabc5","modified":1719993816414},{"_id":"themes/freemind/source/js/main.js","hash":"e3fcd795564533a3984b0ce327bd8dff44145f89","modified":1719993816414},{"_id":"themes/freemind/layout/_partial/post/analytics.ejs","hash":"2e10343136aa0ad78908751f8276490589154ddc","modified":1719993816353},{"_id":"themes/freemind/source/js/md5.min.js","hash":"9fe6cc786714b853c0c4ade488c09288082dbcc4","modified":1719993816415},{"_id":"themes/freemind/layout/_partial/post/category.ejs","hash":"cc5b4cc95af6d5df4f7d1f1301dad8d4a5c7f8d0","modified":1719993816357},{"_id":"themes/freemind/source/js/search.js","hash":"a882244488031de498176fc6af35cea2a13c7a18","modified":1719993816415},{"_id":"themes/freemind/layout/_partial/post/comment.ejs","hash":"94c2df9d0017e325b5ad052f76355a218328fc62","modified":1719993816359},{"_id":"themes/freemind/layout/_partial/post/copyright.ejs","hash":"e3689a9248cecfc0fc585a90f1bda411e65de14d","modified":1719993816363},{"_id":"themes/freemind/layout/_partial/post/entry.ejs","hash":"c7a40f6fa8297daeb7f4c7ec35985c412094bc7b","modified":1719993816364},{"_id":"themes/freemind/layout/_partial/post/comment_footer.ejs","hash":"b3a6db566afdf0931909013926b7008eac9129ee","modified":1719993816361},{"_id":"themes/freemind/layout/_partial/post/meta.ejs","hash":"432e08b2563241dec4e4ef67717173d22e052dcf","modified":1719993816365},{"_id":"themes/freemind/layout/_partial/post/pagination.ejs","hash":"ea48347c56412921da646bfe5c293bfd275c8a9d","modified":1719993816366},{"_id":"themes/freemind/layout/_partial/post/gitalk.ejs","hash":"1c92e2e9a1b8d1a8ea972e322f0b9a11fa6e49b6","modified":1719993816365},{"_id":"themes/freemind/layout/_partial/post/share.ejs","hash":"991cf130c37f08c7e948772fb45587592b165b55","modified":1719993816367},{"_id":"themes/freemind/layout/_partial/post/valine.ejs","hash":"72c9ff6de05b496a1f3aba16f57caa154e8f43c1","modified":1719993816369},{"_id":"themes/freemind/layout/_partial/post/slogan.ejs","hash":"ab0e8ce73ee3e98c5507b6a4ffe4385e2ba81d9e","modified":1719993816367},{"_id":"themes/freemind/layout/_partial/post/waline.ejs","hash":"22eac0f2b373047af104f6a1029f1f47438a9e8e","modified":1719993816369},{"_id":"themes/freemind/layout/_partial/post/tag.ejs","hash":"ae292045468812e678780288e51b1b19fa7e3e0c","modified":1719993816368},{"_id":"themes/freemind/layout/_partial/post/title.ejs","hash":"ce8eb57990e7dac5e472832235ec719863b35201","modified":1719993816368},{"_id":"themes/freemind/source/css/fonts/Fixedsys500c.otf","hash":"e1fede43e072a990b9cd9899cdd26b78b30d305d","modified":1719993816389},{"_id":"themes/freemind/source/css/fonts/Fixedsys500c.eot","hash":"49611cf2e4d7e5c489c191f994ba7ac315bcce5c","modified":1719993816388},{"_id":"themes/freemind/source/css/fonts/Fixedsys500c.ttf","hash":"19a8e49df8611dd0d90133a2eb0e410c23932db4","modified":1719993816392},{"_id":"themes/freemind/source/css/fonts/Fixedsys500c.woff","hash":"21f8e34c5e252a54710c5f6b0e363b9c43f979b2","modified":1719993816393},{"_id":"themes/freemind/source/fonts/google-fonts/0AKsP294HTD-nvJgucYTaIbN6UDyHWBl620a-IRfuBk.woff","hash":"1d9bb14c006d39d7eb0812a85567c7431f899b8d","modified":1719993816408},{"_id":"themes/freemind/source/fonts/google-fonts/0XxGQsSc1g4rdRdjJKZrNBsxEYwM7FgeyaSgU71cLG0.woff","hash":"33225e85c33279e7b4f0c5c65ff93bec740dd59c","modified":1719993816408},{"_id":"themes/freemind/source/fonts/google-fonts/2UX7WLTfW3W8TclTUvlFyQ.woff","hash":"87deb174af2e2beebb9f09d618a5159ca299a3d0","modified":1719993816409},{"_id":"themes/freemind/source/fonts/google-fonts/LKf8nhXsWg5ybwEGXk8UBQ.woff","hash":"f401d51152681048c06187c5d3919b1407b899c5","modified":1719993816410},{"_id":"themes/freemind/source/fonts/google-fonts/PIPMHY90P7jtyjpXuZ2cLD8E0i7KZn-EPnyo3HZu7kw.woff","hash":"18dc51e642b4df958098d3bbc6d3ba0237ef6150","modified":1719993816410},{"_id":"themes/freemind/source/fonts/google-fonts/cj2hUnSRBhwmSPr9kS5899kZXW4sYc4BjuAIFc1SXII.woff","hash":"17a484b92c0dacc8e8b4f0d38ccc1db400819d1d","modified":1719993816411},{"_id":"themes/freemind/source/fonts/google-fonts/UyYrYy3ltEffJV9QueSi4RdbPw3QSf9R-kE0EsQUn2A.woff","hash":"d9f913d09bb3c25749daf8e7ab829c850a842929","modified":1719993816411},{"_id":"themes/freemind/source/fonts/google-fonts/lILlYDvubYemzYzN7GbLkHhCUOGz7vYGh680lGh-uXM.woff","hash":"e6c9f1e5a6a966a8f7250201356f351890a48921","modified":1719993816411},{"_id":"themes/freemind/source/css/bootstrap.min.css","hash":"c3aa181b9719f016142bf49ec5f57d0bf91a2d5f","modified":1719993816383},{"_id":"themes/freemind/source/fonts/FontAwesome.otf","hash":"6270a4a561a69fef5f5cc18cdf9efc256ec2ccbe","modified":1719993816403},{"_id":"themes/freemind/source/fonts/fontawesome-webfont.ttf","hash":"6225ccc4ec94d060f19efab97ca42d842845b949","modified":1719993816406},{"_id":"themes/freemind/source/js/jquery-2.0.3.min.js","hash":"3dad20239301f9ee22f22ca7d5ac6eca1da4ac22","modified":1719993816413},{"_id":"themes/freemind/source/css/fonts/Fixedsys500c.svg","hash":"584b95873e60ea5d4212dc42cb37f4643d3a1915","modified":1719993816390},{"_id":"themes/freemind/source/css/bootstrap.css.map","hash":"916c87ec5b34b3789db112dff0c88a874184ae8f","modified":1719993816381},{"_id":"themes/freemind/source/fonts/FiraCode.ttf","hash":"25562828ef61c2981b59ab0ed20ffafa37a74441","modified":1719993816402},{"_id":"themes/freemind/source/css/fonts/FiraCode.ttf","hash":"25562828ef61c2981b59ab0ed20ffafa37a74441","modified":1719993816387},{"_id":"themes/freemind/source/fonts/fontawesome-webfont.svg","hash":"e471023286b7dd1d2ccc72f670a471cfdfeafab7","modified":1719993816405},{"_id":"public/atom.xml","hash":"12606aff67d4cc19c1a35d18937557e414b4f568","modified":1720060715459},{"_id":"public/search.xml","hash":"3f6c63237d53ff392e32314b1de33556d39a0a5c","modified":1720060715459},{"_id":"public/friends/index.html","hash":"fe6b836caa67b7e547356590c8a7db4c59ce5c56","modified":1720060715459},{"_id":"public/categories/index.html","hash":"6d7b890e0e732fbcfe3f85e1b6ac0723d037bc8a","modified":1720060715459},{"_id":"public/about/index.html","hash":"ab98af81313245ba9959362544d03bfc6290e1d9","modified":1720060715459},{"_id":"public/contact/index.html","hash":"ac465a04334160594f060c6da5030ae56f62b7f7","modified":1720060715459},{"_id":"public/tags/index.html","hash":"03452d6c1341507378facc7f39b116fdbc5ef594","modified":1720060715459},{"_id":"public/2021/10/12/appium-zi-dong-hua-ce-shi/index.html","hash":"4aefe5f18028afd721c7e858cc7e328e421f8403","modified":1720060715459},{"_id":"public/2021/07/30/deploy-a-nft-art-and-transfer-in-eth-testnet/index.html","hash":"765a995fb640fe8f519c597f2b6c6cb29bdbc5c4","modified":1720060715459},{"_id":"public/2021/07/01/ji-yi-ci-bei-diao-yu-wang-zhan-dao-zou-eth-de-jing-li/index.html","hash":"f900bc3aab86bfe72ac13bb9bf73fb1cfc670472","modified":1720060715459},{"_id":"public/2021/06/25/android-tablayout-viewpager2-fragment-ni-ke-neng-yong-cuo-liao/index.html","hash":"a81d857d9dcbdcddba9f0a35a06d59df89f55620","modified":1720060715459},{"_id":"public/2021/06/22/android-zhong-de-dan-li-mo-shi/index.html","hash":"fa95f672d66098465e63e0675462f48ef2e3d6e7","modified":1720060715459},{"_id":"public/2021/06/22/android-zhi-shi-zong-jie/index.html","hash":"a8b130f512a152061e90886a0da367d4ce1f850a","modified":1720060715459},{"_id":"public/2021/05/19/android-ni-xiang-gong-cheng/index.html","hash":"e8eb073a46725d6547068799acd8a0ab80f741de","modified":1720060715459},{"_id":"public/2021/04/27/recycleview-qu-diao-hua-dong-bian-jie-yin-ying/index.html","hash":"983ee93d156b2f2d11b5fec4a46add5cfba7f2ea","modified":1720060715459},{"_id":"public/2021/03/29/ubuntu-quan-xian-xiang-jie/index.html","hash":"b1ef9753877e09ba318a4c679f0bd751e5a6575f","modified":1720060715459},{"_id":"public/2021/03/29/fu-wu-qi-an-zhuang-oh-my-zsh/index.html","hash":"1dff58ccf9550c71d32c96371588a0ce78bb5ef6","modified":1720060715459},{"_id":"public/2021/03/29/jie-jue-fu-wu-qi-lian-bu-shang-github-de-wen-ti/index.html","hash":"be38478d35afb3ef366eae40f12929af8a7635c5","modified":1720060715459},{"_id":"public/2021/03/19/eth-zhi-neng-he-yue-kai-fa/index.html","hash":"a0cabf6dc762835580e410b63bb7d52521b3eb96","modified":1720060715459},{"_id":"public/2021/02/02/zai-linux-fu-wu-qi-shang-an-zhuang-ruby-on-rails/index.html","hash":"5210f1238b9d049b369e6062c4c2d7e364445356","modified":1720060715459},{"_id":"public/2021/02/02/ubuntu-xia-an-zhuang-redis/index.html","hash":"98929b6e729e0048c65c452f13ecb573a0975d23","modified":1720060715459},{"_id":"public/2021/02/02/ubuntu-xia-an-zhuang-mysql/index.html","hash":"c4b10a9dac5095a403ef458489c57986d304e2a1","modified":1720060715459},{"_id":"public/2020/12/18/android-yi-xie-chang-yong-de-bei-jing-tu/index.html","hash":"e55a82dfe8463ca5eb886c2c94eee60c299f9553","modified":1720060715459},{"_id":"public/2020/12/30/da-jian-fu-wu-qi-ubuntu-xi-tong/index.html","hash":"a43df748c13d99e6832ace101a974d923dd4c1c5","modified":1720060715459},{"_id":"public/2021/02/02/ubuntu-xia-che-di-xie-zai-mysql/index.html","hash":"e5208afbdb1ff95ebf9b6a753e7c7911420d8300","modified":1720060715459},{"_id":"public/2020/12/18/android-zi-ding-yi-edittext-yi-jian-qing-chu-he-mi-wen-cha-kan/index.html","hash":"63a868c5d99f7c4ce6ce5271dfa6cd9f18e8a513","modified":1720060715459},{"_id":"public/2020/12/09/linux-ubuntu-shi-yong-fail2ban-wei-nginx-bao-jia-hu-hang/index.html","hash":"2ed1a3fc18b213a9678858d1b618873939c8dc17","modified":1720060715459},{"_id":"public/2020/12/09/gei-linux-an-zhuang-nginx/index.html","hash":"fd2058724015441a956654e81190ab8f402fbab2","modified":1720060715459},{"_id":"public/2020/12/09/gei-fu-wu-qi-she-zhi-ssh-mian-mi-ma-deng-lu/index.html","hash":"e26a72c386d7d3f7ec8147e0293ba272f36075b4","modified":1720060715459},{"_id":"public/2020/12/08/gei-linux-fu-wu-qi-she-zhi-deng-lu-ti-shi/index.html","hash":"15977bcb6df28f971acf4ae19ec6e18b7801c30a","modified":1720060715459},{"_id":"public/2020/12/08/zai-linux-fu-wu-qi-shang-an-zhuang-vim/index.html","hash":"f7fa8a551657883c59392b48df0fbf97b95d273b","modified":1720060715459},{"_id":"public/2020/12/02/linux-yun-wei-fang-mian-de-zhi-shi/index.html","hash":"00ffe26afe44e8ca3309a23dfd57683a8e21f378","modified":1720060715459},{"_id":"public/2020/12/02/redis-shi-yong-xin-de/index.html","hash":"477c2d1203c8135c2ff1d0c2e142c88b1bd05264","modified":1720060715459},{"_id":"public/2020/12/01/rails-lian-jie-duo-ge-shu-ju-ku/index.html","hash":"ae14e33019583db57d826c1fca50f46ee38a86a1","modified":1720060715459},{"_id":"public/2020/11/18/zsh-permission-denied-jie-jue-ban-fa/index.html","hash":"238890234128d2105388f45ce10613c57d529b6c","modified":1720060715459},{"_id":"public/2020/10/21/android-intent-setflags-fang-fa-zhong-can-shu-zhi-de-han-yi/index.html","hash":"42ca71389b0bdc1c9478e2536d0582187182b7b5","modified":1720060715459},{"_id":"public/2020/10/21/android-imageview-she-zhi-background-he-src-de-qu-bie/index.html","hash":"dde13339e09418f953e0525303bb10b7e7720983","modified":1720060715459},{"_id":"public/2020/10/21/android-ru-he-jian-ting-qian-hou-tai/index.html","hash":"793082dfd96ba8d10fec1ebece3f7b35a86b6c0a","modified":1720060715459},{"_id":"public/2020/10/21/android-recycleview-nei-bu-item-dian-ji-shi-jian/index.html","hash":"16347cb04c15fca1e1e356c519c4ab5a66949e06","modified":1720060715459},{"_id":"public/2020/10/21/rust-bi-bao/index.html","hash":"86934c2857fada2c34468e689caf7214faf9a50b","modified":1720060715459},{"_id":"public/2020/10/21/idea-po-jie/index.html","hash":"f19fac0c9cd54d038dec68f0ff5ba5a82ff2a025","modified":1720060715459},{"_id":"public/2020/10/21/rust-suo-sui-zhi-shi-ji-lu-ban/index.html","hash":"434dcac3b3b9029a2faacfc08267c7949ade9db4","modified":1720060715459},{"_id":"public/2020/10/21/chang-yong-ming-ling/index.html","hash":"51414585fdde76353fa0b1c80990c70c77198292","modified":1720060715459},{"_id":"public/2020/10/20/shi-me-shi-yun-xing-shi-runtime/index.html","hash":"68f159c679842b00ce30affe77bddf58ffc0fbc6","modified":1720060715459},{"_id":"public/2020/10/19/rust-0u8-zai-rust-zhong-shi-shi-me-yi-si/index.html","hash":"390bd35fcbba9cd802c3a7417f24d96f0cf6a616","modified":1720060715459},{"_id":"public/2020/10/18/picture-bed/index.html","hash":"e88486ef053bf7c96b5f31c599c5ac49ec2f5be6","modified":1720060715459},{"_id":"public/2020/10/16/hello-world/index.html","hash":"b7c2922f5c28b33de798e34325adc8d5d1830711","modified":1720060715459},{"_id":"public/2020/10/16/hexo-github-da-jian-yi-ge-bo-ke/index.html","hash":"df8ff5c1fd60f652bd31213e9d99c9b356d75df5","modified":1720060715459},{"_id":"public/archives/index.html","hash":"541241ac28862858b6422e247dc0579d9ebf9f20","modified":1720060715459},{"_id":"public/archives/page/2/index.html","hash":"cb66f67c8b1071378c91dc86a2fc36a95446b3fa","modified":1720060715459},{"_id":"public/archives/page/3/index.html","hash":"f58efbddaebea2b2e2e9cf7281b0074c915a46d0","modified":1720060715459},{"_id":"public/archives/page/4/index.html","hash":"f1daa89372c13537f40a2d9c9f18a846ce84b521","modified":1720060715459},{"_id":"public/archives/page/5/index.html","hash":"ec34f4104867e8f7ebe7e6b9927c45c821164e6c","modified":1720060715459},{"_id":"public/archives/2020/index.html","hash":"1bf005e6b72d39d4d7b393b2c19187e8b71433dd","modified":1720060715459},{"_id":"public/archives/2020/page/2/index.html","hash":"1b068f8eb62d8eea22bacb575ce83931c14caac7","modified":1720060715459},{"_id":"public/archives/2020/page/3/index.html","hash":"b534392e7109ff57810f63c1949b0ac3721fb73d","modified":1720060715459},{"_id":"public/archives/2020/10/index.html","hash":"3176aef6c8c5fb9312df475bd911ce217e031cfd","modified":1720060715459},{"_id":"public/archives/2020/10/page/2/index.html","hash":"3be03dcf37f1e7472c1b2c60b005df12b3af374a","modified":1720060715459},{"_id":"public/archives/2020/11/index.html","hash":"a7a2aade5a79746da13aef3fd38eebb28f23d868","modified":1720060715459},{"_id":"public/archives/2020/12/index.html","hash":"1b0ec739d3783673940239cb67d54db14c112925","modified":1720060715459},{"_id":"public/archives/2020/12/page/2/index.html","hash":"9669f14428573ca94dbc99508d03b7dde2c11545","modified":1720060715459},{"_id":"public/archives/2021/index.html","hash":"8851f78dbc07d735e6db29cfb17a15d96aadba1d","modified":1720060715459},{"_id":"public/archives/2021/page/2/index.html","hash":"8467a8037d30b61d290b513d5f68e22134b4a90a","modified":1720060715459},{"_id":"public/archives/2021/02/index.html","hash":"75eb14b276a975fe376d6f9bc59c43aecaf5faf4","modified":1720060715459},{"_id":"public/archives/2021/03/index.html","hash":"cac0be597c412541c672bac5b12e41274f475744","modified":1720060715459},{"_id":"public/archives/2021/04/index.html","hash":"4acf718575d2ffb7cc025c42967a67f1bd3eaa79","modified":1720060715459},{"_id":"public/archives/2021/05/index.html","hash":"da46f293308bd35a228346097d2ace69f31ece17","modified":1720060715459},{"_id":"public/archives/2021/06/index.html","hash":"56251b2e1f35858ab243b7062441e42c0d2990c7","modified":1720060715459},{"_id":"public/archives/2021/07/index.html","hash":"1137a80f47e5d87ba1d26aca69eb1e841ce5f398","modified":1720060715459},{"_id":"public/archives/2021/10/index.html","hash":"686e76b74e0b84d99409d9dacf89383c9b73e1d0","modified":1720060715459},{"_id":"public/categories/Android/index.html","hash":"1ef0d1f2fe38c800f7916bd439a5be203c85c055","modified":1720060715459},{"_id":"public/categories/Android/page/2/index.html","hash":"1a2eeee5b9bf689b152d799d9411629b9e61d4d1","modified":1720060715459},{"_id":"public/categories/ETH智能合约/index.html","hash":"ee72eea90c03faa9a9fdbf647486abfe192924fd","modified":1720060715459},{"_id":"public/categories/IDEA/index.html","hash":"679c3c121eb128a07aca2aaeb172e826d634a065","modified":1720060715459},{"_id":"public/categories/Linux/index.html","hash":"daff181dc4a8a2a373337a443d62a58a9ad1c3e2","modified":1720060715459},{"_id":"public/categories/Rust/index.html","hash":"db7ad1f39df95ebccbda9534a95e31c77f8b40e7","modified":1720060715459},{"_id":"public/categories/Appium/index.html","hash":"ae65272cdf741519123e143a3947cae79af8fab5","modified":1720060715459},{"_id":"public/categories/NFT/index.html","hash":"ec97c0d888b4c7ffdbe715e867b890562f46b299","modified":1720060715459},{"_id":"public/categories/web前端/index.html","hash":"26e648072a660a006b0d61389e6cccf35314271c","modified":1720060715459},{"_id":"public/categories/Mac/index.html","hash":"e19c8a52bc234af623d8f6585ba1a9ff655a833a","modified":1720060715459},{"_id":"public/categories/Fail2ban/index.html","hash":"fb29d23f169627a16a19beb0be114ee042e876a8","modified":1720060715459},{"_id":"public/categories/图床/index.html","hash":"bc5f2787d9ed469da4a2c5333b2921728d129486","modified":1720060715459},{"_id":"public/categories/rails/index.html","hash":"0148ec045b0a343525c2f518646af4cfc1da03ff","modified":1720060715459},{"_id":"public/categories/Redis/index.html","hash":"3c1623d3b79b0e0f839cb122ab7a8c16cd446587","modified":1720060715459},{"_id":"public/categories/mysql/index.html","hash":"d6d7bff66c09334b3a59705d4c912cad4960a34a","modified":1720060715459},{"_id":"public/categories/redis/index.html","hash":"4ccca0339d13b2bbb8d7cda93ab26e5efec8109b","modified":1720060715459},{"_id":"public/categories/Ubuntu/index.html","hash":"f17f257aa57d00901166d460e7133bfab522f706","modified":1720060715459},{"_id":"public/categories/Java/index.html","hash":"44667a48f3df955538cc8a5a70c7e5a13466d30b","modified":1720060715459},{"_id":"public/categories/oh-my-zsh/index.html","hash":"f5fd669bd74cb9e5858f4763959b208d24471a50","modified":1720060715459},{"_id":"public/categories/nginx/index.html","hash":"1df5f9d59ef525fc8d334f87996b68f465e3392a","modified":1720060715459},{"_id":"public/categories/钓鱼网站/index.html","hash":"f0c29e1f2d5941019a47621a39347e1806a98012","modified":1720060715459},{"_id":"public/categories/github/index.html","hash":"d0ac75c204f872bd0ed06fe2d83506f986da9022","modified":1720060715459},{"_id":"public/index.html","hash":"4f673ca1ad7507e40ac3a70c23ae21acc601bfd5","modified":1720060715459},{"_id":"public/page/2/index.html","hash":"d1ed3d074f5041eb2508b92b78313cf183ab41f4","modified":1720060715459},{"_id":"public/page/3/index.html","hash":"d083a116c45d6e785faeff086217881fc8045709","modified":1720060715459},{"_id":"public/page/4/index.html","hash":"416fd38b474d78fa7a54fe1c1b610a927543ec7f","modified":1720060715459},{"_id":"public/tags/ImageView/index.html","hash":"26b505a53c80a38ae4878694f2828afeb824665d","modified":1720060715459},{"_id":"public/tags/RecycleView/index.html","hash":"75bbd01ebb79bd5f3b6f396180371bf5ccea3eca","modified":1720060715459},{"_id":"public/tags/安卓开发/index.html","hash":"b767bf5ad99b7ae286daee62d63fc98a7259d9f7","modified":1720060715459},{"_id":"public/tags/tabLayout/index.html","hash":"1f7ca89b9f247fcae50fc832124e2ec170e3b016","modified":1720060715459},{"_id":"public/tags/viewPager2/index.html","hash":"df3854028a4f91d461dd03c2a6bea33ba33807a5","modified":1720060715459},{"_id":"public/tags/fragment/index.html","hash":"e8c78d5f5ce889f3da0ed4cbc145556c070bb2be","modified":1720060715459},{"_id":"public/tags/Intent/index.html","hash":"fdeb5791bc572a3da0bc669b102dc55469326f50","modified":1720060715459},{"_id":"public/tags/setFlags/index.html","hash":"210eecee738e67d4f4a6142a89abf50332c97adc","modified":1720060715459},{"_id":"public/tags/单例模式/index.html","hash":"75b343a2d787f492227093cebba555a43370b074","modified":1720060715459},{"_id":"public/tags/Android/index.html","hash":"1e8c875432725f5245ae16d68e43181098e174af","modified":1720060715459},{"_id":"public/tags/总结/index.html","hash":"927ff111eddda5bfacdc1dc43cdcb2ed905818a3","modified":1720060715459},{"_id":"public/tags/逆向工程/index.html","hash":"562194f0af04e3db21209adbb58de0916b1a7b54","modified":1720060715459},{"_id":"public/tags/Mac/index.html","hash":"32195a2701b4f597535f9eb93cd50ee01626dd83","modified":1720060715459},{"_id":"public/tags/Java/index.html","hash":"0d4f90fb8d40dc9fc4010988b148d8f1fef5e4c6","modified":1720060715459},{"_id":"public/tags/背景图/index.html","hash":"ca69e1b8ac735fc9b7baf53aaca78fb401bec431","modified":1720060715459},{"_id":"public/tags/Drawable/index.html","hash":"6c89707796e3aca2ae2bc78d7232ff8d4452e2c6","modified":1720060715459},{"_id":"public/tags/xml/index.html","hash":"a58724ab4e42b77d79bc2c98e0337688e1760e15","modified":1720060715459},{"_id":"public/tags/EditText/index.html","hash":"e42acb6fa4922e1edd4af50f691a1b113b570800","modified":1720060715459},{"_id":"public/tags/密文/index.html","hash":"abc8e5d3fc0767da658fa835e003ea741bd8cdc4","modified":1720060715459},{"_id":"public/tags/一键清除/index.html","hash":"0d32663d8b1d8f337e4b4038615f116006cebdcf","modified":1720060715459},{"_id":"public/tags/Solidity/index.html","hash":"a097932361440913d000ded7d6294247197fea4a","modified":1720060715459},{"_id":"public/tags/IDEA/index.html","hash":"5247d13e11a334adb11d35ffd2d1969357b2acaf","modified":1720060715459},{"_id":"public/tags/运维/index.html","hash":"fc98ced3c4f688d2e9998c8d9961d7b6f30e6f20","modified":1720060715459},{"_id":"public/tags/Linux命令/index.html","hash":"adf382615b6d779445898cbfa4f6f0f831c517e4","modified":1720060715459},{"_id":"public/tags/防火墙/index.html","hash":"94837d239d8eb99aa683f34b480049731eee0a4b","modified":1720060715459},{"_id":"public/tags/Rust/index.html","hash":"45dd560e394b5a4b6a84834b5430e3e0d32b9aa0","modified":1720060715459},{"_id":"public/tags/closure/index.html","hash":"e9c627203fa62f237506bdd988369e5884706b13","modified":1720060715459},{"_id":"public/tags/函数式编程/index.html","hash":"ebac0fc7060324193e12dd8cfc7a6531d9218d73","modified":1720060715459},{"_id":"public/tags/Rust-编程/index.html","hash":"b8e3f4862b1cadedb393b21461b8a8435c125cb6","modified":1720060715459},{"_id":"public/tags/ubuntu/index.html","hash":"d58fd23ab0b5789b8993ccb7b8969327de6a512a","modified":1720060715459},{"_id":"public/tags/自动化测试/index.html","hash":"dec992200804c37395a61871ea0c4295f70a74b3","modified":1720060715459},{"_id":"public/tags/eth/index.html","hash":"81bb85374a69f044d8af7c32aed3c4241b68aefa","modified":1720060715459},{"_id":"public/tags/NFT/index.html","hash":"34e995fa1803bc20ba5addc9b964ecfe10469f66","modified":1720060715459},{"_id":"public/tags/jQuery/index.html","hash":"4a94bfdf91e887721a24041a5eec0423a9554c0b","modified":1720060715459},{"_id":"public/tags/表格/index.html","hash":"d6a1197860909b2e38bed01828a83d9b4d845908","modified":1720060715459},{"_id":"public/tags/表单验证/index.html","hash":"d385a532a49047cb248fec3b6e659df5872b1a35","modified":1720060715459},{"_id":"public/tags/hexo/index.html","hash":"da36864cb72e1d495d083b6b61253e97001e32c7","modified":1720060715459},{"_id":"public/tags/github/index.html","hash":"397487985d07083178c843197c3945506ec1bb8e","modified":1720060715459},{"_id":"public/tags/Linux/index.html","hash":"74100303ae2b52a23d0ce012d48f3e1416145e7d","modified":1720060715459},{"_id":"public/tags/jsDelivr/index.html","hash":"3d4f517c929cb92b1d84f1d41eca276300053696","modified":1720060715459},{"_id":"public/tags/PicGo/index.html","hash":"ecf465c58bbc851430944a99b22f62ffe1455551","modified":1720060715459},{"_id":"public/tags/mysql/index.html","hash":"b62a98343982894849fa0419f6f0fb934300dc49","modified":1720060715459},{"_id":"public/tags/rails/index.html","hash":"95d049017060e61f9ce31f5ade8effb230b747d0","modified":1720060715459},{"_id":"public/tags/Redis/index.html","hash":"067b1075f9281e07e31195ea6120117896cb4855","modified":1720060715459},{"_id":"public/tags/字面量/index.html","hash":"9e9b77fb963a1e05bbd3d4863cfda60dc0002040","modified":1720060715459},{"_id":"public/tags/0u8/index.html","hash":"ff98099bd213d56ba692f6271c81e6ac828073fb","modified":1720060715459},{"_id":"public/tags/linux/index.html","hash":"8784a43f4fc3d2e9f2a6ad9f878d5be8084f907b","modified":1720060715459},{"_id":"public/tags/zsh/index.html","hash":"bf63d63f4bb6c75a4cfe4a431ee57ca61bda49ba","modified":1720060715459},{"_id":"public/tags/chmod/index.html","hash":"4c0ed47c99c50abac72cf48b0347f6f9b1b6ab72","modified":1720060715459},{"_id":"public/tags/Runtime/index.html","hash":"a06b5051eec890a19c438b5fdea16ab3e9567c4f","modified":1720060715459},{"_id":"public/tags/ruby/index.html","hash":"370f464226000301f16791ec45728946d56bf4af","modified":1720060715459},{"_id":"public/tags/常用命令/index.html","hash":"3929e2183ca8eadd1c538d35c7b72f7cb1327e8a","modified":1720060715459},{"_id":"public/tags/MacOs/index.html","hash":"619f7e9dcb30cc16d102690b3e7b84666fa7a706","modified":1720060715459},{"_id":"public/tags/服务器搭建/index.html","hash":"40d92718d95110231b3ef771a4d9941c8c17a354","modified":1720060715459},{"_id":"public/tags/Vim/index.html","hash":"9bdec8ddc9fe75077cd51ce5d1db4816d0517647","modified":1720060715459},{"_id":"public/tags/nginx/index.html","hash":"99ec6e35d8b12b7e29330096f16b2d75335d8ad6","modified":1720060715459},{"_id":"public/tags/SSH/index.html","hash":"45812475bf0bfb9f75fd02b9ddf0b166d660c092","modified":1720060715459},{"_id":"public/tags/腾讯云服务器/index.html","hash":"9681073323c2079d95f55dd939c20133ced4b016","modified":1720060715459},{"_id":"public/favicon.png","hash":"61c2eabaf46078d39a745a6c0f69e8fe33aa8775","modified":1720060715459},{"_id":"public/fancybox/blank.gif","hash":"4ffebfc1255c0da73aab342450a9ee09fcaccb86","modified":1720060715459},{"_id":"public/fancybox/fancybox_loading@2x.gif","hash":"381e91e67e85bfda09ce8b88205d93d9a7d20d4d","modified":1720060715459},{"_id":"public/fancybox/fancybox_loading.gif","hash":"4fbaf63664f65a42bef60289c887cd61a925ce4c","modified":1720060715459},{"_id":"public/fancybox/fancybox_overlay.png","hash":"beb714da455e5dbdbf7b2ed466ff4308c103addb","modified":1720060715459},{"_id":"public/fancybox/fancybox_sprite@2x.png","hash":"ecf1523aefe416a4cc901ab4cda5d488e3d9cd76","modified":1720060715459},{"_id":"public/fonts/fontawesome-webfont.eot","hash":"0183979056f0b87616cd99d5c54a48f3b771eee6","modified":1720060715459},{"_id":"public/fancybox/fancybox_sprite.png","hash":"0657b6b574bafc4c819c7d6c3bc5dd7205c8eee7","modified":1720060715459},{"_id":"public/css/fonts/Fixedsys500c.otf","hash":"e1fede43e072a990b9cd9899cdd26b78b30d305d","modified":1720060715459},{"_id":"public/fonts/fontawesome-webfont.woff","hash":"7d65e0227d0d7cdc1718119cd2a7dce0638f151c","modified":1720060715459},{"_id":"public/css/fonts/Fixedsys500c.eot","hash":"49611cf2e4d7e5c489c191f994ba7ac315bcce5c","modified":1720060715459},{"_id":"public/css/fonts/Fixedsys500c.woff","hash":"21f8e34c5e252a54710c5f6b0e363b9c43f979b2","modified":1720060715459},{"_id":"public/css/fonts/Fixedsys500c.ttf","hash":"19a8e49df8611dd0d90133a2eb0e410c23932db4","modified":1720060715459},{"_id":"public/fonts/google-fonts/0AKsP294HTD-nvJgucYTaIbN6UDyHWBl620a-IRfuBk.woff","hash":"1d9bb14c006d39d7eb0812a85567c7431f899b8d","modified":1720060715459},{"_id":"public/fonts/google-fonts/2UX7WLTfW3W8TclTUvlFyQ.woff","hash":"87deb174af2e2beebb9f09d618a5159ca299a3d0","modified":1720060715459},{"_id":"public/fonts/google-fonts/PIPMHY90P7jtyjpXuZ2cLD8E0i7KZn-EPnyo3HZu7kw.woff","hash":"18dc51e642b4df958098d3bbc6d3ba0237ef6150","modified":1720060715459},{"_id":"public/fonts/google-fonts/LKf8nhXsWg5ybwEGXk8UBQ.woff","hash":"f401d51152681048c06187c5d3919b1407b899c5","modified":1720060715459},{"_id":"public/fonts/google-fonts/0XxGQsSc1g4rdRdjJKZrNBsxEYwM7FgeyaSgU71cLG0.woff","hash":"33225e85c33279e7b4f0c5c65ff93bec740dd59c","modified":1720060715459},{"_id":"public/fonts/google-fonts/UyYrYy3ltEffJV9QueSi4RdbPw3QSf9R-kE0EsQUn2A.woff","hash":"d9f913d09bb3c25749daf8e7ab829c850a842929","modified":1720060715459},{"_id":"public/fonts/google-fonts/cj2hUnSRBhwmSPr9kS5899kZXW4sYc4BjuAIFc1SXII.woff","hash":"17a484b92c0dacc8e8b4f0d38ccc1db400819d1d","modified":1720060715459},{"_id":"public/fonts/google-fonts/lILlYDvubYemzYzN7GbLkHhCUOGz7vYGh680lGh-uXM.woff","hash":"e6c9f1e5a6a966a8f7250201356f351890a48921","modified":1720060715459},{"_id":"public/live2dw/lib/L2Dwidget.min.js","hash":"5f1a807437cc723bcadc3791d37add5ceed566a2","modified":1720060715459},{"_id":"public/css/prism-tomorrow.css","hash":"3b99487dfc9b4e51e9105a93743b92a761840e34","modified":1720060715459},{"_id":"public/css/prism-line-numbers.css","hash":"a1692758d22c6cdf6fd1a8dafc9b4b98e41d3138","modified":1720060715459},{"_id":"public/fonts/FontAwesome.otf","hash":"6270a4a561a69fef5f5cc18cdf9efc256ec2ccbe","modified":1720060715459},{"_id":"public/fonts/fontawesome-webfont.ttf","hash":"6225ccc4ec94d060f19efab97ca42d842845b949","modified":1720060715459},{"_id":"public/css/fonts/Fixedsys500c.svg","hash":"584b95873e60ea5d4212dc42cb37f4643d3a1915","modified":1720060715459},{"_id":"public/live2dw/lib/L2Dwidget.min.js.map","hash":"3290fe2df45f065b51a1cd7b24ec325cbf9bb5ce","modified":1720060715459},{"_id":"public/css/highlight.css","hash":"1a80da34ab77a25bf81f45af1f05e6fdf78409d3","modified":1720060715459},{"_id":"public/css/bootstrap-responsive.css","hash":"ea29a73addac5004ba4e7e4860e895cf15a5aa31","modified":1720060715459},{"_id":"public/css/font-awesome.css","hash":"180959029f82028c2100b7eeec7665412a49e588","modified":1720060715459},{"_id":"public/css/prism.css","hash":"4c53536a9051b13afc4c1f1082923c6b48ea3db1","modified":1720060715459},{"_id":"public/css/responsive.css","hash":"30f6a26aa0a5368d24a68575eb3fe254de7b92d2","modified":1720060715459},{"_id":"public/css/style.css","hash":"25bb16906426075c57d422d9b934f6e15d993200","modified":1720060715459},{"_id":"public/fancybox/jquery.fancybox.css","hash":"cbb69ef9748bf92edc3eb4b269b77ad25465d049","modified":1720060715459},{"_id":"public/css/google-fonts.css","hash":"06db66e315b47f844fb208b50e5710606360b142","modified":1720060715459},{"_id":"public/fancybox/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1720060715459},{"_id":"public/js/gallery.js","hash":"10cad81731825178f3d30b80a2694a377c1fb7a6","modified":1720060715459},{"_id":"public/js/bootstrap.min.js","hash":"5814e91bb6276f4de8b7951c965f2f190a03978d","modified":1720060715459},{"_id":"public/js/main.js","hash":"e3fcd795564533a3984b0ce327bd8dff44145f89","modified":1720060715459},{"_id":"public/js/jquery.imagesloaded.min.js","hash":"3eb6381d2ed4b706020e4be5aff024aab4bcabc5","modified":1720060715459},{"_id":"public/js/search.js","hash":"a882244488031de498176fc6af35cea2a13c7a18","modified":1720060715459},{"_id":"public/js/md5.min.js","hash":"9fe6cc786714b853c0c4ade488c09288082dbcc4","modified":1720060715459},{"_id":"public/css/bootstrap.min.css","hash":"f32494db3bd68ccca0368f68ad7a9156e97a4831","modified":1720060715459},{"_id":"public/js/jquery-2.0.3.min.js","hash":"28daf1b2a995cc4de81154a9a9ebdbb98f7c9997","modified":1720060715459},{"_id":"public/live2dw/lib/L2Dwidget.0.min.js","hash":"35bb5b588b6de25c9be2dd51d3fd331feafac02d","modified":1720060715459},{"_id":"public/css/bootstrap.css.map","hash":"916c87ec5b34b3789db112dff0c88a874184ae8f","modified":1720060715459},{"_id":"public/fonts/FiraCode.ttf","hash":"25562828ef61c2981b59ab0ed20ffafa37a74441","modified":1720060715459},{"_id":"public/css/fonts/FiraCode.ttf","hash":"25562828ef61c2981b59ab0ed20ffafa37a74441","modified":1720060715459},{"_id":"public/fonts/fontawesome-webfont.svg","hash":"e471023286b7dd1d2ccc72f670a471cfdfeafab7","modified":1720060715459},{"_id":"public/live2dw/lib/L2Dwidget.0.min.js.map","hash":"35e71cc2a130199efb167b9a06939576602f0d75","modified":1720060715459}],"Category":[{"name":"Android","_id":"cly6nqmw000043ys2dp0zgsg4"},{"name":"ETH智能合约","_id":"cly6nqmwe000y3ys2hk48fzxz"},{"name":"IDEA","_id":"cly6nqmwg00153ys257fo3dv0"},{"name":"Linux","_id":"cly6nqmwi001d3ys26b0t7kjk"},{"name":"Rust","_id":"cly6nqmwj001k3ys2bd4i2fwt"},{"name":"Appium","_id":"cly6nqmwo00223ys2fnul95cz"},{"name":"NFT","_id":"cly6nqmwr002b3ys22mao9rka"},{"name":"web前端","_id":"cly6nqmws002h3ys233qg9f4w"},{"name":"Mac","_id":"cly6nqmwy002n3ys23n8c4tnx"},{"name":"Fail2ban","_id":"cly6nqmx1002u3ys24ioxhja1"},{"name":"图床","_id":"cly6nqmx300313ys20qhvhhv2"},{"name":"rails","_id":"cly6nqmx400373ys2c3zt8w5c"},{"name":"Redis","_id":"cly6nqmx5003d3ys26xl5fso4"},{"name":"mysql","_id":"cly6nqmx6003j3ys2h4a51o25"},{"name":"redis","_id":"cly6nqmx6003p3ys2ff9n7gv3"},{"name":"Ubuntu","_id":"cly6nqmx7003s3ys26pdr9tce"},{"name":"Java","_id":"cly6nqmx700403ys2fqk31v04"},{"name":"oh my zsh","_id":"cly6nqmx800493ys23q9vdl70"},{"name":"nginx","_id":"cly6nqmx8004d3ys20a0jhsct"},{"name":"钓鱼网站","_id":"cly6nqmx9004g3ys27j2sg4en"},{"name":"github","_id":"cly6nqmx9004l3ys2gdrpces9"}],"Data":[{"_id":"friends","data":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}]},{"_id":"musics","data":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}],"Page":[{"title":"friends","date":"2020-10-16T01:52:37.000Z","type":"friends","layout":"friends","_content":"","source":"friends/index.md","raw":"---\ntitle: friends\ndate: 2020-10-16 09:52:37\ntype: \"friends\"\nlayout: \"friends\"\n---\n","updated":"2020-10-16T01:52:58.751Z","path":"friends/index.html","comments":1,"_id":"cly6nqmvq00003ys22ur47hy7","content":"","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":""},{"title":"categories","date":"2020-10-16T01:47:22.000Z","type":"categories","layout":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2020-10-16 09:47:22\ntype: \"categories\"\nlayout: \"categories\"\n---\n","updated":"2020-10-16T01:48:21.798Z","path":"categories/index.html","comments":1,"_id":"cly6nqmvy00023ys20diceu72","content":"","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":""},{"title":"about","date":"2020-10-16T01:49:30.000Z","type":"about","layout":"about","_content":"","source":"about/index.md","raw":"---\ntitle: about\ndate: 2020-10-16 09:49:30\ntype: \"about\"\nlayout: \"about\"\n---\n","updated":"2020-10-16T01:50:04.295Z","path":"about/index.html","comments":1,"_id":"cly6nqmw100063ys26pstfb64","content":"","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":""},{"title":"contact","date":"2020-10-16T01:50:20.000Z","type":"contact","layout":"contact","_content":"","source":"contact/index.md","raw":"---\ntitle: contact\ndate: 2020-10-16 09:50:20\ntype: \"contact\"\nlayout: \"contact\"\n---\n","updated":"2020-10-16T01:50:57.397Z","path":"contact/index.html","comments":1,"_id":"cly6nqmw300083ys2fh777wq8","content":"","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":""},{"title":"tags","date":"2020-10-16T01:48:36.000Z","type":"tags","layout":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2020-10-16 09:48:36\ntype: \"tags\"\nlayout: \"tags\"\n---\n","updated":"2020-10-16T01:49:20.231Z","path":"tags/index.html","comments":1,"_id":"cly6nqmw4000a3ys208c0h6ny","content":"","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":""}],"Post":[{"title":"Android ImageView设置background和src的区别","date":"2020-10-21T09:03:01.000Z","_content":"\n#### 一、ImageView设置background和src的区别。\n\n* 1.src是图片内容（前景），bg是背景，可以同时使用。\n* 2.background会根据ImageView组件给定的长宽进行拉伸，而src就存放的是原图的大小，不会进行拉伸 。\n* 3.scaleType只对src起作用；bg可设置透明度。\n\n#### 二、ImageView几种不同的设置图片的方式。\n\n设置background：\n\n``` java\nimage.setBackground(getResources().getDrawable(R.drawable.black));//变形\nimage.setBackgroundResource(R.drawable.black);//变形 \nimage.setBackgroundDrawable(getResources().getDrawable(R.drawable.black));////变形\n\n```\n\n设置src:\n \n``` java\nimage.setImageDrawable(getResources().getDrawable(R.drawable.blackk)); //不会变形\n\nStringpath = Environment.getExternalStorageDirectory()+File.separator+\"test1.jpg\";\nBitmap bm = BitmapFactory.decodeFile(path);\nimage.setImageBitmap(bm);//不会变形\n\nimage.setImageResource(R.drawable.blackk);//不会变形\n\n```\n","source":"_posts/Android-ImageView设置background和src的区别.md","raw":"---\ntitle: Android ImageView设置background和src的区别\ndate: 2020-10-21 17:03:01\ncategories:\n- Android\ntags:\n- ImageView\n---\n\n#### 一、ImageView设置background和src的区别。\n\n* 1.src是图片内容（前景），bg是背景，可以同时使用。\n* 2.background会根据ImageView组件给定的长宽进行拉伸，而src就存放的是原图的大小，不会进行拉伸 。\n* 3.scaleType只对src起作用；bg可设置透明度。\n\n#### 二、ImageView几种不同的设置图片的方式。\n\n设置background：\n\n``` java\nimage.setBackground(getResources().getDrawable(R.drawable.black));//变形\nimage.setBackgroundResource(R.drawable.black);//变形 \nimage.setBackgroundDrawable(getResources().getDrawable(R.drawable.black));////变形\n\n```\n\n设置src:\n \n``` java\nimage.setImageDrawable(getResources().getDrawable(R.drawable.blackk)); //不会变形\n\nStringpath = Environment.getExternalStorageDirectory()+File.separator+\"test1.jpg\";\nBitmap bm = BitmapFactory.decodeFile(path);\nimage.setImageBitmap(bm);//不会变形\n\nimage.setImageResource(R.drawable.blackk);//不会变形\n\n```\n","slug":"Android-ImageView设置background和src的区别","published":1,"updated":"2020-10-21T09:16:22.392Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmvv00013ys26whn8m25","content":"<h4 id=\"一、ImageView设置background和src的区别。\"><a href=\"#一、ImageView设置background和src的区别。\" class=\"headerlink\" title=\"一、ImageView设置background和src的区别。\"></a>一、ImageView设置background和src的区别。</h4><ul>\n<li>1.src是图片内容（前景），bg是背景，可以同时使用。</li>\n<li>2.background会根据ImageView组件给定的长宽进行拉伸，而src就存放的是原图的大小，不会进行拉伸 。</li>\n<li>3.scaleType只对src起作用；bg可设置透明度。</li>\n</ul>\n<h4 id=\"二、ImageView几种不同的设置图片的方式。\"><a href=\"#二、ImageView几种不同的设置图片的方式。\" class=\"headerlink\" title=\"二、ImageView几种不同的设置图片的方式。\"></a>二、ImageView几种不同的设置图片的方式。</h4><p>设置background：</p>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\">image<span class=\"token punctuation\">.</span><span class=\"token function\">setBackground</span><span class=\"token punctuation\">(</span><span class=\"token function\">getResources</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getDrawable</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>drawable<span class=\"token punctuation\">.</span>black<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\" spellcheck=\"true\">//变形</span>\nimage<span class=\"token punctuation\">.</span><span class=\"token function\">setBackgroundResource</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>drawable<span class=\"token punctuation\">.</span>black<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\" spellcheck=\"true\">//变形 </span>\nimage<span class=\"token punctuation\">.</span><span class=\"token function\">setBackgroundDrawable</span><span class=\"token punctuation\">(</span><span class=\"token function\">getResources</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getDrawable</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>drawable<span class=\"token punctuation\">.</span>black<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\" spellcheck=\"true\">////变形</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>设置src:</p>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\">image<span class=\"token punctuation\">.</span><span class=\"token function\">setImageDrawable</span><span class=\"token punctuation\">(</span><span class=\"token function\">getResources</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getDrawable</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>drawable<span class=\"token punctuation\">.</span>blackk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">//不会变形</span>\n\nStringpath <span class=\"token operator\">=</span> Environment<span class=\"token punctuation\">.</span><span class=\"token function\">getExternalStorageDirectory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>File<span class=\"token punctuation\">.</span>separator<span class=\"token operator\">+</span><span class=\"token string\">\"test1.jpg\"</span><span class=\"token punctuation\">;</span>\nBitmap bm <span class=\"token operator\">=</span> BitmapFactory<span class=\"token punctuation\">.</span><span class=\"token function\">decodeFile</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nimage<span class=\"token punctuation\">.</span><span class=\"token function\">setImageBitmap</span><span class=\"token punctuation\">(</span>bm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\" spellcheck=\"true\">//不会变形</span>\n\nimage<span class=\"token punctuation\">.</span><span class=\"token function\">setImageResource</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>drawable<span class=\"token punctuation\">.</span>blackk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\" spellcheck=\"true\">//不会变形</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"一、ImageView设置background和src的区别。\"><a href=\"#一、ImageView设置background和src的区别。\" class=\"headerlink\" title=\"一、ImageView设置background和src的区别。\"></a>一、ImageView设置background和src的区别。</h4><ul>\n<li>1.src是图片内容（前景），bg是背景，可以同时使用。</li>\n<li>2.background会根据ImageView组件给定的长宽进行拉伸，而src就存放的是原图的大小，不会进行拉伸 。</li>\n<li>3.scaleType只对src起作用；bg可设置透明度。</li>\n</ul>\n<h4 id=\"二、ImageView几种不同的设置图片的方式。\"><a href=\"#二、ImageView几种不同的设置图片的方式。\" class=\"headerlink\" title=\"二、ImageView几种不同的设置图片的方式。\"></a>二、ImageView几种不同的设置图片的方式。</h4><p>设置background：</p>\n<pre><code class=\"java\">image.setBackground(getResources().getDrawable(R.drawable.black));//变形\nimage.setBackgroundResource(R.drawable.black);//变形 \nimage.setBackgroundDrawable(getResources().getDrawable(R.drawable.black));////变形\n</code></pre>\n<p>设置src:</p>\n<pre><code class=\"java\">image.setImageDrawable(getResources().getDrawable(R.drawable.blackk)); //不会变形\n\nStringpath = Environment.getExternalStorageDirectory()+File.separator+&quot;test1.jpg&quot;;\nBitmap bm = BitmapFactory.decodeFile(path);\nimage.setImageBitmap(bm);//不会变形\n\nimage.setImageResource(R.drawable.blackk);//不会变形\n</code></pre>\n"},{"title":"Android-RecycleView内部item点击事件","date":"2020-10-21T08:11:14.000Z","_content":"\n#### RecyclerView的使用——Item内部控件的点击事件\n\n##### 一、在adapter中写item点击事件的接口供外部的activity使用\n\n```` java\n/**\n* item内部的监听接口\n*/\n\npublic interface ItemInnerOnclickListener {\n    // 这个String id 是点击item是想要传的参数\n    void onItemInnerOnClick(int position, String id);\n}\n\nprivate ItemInnerOnclickListener mItemInnerOnclickListener;\n\npublic void setOnItemOnClickListener(ItemInnerOnclickListener mItemInnerOnclickListener) {\n    this.mItemInnerOnclickListener = mItemInnerOnclickListener;\n\n  }\n````\n\n在holder中就可以这么去写：(这里我使用了CommonAdapter 所以holder的代码可能不太一样)\n\n``` java\nholder.setOnClickListener(R.id.cancel_withdraw, new OnMultiClickListener() {\n  @Override\n  public void onMultiClick(View v) {\n    // record.id 是activity那边拿到数据后用bean来解析的 传递过来的数据\n    // public class WithdrawRecordsAdapter extends CommonAdapter<WithdrawRecordBean.Record>\n    mItemInnerOnclickListener.onItemInnerOnClick(position, record.id);\n  }\n});\n```\n\n##### 二、在activity中我们就可以这么去写\n\n``` java\nprivate WithdrawRecordsAdapter withdrawRecordsAdapter;\n```\n\n``` java\nwithdrawRecordsAdapter.setOnItemOnClickListener(new WithdrawRecordsAdapter.ItemInnerOnclickListener() {\n          @Override\n          public void onItemInnerOnClick(int position, String id) {\n            showDialog(id,position);\n          }\n        });\n```\n\n这里我们设置点击事件的时候去new了一个adapter中点击事件的接口，并且我们还可以拿到adapter中点击时想要传递的String id 去做一些事情\n\n\n\n\n","source":"_posts/Android-RecycleView内部item点击事件.md","raw":"---\ntitle: Android-RecycleView内部item点击事件\ndate: 2020-10-21 16:11:14\ncategories:\n- Android\ntags:\n- 安卓开发\n- RecycleView\n---\n\n#### RecyclerView的使用——Item内部控件的点击事件\n\n##### 一、在adapter中写item点击事件的接口供外部的activity使用\n\n```` java\n/**\n* item内部的监听接口\n*/\n\npublic interface ItemInnerOnclickListener {\n    // 这个String id 是点击item是想要传的参数\n    void onItemInnerOnClick(int position, String id);\n}\n\nprivate ItemInnerOnclickListener mItemInnerOnclickListener;\n\npublic void setOnItemOnClickListener(ItemInnerOnclickListener mItemInnerOnclickListener) {\n    this.mItemInnerOnclickListener = mItemInnerOnclickListener;\n\n  }\n````\n\n在holder中就可以这么去写：(这里我使用了CommonAdapter 所以holder的代码可能不太一样)\n\n``` java\nholder.setOnClickListener(R.id.cancel_withdraw, new OnMultiClickListener() {\n  @Override\n  public void onMultiClick(View v) {\n    // record.id 是activity那边拿到数据后用bean来解析的 传递过来的数据\n    // public class WithdrawRecordsAdapter extends CommonAdapter<WithdrawRecordBean.Record>\n    mItemInnerOnclickListener.onItemInnerOnClick(position, record.id);\n  }\n});\n```\n\n##### 二、在activity中我们就可以这么去写\n\n``` java\nprivate WithdrawRecordsAdapter withdrawRecordsAdapter;\n```\n\n``` java\nwithdrawRecordsAdapter.setOnItemOnClickListener(new WithdrawRecordsAdapter.ItemInnerOnclickListener() {\n          @Override\n          public void onItemInnerOnClick(int position, String id) {\n            showDialog(id,position);\n          }\n        });\n```\n\n这里我们设置点击事件的时候去new了一个adapter中点击事件的接口，并且我们还可以拿到adapter中点击时想要传递的String id 去做一些事情\n\n\n\n\n","slug":"Android-RecycleView内部item点击事件","published":1,"updated":"2020-10-21T08:29:38.800Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmvy00033ys25pwt3tds","content":"<h4 id=\"RecyclerView的使用——Item内部控件的点击事件\"><a href=\"#RecyclerView的使用——Item内部控件的点击事件\" class=\"headerlink\" title=\"RecyclerView的使用——Item内部控件的点击事件\"></a>RecyclerView的使用——Item内部控件的点击事件</h4><h5 id=\"一、在adapter中写item点击事件的接口供外部的activity使用\"><a href=\"#一、在adapter中写item点击事件的接口供外部的activity使用\" class=\"headerlink\" title=\"一、在adapter中写item点击事件的接口供外部的activity使用\"></a>一、在adapter中写item点击事件的接口供外部的activity使用</h5><pre class=\"line-numbers language-java\"><code class=\"language-java\"><span class=\"token comment\" spellcheck=\"true\">/**\n* item内部的监听接口\n*/</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">ItemInnerOnclickListener</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\" spellcheck=\"true\">// 这个String id 是点击item是想要传的参数</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">onItemInnerOnClick</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> position<span class=\"token punctuation\">,</span> String id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">private</span> ItemInnerOnclickListener mItemInnerOnclickListener<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setOnItemOnClickListener</span><span class=\"token punctuation\">(</span>ItemInnerOnclickListener mItemInnerOnclickListener<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mItemInnerOnclickListener <span class=\"token operator\">=</span> mItemInnerOnclickListener<span class=\"token punctuation\">;</span>\n\n  <span class=\"token punctuation\">}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>在holder中就可以这么去写：(这里我使用了CommonAdapter 所以holder的代码可能不太一样)</p>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\">holder<span class=\"token punctuation\">.</span><span class=\"token function\">setOnClickListener</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>cancel_withdraw<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OnMultiClickListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onMultiClick</span><span class=\"token punctuation\">(</span>View v<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\" spellcheck=\"true\">// record.id 是activity那边拿到数据后用bean来解析的 传递过来的数据</span>\n    <span class=\"token comment\" spellcheck=\"true\">// public class WithdrawRecordsAdapter extends CommonAdapter&lt;WithdrawRecordBean.Record></span>\n    mItemInnerOnclickListener<span class=\"token punctuation\">.</span><span class=\"token function\">onItemInnerOnClick</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">,</span> record<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h5 id=\"二、在activity中我们就可以这么去写\"><a href=\"#二、在activity中我们就可以这么去写\" class=\"headerlink\" title=\"二、在activity中我们就可以这么去写\"></a>二、在activity中我们就可以这么去写</h5><pre class=\"line-numbers language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> WithdrawRecordsAdapter withdrawRecordsAdapter<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\">withdrawRecordsAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">setOnItemOnClickListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">WithdrawRecordsAdapter<span class=\"token punctuation\">.</span>ItemInnerOnclickListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token annotation punctuation\">@Override</span>\n          <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onItemInnerOnClick</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> position<span class=\"token punctuation\">,</span> String id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">showDialog</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span>position<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>这里我们设置点击事件的时候去new了一个adapter中点击事件的接口，并且我们还可以拿到adapter中点击时想要传递的String id 去做一些事情</p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"RecyclerView的使用——Item内部控件的点击事件\"><a href=\"#RecyclerView的使用——Item内部控件的点击事件\" class=\"headerlink\" title=\"RecyclerView的使用——Item内部控件的点击事件\"></a>RecyclerView的使用——Item内部控件的点击事件</h4><h5 id=\"一、在adapter中写item点击事件的接口供外部的activity使用\"><a href=\"#一、在adapter中写item点击事件的接口供外部的activity使用\" class=\"headerlink\" title=\"一、在adapter中写item点击事件的接口供外部的activity使用\"></a>一、在adapter中写item点击事件的接口供外部的activity使用</h5><pre><code class=\"java\">/**\n* item内部的监听接口\n*/\n\npublic interface ItemInnerOnclickListener &#123;\n    // 这个String id 是点击item是想要传的参数\n    void onItemInnerOnClick(int position, String id);\n&#125;\n\nprivate ItemInnerOnclickListener mItemInnerOnclickListener;\n\npublic void setOnItemOnClickListener(ItemInnerOnclickListener mItemInnerOnclickListener) &#123;\n    this.mItemInnerOnclickListener = mItemInnerOnclickListener;\n\n  &#125;</code></pre>\n<p>在holder中就可以这么去写：(这里我使用了CommonAdapter 所以holder的代码可能不太一样)</p>\n<pre><code class=\"java\">holder.setOnClickListener(R.id.cancel_withdraw, new OnMultiClickListener() &#123;\n  @Override\n  public void onMultiClick(View v) &#123;\n    // record.id 是activity那边拿到数据后用bean来解析的 传递过来的数据\n    // public class WithdrawRecordsAdapter extends CommonAdapter&lt;WithdrawRecordBean.Record&gt;\n    mItemInnerOnclickListener.onItemInnerOnClick(position, record.id);\n  &#125;\n&#125;);</code></pre>\n<h5 id=\"二、在activity中我们就可以这么去写\"><a href=\"#二、在activity中我们就可以这么去写\" class=\"headerlink\" title=\"二、在activity中我们就可以这么去写\"></a>二、在activity中我们就可以这么去写</h5><pre><code class=\"java\">private WithdrawRecordsAdapter withdrawRecordsAdapter;</code></pre>\n<pre><code class=\"java\">withdrawRecordsAdapter.setOnItemOnClickListener(new WithdrawRecordsAdapter.ItemInnerOnclickListener() &#123;\n          @Override\n          public void onItemInnerOnClick(int position, String id) &#123;\n            showDialog(id,position);\n          &#125;\n        &#125;);</code></pre>\n<p>这里我们设置点击事件的时候去new了一个adapter中点击事件的接口，并且我们还可以拿到adapter中点击时想要传递的String id 去做一些事情</p>\n"},{"title":"Android tablayout viewpager2 fragment 你可能用错了","date":"2021-06-25T09:11:29.000Z","_content":"\n### tabLayout + viewPager2 + fragment 用不好会导致内存泄漏\n\n### 前言\n\ntabLayout + viewPager2 + fragment 这是在app开发中非常常见的UI架构了 但是用不好的话 是会导致内存泄漏的\n\n[Demo地址](https://github.com/Naruto-1996/ViewPager2_Demo)\n\n先上图: \n\n(`app`模板使用`android studio` 创建一个就行 我只用 `HomeFragment`)\n\n<img src=\"https://ae03.alicdn.com/kf/U3292cb58c99d44a3bcf092f9d0fba361h.png\" width = \"300\" height = \"600\" alt=\"图片名称\" align=center />\n\n### 先了解一下viewPager\n\n之前我们都是使用viewPager 但是 viewPager 有两个毛病 \n\n* 不能关闭预加载\n\n* 更新Adapter不生效\n\n虽然能解决 但是很麻烦\n\nviewPager 有个方法 `offscreenPageLimit` 用来设置 当前页前后预加载的数量 即使设置为0也不起任何作用 因为源码中默认值为1\n\n先来看个图:\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210625175636.png)\n\n上面是`ViewPager`默认情况下的加载示意图，当切换到当前页面时，会默认预加载左右两侧的布局到`ViewPager`中，\n尽管两侧的`View`并不可见的，我们称这种情况叫预加载；由于`ViewPager`对`offscreenPageLimit`设置了限制，\n页面的预加载是不可避免\n\n如果使用 一定要使用viewPager 也可以做到 fragment 懒加载 主要是对`fragment`做手脚 结合生命周期方法和setUserVisibleHint状态，控制数据延迟加载，而布局只能提前进入\n\n### viewPager2基本使用\n\n1、 承载tabLayout 和 viewPager2 需要一个 fragment 或者 activity 这里我们使用 fragment\n\n`HomeFragment` 如下:\n\n```java\n\npublic class HomeFragment extends Fragment {\n\n  private HomeViewModel homeViewModel;\n  private TabLayout tabLayout;\n  private ViewPager2 viewPager2;\n\n  private final ArrayList<String> tabTitles = new ArrayList<>();\n\n  // 用List 存放fragment 不推荐使用 用不好 导致内存泄漏\n  private ArrayList<BlankFragment> fragments = new ArrayList<>();\n\n\n\n  public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {\n    homeViewModel = new ViewModelProvider(this).get(HomeViewModel.class);\n    View root = inflater.inflate(R.layout.fragment_home, container, false);\n\n    tabLayout = root.findViewById(R.id.tabs);\n    viewPager2 = root.findViewById(R.id.viewPager);\n    return root;\n  }\n\n\n  @Override\n  public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {\n    super.onViewCreated(view, savedInstanceState);\n\n    // 初始化 tabTitles 和 fragments\n    for (int i = 0; i < 15; i++) {\n      tabTitles.add(String.valueOf(i));\n      fragments.add(BlankFragment.newInstance(tabTitles.get(i)));\n    }\n\n    // 关闭预加载\n    viewPager2.setOffscreenPageLimit(ViewPager2.OFFSCREEN_PAGE_LIMIT_DEFAULT);  // 可以不设置 因为默认是 -1 默认不进行预加载\n    // 这个必须设置 不然仍然会启用预加载\n    ((RecyclerView)viewPager2.getChildAt(0)).getLayoutManager().setItemPrefetchEnabled(false);\n    // 设置缓存数量，对应 RecyclerView 中的 mCachedViews，即屏幕外的视图数量\n    ((RecyclerView)viewPager2.getChildAt(0)).setItemViewCacheSize(0);\n\n    // 第一种方法 (可能会内存泄漏)\n    //FragmentAdapter adapter = new FragmentAdapter(this, fragments);\n    //viewPager2.setAdapter(adapter);\n\n    // 这里使用第二种方法\n    viewPager2.setAdapter(new FragmentStateAdapter(this) {\n      @NonNull\n      @Override\n      public Fragment createFragment(int position) {\n        return BlankFragment.newInstance(tabTitles.get(position));\n      }\n\n      @Override\n      public int getItemCount() {\n        return tabTitles.size();\n      }\n\n    });\n    // viewPager2 滑动监听\n    viewPager2.registerOnPageChangeCallback(new ViewPager2.OnPageChangeCallback() {\n      @Override\n      public void onPageSelected(int position) {\n        super.onPageSelected(position);\n\n      }\n    });\n\n    // 这里第四个参数一定要设置为false  如果设置为true时 我们在滑动时 BlankFragment的创建 和 销毁 都很正常\n    // 一旦 我们通过 点击tabLayout时 如果两个tab距离过远  那么所有划过的tabLayout 都会创建和销毁BlankFragment 这显然不是我们想要的\n\n    // tabLayout 和 viewPager 联动\n    new TabLayoutMediator(tabLayout, viewPager2,true,false, new TabLayoutMediator.TabConfigurationStrategy() {\n      @Override\n      public void onConfigureTab(@NonNull TabLayout.Tab tab, int position) {\n        tab.setText(tabTitles.get(position));\n      }\n    }).attach();\n\n\n  }\n\n}\n\n```\n\n`fragment_home.xml` 布局文件:\n\n```xml\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n  xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n  xmlns:tools=\"http://schemas.android.com/tools\"\n  android:layout_width=\"match_parent\"\n  android:orientation=\"vertical\"\n  android:layout_height=\"match_parent\"\n  tools:context=\".ui.home.HomeFragment\">\n\n  <com.google.android.material.tabs.TabLayout\n    android:id=\"@+id/tabs\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"40dp\"\n    app:tabGravity=\"center\"\n    app:tabIndicatorColor=\"#ff678f\"\n    app:tabIndicatorFullWidth=\"false\"\n    app:tabIndicatorHeight=\"2dp\"\n    app:tabMode=\"scrollable\"\n    android:layout_marginTop=\"0dp\"\n    app:tabSelectedTextColor=\"#ff678f\"\n    app:tabTextColor=\"#333333\"\n    app:tabUnboundedRipple=\"true\" />\n\n\n  <androidx.viewpager2.widget.ViewPager2\n    android:id=\"@+id/viewPager\"\n    android:layout_width=\"match_parent\"\n    android:background=\"@color/purple_200\"\n    android:layout_height=\"0dp\"\n    android:layout_weight=\"1\"/>\n</LinearLayout>\n\n```\n\n2、viewPager2的 FragmentStateAdapter 创建fragment时 我们 复用一个fragment\n\n`BlankFragment` 如下:\n\n```java\n\npublic class BlankFragment extends Fragment {\n\n  private String mParam1;\n  private TextView mTextView;\n\n  public static BlankFragment newInstance(String param1) {\n    BlankFragment fragment = new BlankFragment();\n    Bundle args = new Bundle();\n    args.putString(\"param1\", param1);\n    fragment.setArguments(args);\n    return fragment;\n  }\n\n  @Override\n  public void onPause() {\n    super.onPause();\n    Log.i(\"TAG=======onPause\", mParam1);\n  }\n\n  @Override\n  public void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    if (getArguments() != null) {\n      mParam1 = getArguments().getString(\"param1\");\n    }\n\n    Log.i(\"TAG=======onCreate\", mParam1);\n    Toast.makeText(getContext(), mParam1, Toast.LENGTH_SHORT).show();\n  }\n\n\n\n  @Override\n  public void onDestroy() {\n    super.onDestroy();\n    Log.i(\"TAG=======onDestroy\", mParam1);\n  }\n\n  @Override\n  public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {\n    // Inflate the layout for this fragment\n    View root = inflater.inflate(R.layout.fragment_blank, container, false);\n    mTextView = root.findViewById(R.id.text1);\n    mTextView.setText(mParam1);\n    Log.i(\"TAG=======onCreateView\", mParam1);\n    return root;\n  }\n\n  // 对外提供一个刷新Ui的方法\n  public void refreshUi() {\n    if (getArguments() != null) {\n      mParam1 = getArguments().getString(\"param1\");\n      mTextView.setText(mParam1 + \"ddd\");\n    }\n\n  }\n\n  @Override\n  public void onDestroyView() {\n    super.onDestroyView();\n    Log.i(\"TAG======onDestroyView\", mParam1);\n  }\n}\n\n```\n\n`fragment_blank.xml` 如下:\n\n```xml\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n  xmlns:tools=\"http://schemas.android.com/tools\"\n  android:layout_width=\"match_parent\"\n  android:layout_height=\"match_parent\"\n  android:orientation=\"vertical\"\n  android:gravity=\"center\"\n  tools:context=\".ui.BlankFragment\">\n\n  <TextView\n    android:id=\"@+id/text1\"\n    android:textSize=\"26sp\"\n    android:layout_width=\"wrap_content\"\n    android:layout_height=\"wrap_content\"\n    android:text=\"black\"/>\n\n</LinearLayout>\n\n```\n\n至此 我们已经完成了 tabLayout + viewPager2 + fragment \n\n### viewPager2常用方法\n\n* `setAdapter()` 设置适配器\n* `setOrientation()` 设置布局方向\n* `setCurrentItem()` 设置当前Item下标\n* `beginFakeDrag()` 开始模拟拖拽\n* `fakeDragBy()` 模拟拖拽中\n* `endFakeDrag()` 模拟拖拽结束\n* `setUserInputEnabled()` 设置是否允许用户输入/触摸\n* `setOffscreenPageLimit()` 设置屏幕外加载页面数量\n* `registerOnPageChangeCallback()` 注册页面滑动监听回调\n* `setPageTransformer()` 设置页面滑动时的变换效果\n\n\n### ViewPager2 预加载和缓存\n\n`viewPager2` 是存在预加载和缓存的 我们虽然可以通过`offscreenPageLimit` 去设置预加载的数量 但是 `viewPager2` 会默认帮我们\n缓存两个`fragment` 意思就是我们再滑动回来时 不会再去走 fragment 创建的生命周期了 会走 onResume 生命周期函数\n\n`one picture is worth a thousand words` :\n\n`viewPager2` 默认开启预加载 \n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210625182426.png)\n\n**如何关闭预加载、并设置缓存数量**\n\n**常见设置如下**\n\n```java\n\n//设置应保留在当前可见页面两侧的页面数\nviewPager2.setOffscreenPageLimit(4);\n\n//关闭预加载\n((RecyclerView)viewPager2.getChildAt(0)).getLayoutManager().setItemPrefetchEnabled(false);\n\n//设置缓存数量，对应 RecyclerView 中的 mCachedViews，即屏幕外的视图数量\n((RecyclerView)viewPager2.getChildAt(0)).setItemViewCacheSize(4);\n\n```\n\n`viewPager2` 会默认缓存2个`ItemView`\n\n我们将`((RecyclerView)viewPager2.getChildAt(0)).setItemViewCacheSize(0);` 设置为`0`即可 这样我们每次滑动一个新的`tab`时 会创建\n新的`fragment`并销毁上一个`fragment`\n\n### viewPager2 对 fragment 的支持\n\n目前，`ViewPager2`对`Fragment`的支持只能使用`FragmentStateAdapter`，使用起来也是非常简单：\n\n\n```java\n\nviewPager2.setAdapter(new FragmentStateAdapter(this) {\n  @NonNull\n  @Override\n  public Fragment createFragment(int position) {\n    return BlankFragment.newInstance(tabTitles.get(position));\n  }\n\n  @Override\n  public int getItemCount() {\n    return tabTitles.size();\n  }\n\n});\n\n```\n\n### 另外还有一个小坑 \n\n**ViewPager2+TabLayout懒加载问题，Fragment被创建多次**\n\n`ViewPager2`默认只加载当前页面，相当于官方处理了`Fragment`的懒加载问题，当你使用代码\n\n```\n\nnew TabLayoutMediator(tabLayout, viewPager, true, new TabLayoutMediator.TabConfigurationStrategy() {\n\n       @Override\n\n       public void onConfigureTab(@NonNull TabLayout.Tab tab, int position) {\n\n           tab.setText(titles.get(position));\n\n       }\n\n}).attach();\n\n```\n\n此时当你滑动`ViewPager2`时，滑动到某个`Fragment`页面才会加载，执行onCreateView()方法，\n\n但是当你手动点击`TabLayout`时，此时懒加载就会失效，`onCreateView()`会被执行多次，\n\n原因就是...此时`ViewPager2`默认是平滑滚动的，滚动滑过的`Fragment`都会被加载，\n\n**只需修改代码:**\n\n```java\n\nnew TabLayoutMediator(tabLayout, viewPager, true,false, new TabLayoutMediator.TabConfigurationStrategy() {\n\n            @Override\n\n            public void onConfigureTab(@NonNull TabLayout.Tab tab, int position) {\n\n                tab.setText(titles.get(position));\n\n            }\n\n}).attach();\n\n```\n\n其中，第二个`boolean`参数为`smoothScroll` 一定要填`false`  这时点击 哪个`tab` 就会创建 哪个 `fragment`\n\n但是页面看起来没有那么平滑了 各有利弊吧\n\n**---------------------------------------------------------------------------------------**\n\n如果 需要点击tab无动画 滑动页面时有动画 怎么办呢?\n\nTabLayoutMediator 是final类  且smoothScroll字段是私有的、我们没法继承重写、但是可以copy源码修改、不会有问题\n\n我们将 源码copy下来 稍作修改就可以用了 下面是修改好的代码:\n\n```java\n\nimport static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_DRAGGING;\nimport static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_IDLE;\nimport static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_SETTLING;\n\nimport androidx.annotation.NonNull;\nimport androidx.annotation.Nullable;\nimport androidx.recyclerview.widget.RecyclerView;\nimport androidx.viewpager2.widget.ViewPager2;\n\nimport com.google.android.material.tabs.TabLayout;\n\nimport java.lang.ref.WeakReference;\n\n/**\n * A mediator to link a TabLayout with a ViewPager2. The mediator will synchronize the ViewPager2's\n * position with the selected tab when a tab is selected, and the TabLayout's scroll position when\n * the user drags the ViewPager2. TabLayoutMediator will listen to ViewPager2's OnPageChangeCallback\n * to adjust tab when ViewPager2 moves. TabLayoutMediator listens to TabLayout's\n * OnTabSelectedListener to adjust VP2 when tab moves. TabLayoutMediator listens to RecyclerView's\n * AdapterDataObserver to recreate tab content when dataset changes.\n *\n * <p>Establish the link by creating an instance of this class, make sure the ViewPager2 has an\n * adapter and then call {@link #attach()} on it. Instantiating a TabLayoutMediator will only create\n * the mediator object, {@link #attach()} will link the TabLayout and the ViewPager2 together. When\n * creating an instance of this class, you must supply an implementation of {@link\n * com.google.android.material.tabs.TabLayoutMediator.TabConfigurationStrategy} in which you set the text of the tab, and/or perform any styling of the\n * tabs that you require. Changing ViewPager2's adapter will require a {@link #detach()} followed by\n * {@link #attach()} call. Changing the ViewPager2 or TabLayout will require a new instantiation of\n * TabLayoutMediator.\n */\npublic final class TabLayoutMediators {\n  @NonNull private final TabLayout tabLayout;\n  @NonNull private final ViewPager2 viewPager;\n  private final boolean autoRefresh;\n  // 这里我们改为静态变量 以便于在静态方法中使用这个变量\n  private static boolean smoothScroll;\n  private final TabConfigurationStrategy tabConfigurationStrategy;\n  @Nullable private RecyclerView.Adapter<?> adapter;\n  private boolean attached;\n\n  @Nullable private TabLayoutOnPageChangeCallback onPageChangeCallback;\n  @Nullable private TabLayout.OnTabSelectedListener onTabSelectedListener;\n  @Nullable private RecyclerView.AdapterDataObserver pagerAdapterObserver;\n\n  /**\n   * A callback interface that must be implemented to set the text and styling of newly created\n   * tabs.\n   */\n  public interface TabConfigurationStrategy {\n    /**\n     * Called to configure the tab for the page at the specified position. Typically calls {@link\n     * TabLayout.Tab#setText(CharSequence)}, but any form of styling can be applied.\n     *\n     * @param tab The Tab which should be configured to represent the title of the item at the given\n     *     position in the data set.\n     * @param position The position of the item within the adapter's data set.\n     */\n    void onConfigureTab(@NonNull TabLayout.Tab tab, int position);\n  }\n\n  public TabLayoutMediators(\n    @NonNull TabLayout tabLayout,\n    @NonNull ViewPager2 viewPager,\n    @NonNull TabConfigurationStrategy tabConfigurationStrategy) {\n    this(tabLayout, viewPager, /* autoRefresh= */ true, tabConfigurationStrategy);\n  }\n\n  public TabLayoutMediators(\n    @NonNull TabLayout tabLayout,\n    @NonNull ViewPager2 viewPager,\n    boolean autoRefresh,\n    @NonNull TabConfigurationStrategy tabConfigurationStrategy) {\n    this(tabLayout, viewPager, autoRefresh, /* smoothScroll= */ true, tabConfigurationStrategy);\n  }\n\n  public TabLayoutMediators(\n    @NonNull TabLayout tabLayout,\n    @NonNull ViewPager2 viewPager,\n    boolean autoRefresh,\n    boolean smoothScroll,\n    @NonNull TabConfigurationStrategy tabConfigurationStrategy) {\n    this.tabLayout = tabLayout;\n    this.viewPager = viewPager;\n    this.autoRefresh = autoRefresh;\n    TabLayoutMediators.smoothScroll = smoothScroll;\n    this.tabConfigurationStrategy = tabConfigurationStrategy;\n  }\n\n  /**\n   * Link the TabLayout and the ViewPager2 together. Must be called after ViewPager2 has an adapter\n   * set. To be called on a new instance of TabLayoutMediator or if the ViewPager2's adapter\n   * changes.\n   *\n   * @throws IllegalStateException If the mediator is already attached, or the ViewPager2 has no\n   *     adapter.\n   */\n  public void attach() {\n    if (attached) {\n      throw new IllegalStateException(\"TabLayoutMediator is already attached\");\n    }\n    adapter = viewPager.getAdapter();\n    if (adapter == null) {\n      throw new IllegalStateException(\n        \"TabLayoutMediator attached before ViewPager2 has an \" + \"adapter\");\n    }\n    attached = true;\n\n    // Add our custom OnPageChangeCallback to the ViewPager\n    onPageChangeCallback = new TabLayoutOnPageChangeCallback(tabLayout);\n    viewPager.registerOnPageChangeCallback(onPageChangeCallback);\n\n    // Now we'll add a tab selected listener to set ViewPager's current item\n    onTabSelectedListener = new ViewPagerOnTabSelectedListener(viewPager, smoothScroll);\n    tabLayout.addOnTabSelectedListener(onTabSelectedListener);\n\n    // Now we'll populate ourselves from the pager adapter, adding an observer if\n    // autoRefresh is enabled\n    if (autoRefresh) {\n      // Register our observer on the new adapter\n      pagerAdapterObserver = new PagerAdapterObserver();\n      adapter.registerAdapterDataObserver(pagerAdapterObserver);\n    }\n\n    populateTabsFromPagerAdapter();\n\n    // Now update the scroll position to match the ViewPager's current item\n    tabLayout.setScrollPosition(viewPager.getCurrentItem(), 0f, true);\n  }\n\n  /**\n   * Unlink the TabLayout and the ViewPager. To be called on a stale TabLayoutMediator if a new one\n   * is instantiated, to prevent holding on to a view that should be garbage collected. Also to be\n   * called before {@link #attach()} when a ViewPager2's adapter is changed.\n   */\n  public void detach() {\n    if (autoRefresh && adapter != null) {\n      adapter.unregisterAdapterDataObserver(pagerAdapterObserver);\n      pagerAdapterObserver = null;\n    }\n    tabLayout.removeOnTabSelectedListener(onTabSelectedListener);\n    viewPager.unregisterOnPageChangeCallback(onPageChangeCallback);\n    onTabSelectedListener = null;\n    onPageChangeCallback = null;\n    adapter = null;\n    attached = false;\n  }\n\n  @SuppressWarnings(\"WeakerAccess\")\n  void populateTabsFromPagerAdapter() {\n    tabLayout.removeAllTabs();\n\n    if (adapter != null) {\n      int adapterCount = adapter.getItemCount();\n      for (int i = 0; i < adapterCount; i++) {\n        TabLayout.Tab tab = tabLayout.newTab();\n        tabConfigurationStrategy.onConfigureTab(tab, i);\n        tabLayout.addTab(tab, false);\n      }\n      // Make sure we reflect the currently set ViewPager item\n      if (adapterCount > 0) {\n        int lastItem = tabLayout.getTabCount() - 1;\n        int currItem = Math.min(viewPager.getCurrentItem(), lastItem);\n        if (currItem != tabLayout.getSelectedTabPosition()) {\n          tabLayout.selectTab(tabLayout.getTabAt(currItem));\n        }\n      }\n    }\n  }\n\n  /**\n   * A {@link ViewPager2.OnPageChangeCallback} class which contains the necessary calls back to the\n   * provided {@link TabLayout} so that the tab position is kept in sync.\n   *\n   * <p>This class stores the provided TabLayout weakly, meaning that you can use {@link\n   * ViewPager2#registerOnPageChangeCallback(ViewPager2.OnPageChangeCallback)} without removing the\n   * callback and not cause a leak.\n   */\n  private static class TabLayoutOnPageChangeCallback extends ViewPager2.OnPageChangeCallback {\n    @NonNull private final WeakReference<TabLayout> tabLayoutRef;\n    private int previousScrollState;\n    private int scrollState;\n\n    TabLayoutOnPageChangeCallback(TabLayout tabLayout) {\n      tabLayoutRef = new WeakReference<>(tabLayout);\n      reset();\n    }\n\n    @Override\n    public void onPageScrollStateChanged(final int state) {\n      // 根据 是滑动的viewPager还是 点击的 tab 去设置 是否需要平滑动画\n      if (state == SCROLL_STATE_DRAGGING) {\n        // 如果是滑动就设置平滑动画\n        smoothScroll = true;\n      } else if (state == SCROLL_STATE_IDLE) {\n        // 点击的tab就不设置平滑动画\n        smoothScroll = false;\n      }\n      previousScrollState = scrollState;\n      scrollState = state;\n    }\n\n    @Override\n    public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {\n      TabLayout tabLayout = tabLayoutRef.get();\n      if (tabLayout != null) {\n        // Only update the text selection if we're not settling, or we are settling after\n        // being dragged\n        boolean updateText =\n          scrollState != SCROLL_STATE_SETTLING || previousScrollState == SCROLL_STATE_DRAGGING;\n        // Update the indicator if we're not settling after being idle. This is caused\n        // from a setCurrentItem() call and will be handled by an animation from\n        // onPageSelected() instead.\n        boolean updateIndicator =\n          !(scrollState == SCROLL_STATE_SETTLING && previousScrollState == SCROLL_STATE_IDLE);\n        tabLayout.setScrollPosition(position, positionOffset, updateText, updateIndicator);\n      }\n    }\n\n    @Override\n    public void onPageSelected(final int position) {\n      TabLayout tabLayout = tabLayoutRef.get();\n      if (tabLayout != null\n        && tabLayout.getSelectedTabPosition() != position\n        && position < tabLayout.getTabCount()) {\n        // Select the tab, only updating the indicator if we're not being dragged/settled\n        // (since onPageScrolled will handle that).\n        boolean updateIndicator =\n          scrollState == SCROLL_STATE_IDLE\n            || (scrollState == SCROLL_STATE_SETTLING\n            && previousScrollState == SCROLL_STATE_IDLE);\n        tabLayout.selectTab(tabLayout.getTabAt(position), updateIndicator);\n      }\n    }\n\n    void reset() {\n      previousScrollState = scrollState = SCROLL_STATE_IDLE;\n    }\n  }\n\n  /**\n   * A {@link TabLayout.OnTabSelectedListener} class which contains the necessary calls back to the\n   * provided {@link ViewPager2} so that the tab position is kept in sync.\n   */\n  private static class ViewPagerOnTabSelectedListener implements TabLayout.OnTabSelectedListener {\n    private final ViewPager2 viewPager;\n    // 注释掉这个局部变量 使用最上边的那个全局变量\n    //private final boolean smoothScroll;\n\n    ViewPagerOnTabSelectedListener(ViewPager2 viewPager, boolean smoothScroll) {\n      this.viewPager = viewPager;\n      // 这一行也注释掉\n      //this.smoothScroll = smoothScroll;\n    }\n\n    @Override\n    public void onTabSelected(@NonNull TabLayout.Tab tab) {\n      viewPager.setCurrentItem(tab.getPosition(), smoothScroll);\n    }\n\n    @Override\n    public void onTabUnselected(TabLayout.Tab tab) {\n      // No-op\n    }\n\n    @Override\n    public void onTabReselected(TabLayout.Tab tab) {\n      // No-op\n    }\n  }\n\n  private class PagerAdapterObserver extends RecyclerView.AdapterDataObserver {\n    PagerAdapterObserver() {}\n\n    @Override\n    public void onChanged() {\n      populateTabsFromPagerAdapter();\n    }\n\n    @Override\n    public void onItemRangeChanged(int positionStart, int itemCount) {\n      populateTabsFromPagerAdapter();\n    }\n\n    @Override\n    public void onItemRangeChanged(int positionStart, int itemCount, @Nullable Object payload) {\n      populateTabsFromPagerAdapter();\n    }\n\n    @Override\n    public void onItemRangeInserted(int positionStart, int itemCount) {\n      populateTabsFromPagerAdapter();\n    }\n\n    @Override\n    public void onItemRangeRemoved(int positionStart, int itemCount) {\n      populateTabsFromPagerAdapter();\n    }\n\n    @Override\n    public void onItemRangeMoved(int fromPosition, int toPosition, int itemCount) {\n      populateTabsFromPagerAdapter();\n    }\n  }\n}\n\n```\n\n具体用法为:\n\n```java\n\n    new TabLayoutMediators(tabLayout, viewPager2, new TabLayoutMediators.TabConfigurationStrategy() {\n      @Override\n      public void onConfigureTab(@NonNull TabLayout.Tab tab, int position) {\n        tab.setText(tabTitles.get(position));\n      }\n    }).attach();\n\n```\n\n和官方的用法一样 没啥差别\n\n**---------------------------------------------------------------------------------------**\n\n如果即要求点击tab有动画 滑动页面也有动画 可以看下面这个 我们摒弃官方的 TabLayoutMediator 联动方法\n\n我们自己来手动 让 tabLayout 和 viewPager2 联动起来\n\n```java\n\n  private void firstMethod() {\n\n    // 设置 tabLayout 标题\n    for (int i = 0; i < tabTitles.size(); i++) {\n      tabLayout.addTab(tabLayout.newTab().setText(tabTitles.get(i)));\n    }\n    // 监听tabLayout事件 设置选中的viewPager2\n    tabLayout.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() {\n      @Override\n      public void onTabSelected(TabLayout.Tab tab) {\n        viewPager2.setCurrentItem(tab.getPosition(), false);\n      }\n\n      @Override\n      public void onTabUnselected(TabLayout.Tab tab) {\n\n      }\n\n      @Override\n      public void onTabReselected(TabLayout.Tab tab) {\n\n      }\n    });\n\n\n    // viewPager2 滑动监听 设置tab选中\n    viewPager2.registerOnPageChangeCallback(new ViewPager2.OnPageChangeCallback() {\n      @Override\n      public void onPageSelected(int position) {\n        tabLayout.selectTab(tabLayout.getTabAt(position));\n      }\n    });\n\n}\n\n\n```\n\n\n### 总结\n\nviewPager2的优点还是有目共睹的, 但是还是要去踩坑啊，我之前也是用`viewPager2` 但是没用对的话是会产生内存泄露的\n所以就研究了一下 在这里记录一下问题 参考了很多博客 基本上都不咋解决问题\n\n\n只有下面这四篇有帮助 感谢!!!\n\n第一篇、 [ViewPager2重大更新](https://hitendev.github.io/2019/05/14/ViewPager2%E9%87%8D%E5%A4%A7%E6%9B%B4%E6%96%B0%EF%BC%8C%E6%94%AF%E6%8C%81offscreenPageLimit/)\n\n第二篇、 [ViewPager2主要功能](https://juejin.cn/post/6844904114124652558#heading-9)\n\n第三篇、 [解决ViewPager2+TabLayout懒加载问题，Fragment被创建多次](https://www.jianshu.com/p/2cc7bdd50c6c)\n\n第四篇、[android ViewPager2+TabLayout、滑动效果相关问题！](https://blog.csdn.net/BirdEatBug/article/details/117414954)\n\n**另外**\n\nLeakCanary --> [内存泄漏检测工具](https://square.github.io/leakcanary/getting_started/)\n\n使用非常简单 \n\n只需要 在build.gradle 中 添加这么一行就可以了 只会在debug模式下检测 不会影响到 正式环境\n\n```\ndependencies {\n  // debugImplementation because LeakCanary should only run in debug builds.\n  debugImplementation 'com.squareup.leakcanary:leakcanary-android:2.7'\n}\n```\n","source":"_posts/Android-tablayout-viewpager2-fragment-你可能用错了.md","raw":"---\ntitle: Android tablayout viewpager2 fragment 你可能用错了\ndate: 2021-06-25 17:11:29\ncategory:\n- Android\ntags:\n- tabLayout\n- viewPager2\n- fragment\n---\n\n### tabLayout + viewPager2 + fragment 用不好会导致内存泄漏\n\n### 前言\n\ntabLayout + viewPager2 + fragment 这是在app开发中非常常见的UI架构了 但是用不好的话 是会导致内存泄漏的\n\n[Demo地址](https://github.com/Naruto-1996/ViewPager2_Demo)\n\n先上图: \n\n(`app`模板使用`android studio` 创建一个就行 我只用 `HomeFragment`)\n\n<img src=\"https://ae03.alicdn.com/kf/U3292cb58c99d44a3bcf092f9d0fba361h.png\" width = \"300\" height = \"600\" alt=\"图片名称\" align=center />\n\n### 先了解一下viewPager\n\n之前我们都是使用viewPager 但是 viewPager 有两个毛病 \n\n* 不能关闭预加载\n\n* 更新Adapter不生效\n\n虽然能解决 但是很麻烦\n\nviewPager 有个方法 `offscreenPageLimit` 用来设置 当前页前后预加载的数量 即使设置为0也不起任何作用 因为源码中默认值为1\n\n先来看个图:\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210625175636.png)\n\n上面是`ViewPager`默认情况下的加载示意图，当切换到当前页面时，会默认预加载左右两侧的布局到`ViewPager`中，\n尽管两侧的`View`并不可见的，我们称这种情况叫预加载；由于`ViewPager`对`offscreenPageLimit`设置了限制，\n页面的预加载是不可避免\n\n如果使用 一定要使用viewPager 也可以做到 fragment 懒加载 主要是对`fragment`做手脚 结合生命周期方法和setUserVisibleHint状态，控制数据延迟加载，而布局只能提前进入\n\n### viewPager2基本使用\n\n1、 承载tabLayout 和 viewPager2 需要一个 fragment 或者 activity 这里我们使用 fragment\n\n`HomeFragment` 如下:\n\n```java\n\npublic class HomeFragment extends Fragment {\n\n  private HomeViewModel homeViewModel;\n  private TabLayout tabLayout;\n  private ViewPager2 viewPager2;\n\n  private final ArrayList<String> tabTitles = new ArrayList<>();\n\n  // 用List 存放fragment 不推荐使用 用不好 导致内存泄漏\n  private ArrayList<BlankFragment> fragments = new ArrayList<>();\n\n\n\n  public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {\n    homeViewModel = new ViewModelProvider(this).get(HomeViewModel.class);\n    View root = inflater.inflate(R.layout.fragment_home, container, false);\n\n    tabLayout = root.findViewById(R.id.tabs);\n    viewPager2 = root.findViewById(R.id.viewPager);\n    return root;\n  }\n\n\n  @Override\n  public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {\n    super.onViewCreated(view, savedInstanceState);\n\n    // 初始化 tabTitles 和 fragments\n    for (int i = 0; i < 15; i++) {\n      tabTitles.add(String.valueOf(i));\n      fragments.add(BlankFragment.newInstance(tabTitles.get(i)));\n    }\n\n    // 关闭预加载\n    viewPager2.setOffscreenPageLimit(ViewPager2.OFFSCREEN_PAGE_LIMIT_DEFAULT);  // 可以不设置 因为默认是 -1 默认不进行预加载\n    // 这个必须设置 不然仍然会启用预加载\n    ((RecyclerView)viewPager2.getChildAt(0)).getLayoutManager().setItemPrefetchEnabled(false);\n    // 设置缓存数量，对应 RecyclerView 中的 mCachedViews，即屏幕外的视图数量\n    ((RecyclerView)viewPager2.getChildAt(0)).setItemViewCacheSize(0);\n\n    // 第一种方法 (可能会内存泄漏)\n    //FragmentAdapter adapter = new FragmentAdapter(this, fragments);\n    //viewPager2.setAdapter(adapter);\n\n    // 这里使用第二种方法\n    viewPager2.setAdapter(new FragmentStateAdapter(this) {\n      @NonNull\n      @Override\n      public Fragment createFragment(int position) {\n        return BlankFragment.newInstance(tabTitles.get(position));\n      }\n\n      @Override\n      public int getItemCount() {\n        return tabTitles.size();\n      }\n\n    });\n    // viewPager2 滑动监听\n    viewPager2.registerOnPageChangeCallback(new ViewPager2.OnPageChangeCallback() {\n      @Override\n      public void onPageSelected(int position) {\n        super.onPageSelected(position);\n\n      }\n    });\n\n    // 这里第四个参数一定要设置为false  如果设置为true时 我们在滑动时 BlankFragment的创建 和 销毁 都很正常\n    // 一旦 我们通过 点击tabLayout时 如果两个tab距离过远  那么所有划过的tabLayout 都会创建和销毁BlankFragment 这显然不是我们想要的\n\n    // tabLayout 和 viewPager 联动\n    new TabLayoutMediator(tabLayout, viewPager2,true,false, new TabLayoutMediator.TabConfigurationStrategy() {\n      @Override\n      public void onConfigureTab(@NonNull TabLayout.Tab tab, int position) {\n        tab.setText(tabTitles.get(position));\n      }\n    }).attach();\n\n\n  }\n\n}\n\n```\n\n`fragment_home.xml` 布局文件:\n\n```xml\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n  xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n  xmlns:tools=\"http://schemas.android.com/tools\"\n  android:layout_width=\"match_parent\"\n  android:orientation=\"vertical\"\n  android:layout_height=\"match_parent\"\n  tools:context=\".ui.home.HomeFragment\">\n\n  <com.google.android.material.tabs.TabLayout\n    android:id=\"@+id/tabs\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"40dp\"\n    app:tabGravity=\"center\"\n    app:tabIndicatorColor=\"#ff678f\"\n    app:tabIndicatorFullWidth=\"false\"\n    app:tabIndicatorHeight=\"2dp\"\n    app:tabMode=\"scrollable\"\n    android:layout_marginTop=\"0dp\"\n    app:tabSelectedTextColor=\"#ff678f\"\n    app:tabTextColor=\"#333333\"\n    app:tabUnboundedRipple=\"true\" />\n\n\n  <androidx.viewpager2.widget.ViewPager2\n    android:id=\"@+id/viewPager\"\n    android:layout_width=\"match_parent\"\n    android:background=\"@color/purple_200\"\n    android:layout_height=\"0dp\"\n    android:layout_weight=\"1\"/>\n</LinearLayout>\n\n```\n\n2、viewPager2的 FragmentStateAdapter 创建fragment时 我们 复用一个fragment\n\n`BlankFragment` 如下:\n\n```java\n\npublic class BlankFragment extends Fragment {\n\n  private String mParam1;\n  private TextView mTextView;\n\n  public static BlankFragment newInstance(String param1) {\n    BlankFragment fragment = new BlankFragment();\n    Bundle args = new Bundle();\n    args.putString(\"param1\", param1);\n    fragment.setArguments(args);\n    return fragment;\n  }\n\n  @Override\n  public void onPause() {\n    super.onPause();\n    Log.i(\"TAG=======onPause\", mParam1);\n  }\n\n  @Override\n  public void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    if (getArguments() != null) {\n      mParam1 = getArguments().getString(\"param1\");\n    }\n\n    Log.i(\"TAG=======onCreate\", mParam1);\n    Toast.makeText(getContext(), mParam1, Toast.LENGTH_SHORT).show();\n  }\n\n\n\n  @Override\n  public void onDestroy() {\n    super.onDestroy();\n    Log.i(\"TAG=======onDestroy\", mParam1);\n  }\n\n  @Override\n  public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {\n    // Inflate the layout for this fragment\n    View root = inflater.inflate(R.layout.fragment_blank, container, false);\n    mTextView = root.findViewById(R.id.text1);\n    mTextView.setText(mParam1);\n    Log.i(\"TAG=======onCreateView\", mParam1);\n    return root;\n  }\n\n  // 对外提供一个刷新Ui的方法\n  public void refreshUi() {\n    if (getArguments() != null) {\n      mParam1 = getArguments().getString(\"param1\");\n      mTextView.setText(mParam1 + \"ddd\");\n    }\n\n  }\n\n  @Override\n  public void onDestroyView() {\n    super.onDestroyView();\n    Log.i(\"TAG======onDestroyView\", mParam1);\n  }\n}\n\n```\n\n`fragment_blank.xml` 如下:\n\n```xml\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n  xmlns:tools=\"http://schemas.android.com/tools\"\n  android:layout_width=\"match_parent\"\n  android:layout_height=\"match_parent\"\n  android:orientation=\"vertical\"\n  android:gravity=\"center\"\n  tools:context=\".ui.BlankFragment\">\n\n  <TextView\n    android:id=\"@+id/text1\"\n    android:textSize=\"26sp\"\n    android:layout_width=\"wrap_content\"\n    android:layout_height=\"wrap_content\"\n    android:text=\"black\"/>\n\n</LinearLayout>\n\n```\n\n至此 我们已经完成了 tabLayout + viewPager2 + fragment \n\n### viewPager2常用方法\n\n* `setAdapter()` 设置适配器\n* `setOrientation()` 设置布局方向\n* `setCurrentItem()` 设置当前Item下标\n* `beginFakeDrag()` 开始模拟拖拽\n* `fakeDragBy()` 模拟拖拽中\n* `endFakeDrag()` 模拟拖拽结束\n* `setUserInputEnabled()` 设置是否允许用户输入/触摸\n* `setOffscreenPageLimit()` 设置屏幕外加载页面数量\n* `registerOnPageChangeCallback()` 注册页面滑动监听回调\n* `setPageTransformer()` 设置页面滑动时的变换效果\n\n\n### ViewPager2 预加载和缓存\n\n`viewPager2` 是存在预加载和缓存的 我们虽然可以通过`offscreenPageLimit` 去设置预加载的数量 但是 `viewPager2` 会默认帮我们\n缓存两个`fragment` 意思就是我们再滑动回来时 不会再去走 fragment 创建的生命周期了 会走 onResume 生命周期函数\n\n`one picture is worth a thousand words` :\n\n`viewPager2` 默认开启预加载 \n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210625182426.png)\n\n**如何关闭预加载、并设置缓存数量**\n\n**常见设置如下**\n\n```java\n\n//设置应保留在当前可见页面两侧的页面数\nviewPager2.setOffscreenPageLimit(4);\n\n//关闭预加载\n((RecyclerView)viewPager2.getChildAt(0)).getLayoutManager().setItemPrefetchEnabled(false);\n\n//设置缓存数量，对应 RecyclerView 中的 mCachedViews，即屏幕外的视图数量\n((RecyclerView)viewPager2.getChildAt(0)).setItemViewCacheSize(4);\n\n```\n\n`viewPager2` 会默认缓存2个`ItemView`\n\n我们将`((RecyclerView)viewPager2.getChildAt(0)).setItemViewCacheSize(0);` 设置为`0`即可 这样我们每次滑动一个新的`tab`时 会创建\n新的`fragment`并销毁上一个`fragment`\n\n### viewPager2 对 fragment 的支持\n\n目前，`ViewPager2`对`Fragment`的支持只能使用`FragmentStateAdapter`，使用起来也是非常简单：\n\n\n```java\n\nviewPager2.setAdapter(new FragmentStateAdapter(this) {\n  @NonNull\n  @Override\n  public Fragment createFragment(int position) {\n    return BlankFragment.newInstance(tabTitles.get(position));\n  }\n\n  @Override\n  public int getItemCount() {\n    return tabTitles.size();\n  }\n\n});\n\n```\n\n### 另外还有一个小坑 \n\n**ViewPager2+TabLayout懒加载问题，Fragment被创建多次**\n\n`ViewPager2`默认只加载当前页面，相当于官方处理了`Fragment`的懒加载问题，当你使用代码\n\n```\n\nnew TabLayoutMediator(tabLayout, viewPager, true, new TabLayoutMediator.TabConfigurationStrategy() {\n\n       @Override\n\n       public void onConfigureTab(@NonNull TabLayout.Tab tab, int position) {\n\n           tab.setText(titles.get(position));\n\n       }\n\n}).attach();\n\n```\n\n此时当你滑动`ViewPager2`时，滑动到某个`Fragment`页面才会加载，执行onCreateView()方法，\n\n但是当你手动点击`TabLayout`时，此时懒加载就会失效，`onCreateView()`会被执行多次，\n\n原因就是...此时`ViewPager2`默认是平滑滚动的，滚动滑过的`Fragment`都会被加载，\n\n**只需修改代码:**\n\n```java\n\nnew TabLayoutMediator(tabLayout, viewPager, true,false, new TabLayoutMediator.TabConfigurationStrategy() {\n\n            @Override\n\n            public void onConfigureTab(@NonNull TabLayout.Tab tab, int position) {\n\n                tab.setText(titles.get(position));\n\n            }\n\n}).attach();\n\n```\n\n其中，第二个`boolean`参数为`smoothScroll` 一定要填`false`  这时点击 哪个`tab` 就会创建 哪个 `fragment`\n\n但是页面看起来没有那么平滑了 各有利弊吧\n\n**---------------------------------------------------------------------------------------**\n\n如果 需要点击tab无动画 滑动页面时有动画 怎么办呢?\n\nTabLayoutMediator 是final类  且smoothScroll字段是私有的、我们没法继承重写、但是可以copy源码修改、不会有问题\n\n我们将 源码copy下来 稍作修改就可以用了 下面是修改好的代码:\n\n```java\n\nimport static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_DRAGGING;\nimport static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_IDLE;\nimport static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_SETTLING;\n\nimport androidx.annotation.NonNull;\nimport androidx.annotation.Nullable;\nimport androidx.recyclerview.widget.RecyclerView;\nimport androidx.viewpager2.widget.ViewPager2;\n\nimport com.google.android.material.tabs.TabLayout;\n\nimport java.lang.ref.WeakReference;\n\n/**\n * A mediator to link a TabLayout with a ViewPager2. The mediator will synchronize the ViewPager2's\n * position with the selected tab when a tab is selected, and the TabLayout's scroll position when\n * the user drags the ViewPager2. TabLayoutMediator will listen to ViewPager2's OnPageChangeCallback\n * to adjust tab when ViewPager2 moves. TabLayoutMediator listens to TabLayout's\n * OnTabSelectedListener to adjust VP2 when tab moves. TabLayoutMediator listens to RecyclerView's\n * AdapterDataObserver to recreate tab content when dataset changes.\n *\n * <p>Establish the link by creating an instance of this class, make sure the ViewPager2 has an\n * adapter and then call {@link #attach()} on it. Instantiating a TabLayoutMediator will only create\n * the mediator object, {@link #attach()} will link the TabLayout and the ViewPager2 together. When\n * creating an instance of this class, you must supply an implementation of {@link\n * com.google.android.material.tabs.TabLayoutMediator.TabConfigurationStrategy} in which you set the text of the tab, and/or perform any styling of the\n * tabs that you require. Changing ViewPager2's adapter will require a {@link #detach()} followed by\n * {@link #attach()} call. Changing the ViewPager2 or TabLayout will require a new instantiation of\n * TabLayoutMediator.\n */\npublic final class TabLayoutMediators {\n  @NonNull private final TabLayout tabLayout;\n  @NonNull private final ViewPager2 viewPager;\n  private final boolean autoRefresh;\n  // 这里我们改为静态变量 以便于在静态方法中使用这个变量\n  private static boolean smoothScroll;\n  private final TabConfigurationStrategy tabConfigurationStrategy;\n  @Nullable private RecyclerView.Adapter<?> adapter;\n  private boolean attached;\n\n  @Nullable private TabLayoutOnPageChangeCallback onPageChangeCallback;\n  @Nullable private TabLayout.OnTabSelectedListener onTabSelectedListener;\n  @Nullable private RecyclerView.AdapterDataObserver pagerAdapterObserver;\n\n  /**\n   * A callback interface that must be implemented to set the text and styling of newly created\n   * tabs.\n   */\n  public interface TabConfigurationStrategy {\n    /**\n     * Called to configure the tab for the page at the specified position. Typically calls {@link\n     * TabLayout.Tab#setText(CharSequence)}, but any form of styling can be applied.\n     *\n     * @param tab The Tab which should be configured to represent the title of the item at the given\n     *     position in the data set.\n     * @param position The position of the item within the adapter's data set.\n     */\n    void onConfigureTab(@NonNull TabLayout.Tab tab, int position);\n  }\n\n  public TabLayoutMediators(\n    @NonNull TabLayout tabLayout,\n    @NonNull ViewPager2 viewPager,\n    @NonNull TabConfigurationStrategy tabConfigurationStrategy) {\n    this(tabLayout, viewPager, /* autoRefresh= */ true, tabConfigurationStrategy);\n  }\n\n  public TabLayoutMediators(\n    @NonNull TabLayout tabLayout,\n    @NonNull ViewPager2 viewPager,\n    boolean autoRefresh,\n    @NonNull TabConfigurationStrategy tabConfigurationStrategy) {\n    this(tabLayout, viewPager, autoRefresh, /* smoothScroll= */ true, tabConfigurationStrategy);\n  }\n\n  public TabLayoutMediators(\n    @NonNull TabLayout tabLayout,\n    @NonNull ViewPager2 viewPager,\n    boolean autoRefresh,\n    boolean smoothScroll,\n    @NonNull TabConfigurationStrategy tabConfigurationStrategy) {\n    this.tabLayout = tabLayout;\n    this.viewPager = viewPager;\n    this.autoRefresh = autoRefresh;\n    TabLayoutMediators.smoothScroll = smoothScroll;\n    this.tabConfigurationStrategy = tabConfigurationStrategy;\n  }\n\n  /**\n   * Link the TabLayout and the ViewPager2 together. Must be called after ViewPager2 has an adapter\n   * set. To be called on a new instance of TabLayoutMediator or if the ViewPager2's adapter\n   * changes.\n   *\n   * @throws IllegalStateException If the mediator is already attached, or the ViewPager2 has no\n   *     adapter.\n   */\n  public void attach() {\n    if (attached) {\n      throw new IllegalStateException(\"TabLayoutMediator is already attached\");\n    }\n    adapter = viewPager.getAdapter();\n    if (adapter == null) {\n      throw new IllegalStateException(\n        \"TabLayoutMediator attached before ViewPager2 has an \" + \"adapter\");\n    }\n    attached = true;\n\n    // Add our custom OnPageChangeCallback to the ViewPager\n    onPageChangeCallback = new TabLayoutOnPageChangeCallback(tabLayout);\n    viewPager.registerOnPageChangeCallback(onPageChangeCallback);\n\n    // Now we'll add a tab selected listener to set ViewPager's current item\n    onTabSelectedListener = new ViewPagerOnTabSelectedListener(viewPager, smoothScroll);\n    tabLayout.addOnTabSelectedListener(onTabSelectedListener);\n\n    // Now we'll populate ourselves from the pager adapter, adding an observer if\n    // autoRefresh is enabled\n    if (autoRefresh) {\n      // Register our observer on the new adapter\n      pagerAdapterObserver = new PagerAdapterObserver();\n      adapter.registerAdapterDataObserver(pagerAdapterObserver);\n    }\n\n    populateTabsFromPagerAdapter();\n\n    // Now update the scroll position to match the ViewPager's current item\n    tabLayout.setScrollPosition(viewPager.getCurrentItem(), 0f, true);\n  }\n\n  /**\n   * Unlink the TabLayout and the ViewPager. To be called on a stale TabLayoutMediator if a new one\n   * is instantiated, to prevent holding on to a view that should be garbage collected. Also to be\n   * called before {@link #attach()} when a ViewPager2's adapter is changed.\n   */\n  public void detach() {\n    if (autoRefresh && adapter != null) {\n      adapter.unregisterAdapterDataObserver(pagerAdapterObserver);\n      pagerAdapterObserver = null;\n    }\n    tabLayout.removeOnTabSelectedListener(onTabSelectedListener);\n    viewPager.unregisterOnPageChangeCallback(onPageChangeCallback);\n    onTabSelectedListener = null;\n    onPageChangeCallback = null;\n    adapter = null;\n    attached = false;\n  }\n\n  @SuppressWarnings(\"WeakerAccess\")\n  void populateTabsFromPagerAdapter() {\n    tabLayout.removeAllTabs();\n\n    if (adapter != null) {\n      int adapterCount = adapter.getItemCount();\n      for (int i = 0; i < adapterCount; i++) {\n        TabLayout.Tab tab = tabLayout.newTab();\n        tabConfigurationStrategy.onConfigureTab(tab, i);\n        tabLayout.addTab(tab, false);\n      }\n      // Make sure we reflect the currently set ViewPager item\n      if (adapterCount > 0) {\n        int lastItem = tabLayout.getTabCount() - 1;\n        int currItem = Math.min(viewPager.getCurrentItem(), lastItem);\n        if (currItem != tabLayout.getSelectedTabPosition()) {\n          tabLayout.selectTab(tabLayout.getTabAt(currItem));\n        }\n      }\n    }\n  }\n\n  /**\n   * A {@link ViewPager2.OnPageChangeCallback} class which contains the necessary calls back to the\n   * provided {@link TabLayout} so that the tab position is kept in sync.\n   *\n   * <p>This class stores the provided TabLayout weakly, meaning that you can use {@link\n   * ViewPager2#registerOnPageChangeCallback(ViewPager2.OnPageChangeCallback)} without removing the\n   * callback and not cause a leak.\n   */\n  private static class TabLayoutOnPageChangeCallback extends ViewPager2.OnPageChangeCallback {\n    @NonNull private final WeakReference<TabLayout> tabLayoutRef;\n    private int previousScrollState;\n    private int scrollState;\n\n    TabLayoutOnPageChangeCallback(TabLayout tabLayout) {\n      tabLayoutRef = new WeakReference<>(tabLayout);\n      reset();\n    }\n\n    @Override\n    public void onPageScrollStateChanged(final int state) {\n      // 根据 是滑动的viewPager还是 点击的 tab 去设置 是否需要平滑动画\n      if (state == SCROLL_STATE_DRAGGING) {\n        // 如果是滑动就设置平滑动画\n        smoothScroll = true;\n      } else if (state == SCROLL_STATE_IDLE) {\n        // 点击的tab就不设置平滑动画\n        smoothScroll = false;\n      }\n      previousScrollState = scrollState;\n      scrollState = state;\n    }\n\n    @Override\n    public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {\n      TabLayout tabLayout = tabLayoutRef.get();\n      if (tabLayout != null) {\n        // Only update the text selection if we're not settling, or we are settling after\n        // being dragged\n        boolean updateText =\n          scrollState != SCROLL_STATE_SETTLING || previousScrollState == SCROLL_STATE_DRAGGING;\n        // Update the indicator if we're not settling after being idle. This is caused\n        // from a setCurrentItem() call and will be handled by an animation from\n        // onPageSelected() instead.\n        boolean updateIndicator =\n          !(scrollState == SCROLL_STATE_SETTLING && previousScrollState == SCROLL_STATE_IDLE);\n        tabLayout.setScrollPosition(position, positionOffset, updateText, updateIndicator);\n      }\n    }\n\n    @Override\n    public void onPageSelected(final int position) {\n      TabLayout tabLayout = tabLayoutRef.get();\n      if (tabLayout != null\n        && tabLayout.getSelectedTabPosition() != position\n        && position < tabLayout.getTabCount()) {\n        // Select the tab, only updating the indicator if we're not being dragged/settled\n        // (since onPageScrolled will handle that).\n        boolean updateIndicator =\n          scrollState == SCROLL_STATE_IDLE\n            || (scrollState == SCROLL_STATE_SETTLING\n            && previousScrollState == SCROLL_STATE_IDLE);\n        tabLayout.selectTab(tabLayout.getTabAt(position), updateIndicator);\n      }\n    }\n\n    void reset() {\n      previousScrollState = scrollState = SCROLL_STATE_IDLE;\n    }\n  }\n\n  /**\n   * A {@link TabLayout.OnTabSelectedListener} class which contains the necessary calls back to the\n   * provided {@link ViewPager2} so that the tab position is kept in sync.\n   */\n  private static class ViewPagerOnTabSelectedListener implements TabLayout.OnTabSelectedListener {\n    private final ViewPager2 viewPager;\n    // 注释掉这个局部变量 使用最上边的那个全局变量\n    //private final boolean smoothScroll;\n\n    ViewPagerOnTabSelectedListener(ViewPager2 viewPager, boolean smoothScroll) {\n      this.viewPager = viewPager;\n      // 这一行也注释掉\n      //this.smoothScroll = smoothScroll;\n    }\n\n    @Override\n    public void onTabSelected(@NonNull TabLayout.Tab tab) {\n      viewPager.setCurrentItem(tab.getPosition(), smoothScroll);\n    }\n\n    @Override\n    public void onTabUnselected(TabLayout.Tab tab) {\n      // No-op\n    }\n\n    @Override\n    public void onTabReselected(TabLayout.Tab tab) {\n      // No-op\n    }\n  }\n\n  private class PagerAdapterObserver extends RecyclerView.AdapterDataObserver {\n    PagerAdapterObserver() {}\n\n    @Override\n    public void onChanged() {\n      populateTabsFromPagerAdapter();\n    }\n\n    @Override\n    public void onItemRangeChanged(int positionStart, int itemCount) {\n      populateTabsFromPagerAdapter();\n    }\n\n    @Override\n    public void onItemRangeChanged(int positionStart, int itemCount, @Nullable Object payload) {\n      populateTabsFromPagerAdapter();\n    }\n\n    @Override\n    public void onItemRangeInserted(int positionStart, int itemCount) {\n      populateTabsFromPagerAdapter();\n    }\n\n    @Override\n    public void onItemRangeRemoved(int positionStart, int itemCount) {\n      populateTabsFromPagerAdapter();\n    }\n\n    @Override\n    public void onItemRangeMoved(int fromPosition, int toPosition, int itemCount) {\n      populateTabsFromPagerAdapter();\n    }\n  }\n}\n\n```\n\n具体用法为:\n\n```java\n\n    new TabLayoutMediators(tabLayout, viewPager2, new TabLayoutMediators.TabConfigurationStrategy() {\n      @Override\n      public void onConfigureTab(@NonNull TabLayout.Tab tab, int position) {\n        tab.setText(tabTitles.get(position));\n      }\n    }).attach();\n\n```\n\n和官方的用法一样 没啥差别\n\n**---------------------------------------------------------------------------------------**\n\n如果即要求点击tab有动画 滑动页面也有动画 可以看下面这个 我们摒弃官方的 TabLayoutMediator 联动方法\n\n我们自己来手动 让 tabLayout 和 viewPager2 联动起来\n\n```java\n\n  private void firstMethod() {\n\n    // 设置 tabLayout 标题\n    for (int i = 0; i < tabTitles.size(); i++) {\n      tabLayout.addTab(tabLayout.newTab().setText(tabTitles.get(i)));\n    }\n    // 监听tabLayout事件 设置选中的viewPager2\n    tabLayout.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() {\n      @Override\n      public void onTabSelected(TabLayout.Tab tab) {\n        viewPager2.setCurrentItem(tab.getPosition(), false);\n      }\n\n      @Override\n      public void onTabUnselected(TabLayout.Tab tab) {\n\n      }\n\n      @Override\n      public void onTabReselected(TabLayout.Tab tab) {\n\n      }\n    });\n\n\n    // viewPager2 滑动监听 设置tab选中\n    viewPager2.registerOnPageChangeCallback(new ViewPager2.OnPageChangeCallback() {\n      @Override\n      public void onPageSelected(int position) {\n        tabLayout.selectTab(tabLayout.getTabAt(position));\n      }\n    });\n\n}\n\n\n```\n\n\n### 总结\n\nviewPager2的优点还是有目共睹的, 但是还是要去踩坑啊，我之前也是用`viewPager2` 但是没用对的话是会产生内存泄露的\n所以就研究了一下 在这里记录一下问题 参考了很多博客 基本上都不咋解决问题\n\n\n只有下面这四篇有帮助 感谢!!!\n\n第一篇、 [ViewPager2重大更新](https://hitendev.github.io/2019/05/14/ViewPager2%E9%87%8D%E5%A4%A7%E6%9B%B4%E6%96%B0%EF%BC%8C%E6%94%AF%E6%8C%81offscreenPageLimit/)\n\n第二篇、 [ViewPager2主要功能](https://juejin.cn/post/6844904114124652558#heading-9)\n\n第三篇、 [解决ViewPager2+TabLayout懒加载问题，Fragment被创建多次](https://www.jianshu.com/p/2cc7bdd50c6c)\n\n第四篇、[android ViewPager2+TabLayout、滑动效果相关问题！](https://blog.csdn.net/BirdEatBug/article/details/117414954)\n\n**另外**\n\nLeakCanary --> [内存泄漏检测工具](https://square.github.io/leakcanary/getting_started/)\n\n使用非常简单 \n\n只需要 在build.gradle 中 添加这么一行就可以了 只会在debug模式下检测 不会影响到 正式环境\n\n```\ndependencies {\n  // debugImplementation because LeakCanary should only run in debug builds.\n  debugImplementation 'com.squareup.leakcanary:leakcanary-android:2.7'\n}\n```\n","slug":"Android-tablayout-viewpager2-fragment-你可能用错了","published":1,"updated":"2021-06-30T01:47:21.153Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmw200073ys277550de6","content":"<h3 id=\"tabLayout-viewPager2-fragment-用不好会导致内存泄漏\"><a href=\"#tabLayout-viewPager2-fragment-用不好会导致内存泄漏\" class=\"headerlink\" title=\"tabLayout + viewPager2 + fragment 用不好会导致内存泄漏\"></a>tabLayout + viewPager2 + fragment 用不好会导致内存泄漏</h3><h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>tabLayout + viewPager2 + fragment 这是在app开发中非常常见的UI架构了 但是用不好的话 是会导致内存泄漏的</p>\n<p><a href=\"https://github.com/Naruto-1996/ViewPager2_Demo\">Demo地址</a></p>\n<p>先上图: </p>\n<p>(<code>app</code>模板使用<code>android studio</code> 创建一个就行 我只用 <code>HomeFragment</code>)</p>\n<img src=\"https://ae03.alicdn.com/kf/U3292cb58c99d44a3bcf092f9d0fba361h.png\" width=\"300\" height=\"600\" alt=\"图片名称\" align=\"center\">\n\n<h3 id=\"先了解一下viewPager\"><a href=\"#先了解一下viewPager\" class=\"headerlink\" title=\"先了解一下viewPager\"></a>先了解一下viewPager</h3><p>之前我们都是使用viewPager 但是 viewPager 有两个毛病 </p>\n<ul>\n<li><p>不能关闭预加载</p>\n</li>\n<li><p>更新Adapter不生效</p>\n</li>\n</ul>\n<p>虽然能解决 但是很麻烦</p>\n<p>viewPager 有个方法 <code>offscreenPageLimit</code> 用来设置 当前页前后预加载的数量 即使设置为0也不起任何作用 因为源码中默认值为1</p>\n<p>先来看个图:</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210625175636.png\"></p>\n<p>上面是<code>ViewPager</code>默认情况下的加载示意图，当切换到当前页面时，会默认预加载左右两侧的布局到<code>ViewPager</code>中，<br>尽管两侧的<code>View</code>并不可见的，我们称这种情况叫预加载；由于<code>ViewPager</code>对<code>offscreenPageLimit</code>设置了限制，<br>页面的预加载是不可避免</p>\n<p>如果使用 一定要使用viewPager 也可以做到 fragment 懒加载 主要是对<code>fragment</code>做手脚 结合生命周期方法和setUserVisibleHint状态，控制数据延迟加载，而布局只能提前进入</p>\n<h3 id=\"viewPager2基本使用\"><a href=\"#viewPager2基本使用\" class=\"headerlink\" title=\"viewPager2基本使用\"></a>viewPager2基本使用</h3><p>1、 承载tabLayout 和 viewPager2 需要一个 fragment 或者 activity 这里我们使用 fragment</p>\n<p><code>HomeFragment</code> 如下:</p>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\">\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HomeFragment</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Fragment</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">private</span> HomeViewModel homeViewModel<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> TabLayout tabLayout<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> ViewPager2 viewPager2<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> ArrayList<span class=\"token operator\">&lt;</span>String<span class=\"token operator\">></span> tabTitles <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">// 用List 存放fragment 不推荐使用 用不好 导致内存泄漏</span>\n  <span class=\"token keyword\">private</span> ArrayList<span class=\"token operator\">&lt;</span>BlankFragment<span class=\"token operator\">></span> fragments <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n\n  <span class=\"token keyword\">public</span> View <span class=\"token function\">onCreateView</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@NonNull</span> LayoutInflater inflater<span class=\"token punctuation\">,</span> ViewGroup container<span class=\"token punctuation\">,</span> Bundle savedInstanceState<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    homeViewModel <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ViewModelProvider</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>HomeViewModel<span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    View root <span class=\"token operator\">=</span> inflater<span class=\"token punctuation\">.</span><span class=\"token function\">inflate</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>layout<span class=\"token punctuation\">.</span>fragment_home<span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    tabLayout <span class=\"token operator\">=</span> root<span class=\"token punctuation\">.</span><span class=\"token function\">findViewById</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    viewPager2 <span class=\"token operator\">=</span> root<span class=\"token punctuation\">.</span><span class=\"token function\">findViewById</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>viewPager<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> root<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onViewCreated</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@NonNull</span> View view<span class=\"token punctuation\">,</span> <span class=\"token annotation punctuation\">@Nullable</span> Bundle savedInstanceState<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onViewCreated</span><span class=\"token punctuation\">(</span>view<span class=\"token punctuation\">,</span> savedInstanceState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// 初始化 tabTitles 和 fragments</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">15</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      tabTitles<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      fragments<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>BlankFragment<span class=\"token punctuation\">.</span><span class=\"token function\">newInstance</span><span class=\"token punctuation\">(</span>tabTitles<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// 关闭预加载</span>\n    viewPager2<span class=\"token punctuation\">.</span><span class=\"token function\">setOffscreenPageLimit</span><span class=\"token punctuation\">(</span>ViewPager2<span class=\"token punctuation\">.</span>OFFSCREEN_PAGE_LIMIT_DEFAULT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">// 可以不设置 因为默认是 -1 默认不进行预加载</span>\n    <span class=\"token comment\" spellcheck=\"true\">// 这个必须设置 不然仍然会启用预加载</span>\n    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>RecyclerView<span class=\"token punctuation\">)</span>viewPager2<span class=\"token punctuation\">.</span><span class=\"token function\">getChildAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLayoutManager</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setItemPrefetchEnabled</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">// 设置缓存数量，对应 RecyclerView 中的 mCachedViews，即屏幕外的视图数量</span>\n    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>RecyclerView<span class=\"token punctuation\">)</span>viewPager2<span class=\"token punctuation\">.</span><span class=\"token function\">getChildAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setItemViewCacheSize</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// 第一种方法 (可能会内存泄漏)</span>\n    <span class=\"token comment\" spellcheck=\"true\">//FragmentAdapter adapter = new FragmentAdapter(this, fragments);</span>\n    <span class=\"token comment\" spellcheck=\"true\">//viewPager2.setAdapter(adapter);</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// 这里使用第二种方法</span>\n    viewPager2<span class=\"token punctuation\">.</span><span class=\"token function\">setAdapter</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">FragmentStateAdapter</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token annotation punctuation\">@NonNull</span>\n      <span class=\"token annotation punctuation\">@Override</span>\n      <span class=\"token keyword\">public</span> Fragment <span class=\"token function\">createFragment</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> position<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> BlankFragment<span class=\"token punctuation\">.</span><span class=\"token function\">newInstance</span><span class=\"token punctuation\">(</span>tabTitles<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token annotation punctuation\">@Override</span>\n      <span class=\"token keyword\">public</span> <span class=\"token keyword\">int</span> <span class=\"token function\">getItemCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> tabTitles<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">// viewPager2 滑动监听</span>\n    viewPager2<span class=\"token punctuation\">.</span><span class=\"token function\">registerOnPageChangeCallback</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ViewPager2<span class=\"token punctuation\">.</span>OnPageChangeCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token annotation punctuation\">@Override</span>\n      <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onPageSelected</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> position<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onPageSelected</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// 这里第四个参数一定要设置为false  如果设置为true时 我们在滑动时 BlankFragment的创建 和 销毁 都很正常</span>\n    <span class=\"token comment\" spellcheck=\"true\">// 一旦 我们通过 点击tabLayout时 如果两个tab距离过远  那么所有划过的tabLayout 都会创建和销毁BlankFragment 这显然不是我们想要的</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// tabLayout 和 viewPager 联动</span>\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">TabLayoutMediator</span><span class=\"token punctuation\">(</span>tabLayout<span class=\"token punctuation\">,</span> viewPager2<span class=\"token punctuation\">,</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TabLayoutMediator<span class=\"token punctuation\">.</span>TabConfigurationStrategy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token annotation punctuation\">@Override</span>\n      <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onConfigureTab</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@NonNull</span> TabLayout<span class=\"token punctuation\">.</span>Tab tab<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> position<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        tab<span class=\"token punctuation\">.</span><span class=\"token function\">setText</span><span class=\"token punctuation\">(</span>tabTitles<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">attach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><code>fragment_home.xml</code> 布局文件:</p>\n<pre class=\"line-numbers language-xml\"><code class=\"language-xml\">\n<span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LinearLayout</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>android</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/apk/res/android<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>app</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/apk/res-auto<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>tools</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/tools<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>match_parent<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>orientation</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>vertical<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>match_parent<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">tools:</span>context</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>.ui.home.HomeFragment<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>com.google.android.material.tabs.TabLayout</span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>@+id/tabs<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>match_parent<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>40dp<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">app:</span>tabGravity</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>center<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">app:</span>tabIndicatorColor</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#ff678f<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">app:</span>tabIndicatorFullWidth</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>false<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">app:</span>tabIndicatorHeight</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>2dp<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">app:</span>tabMode</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>scrollable<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_marginTop</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>0dp<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">app:</span>tabSelectedTextColor</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#ff678f<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">app:</span>tabTextColor</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#333333<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">app:</span>tabUnboundedRipple</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>androidx.viewpager2.widget.ViewPager2</span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>@+id/viewPager<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>match_parent<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>background</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>@color/purple_200<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>0dp<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_weight</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>LinearLayout</span><span class=\"token punctuation\">></span></span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>2、viewPager2的 FragmentStateAdapter 创建fragment时 我们 复用一个fragment</p>\n<p><code>BlankFragment</code> 如下:</p>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\">\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BlankFragment</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Fragment</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">private</span> String mParam1<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> TextView mTextView<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> BlankFragment <span class=\"token function\">newInstance</span><span class=\"token punctuation\">(</span>String param1<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    BlankFragment fragment <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BlankFragment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Bundle args <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Bundle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    args<span class=\"token punctuation\">.</span><span class=\"token function\">putString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"param1\"</span><span class=\"token punctuation\">,</span> param1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    fragment<span class=\"token punctuation\">.</span><span class=\"token function\">setArguments</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> fragment<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onPause</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onPause</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Log<span class=\"token punctuation\">.</span><span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TAG=======onPause\"</span><span class=\"token punctuation\">,</span> mParam1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onCreate</span><span class=\"token punctuation\">(</span>Bundle savedInstanceState<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onCreate</span><span class=\"token punctuation\">(</span>savedInstanceState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">getArguments</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> null<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      mParam1 <span class=\"token operator\">=</span> <span class=\"token function\">getArguments</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"param1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    Log<span class=\"token punctuation\">.</span><span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TAG=======onCreate\"</span><span class=\"token punctuation\">,</span> mParam1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Toast<span class=\"token punctuation\">.</span><span class=\"token function\">makeText</span><span class=\"token punctuation\">(</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> mParam1<span class=\"token punctuation\">,</span> Toast<span class=\"token punctuation\">.</span>LENGTH_SHORT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onDestroy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onDestroy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Log<span class=\"token punctuation\">.</span><span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TAG=======onDestroy\"</span><span class=\"token punctuation\">,</span> mParam1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> View <span class=\"token function\">onCreateView</span><span class=\"token punctuation\">(</span>LayoutInflater inflater<span class=\"token punctuation\">,</span> ViewGroup container<span class=\"token punctuation\">,</span> Bundle savedInstanceState<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\" spellcheck=\"true\">// Inflate the layout for this fragment</span>\n    View root <span class=\"token operator\">=</span> inflater<span class=\"token punctuation\">.</span><span class=\"token function\">inflate</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>layout<span class=\"token punctuation\">.</span>fragment_blank<span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mTextView <span class=\"token operator\">=</span> root<span class=\"token punctuation\">.</span><span class=\"token function\">findViewById</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>text1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mTextView<span class=\"token punctuation\">.</span><span class=\"token function\">setText</span><span class=\"token punctuation\">(</span>mParam1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Log<span class=\"token punctuation\">.</span><span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TAG=======onCreateView\"</span><span class=\"token punctuation\">,</span> mParam1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> root<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">// 对外提供一个刷新Ui的方法</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">refreshUi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">getArguments</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> null<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      mParam1 <span class=\"token operator\">=</span> <span class=\"token function\">getArguments</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"param1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      mTextView<span class=\"token punctuation\">.</span><span class=\"token function\">setText</span><span class=\"token punctuation\">(</span>mParam1 <span class=\"token operator\">+</span> <span class=\"token string\">\"ddd\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onDestroyView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onDestroyView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Log<span class=\"token punctuation\">.</span><span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TAG======onDestroyView\"</span><span class=\"token punctuation\">,</span> mParam1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><code>fragment_blank.xml</code> 如下:</p>\n<pre class=\"line-numbers language-xml\"><code class=\"language-xml\">\n<span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LinearLayout</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>android</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/apk/res/android<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>tools</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/tools<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>match_parent<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>match_parent<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>orientation</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>vertical<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>gravity</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>center<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">tools:</span>context</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>.ui.BlankFragment<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TextView</span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>@+id/text1<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>textSize</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>26sp<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>text</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>LinearLayout</span><span class=\"token punctuation\">></span></span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>至此 我们已经完成了 tabLayout + viewPager2 + fragment </p>\n<h3 id=\"viewPager2常用方法\"><a href=\"#viewPager2常用方法\" class=\"headerlink\" title=\"viewPager2常用方法\"></a>viewPager2常用方法</h3><ul>\n<li><code>setAdapter()</code> 设置适配器</li>\n<li><code>setOrientation()</code> 设置布局方向</li>\n<li><code>setCurrentItem()</code> 设置当前Item下标</li>\n<li><code>beginFakeDrag()</code> 开始模拟拖拽</li>\n<li><code>fakeDragBy()</code> 模拟拖拽中</li>\n<li><code>endFakeDrag()</code> 模拟拖拽结束</li>\n<li><code>setUserInputEnabled()</code> 设置是否允许用户输入/触摸</li>\n<li><code>setOffscreenPageLimit()</code> 设置屏幕外加载页面数量</li>\n<li><code>registerOnPageChangeCallback()</code> 注册页面滑动监听回调</li>\n<li><code>setPageTransformer()</code> 设置页面滑动时的变换效果</li>\n</ul>\n<h3 id=\"ViewPager2-预加载和缓存\"><a href=\"#ViewPager2-预加载和缓存\" class=\"headerlink\" title=\"ViewPager2 预加载和缓存\"></a>ViewPager2 预加载和缓存</h3><p><code>viewPager2</code> 是存在预加载和缓存的 我们虽然可以通过<code>offscreenPageLimit</code> 去设置预加载的数量 但是 <code>viewPager2</code> 会默认帮我们<br>缓存两个<code>fragment</code> 意思就是我们再滑动回来时 不会再去走 fragment 创建的生命周期了 会走 onResume 生命周期函数</p>\n<p><code>one picture is worth a thousand words</code> :</p>\n<p><code>viewPager2</code> 默认开启预加载 </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210625182426.png\"></p>\n<p><strong>如何关闭预加载、并设置缓存数量</strong></p>\n<p><strong>常见设置如下</strong></p>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\">\n<span class=\"token comment\" spellcheck=\"true\">//设置应保留在当前可见页面两侧的页面数</span>\nviewPager2<span class=\"token punctuation\">.</span><span class=\"token function\">setOffscreenPageLimit</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">//关闭预加载</span>\n<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>RecyclerView<span class=\"token punctuation\">)</span>viewPager2<span class=\"token punctuation\">.</span><span class=\"token function\">getChildAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLayoutManager</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setItemPrefetchEnabled</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">//设置缓存数量，对应 RecyclerView 中的 mCachedViews，即屏幕外的视图数量</span>\n<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>RecyclerView<span class=\"token punctuation\">)</span>viewPager2<span class=\"token punctuation\">.</span><span class=\"token function\">getChildAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setItemViewCacheSize</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><code>viewPager2</code> 会默认缓存2个<code>ItemView</code></p>\n<p>我们将<code>((RecyclerView)viewPager2.getChildAt(0)).setItemViewCacheSize(0);</code> 设置为<code>0</code>即可 这样我们每次滑动一个新的<code>tab</code>时 会创建<br>新的<code>fragment</code>并销毁上一个<code>fragment</code></p>\n<h3 id=\"viewPager2-对-fragment-的支持\"><a href=\"#viewPager2-对-fragment-的支持\" class=\"headerlink\" title=\"viewPager2 对 fragment 的支持\"></a>viewPager2 对 fragment 的支持</h3><p>目前，<code>ViewPager2</code>对<code>Fragment</code>的支持只能使用<code>FragmentStateAdapter</code>，使用起来也是非常简单：</p>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\">\nviewPager2<span class=\"token punctuation\">.</span><span class=\"token function\">setAdapter</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">FragmentStateAdapter</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token annotation punctuation\">@NonNull</span>\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> Fragment <span class=\"token function\">createFragment</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> position<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> BlankFragment<span class=\"token punctuation\">.</span><span class=\"token function\">newInstance</span><span class=\"token punctuation\">(</span>tabTitles<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">int</span> <span class=\"token function\">getItemCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> tabTitles<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"另外还有一个小坑\"><a href=\"#另外还有一个小坑\" class=\"headerlink\" title=\"另外还有一个小坑\"></a>另外还有一个小坑</h3><p><strong>ViewPager2+TabLayout懒加载问题，Fragment被创建多次</strong></p>\n<p><code>ViewPager2</code>默认只加载当前页面，相当于官方处理了<code>Fragment</code>的懒加载问题，当你使用代码</p>\n<pre><code>\nnew TabLayoutMediator(tabLayout, viewPager, true, new TabLayoutMediator.TabConfigurationStrategy() {\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void onConfigureTab(@NonNull TabLayout.Tab tab, int position) {\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tab.setText(titles.get(position));\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n}).attach();\n</code></pre>\n<p>此时当你滑动<code>ViewPager2</code>时，滑动到某个<code>Fragment</code>页面才会加载，执行onCreateView()方法，</p>\n<p>但是当你手动点击<code>TabLayout</code>时，此时懒加载就会失效，<code>onCreateView()</code>会被执行多次，</p>\n<p>原因就是…此时<code>ViewPager2</code>默认是平滑滚动的，滚动滑过的<code>Fragment</code>都会被加载，</p>\n<p><strong>只需修改代码:</strong></p>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\">\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">TabLayoutMediator</span><span class=\"token punctuation\">(</span>tabLayout<span class=\"token punctuation\">,</span> viewPager<span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TabLayoutMediator<span class=\"token punctuation\">.</span>TabConfigurationStrategy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token annotation punctuation\">@Override</span>\n\n<span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onConfigureTab</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@NonNull</span> TabLayout<span class=\"token punctuation\">.</span>Tab tab<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> position<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span>tab<span class=\"token punctuation\">.</span><span class=\"token function\">setText</span><span class=\"token punctuation\">(</span>titles<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">attach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>其中，第二个<code>boolean</code>参数为<code>smoothScroll</code> 一定要填<code>false</code>  这时点击 哪个<code>tab</code> 就会创建 哪个 <code>fragment</code></p>\n<p>但是页面看起来没有那么平滑了 各有利弊吧</p>\n<p><strong>—————————————————————————————</strong></p>\n<p>如果 需要点击tab无动画 滑动页面时有动画 怎么办呢?</p>\n<p>TabLayoutMediator 是final类  且smoothScroll字段是私有的、我们没法继承重写、但是可以copy源码修改、不会有问题</p>\n<p>我们将 源码copy下来 稍作修改就可以用了 下面是修改好的代码:</p>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\">\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> androidx<span class=\"token punctuation\">.</span>viewpager2<span class=\"token punctuation\">.</span>widget<span class=\"token punctuation\">.</span>ViewPager2<span class=\"token punctuation\">.</span>SCROLL_STATE_DRAGGING<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> androidx<span class=\"token punctuation\">.</span>viewpager2<span class=\"token punctuation\">.</span>widget<span class=\"token punctuation\">.</span>ViewPager2<span class=\"token punctuation\">.</span>SCROLL_STATE_IDLE<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> androidx<span class=\"token punctuation\">.</span>viewpager2<span class=\"token punctuation\">.</span>widget<span class=\"token punctuation\">.</span>ViewPager2<span class=\"token punctuation\">.</span>SCROLL_STATE_SETTLING<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> androidx<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span>NonNull<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> androidx<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span>Nullable<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> androidx<span class=\"token punctuation\">.</span>recyclerview<span class=\"token punctuation\">.</span>widget<span class=\"token punctuation\">.</span>RecyclerView<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> androidx<span class=\"token punctuation\">.</span>viewpager2<span class=\"token punctuation\">.</span>widget<span class=\"token punctuation\">.</span>ViewPager2<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>google<span class=\"token punctuation\">.</span>android<span class=\"token punctuation\">.</span>material<span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">.</span>TabLayout<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> java<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span>ref<span class=\"token punctuation\">.</span>WeakReference<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">/**\n * A mediator to link a TabLayout with a ViewPager2. The mediator will synchronize the ViewPager2's\n * position with the selected tab when a tab is selected, and the TabLayout's scroll position when\n * the user drags the ViewPager2. TabLayoutMediator will listen to ViewPager2's OnPageChangeCallback\n * to adjust tab when ViewPager2 moves. TabLayoutMediator listens to TabLayout's\n * OnTabSelectedListener to adjust VP2 when tab moves. TabLayoutMediator listens to RecyclerView's\n * AdapterDataObserver to recreate tab content when dataset changes.\n *\n * &lt;p>Establish the link by creating an instance of this class, make sure the ViewPager2 has an\n * adapter and then call {@link #attach()} on it. Instantiating a TabLayoutMediator will only create\n * the mediator object, {@link #attach()} will link the TabLayout and the ViewPager2 together. When\n * creating an instance of this class, you must supply an implementation of {@link\n * com.google.android.material.tabs.TabLayoutMediator.TabConfigurationStrategy} in which you set the text of the tab, and/or perform any styling of the\n * tabs that you require. Changing ViewPager2's adapter will require a {@link #detach()} followed by\n * {@link #attach()} call. Changing the ViewPager2 or TabLayout will require a new instantiation of\n * TabLayoutMediator.\n */</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TabLayoutMediators</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token annotation punctuation\">@NonNull</span> <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> TabLayout tabLayout<span class=\"token punctuation\">;</span>\n  <span class=\"token annotation punctuation\">@NonNull</span> <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> ViewPager2 viewPager<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">boolean</span> autoRefresh<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\" spellcheck=\"true\">// 这里我们改为静态变量 以便于在静态方法中使用这个变量</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">boolean</span> smoothScroll<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> TabConfigurationStrategy tabConfigurationStrategy<span class=\"token punctuation\">;</span>\n  <span class=\"token annotation punctuation\">@Nullable</span> <span class=\"token keyword\">private</span> RecyclerView<span class=\"token punctuation\">.</span>Adapter<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span><span class=\"token operator\">></span> adapter<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">boolean</span> attached<span class=\"token punctuation\">;</span>\n\n  <span class=\"token annotation punctuation\">@Nullable</span> <span class=\"token keyword\">private</span> TabLayoutOnPageChangeCallback onPageChangeCallback<span class=\"token punctuation\">;</span>\n  <span class=\"token annotation punctuation\">@Nullable</span> <span class=\"token keyword\">private</span> TabLayout<span class=\"token punctuation\">.</span>OnTabSelectedListener onTabSelectedListener<span class=\"token punctuation\">;</span>\n  <span class=\"token annotation punctuation\">@Nullable</span> <span class=\"token keyword\">private</span> RecyclerView<span class=\"token punctuation\">.</span>AdapterDataObserver pagerAdapterObserver<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">/**\n   * A callback interface that must be implemented to set the text and styling of newly created\n   * tabs.\n   */</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">TabConfigurationStrategy</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\" spellcheck=\"true\">/**\n     * Called to configure the tab for the page at the specified position. Typically calls {@link\n     * TabLayout.Tab#setText(CharSequence)}, but any form of styling can be applied.\n     *\n     * @param tab The Tab which should be configured to represent the title of the item at the given\n     *     position in the data set.\n     * @param position The position of the item within the adapter's data set.\n     */</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">onConfigureTab</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@NonNull</span> TabLayout<span class=\"token punctuation\">.</span>Tab tab<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> position<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">TabLayoutMediators</span><span class=\"token punctuation\">(</span>\n    <span class=\"token annotation punctuation\">@NonNull</span> TabLayout tabLayout<span class=\"token punctuation\">,</span>\n    <span class=\"token annotation punctuation\">@NonNull</span> ViewPager2 viewPager<span class=\"token punctuation\">,</span>\n    <span class=\"token annotation punctuation\">@NonNull</span> TabConfigurationStrategy tabConfigurationStrategy<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">(</span>tabLayout<span class=\"token punctuation\">,</span> viewPager<span class=\"token punctuation\">,</span> <span class=\"token comment\" spellcheck=\"true\">/* autoRefresh= */</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> tabConfigurationStrategy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">TabLayoutMediators</span><span class=\"token punctuation\">(</span>\n    <span class=\"token annotation punctuation\">@NonNull</span> TabLayout tabLayout<span class=\"token punctuation\">,</span>\n    <span class=\"token annotation punctuation\">@NonNull</span> ViewPager2 viewPager<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">boolean</span> autoRefresh<span class=\"token punctuation\">,</span>\n    <span class=\"token annotation punctuation\">@NonNull</span> TabConfigurationStrategy tabConfigurationStrategy<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">(</span>tabLayout<span class=\"token punctuation\">,</span> viewPager<span class=\"token punctuation\">,</span> autoRefresh<span class=\"token punctuation\">,</span> <span class=\"token comment\" spellcheck=\"true\">/* smoothScroll= */</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> tabConfigurationStrategy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">TabLayoutMediators</span><span class=\"token punctuation\">(</span>\n    <span class=\"token annotation punctuation\">@NonNull</span> TabLayout tabLayout<span class=\"token punctuation\">,</span>\n    <span class=\"token annotation punctuation\">@NonNull</span> ViewPager2 viewPager<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">boolean</span> autoRefresh<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">boolean</span> smoothScroll<span class=\"token punctuation\">,</span>\n    <span class=\"token annotation punctuation\">@NonNull</span> TabConfigurationStrategy tabConfigurationStrategy<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tabLayout <span class=\"token operator\">=</span> tabLayout<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>viewPager <span class=\"token operator\">=</span> viewPager<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>autoRefresh <span class=\"token operator\">=</span> autoRefresh<span class=\"token punctuation\">;</span>\n    TabLayoutMediators<span class=\"token punctuation\">.</span>smoothScroll <span class=\"token operator\">=</span> smoothScroll<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tabConfigurationStrategy <span class=\"token operator\">=</span> tabConfigurationStrategy<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">/**\n   * Link the TabLayout and the ViewPager2 together. Must be called after ViewPager2 has an adapter\n   * set. To be called on a new instance of TabLayoutMediator or if the ViewPager2's adapter\n   * changes.\n   *\n   * @throws IllegalStateException If the mediator is already attached, or the ViewPager2 has no\n   *     adapter.\n   */</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">attach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>attached<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IllegalStateException</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TabLayoutMediator is already attached\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    adapter <span class=\"token operator\">=</span> viewPager<span class=\"token punctuation\">.</span><span class=\"token function\">getAdapter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>adapter <span class=\"token operator\">==</span> null<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IllegalStateException</span><span class=\"token punctuation\">(</span>\n        <span class=\"token string\">\"TabLayoutMediator attached before ViewPager2 has an \"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"adapter\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    attached <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// Add our custom OnPageChangeCallback to the ViewPager</span>\n    onPageChangeCallback <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TabLayoutOnPageChangeCallback</span><span class=\"token punctuation\">(</span>tabLayout<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    viewPager<span class=\"token punctuation\">.</span><span class=\"token function\">registerOnPageChangeCallback</span><span class=\"token punctuation\">(</span>onPageChangeCallback<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// Now we'll add a tab selected listener to set ViewPager's current item</span>\n    onTabSelectedListener <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ViewPagerOnTabSelectedListener</span><span class=\"token punctuation\">(</span>viewPager<span class=\"token punctuation\">,</span> smoothScroll<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">addOnTabSelectedListener</span><span class=\"token punctuation\">(</span>onTabSelectedListener<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// Now we'll populate ourselves from the pager adapter, adding an observer if</span>\n    <span class=\"token comment\" spellcheck=\"true\">// autoRefresh is enabled</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>autoRefresh<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\" spellcheck=\"true\">// Register our observer on the new adapter</span>\n      pagerAdapterObserver <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PagerAdapterObserver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      adapter<span class=\"token punctuation\">.</span><span class=\"token function\">registerAdapterDataObserver</span><span class=\"token punctuation\">(</span>pagerAdapterObserver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">populateTabsFromPagerAdapter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// Now update the scroll position to match the ViewPager's current item</span>\n    tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">setScrollPosition</span><span class=\"token punctuation\">(</span>viewPager<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrentItem</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0f</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">/**\n   * Unlink the TabLayout and the ViewPager. To be called on a stale TabLayoutMediator if a new one\n   * is instantiated, to prevent holding on to a view that should be garbage collected. Also to be\n   * called before {@link #attach()} when a ViewPager2's adapter is changed.\n   */</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">detach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>autoRefresh <span class=\"token operator\">&amp;&amp;</span> adapter <span class=\"token operator\">!=</span> null<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      adapter<span class=\"token punctuation\">.</span><span class=\"token function\">unregisterAdapterDataObserver</span><span class=\"token punctuation\">(</span>pagerAdapterObserver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      pagerAdapterObserver <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">removeOnTabSelectedListener</span><span class=\"token punctuation\">(</span>onTabSelectedListener<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    viewPager<span class=\"token punctuation\">.</span><span class=\"token function\">unregisterOnPageChangeCallback</span><span class=\"token punctuation\">(</span>onPageChangeCallback<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    onTabSelectedListener <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n    onPageChangeCallback <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n    adapter <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n    attached <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@SuppressWarnings</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"WeakerAccess\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">void</span> <span class=\"token function\">populateTabsFromPagerAdapter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">removeAllTabs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>adapter <span class=\"token operator\">!=</span> null<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">int</span> adapterCount <span class=\"token operator\">=</span> adapter<span class=\"token punctuation\">.</span><span class=\"token function\">getItemCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> adapterCount<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        TabLayout<span class=\"token punctuation\">.</span>Tab tab <span class=\"token operator\">=</span> tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">newTab</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        tabConfigurationStrategy<span class=\"token punctuation\">.</span><span class=\"token function\">onConfigureTab</span><span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">addTab</span><span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token comment\" spellcheck=\"true\">// Make sure we reflect the currently set ViewPager item</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>adapterCount <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">int</span> lastItem <span class=\"token operator\">=</span> tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">getTabCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> currItem <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span>viewPager<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrentItem</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> lastItem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>currItem <span class=\"token operator\">!=</span> tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">getSelectedTabPosition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">selectTab</span><span class=\"token punctuation\">(</span>tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">getTabAt</span><span class=\"token punctuation\">(</span>currItem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">/**\n   * A {@link ViewPager2.OnPageChangeCallback} class which contains the necessary calls back to the\n   * provided {@link TabLayout} so that the tab position is kept in sync.\n   *\n   * &lt;p>This class stores the provided TabLayout weakly, meaning that you can use {@link\n   * ViewPager2#registerOnPageChangeCallback(ViewPager2.OnPageChangeCallback)} without removing the\n   * callback and not cause a leak.\n   */</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TabLayoutOnPageChangeCallback</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">ViewPager2<span class=\"token punctuation\">.</span>OnPageChangeCallback</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@NonNull</span> <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> WeakReference<span class=\"token operator\">&lt;</span>TabLayout<span class=\"token operator\">></span> tabLayoutRef<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> previousScrollState<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> scrollState<span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">TabLayoutOnPageChangeCallback</span><span class=\"token punctuation\">(</span>TabLayout tabLayout<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      tabLayoutRef <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WeakReference</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>tabLayout<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">reset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onPageScrollStateChanged</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> state<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\" spellcheck=\"true\">// 根据 是滑动的viewPager还是 点击的 tab 去设置 是否需要平滑动画</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>state <span class=\"token operator\">==</span> SCROLL_STATE_DRAGGING<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\" spellcheck=\"true\">// 如果是滑动就设置平滑动画</span>\n        smoothScroll <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>state <span class=\"token operator\">==</span> SCROLL_STATE_IDLE<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\" spellcheck=\"true\">// 点击的tab就不设置平滑动画</span>\n        smoothScroll <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      previousScrollState <span class=\"token operator\">=</span> scrollState<span class=\"token punctuation\">;</span>\n      scrollState <span class=\"token operator\">=</span> state<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onPageScrolled</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> position<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> positionOffset<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> positionOffsetPixels<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      TabLayout tabLayout <span class=\"token operator\">=</span> tabLayoutRef<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tabLayout <span class=\"token operator\">!=</span> null<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\" spellcheck=\"true\">// Only update the text selection if we're not settling, or we are settling after</span>\n        <span class=\"token comment\" spellcheck=\"true\">// being dragged</span>\n        <span class=\"token keyword\">boolean</span> updateText <span class=\"token operator\">=</span>\n          scrollState <span class=\"token operator\">!=</span> SCROLL_STATE_SETTLING <span class=\"token operator\">||</span> previousScrollState <span class=\"token operator\">==</span> SCROLL_STATE_DRAGGING<span class=\"token punctuation\">;</span>\n        <span class=\"token comment\" spellcheck=\"true\">// Update the indicator if we're not settling after being idle. This is caused</span>\n        <span class=\"token comment\" spellcheck=\"true\">// from a setCurrentItem() call and will be handled by an animation from</span>\n        <span class=\"token comment\" spellcheck=\"true\">// onPageSelected() instead.</span>\n        <span class=\"token keyword\">boolean</span> updateIndicator <span class=\"token operator\">=</span>\n          <span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>scrollState <span class=\"token operator\">==</span> SCROLL_STATE_SETTLING <span class=\"token operator\">&amp;&amp;</span> previousScrollState <span class=\"token operator\">==</span> SCROLL_STATE_IDLE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">setScrollPosition</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">,</span> positionOffset<span class=\"token punctuation\">,</span> updateText<span class=\"token punctuation\">,</span> updateIndicator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onPageSelected</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> position<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      TabLayout tabLayout <span class=\"token operator\">=</span> tabLayoutRef<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tabLayout <span class=\"token operator\">!=</span> null\n        <span class=\"token operator\">&amp;&amp;</span> tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">getSelectedTabPosition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> position\n        <span class=\"token operator\">&amp;&amp;</span> position <span class=\"token operator\">&lt;</span> tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">getTabCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\" spellcheck=\"true\">// Select the tab, only updating the indicator if we're not being dragged/settled</span>\n        <span class=\"token comment\" spellcheck=\"true\">// (since onPageScrolled will handle that).</span>\n        <span class=\"token keyword\">boolean</span> updateIndicator <span class=\"token operator\">=</span>\n          scrollState <span class=\"token operator\">==</span> SCROLL_STATE_IDLE\n            <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>scrollState <span class=\"token operator\">==</span> SCROLL_STATE_SETTLING\n            <span class=\"token operator\">&amp;&amp;</span> previousScrollState <span class=\"token operator\">==</span> SCROLL_STATE_IDLE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">selectTab</span><span class=\"token punctuation\">(</span>tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">getTabAt</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> updateIndicator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">void</span> <span class=\"token function\">reset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      previousScrollState <span class=\"token operator\">=</span> scrollState <span class=\"token operator\">=</span> SCROLL_STATE_IDLE<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">/**\n   * A {@link TabLayout.OnTabSelectedListener} class which contains the necessary calls back to the\n   * provided {@link ViewPager2} so that the tab position is kept in sync.\n   */</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ViewPagerOnTabSelectedListener</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">TabLayout<span class=\"token punctuation\">.</span>OnTabSelectedListener</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> ViewPager2 viewPager<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">// 注释掉这个局部变量 使用最上边的那个全局变量</span>\n    <span class=\"token comment\" spellcheck=\"true\">//private final boolean smoothScroll;</span>\n\n    <span class=\"token function\">ViewPagerOnTabSelectedListener</span><span class=\"token punctuation\">(</span>ViewPager2 viewPager<span class=\"token punctuation\">,</span> <span class=\"token keyword\">boolean</span> smoothScroll<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>viewPager <span class=\"token operator\">=</span> viewPager<span class=\"token punctuation\">;</span>\n      <span class=\"token comment\" spellcheck=\"true\">// 这一行也注释掉</span>\n      <span class=\"token comment\" spellcheck=\"true\">//this.smoothScroll = smoothScroll;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onTabSelected</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@NonNull</span> TabLayout<span class=\"token punctuation\">.</span>Tab tab<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      viewPager<span class=\"token punctuation\">.</span><span class=\"token function\">setCurrentItem</span><span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">.</span><span class=\"token function\">getPosition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> smoothScroll<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onTabUnselected</span><span class=\"token punctuation\">(</span>TabLayout<span class=\"token punctuation\">.</span>Tab tab<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\" spellcheck=\"true\">// No-op</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onTabReselected</span><span class=\"token punctuation\">(</span>TabLayout<span class=\"token punctuation\">.</span>Tab tab<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\" spellcheck=\"true\">// No-op</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PagerAdapterObserver</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">RecyclerView<span class=\"token punctuation\">.</span>AdapterDataObserver</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">PagerAdapterObserver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onChanged</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">populateTabsFromPagerAdapter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onItemRangeChanged</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> positionStart<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> itemCount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">populateTabsFromPagerAdapter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onItemRangeChanged</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> positionStart<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> itemCount<span class=\"token punctuation\">,</span> <span class=\"token annotation punctuation\">@Nullable</span> Object payload<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">populateTabsFromPagerAdapter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onItemRangeInserted</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> positionStart<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> itemCount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">populateTabsFromPagerAdapter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onItemRangeRemoved</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> positionStart<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> itemCount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">populateTabsFromPagerAdapter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onItemRangeMoved</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> fromPosition<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> toPosition<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> itemCount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">populateTabsFromPagerAdapter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>具体用法为:</p>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\">\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">TabLayoutMediators</span><span class=\"token punctuation\">(</span>tabLayout<span class=\"token punctuation\">,</span> viewPager2<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TabLayoutMediators<span class=\"token punctuation\">.</span>TabConfigurationStrategy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token annotation punctuation\">@Override</span>\n      <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onConfigureTab</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@NonNull</span> TabLayout<span class=\"token punctuation\">.</span>Tab tab<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> position<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        tab<span class=\"token punctuation\">.</span><span class=\"token function\">setText</span><span class=\"token punctuation\">(</span>tabTitles<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">attach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>和官方的用法一样 没啥差别</p>\n<p><strong>—————————————————————————————</strong></p>\n<p>如果即要求点击tab有动画 滑动页面也有动画 可以看下面这个 我们摒弃官方的 TabLayoutMediator 联动方法</p>\n<p>我们自己来手动 让 tabLayout 和 viewPager2 联动起来</p>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\">\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">firstMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// 设置 tabLayout 标题</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> tabTitles<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">addTab</span><span class=\"token punctuation\">(</span>tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">newTab</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setText</span><span class=\"token punctuation\">(</span>tabTitles<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\" spellcheck=\"true\">// 监听tabLayout事件 设置选中的viewPager2</span>\n    tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">addOnTabSelectedListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">TabLayout<span class=\"token punctuation\">.</span>OnTabSelectedListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token annotation punctuation\">@Override</span>\n      <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onTabSelected</span><span class=\"token punctuation\">(</span>TabLayout<span class=\"token punctuation\">.</span>Tab tab<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        viewPager2<span class=\"token punctuation\">.</span><span class=\"token function\">setCurrentItem</span><span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">.</span><span class=\"token function\">getPosition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token annotation punctuation\">@Override</span>\n      <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onTabUnselected</span><span class=\"token punctuation\">(</span>TabLayout<span class=\"token punctuation\">.</span>Tab tab<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token annotation punctuation\">@Override</span>\n      <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onTabReselected</span><span class=\"token punctuation\">(</span>TabLayout<span class=\"token punctuation\">.</span>Tab tab<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n    <span class=\"token comment\" spellcheck=\"true\">// viewPager2 滑动监听 设置tab选中</span>\n    viewPager2<span class=\"token punctuation\">.</span><span class=\"token function\">registerOnPageChangeCallback</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ViewPager2<span class=\"token punctuation\">.</span>OnPageChangeCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token annotation punctuation\">@Override</span>\n      <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onPageSelected</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> position<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">selectTab</span><span class=\"token punctuation\">(</span>tabLayout<span class=\"token punctuation\">.</span><span class=\"token function\">getTabAt</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h3><p>viewPager2的优点还是有目共睹的, 但是还是要去踩坑啊，我之前也是用<code>viewPager2</code> 但是没用对的话是会产生内存泄露的<br>所以就研究了一下 在这里记录一下问题 参考了很多博客 基本上都不咋解决问题</p>\n<p>只有下面这四篇有帮助 感谢!!!</p>\n<p>第一篇、 <a href=\"https://hitendev.github.io/2019/05/14/ViewPager2%E9%87%8D%E5%A4%A7%E6%9B%B4%E6%96%B0%EF%BC%8C%E6%94%AF%E6%8C%81offscreenPageLimit/\">ViewPager2重大更新</a></p>\n<p>第二篇、 <a href=\"https://juejin.cn/post/6844904114124652558#heading-9\">ViewPager2主要功能</a></p>\n<p>第三篇、 <a href=\"https://www.jianshu.com/p/2cc7bdd50c6c\">解决ViewPager2+TabLayout懒加载问题，Fragment被创建多次</a></p>\n<p>第四篇、<a href=\"https://blog.csdn.net/BirdEatBug/article/details/117414954\">android ViewPager2+TabLayout、滑动效果相关问题！</a></p>\n<p><strong>另外</strong></p>\n<p>LeakCanary –&gt; <a href=\"https://square.github.io/leakcanary/getting_started/\">内存泄漏检测工具</a></p>\n<p>使用非常简单 </p>\n<p>只需要 在build.gradle 中 添加这么一行就可以了 只会在debug模式下检测 不会影响到 正式环境</p>\n<pre><code>dependencies {\n  // debugImplementation because LeakCanary should only run in debug builds.\n  debugImplementation 'com.squareup.leakcanary:leakcanary-android:2.7'\n}</code></pre>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"tabLayout-viewPager2-fragment-用不好会导致内存泄漏\"><a href=\"#tabLayout-viewPager2-fragment-用不好会导致内存泄漏\" class=\"headerlink\" title=\"tabLayout + viewPager2 + fragment 用不好会导致内存泄漏\"></a>tabLayout + viewPager2 + fragment 用不好会导致内存泄漏</h3><h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>tabLayout + viewPager2 + fragment 这是在app开发中非常常见的UI架构了 但是用不好的话 是会导致内存泄漏的</p>\n<p><a href=\"https://github.com/Naruto-1996/ViewPager2_Demo\">Demo地址</a></p>\n<p>先上图: </p>\n<p>(<code>app</code>模板使用<code>android studio</code> 创建一个就行 我只用 <code>HomeFragment</code>)</p>\n<img src=\"https://ae03.alicdn.com/kf/U3292cb58c99d44a3bcf092f9d0fba361h.png\" width = \"300\" height = \"600\" alt=\"图片名称\" align=center />\n\n<h3 id=\"先了解一下viewPager\"><a href=\"#先了解一下viewPager\" class=\"headerlink\" title=\"先了解一下viewPager\"></a>先了解一下viewPager</h3><p>之前我们都是使用viewPager 但是 viewPager 有两个毛病 </p>\n<ul>\n<li><p>不能关闭预加载</p>\n</li>\n<li><p>更新Adapter不生效</p>\n</li>\n</ul>\n<p>虽然能解决 但是很麻烦</p>\n<p>viewPager 有个方法 <code>offscreenPageLimit</code> 用来设置 当前页前后预加载的数量 即使设置为0也不起任何作用 因为源码中默认值为1</p>\n<p>先来看个图:</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210625175636.png\"></p>\n<p>上面是<code>ViewPager</code>默认情况下的加载示意图，当切换到当前页面时，会默认预加载左右两侧的布局到<code>ViewPager</code>中，<br>尽管两侧的<code>View</code>并不可见的，我们称这种情况叫预加载；由于<code>ViewPager</code>对<code>offscreenPageLimit</code>设置了限制，<br>页面的预加载是不可避免</p>\n<p>如果使用 一定要使用viewPager 也可以做到 fragment 懒加载 主要是对<code>fragment</code>做手脚 结合生命周期方法和setUserVisibleHint状态，控制数据延迟加载，而布局只能提前进入</p>\n<h3 id=\"viewPager2基本使用\"><a href=\"#viewPager2基本使用\" class=\"headerlink\" title=\"viewPager2基本使用\"></a>viewPager2基本使用</h3><p>1、 承载tabLayout 和 viewPager2 需要一个 fragment 或者 activity 这里我们使用 fragment</p>\n<p><code>HomeFragment</code> 如下:</p>\n<pre><code class=\"java\">\npublic class HomeFragment extends Fragment &#123;\n\n  private HomeViewModel homeViewModel;\n  private TabLayout tabLayout;\n  private ViewPager2 viewPager2;\n\n  private final ArrayList&lt;String&gt; tabTitles = new ArrayList&lt;&gt;();\n\n  // 用List 存放fragment 不推荐使用 用不好 导致内存泄漏\n  private ArrayList&lt;BlankFragment&gt; fragments = new ArrayList&lt;&gt;();\n\n\n\n  public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) &#123;\n    homeViewModel = new ViewModelProvider(this).get(HomeViewModel.class);\n    View root = inflater.inflate(R.layout.fragment_home, container, false);\n\n    tabLayout = root.findViewById(R.id.tabs);\n    viewPager2 = root.findViewById(R.id.viewPager);\n    return root;\n  &#125;\n\n\n  @Override\n  public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) &#123;\n    super.onViewCreated(view, savedInstanceState);\n\n    // 初始化 tabTitles 和 fragments\n    for (int i = 0; i &lt; 15; i++) &#123;\n      tabTitles.add(String.valueOf(i));\n      fragments.add(BlankFragment.newInstance(tabTitles.get(i)));\n    &#125;\n\n    // 关闭预加载\n    viewPager2.setOffscreenPageLimit(ViewPager2.OFFSCREEN_PAGE_LIMIT_DEFAULT);  // 可以不设置 因为默认是 -1 默认不进行预加载\n    // 这个必须设置 不然仍然会启用预加载\n    ((RecyclerView)viewPager2.getChildAt(0)).getLayoutManager().setItemPrefetchEnabled(false);\n    // 设置缓存数量，对应 RecyclerView 中的 mCachedViews，即屏幕外的视图数量\n    ((RecyclerView)viewPager2.getChildAt(0)).setItemViewCacheSize(0);\n\n    // 第一种方法 (可能会内存泄漏)\n    //FragmentAdapter adapter = new FragmentAdapter(this, fragments);\n    //viewPager2.setAdapter(adapter);\n\n    // 这里使用第二种方法\n    viewPager2.setAdapter(new FragmentStateAdapter(this) &#123;\n      @NonNull\n      @Override\n      public Fragment createFragment(int position) &#123;\n        return BlankFragment.newInstance(tabTitles.get(position));\n      &#125;\n\n      @Override\n      public int getItemCount() &#123;\n        return tabTitles.size();\n      &#125;\n\n    &#125;);\n    // viewPager2 滑动监听\n    viewPager2.registerOnPageChangeCallback(new ViewPager2.OnPageChangeCallback() &#123;\n      @Override\n      public void onPageSelected(int position) &#123;\n        super.onPageSelected(position);\n\n      &#125;\n    &#125;);\n\n    // 这里第四个参数一定要设置为false  如果设置为true时 我们在滑动时 BlankFragment的创建 和 销毁 都很正常\n    // 一旦 我们通过 点击tabLayout时 如果两个tab距离过远  那么所有划过的tabLayout 都会创建和销毁BlankFragment 这显然不是我们想要的\n\n    // tabLayout 和 viewPager 联动\n    new TabLayoutMediator(tabLayout, viewPager2,true,false, new TabLayoutMediator.TabConfigurationStrategy() &#123;\n      @Override\n      public void onConfigureTab(@NonNull TabLayout.Tab tab, int position) &#123;\n        tab.setText(tabTitles.get(position));\n      &#125;\n    &#125;).attach();\n\n\n  &#125;\n\n&#125;\n</code></pre>\n<p><code>fragment_home.xml</code> 布局文件:</p>\n<pre><code class=\"xml\">\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n  xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\n  xmlns:tools=&quot;http://schemas.android.com/tools&quot;\n  android:layout_width=&quot;match_parent&quot;\n  android:orientation=&quot;vertical&quot;\n  android:layout_height=&quot;match_parent&quot;\n  tools:context=&quot;.ui.home.HomeFragment&quot;&gt;\n\n  &lt;com.google.android.material.tabs.TabLayout\n    android:id=&quot;@+id/tabs&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;40dp&quot;\n    app:tabGravity=&quot;center&quot;\n    app:tabIndicatorColor=&quot;#ff678f&quot;\n    app:tabIndicatorFullWidth=&quot;false&quot;\n    app:tabIndicatorHeight=&quot;2dp&quot;\n    app:tabMode=&quot;scrollable&quot;\n    android:layout_marginTop=&quot;0dp&quot;\n    app:tabSelectedTextColor=&quot;#ff678f&quot;\n    app:tabTextColor=&quot;#333333&quot;\n    app:tabUnboundedRipple=&quot;true&quot; /&gt;\n\n\n  &lt;androidx.viewpager2.widget.ViewPager2\n    android:id=&quot;@+id/viewPager&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:background=&quot;@color/purple_200&quot;\n    android:layout_height=&quot;0dp&quot;\n    android:layout_weight=&quot;1&quot;/&gt;\n&lt;/LinearLayout&gt;\n</code></pre>\n<p>2、viewPager2的 FragmentStateAdapter 创建fragment时 我们 复用一个fragment</p>\n<p><code>BlankFragment</code> 如下:</p>\n<pre><code class=\"java\">\npublic class BlankFragment extends Fragment &#123;\n\n  private String mParam1;\n  private TextView mTextView;\n\n  public static BlankFragment newInstance(String param1) &#123;\n    BlankFragment fragment = new BlankFragment();\n    Bundle args = new Bundle();\n    args.putString(&quot;param1&quot;, param1);\n    fragment.setArguments(args);\n    return fragment;\n  &#125;\n\n  @Override\n  public void onPause() &#123;\n    super.onPause();\n    Log.i(&quot;TAG=======onPause&quot;, mParam1);\n  &#125;\n\n  @Override\n  public void onCreate(Bundle savedInstanceState) &#123;\n    super.onCreate(savedInstanceState);\n    if (getArguments() != null) &#123;\n      mParam1 = getArguments().getString(&quot;param1&quot;);\n    &#125;\n\n    Log.i(&quot;TAG=======onCreate&quot;, mParam1);\n    Toast.makeText(getContext(), mParam1, Toast.LENGTH_SHORT).show();\n  &#125;\n\n\n\n  @Override\n  public void onDestroy() &#123;\n    super.onDestroy();\n    Log.i(&quot;TAG=======onDestroy&quot;, mParam1);\n  &#125;\n\n  @Override\n  public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) &#123;\n    // Inflate the layout for this fragment\n    View root = inflater.inflate(R.layout.fragment_blank, container, false);\n    mTextView = root.findViewById(R.id.text1);\n    mTextView.setText(mParam1);\n    Log.i(&quot;TAG=======onCreateView&quot;, mParam1);\n    return root;\n  &#125;\n\n  // 对外提供一个刷新Ui的方法\n  public void refreshUi() &#123;\n    if (getArguments() != null) &#123;\n      mParam1 = getArguments().getString(&quot;param1&quot;);\n      mTextView.setText(mParam1 + &quot;ddd&quot;);\n    &#125;\n\n  &#125;\n\n  @Override\n  public void onDestroyView() &#123;\n    super.onDestroyView();\n    Log.i(&quot;TAG======onDestroyView&quot;, mParam1);\n  &#125;\n&#125;\n</code></pre>\n<p><code>fragment_blank.xml</code> 如下:</p>\n<pre><code class=\"xml\">\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n  xmlns:tools=&quot;http://schemas.android.com/tools&quot;\n  android:layout_width=&quot;match_parent&quot;\n  android:layout_height=&quot;match_parent&quot;\n  android:orientation=&quot;vertical&quot;\n  android:gravity=&quot;center&quot;\n  tools:context=&quot;.ui.BlankFragment&quot;&gt;\n\n  &lt;TextView\n    android:id=&quot;@+id/text1&quot;\n    android:textSize=&quot;26sp&quot;\n    android:layout_width=&quot;wrap_content&quot;\n    android:layout_height=&quot;wrap_content&quot;\n    android:text=&quot;black&quot;/&gt;\n\n&lt;/LinearLayout&gt;\n</code></pre>\n<p>至此 我们已经完成了 tabLayout + viewPager2 + fragment </p>\n<h3 id=\"viewPager2常用方法\"><a href=\"#viewPager2常用方法\" class=\"headerlink\" title=\"viewPager2常用方法\"></a>viewPager2常用方法</h3><ul>\n<li><code>setAdapter()</code> 设置适配器</li>\n<li><code>setOrientation()</code> 设置布局方向</li>\n<li><code>setCurrentItem()</code> 设置当前Item下标</li>\n<li><code>beginFakeDrag()</code> 开始模拟拖拽</li>\n<li><code>fakeDragBy()</code> 模拟拖拽中</li>\n<li><code>endFakeDrag()</code> 模拟拖拽结束</li>\n<li><code>setUserInputEnabled()</code> 设置是否允许用户输入/触摸</li>\n<li><code>setOffscreenPageLimit()</code> 设置屏幕外加载页面数量</li>\n<li><code>registerOnPageChangeCallback()</code> 注册页面滑动监听回调</li>\n<li><code>setPageTransformer()</code> 设置页面滑动时的变换效果</li>\n</ul>\n<h3 id=\"ViewPager2-预加载和缓存\"><a href=\"#ViewPager2-预加载和缓存\" class=\"headerlink\" title=\"ViewPager2 预加载和缓存\"></a>ViewPager2 预加载和缓存</h3><p><code>viewPager2</code> 是存在预加载和缓存的 我们虽然可以通过<code>offscreenPageLimit</code> 去设置预加载的数量 但是 <code>viewPager2</code> 会默认帮我们<br>缓存两个<code>fragment</code> 意思就是我们再滑动回来时 不会再去走 fragment 创建的生命周期了 会走 onResume 生命周期函数</p>\n<p><code>one picture is worth a thousand words</code> :</p>\n<p><code>viewPager2</code> 默认开启预加载 </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210625182426.png\"></p>\n<p><strong>如何关闭预加载、并设置缓存数量</strong></p>\n<p><strong>常见设置如下</strong></p>\n<pre><code class=\"java\">\n//设置应保留在当前可见页面两侧的页面数\nviewPager2.setOffscreenPageLimit(4);\n\n//关闭预加载\n((RecyclerView)viewPager2.getChildAt(0)).getLayoutManager().setItemPrefetchEnabled(false);\n\n//设置缓存数量，对应 RecyclerView 中的 mCachedViews，即屏幕外的视图数量\n((RecyclerView)viewPager2.getChildAt(0)).setItemViewCacheSize(4);\n</code></pre>\n<p><code>viewPager2</code> 会默认缓存2个<code>ItemView</code></p>\n<p>我们将<code>((RecyclerView)viewPager2.getChildAt(0)).setItemViewCacheSize(0);</code> 设置为<code>0</code>即可 这样我们每次滑动一个新的<code>tab</code>时 会创建<br>新的<code>fragment</code>并销毁上一个<code>fragment</code></p>\n<h3 id=\"viewPager2-对-fragment-的支持\"><a href=\"#viewPager2-对-fragment-的支持\" class=\"headerlink\" title=\"viewPager2 对 fragment 的支持\"></a>viewPager2 对 fragment 的支持</h3><p>目前，<code>ViewPager2</code>对<code>Fragment</code>的支持只能使用<code>FragmentStateAdapter</code>，使用起来也是非常简单：</p>\n<pre><code class=\"java\">\nviewPager2.setAdapter(new FragmentStateAdapter(this) &#123;\n  @NonNull\n  @Override\n  public Fragment createFragment(int position) &#123;\n    return BlankFragment.newInstance(tabTitles.get(position));\n  &#125;\n\n  @Override\n  public int getItemCount() &#123;\n    return tabTitles.size();\n  &#125;\n\n&#125;);\n</code></pre>\n<h3 id=\"另外还有一个小坑\"><a href=\"#另外还有一个小坑\" class=\"headerlink\" title=\"另外还有一个小坑\"></a>另外还有一个小坑</h3><p><strong>ViewPager2+TabLayout懒加载问题，Fragment被创建多次</strong></p>\n<p><code>ViewPager2</code>默认只加载当前页面，相当于官方处理了<code>Fragment</code>的懒加载问题，当你使用代码</p>\n<pre><code>\nnew TabLayoutMediator(tabLayout, viewPager, true, new TabLayoutMediator.TabConfigurationStrategy() &#123;\n\n       @Override\n\n       public void onConfigureTab(@NonNull TabLayout.Tab tab, int position) &#123;\n\n           tab.setText(titles.get(position));\n\n       &#125;\n\n&#125;).attach();\n</code></pre>\n<p>此时当你滑动<code>ViewPager2</code>时，滑动到某个<code>Fragment</code>页面才会加载，执行onCreateView()方法，</p>\n<p>但是当你手动点击<code>TabLayout</code>时，此时懒加载就会失效，<code>onCreateView()</code>会被执行多次，</p>\n<p>原因就是…此时<code>ViewPager2</code>默认是平滑滚动的，滚动滑过的<code>Fragment</code>都会被加载，</p>\n<p><strong>只需修改代码:</strong></p>\n<pre><code class=\"java\">\nnew TabLayoutMediator(tabLayout, viewPager, true,false, new TabLayoutMediator.TabConfigurationStrategy() &#123;\n\n            @Override\n\n            public void onConfigureTab(@NonNull TabLayout.Tab tab, int position) &#123;\n\n                tab.setText(titles.get(position));\n\n            &#125;\n\n&#125;).attach();\n</code></pre>\n<p>其中，第二个<code>boolean</code>参数为<code>smoothScroll</code> 一定要填<code>false</code>  这时点击 哪个<code>tab</code> 就会创建 哪个 <code>fragment</code></p>\n<p>但是页面看起来没有那么平滑了 各有利弊吧</p>\n<p><strong>—————————————————————————————</strong></p>\n<p>如果 需要点击tab无动画 滑动页面时有动画 怎么办呢?</p>\n<p>TabLayoutMediator 是final类  且smoothScroll字段是私有的、我们没法继承重写、但是可以copy源码修改、不会有问题</p>\n<p>我们将 源码copy下来 稍作修改就可以用了 下面是修改好的代码:</p>\n<pre><code class=\"java\">\nimport static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_DRAGGING;\nimport static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_IDLE;\nimport static androidx.viewpager2.widget.ViewPager2.SCROLL_STATE_SETTLING;\n\nimport androidx.annotation.NonNull;\nimport androidx.annotation.Nullable;\nimport androidx.recyclerview.widget.RecyclerView;\nimport androidx.viewpager2.widget.ViewPager2;\n\nimport com.google.android.material.tabs.TabLayout;\n\nimport java.lang.ref.WeakReference;\n\n/**\n * A mediator to link a TabLayout with a ViewPager2. The mediator will synchronize the ViewPager2&#39;s\n * position with the selected tab when a tab is selected, and the TabLayout&#39;s scroll position when\n * the user drags the ViewPager2. TabLayoutMediator will listen to ViewPager2&#39;s OnPageChangeCallback\n * to adjust tab when ViewPager2 moves. TabLayoutMediator listens to TabLayout&#39;s\n * OnTabSelectedListener to adjust VP2 when tab moves. TabLayoutMediator listens to RecyclerView&#39;s\n * AdapterDataObserver to recreate tab content when dataset changes.\n *\n * &lt;p&gt;Establish the link by creating an instance of this class, make sure the ViewPager2 has an\n * adapter and then call &#123;@link #attach()&#125; on it. Instantiating a TabLayoutMediator will only create\n * the mediator object, &#123;@link #attach()&#125; will link the TabLayout and the ViewPager2 together. When\n * creating an instance of this class, you must supply an implementation of &#123;@link\n * com.google.android.material.tabs.TabLayoutMediator.TabConfigurationStrategy&#125; in which you set the text of the tab, and/or perform any styling of the\n * tabs that you require. Changing ViewPager2&#39;s adapter will require a &#123;@link #detach()&#125; followed by\n * &#123;@link #attach()&#125; call. Changing the ViewPager2 or TabLayout will require a new instantiation of\n * TabLayoutMediator.\n */\npublic final class TabLayoutMediators &#123;\n  @NonNull private final TabLayout tabLayout;\n  @NonNull private final ViewPager2 viewPager;\n  private final boolean autoRefresh;\n  // 这里我们改为静态变量 以便于在静态方法中使用这个变量\n  private static boolean smoothScroll;\n  private final TabConfigurationStrategy tabConfigurationStrategy;\n  @Nullable private RecyclerView.Adapter&lt;?&gt; adapter;\n  private boolean attached;\n\n  @Nullable private TabLayoutOnPageChangeCallback onPageChangeCallback;\n  @Nullable private TabLayout.OnTabSelectedListener onTabSelectedListener;\n  @Nullable private RecyclerView.AdapterDataObserver pagerAdapterObserver;\n\n  /**\n   * A callback interface that must be implemented to set the text and styling of newly created\n   * tabs.\n   */\n  public interface TabConfigurationStrategy &#123;\n    /**\n     * Called to configure the tab for the page at the specified position. Typically calls &#123;@link\n     * TabLayout.Tab#setText(CharSequence)&#125;, but any form of styling can be applied.\n     *\n     * @param tab The Tab which should be configured to represent the title of the item at the given\n     *     position in the data set.\n     * @param position The position of the item within the adapter&#39;s data set.\n     */\n    void onConfigureTab(@NonNull TabLayout.Tab tab, int position);\n  &#125;\n\n  public TabLayoutMediators(\n    @NonNull TabLayout tabLayout,\n    @NonNull ViewPager2 viewPager,\n    @NonNull TabConfigurationStrategy tabConfigurationStrategy) &#123;\n    this(tabLayout, viewPager, /* autoRefresh= */ true, tabConfigurationStrategy);\n  &#125;\n\n  public TabLayoutMediators(\n    @NonNull TabLayout tabLayout,\n    @NonNull ViewPager2 viewPager,\n    boolean autoRefresh,\n    @NonNull TabConfigurationStrategy tabConfigurationStrategy) &#123;\n    this(tabLayout, viewPager, autoRefresh, /* smoothScroll= */ true, tabConfigurationStrategy);\n  &#125;\n\n  public TabLayoutMediators(\n    @NonNull TabLayout tabLayout,\n    @NonNull ViewPager2 viewPager,\n    boolean autoRefresh,\n    boolean smoothScroll,\n    @NonNull TabConfigurationStrategy tabConfigurationStrategy) &#123;\n    this.tabLayout = tabLayout;\n    this.viewPager = viewPager;\n    this.autoRefresh = autoRefresh;\n    TabLayoutMediators.smoothScroll = smoothScroll;\n    this.tabConfigurationStrategy = tabConfigurationStrategy;\n  &#125;\n\n  /**\n   * Link the TabLayout and the ViewPager2 together. Must be called after ViewPager2 has an adapter\n   * set. To be called on a new instance of TabLayoutMediator or if the ViewPager2&#39;s adapter\n   * changes.\n   *\n   * @throws IllegalStateException If the mediator is already attached, or the ViewPager2 has no\n   *     adapter.\n   */\n  public void attach() &#123;\n    if (attached) &#123;\n      throw new IllegalStateException(&quot;TabLayoutMediator is already attached&quot;);\n    &#125;\n    adapter = viewPager.getAdapter();\n    if (adapter == null) &#123;\n      throw new IllegalStateException(\n        &quot;TabLayoutMediator attached before ViewPager2 has an &quot; + &quot;adapter&quot;);\n    &#125;\n    attached = true;\n\n    // Add our custom OnPageChangeCallback to the ViewPager\n    onPageChangeCallback = new TabLayoutOnPageChangeCallback(tabLayout);\n    viewPager.registerOnPageChangeCallback(onPageChangeCallback);\n\n    // Now we&#39;ll add a tab selected listener to set ViewPager&#39;s current item\n    onTabSelectedListener = new ViewPagerOnTabSelectedListener(viewPager, smoothScroll);\n    tabLayout.addOnTabSelectedListener(onTabSelectedListener);\n\n    // Now we&#39;ll populate ourselves from the pager adapter, adding an observer if\n    // autoRefresh is enabled\n    if (autoRefresh) &#123;\n      // Register our observer on the new adapter\n      pagerAdapterObserver = new PagerAdapterObserver();\n      adapter.registerAdapterDataObserver(pagerAdapterObserver);\n    &#125;\n\n    populateTabsFromPagerAdapter();\n\n    // Now update the scroll position to match the ViewPager&#39;s current item\n    tabLayout.setScrollPosition(viewPager.getCurrentItem(), 0f, true);\n  &#125;\n\n  /**\n   * Unlink the TabLayout and the ViewPager. To be called on a stale TabLayoutMediator if a new one\n   * is instantiated, to prevent holding on to a view that should be garbage collected. Also to be\n   * called before &#123;@link #attach()&#125; when a ViewPager2&#39;s adapter is changed.\n   */\n  public void detach() &#123;\n    if (autoRefresh &amp;&amp; adapter != null) &#123;\n      adapter.unregisterAdapterDataObserver(pagerAdapterObserver);\n      pagerAdapterObserver = null;\n    &#125;\n    tabLayout.removeOnTabSelectedListener(onTabSelectedListener);\n    viewPager.unregisterOnPageChangeCallback(onPageChangeCallback);\n    onTabSelectedListener = null;\n    onPageChangeCallback = null;\n    adapter = null;\n    attached = false;\n  &#125;\n\n  @SuppressWarnings(&quot;WeakerAccess&quot;)\n  void populateTabsFromPagerAdapter() &#123;\n    tabLayout.removeAllTabs();\n\n    if (adapter != null) &#123;\n      int adapterCount = adapter.getItemCount();\n      for (int i = 0; i &lt; adapterCount; i++) &#123;\n        TabLayout.Tab tab = tabLayout.newTab();\n        tabConfigurationStrategy.onConfigureTab(tab, i);\n        tabLayout.addTab(tab, false);\n      &#125;\n      // Make sure we reflect the currently set ViewPager item\n      if (adapterCount &gt; 0) &#123;\n        int lastItem = tabLayout.getTabCount() - 1;\n        int currItem = Math.min(viewPager.getCurrentItem(), lastItem);\n        if (currItem != tabLayout.getSelectedTabPosition()) &#123;\n          tabLayout.selectTab(tabLayout.getTabAt(currItem));\n        &#125;\n      &#125;\n    &#125;\n  &#125;\n\n  /**\n   * A &#123;@link ViewPager2.OnPageChangeCallback&#125; class which contains the necessary calls back to the\n   * provided &#123;@link TabLayout&#125; so that the tab position is kept in sync.\n   *\n   * &lt;p&gt;This class stores the provided TabLayout weakly, meaning that you can use &#123;@link\n   * ViewPager2#registerOnPageChangeCallback(ViewPager2.OnPageChangeCallback)&#125; without removing the\n   * callback and not cause a leak.\n   */\n  private static class TabLayoutOnPageChangeCallback extends ViewPager2.OnPageChangeCallback &#123;\n    @NonNull private final WeakReference&lt;TabLayout&gt; tabLayoutRef;\n    private int previousScrollState;\n    private int scrollState;\n\n    TabLayoutOnPageChangeCallback(TabLayout tabLayout) &#123;\n      tabLayoutRef = new WeakReference&lt;&gt;(tabLayout);\n      reset();\n    &#125;\n\n    @Override\n    public void onPageScrollStateChanged(final int state) &#123;\n      // 根据 是滑动的viewPager还是 点击的 tab 去设置 是否需要平滑动画\n      if (state == SCROLL_STATE_DRAGGING) &#123;\n        // 如果是滑动就设置平滑动画\n        smoothScroll = true;\n      &#125; else if (state == SCROLL_STATE_IDLE) &#123;\n        // 点击的tab就不设置平滑动画\n        smoothScroll = false;\n      &#125;\n      previousScrollState = scrollState;\n      scrollState = state;\n    &#125;\n\n    @Override\n    public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) &#123;\n      TabLayout tabLayout = tabLayoutRef.get();\n      if (tabLayout != null) &#123;\n        // Only update the text selection if we&#39;re not settling, or we are settling after\n        // being dragged\n        boolean updateText =\n          scrollState != SCROLL_STATE_SETTLING || previousScrollState == SCROLL_STATE_DRAGGING;\n        // Update the indicator if we&#39;re not settling after being idle. This is caused\n        // from a setCurrentItem() call and will be handled by an animation from\n        // onPageSelected() instead.\n        boolean updateIndicator =\n          !(scrollState == SCROLL_STATE_SETTLING &amp;&amp; previousScrollState == SCROLL_STATE_IDLE);\n        tabLayout.setScrollPosition(position, positionOffset, updateText, updateIndicator);\n      &#125;\n    &#125;\n\n    @Override\n    public void onPageSelected(final int position) &#123;\n      TabLayout tabLayout = tabLayoutRef.get();\n      if (tabLayout != null\n        &amp;&amp; tabLayout.getSelectedTabPosition() != position\n        &amp;&amp; position &lt; tabLayout.getTabCount()) &#123;\n        // Select the tab, only updating the indicator if we&#39;re not being dragged/settled\n        // (since onPageScrolled will handle that).\n        boolean updateIndicator =\n          scrollState == SCROLL_STATE_IDLE\n            || (scrollState == SCROLL_STATE_SETTLING\n            &amp;&amp; previousScrollState == SCROLL_STATE_IDLE);\n        tabLayout.selectTab(tabLayout.getTabAt(position), updateIndicator);\n      &#125;\n    &#125;\n\n    void reset() &#123;\n      previousScrollState = scrollState = SCROLL_STATE_IDLE;\n    &#125;\n  &#125;\n\n  /**\n   * A &#123;@link TabLayout.OnTabSelectedListener&#125; class which contains the necessary calls back to the\n   * provided &#123;@link ViewPager2&#125; so that the tab position is kept in sync.\n   */\n  private static class ViewPagerOnTabSelectedListener implements TabLayout.OnTabSelectedListener &#123;\n    private final ViewPager2 viewPager;\n    // 注释掉这个局部变量 使用最上边的那个全局变量\n    //private final boolean smoothScroll;\n\n    ViewPagerOnTabSelectedListener(ViewPager2 viewPager, boolean smoothScroll) &#123;\n      this.viewPager = viewPager;\n      // 这一行也注释掉\n      //this.smoothScroll = smoothScroll;\n    &#125;\n\n    @Override\n    public void onTabSelected(@NonNull TabLayout.Tab tab) &#123;\n      viewPager.setCurrentItem(tab.getPosition(), smoothScroll);\n    &#125;\n\n    @Override\n    public void onTabUnselected(TabLayout.Tab tab) &#123;\n      // No-op\n    &#125;\n\n    @Override\n    public void onTabReselected(TabLayout.Tab tab) &#123;\n      // No-op\n    &#125;\n  &#125;\n\n  private class PagerAdapterObserver extends RecyclerView.AdapterDataObserver &#123;\n    PagerAdapterObserver() &#123;&#125;\n\n    @Override\n    public void onChanged() &#123;\n      populateTabsFromPagerAdapter();\n    &#125;\n\n    @Override\n    public void onItemRangeChanged(int positionStart, int itemCount) &#123;\n      populateTabsFromPagerAdapter();\n    &#125;\n\n    @Override\n    public void onItemRangeChanged(int positionStart, int itemCount, @Nullable Object payload) &#123;\n      populateTabsFromPagerAdapter();\n    &#125;\n\n    @Override\n    public void onItemRangeInserted(int positionStart, int itemCount) &#123;\n      populateTabsFromPagerAdapter();\n    &#125;\n\n    @Override\n    public void onItemRangeRemoved(int positionStart, int itemCount) &#123;\n      populateTabsFromPagerAdapter();\n    &#125;\n\n    @Override\n    public void onItemRangeMoved(int fromPosition, int toPosition, int itemCount) &#123;\n      populateTabsFromPagerAdapter();\n    &#125;\n  &#125;\n&#125;\n</code></pre>\n<p>具体用法为:</p>\n<pre><code class=\"java\">\n    new TabLayoutMediators(tabLayout, viewPager2, new TabLayoutMediators.TabConfigurationStrategy() &#123;\n      @Override\n      public void onConfigureTab(@NonNull TabLayout.Tab tab, int position) &#123;\n        tab.setText(tabTitles.get(position));\n      &#125;\n    &#125;).attach();\n</code></pre>\n<p>和官方的用法一样 没啥差别</p>\n<p><strong>—————————————————————————————</strong></p>\n<p>如果即要求点击tab有动画 滑动页面也有动画 可以看下面这个 我们摒弃官方的 TabLayoutMediator 联动方法</p>\n<p>我们自己来手动 让 tabLayout 和 viewPager2 联动起来</p>\n<pre><code class=\"java\">\n  private void firstMethod() &#123;\n\n    // 设置 tabLayout 标题\n    for (int i = 0; i &lt; tabTitles.size(); i++) &#123;\n      tabLayout.addTab(tabLayout.newTab().setText(tabTitles.get(i)));\n    &#125;\n    // 监听tabLayout事件 设置选中的viewPager2\n    tabLayout.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() &#123;\n      @Override\n      public void onTabSelected(TabLayout.Tab tab) &#123;\n        viewPager2.setCurrentItem(tab.getPosition(), false);\n      &#125;\n\n      @Override\n      public void onTabUnselected(TabLayout.Tab tab) &#123;\n\n      &#125;\n\n      @Override\n      public void onTabReselected(TabLayout.Tab tab) &#123;\n\n      &#125;\n    &#125;);\n\n\n    // viewPager2 滑动监听 设置tab选中\n    viewPager2.registerOnPageChangeCallback(new ViewPager2.OnPageChangeCallback() &#123;\n      @Override\n      public void onPageSelected(int position) &#123;\n        tabLayout.selectTab(tabLayout.getTabAt(position));\n      &#125;\n    &#125;);\n\n&#125;\n\n</code></pre>\n<h3 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h3><p>viewPager2的优点还是有目共睹的, 但是还是要去踩坑啊，我之前也是用<code>viewPager2</code> 但是没用对的话是会产生内存泄露的<br>所以就研究了一下 在这里记录一下问题 参考了很多博客 基本上都不咋解决问题</p>\n<p>只有下面这四篇有帮助 感谢!!!</p>\n<p>第一篇、 <a href=\"https://hitendev.github.io/2019/05/14/ViewPager2%E9%87%8D%E5%A4%A7%E6%9B%B4%E6%96%B0%EF%BC%8C%E6%94%AF%E6%8C%81offscreenPageLimit/\">ViewPager2重大更新</a></p>\n<p>第二篇、 <a href=\"https://juejin.cn/post/6844904114124652558#heading-9\">ViewPager2主要功能</a></p>\n<p>第三篇、 <a href=\"https://www.jianshu.com/p/2cc7bdd50c6c\">解决ViewPager2+TabLayout懒加载问题，Fragment被创建多次</a></p>\n<p>第四篇、<a href=\"https://blog.csdn.net/BirdEatBug/article/details/117414954\">android ViewPager2+TabLayout、滑动效果相关问题！</a></p>\n<p><strong>另外</strong></p>\n<p>LeakCanary –&gt; <a href=\"https://square.github.io/leakcanary/getting_started/\">内存泄漏检测工具</a></p>\n<p>使用非常简单 </p>\n<p>只需要 在build.gradle 中 添加这么一行就可以了 只会在debug模式下检测 不会影响到 正式环境</p>\n<pre><code>dependencies &#123;\n  // debugImplementation because LeakCanary should only run in debug builds.\n  debugImplementation &#39;com.squareup.leakcanary:leakcanary-android:2.7&#39;\n&#125;</code></pre>\n"},{"title":"Android intent.setFlags方法中参数值的含义","date":"2020-10-21T09:17:58.000Z","_content":"\n#### Android中intent.setFlags方法中参数值的含义\n\n##### 一、FLAG_ACTIVITY_NEW_TASK:\n\n例如现在栈一的情况是：A    B   C(C位于栈顶)，C通过intent跳转到D，并且这个Intent添加了FLAG_ACTIVITY_NEW_TASK标记，\n如果D这个Activity在Manifest.xml中声明了添加Task affinity，系统首先会查找有没有和D的Task affinity相同的task栈存在，\n如果存在，就将D压入那个栈，如果不存在则会新建一个D的affinity的栈将其压入。如果D的Task affinity默认没有设置，则会将其压入栈1，变成A B C D，\n这样就和不加FLAG_ACTIVITY_NEW_TASK标记效果是一样的了。但如果试图从非Activity的非正常途径启动一个activity，\n比如从一个service、BroadcastReceiver等中启动一个Activity，则intent要设置Intent.FLAG_ACTIVITY_NEW_TASK标记。\nActivity要存在于Activity栈中，而非Activity的途径启动Activity时必然不存在一个Activity的栈，\n所以要新建一个Activity栈来存放要启动的Activity。\n\n##### 二、FLAG_ACTIVITY_CLEAR_TOP:\n\n例如现在的栈情况为A B C D, D此时通过intent跳转到B，如果这个intent设置FLAG_ACTIVITY_CLEAR_TOP标记，则栈情况变为:A B。如果没有添加这个标记，则栈的情况将会变为：A B C D B 。\n也就是说，如果设置了FLAG_ACTIVITY_CLEAR_TOP标记，并且目标Activity在栈中已存在，\n则会把位于该目标Activity之上的Activity从栈中弹出销毁。\n\n##### 三、FLAG_ACTIVITY_NO_HISTORY:\n\n例如现在栈的情况为：A B C 。C通过intent跳转到D，这个intent添加FLAG_ACTIVITY_NO_HISTORY标志，此时界面显示D的内容，但是它并不会压入栈中。\n如果按返回键，返回到C，栈的情况是：A  B  C。如果D中又跳转到E，栈的情况为：A B C E,此时按返回键会回到C，因为D根本就没有被压入栈中。\n\n##### 四、FLAG_ACTIVITY_SINGLE_TOP:\n\n和Activity的Launch mode的singleTop类似。如果某个intent设置了这个标志，并且这个intent的目标Activity就是栈顶的Activity，那么将不会新建一个实例压入栈中。\n简言之，目标Activity已在栈顶则跳转过去，不在栈顶则在栈顶新建Activity。\n\n* 如果遇到这种错误\n\n``` java\n\nCaused by: android.util.AndroidRuntimeException: Calling startActivity() from outside of an Activity  context requires the FLAG_ACTIVITY_NEW_TASK flag. Is this really what you want?\n\n```\n\n\nContext中有一个startActivity方法，Activity继承自Context，覆写了startActivity方法。\n如果使用Activity的startActivity方法，不会有任何问题，而如果使用Context的startActivity方法，\n就必须新建一个Activity栈，遇到上面的异常，是因为使用了Context的startActivity方法。\n\n解决的办法是：为intent设置一个flag，即\n\n``` java\nintent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n```\n这样就可以在新的Activity栈里启动这个Activity了。\n","source":"_posts/Android-intent-setFlags方法中参数值的含义.md","raw":"---\ntitle: Android intent.setFlags方法中参数值的含义\ndate: 2020-10-21 17:17:58\ncategories:\n- Android\ntags:\n- Intent\n- setFlags\n---\n\n#### Android中intent.setFlags方法中参数值的含义\n\n##### 一、FLAG_ACTIVITY_NEW_TASK:\n\n例如现在栈一的情况是：A    B   C(C位于栈顶)，C通过intent跳转到D，并且这个Intent添加了FLAG_ACTIVITY_NEW_TASK标记，\n如果D这个Activity在Manifest.xml中声明了添加Task affinity，系统首先会查找有没有和D的Task affinity相同的task栈存在，\n如果存在，就将D压入那个栈，如果不存在则会新建一个D的affinity的栈将其压入。如果D的Task affinity默认没有设置，则会将其压入栈1，变成A B C D，\n这样就和不加FLAG_ACTIVITY_NEW_TASK标记效果是一样的了。但如果试图从非Activity的非正常途径启动一个activity，\n比如从一个service、BroadcastReceiver等中启动一个Activity，则intent要设置Intent.FLAG_ACTIVITY_NEW_TASK标记。\nActivity要存在于Activity栈中，而非Activity的途径启动Activity时必然不存在一个Activity的栈，\n所以要新建一个Activity栈来存放要启动的Activity。\n\n##### 二、FLAG_ACTIVITY_CLEAR_TOP:\n\n例如现在的栈情况为A B C D, D此时通过intent跳转到B，如果这个intent设置FLAG_ACTIVITY_CLEAR_TOP标记，则栈情况变为:A B。如果没有添加这个标记，则栈的情况将会变为：A B C D B 。\n也就是说，如果设置了FLAG_ACTIVITY_CLEAR_TOP标记，并且目标Activity在栈中已存在，\n则会把位于该目标Activity之上的Activity从栈中弹出销毁。\n\n##### 三、FLAG_ACTIVITY_NO_HISTORY:\n\n例如现在栈的情况为：A B C 。C通过intent跳转到D，这个intent添加FLAG_ACTIVITY_NO_HISTORY标志，此时界面显示D的内容，但是它并不会压入栈中。\n如果按返回键，返回到C，栈的情况是：A  B  C。如果D中又跳转到E，栈的情况为：A B C E,此时按返回键会回到C，因为D根本就没有被压入栈中。\n\n##### 四、FLAG_ACTIVITY_SINGLE_TOP:\n\n和Activity的Launch mode的singleTop类似。如果某个intent设置了这个标志，并且这个intent的目标Activity就是栈顶的Activity，那么将不会新建一个实例压入栈中。\n简言之，目标Activity已在栈顶则跳转过去，不在栈顶则在栈顶新建Activity。\n\n* 如果遇到这种错误\n\n``` java\n\nCaused by: android.util.AndroidRuntimeException: Calling startActivity() from outside of an Activity  context requires the FLAG_ACTIVITY_NEW_TASK flag. Is this really what you want?\n\n```\n\n\nContext中有一个startActivity方法，Activity继承自Context，覆写了startActivity方法。\n如果使用Activity的startActivity方法，不会有任何问题，而如果使用Context的startActivity方法，\n就必须新建一个Activity栈，遇到上面的异常，是因为使用了Context的startActivity方法。\n\n解决的办法是：为intent设置一个flag，即\n\n``` java\nintent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n```\n这样就可以在新的Activity栈里启动这个Activity了。\n","slug":"Android-intent-setFlags方法中参数值的含义","published":1,"updated":"2020-10-21T09:26:50.698Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmw300093ys2033kgtt8","content":"<h4 id=\"Android中intent-setFlags方法中参数值的含义\"><a href=\"#Android中intent-setFlags方法中参数值的含义\" class=\"headerlink\" title=\"Android中intent.setFlags方法中参数值的含义\"></a>Android中intent.setFlags方法中参数值的含义</h4><h5 id=\"一、FLAG-ACTIVITY-NEW-TASK\"><a href=\"#一、FLAG-ACTIVITY-NEW-TASK\" class=\"headerlink\" title=\"一、FLAG_ACTIVITY_NEW_TASK:\"></a>一、FLAG_ACTIVITY_NEW_TASK:</h5><p>例如现在栈一的情况是：A    B   C(C位于栈顶)，C通过intent跳转到D，并且这个Intent添加了FLAG_ACTIVITY_NEW_TASK标记，<br>如果D这个Activity在Manifest.xml中声明了添加Task affinity，系统首先会查找有没有和D的Task affinity相同的task栈存在，<br>如果存在，就将D压入那个栈，如果不存在则会新建一个D的affinity的栈将其压入。如果D的Task affinity默认没有设置，则会将其压入栈1，变成A B C D，<br>这样就和不加FLAG_ACTIVITY_NEW_TASK标记效果是一样的了。但如果试图从非Activity的非正常途径启动一个activity，<br>比如从一个service、BroadcastReceiver等中启动一个Activity，则intent要设置Intent.FLAG_ACTIVITY_NEW_TASK标记。<br>Activity要存在于Activity栈中，而非Activity的途径启动Activity时必然不存在一个Activity的栈，<br>所以要新建一个Activity栈来存放要启动的Activity。</p>\n<h5 id=\"二、FLAG-ACTIVITY-CLEAR-TOP\"><a href=\"#二、FLAG-ACTIVITY-CLEAR-TOP\" class=\"headerlink\" title=\"二、FLAG_ACTIVITY_CLEAR_TOP:\"></a>二、FLAG_ACTIVITY_CLEAR_TOP:</h5><p>例如现在的栈情况为A B C D, D此时通过intent跳转到B，如果这个intent设置FLAG_ACTIVITY_CLEAR_TOP标记，则栈情况变为:A B。如果没有添加这个标记，则栈的情况将会变为：A B C D B 。<br>也就是说，如果设置了FLAG_ACTIVITY_CLEAR_TOP标记，并且目标Activity在栈中已存在，<br>则会把位于该目标Activity之上的Activity从栈中弹出销毁。</p>\n<h5 id=\"三、FLAG-ACTIVITY-NO-HISTORY\"><a href=\"#三、FLAG-ACTIVITY-NO-HISTORY\" class=\"headerlink\" title=\"三、FLAG_ACTIVITY_NO_HISTORY:\"></a>三、FLAG_ACTIVITY_NO_HISTORY:</h5><p>例如现在栈的情况为：A B C 。C通过intent跳转到D，这个intent添加FLAG_ACTIVITY_NO_HISTORY标志，此时界面显示D的内容，但是它并不会压入栈中。<br>如果按返回键，返回到C，栈的情况是：A  B  C。如果D中又跳转到E，栈的情况为：A B C E,此时按返回键会回到C，因为D根本就没有被压入栈中。</p>\n<h5 id=\"四、FLAG-ACTIVITY-SINGLE-TOP\"><a href=\"#四、FLAG-ACTIVITY-SINGLE-TOP\" class=\"headerlink\" title=\"四、FLAG_ACTIVITY_SINGLE_TOP:\"></a>四、FLAG_ACTIVITY_SINGLE_TOP:</h5><p>和Activity的Launch mode的singleTop类似。如果某个intent设置了这个标志，并且这个intent的目标Activity就是栈顶的Activity，那么将不会新建一个实例压入栈中。<br>简言之，目标Activity已在栈顶则跳转过去，不在栈顶则在栈顶新建Activity。</p>\n<ul>\n<li>如果遇到这种错误</li>\n</ul>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\">\nCaused by<span class=\"token operator\">:</span> android<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>AndroidRuntimeException<span class=\"token operator\">:</span> Calling <span class=\"token function\">startActivity</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> from outside of an Activity  context requires the FLAG_ACTIVITY_NEW_TASK flag<span class=\"token punctuation\">.</span> Is <span class=\"token keyword\">this</span> really what you want<span class=\"token operator\">?</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>Context中有一个startActivity方法，Activity继承自Context，覆写了startActivity方法。<br>如果使用Activity的startActivity方法，不会有任何问题，而如果使用Context的startActivity方法，<br>就必须新建一个Activity栈，遇到上面的异常，是因为使用了Context的startActivity方法。</p>\n<p>解决的办法是：为intent设置一个flag，即</p>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\">intent<span class=\"token punctuation\">.</span><span class=\"token function\">setFlags</span><span class=\"token punctuation\">(</span>Intent<span class=\"token punctuation\">.</span>FLAG_ACTIVITY_NEW_TASK<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>这样就可以在新的Activity栈里启动这个Activity了。</p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"Android中intent-setFlags方法中参数值的含义\"><a href=\"#Android中intent-setFlags方法中参数值的含义\" class=\"headerlink\" title=\"Android中intent.setFlags方法中参数值的含义\"></a>Android中intent.setFlags方法中参数值的含义</h4><h5 id=\"一、FLAG-ACTIVITY-NEW-TASK\"><a href=\"#一、FLAG-ACTIVITY-NEW-TASK\" class=\"headerlink\" title=\"一、FLAG_ACTIVITY_NEW_TASK:\"></a>一、FLAG_ACTIVITY_NEW_TASK:</h5><p>例如现在栈一的情况是：A    B   C(C位于栈顶)，C通过intent跳转到D，并且这个Intent添加了FLAG_ACTIVITY_NEW_TASK标记，<br>如果D这个Activity在Manifest.xml中声明了添加Task affinity，系统首先会查找有没有和D的Task affinity相同的task栈存在，<br>如果存在，就将D压入那个栈，如果不存在则会新建一个D的affinity的栈将其压入。如果D的Task affinity默认没有设置，则会将其压入栈1，变成A B C D，<br>这样就和不加FLAG_ACTIVITY_NEW_TASK标记效果是一样的了。但如果试图从非Activity的非正常途径启动一个activity，<br>比如从一个service、BroadcastReceiver等中启动一个Activity，则intent要设置Intent.FLAG_ACTIVITY_NEW_TASK标记。<br>Activity要存在于Activity栈中，而非Activity的途径启动Activity时必然不存在一个Activity的栈，<br>所以要新建一个Activity栈来存放要启动的Activity。</p>\n<h5 id=\"二、FLAG-ACTIVITY-CLEAR-TOP\"><a href=\"#二、FLAG-ACTIVITY-CLEAR-TOP\" class=\"headerlink\" title=\"二、FLAG_ACTIVITY_CLEAR_TOP:\"></a>二、FLAG_ACTIVITY_CLEAR_TOP:</h5><p>例如现在的栈情况为A B C D, D此时通过intent跳转到B，如果这个intent设置FLAG_ACTIVITY_CLEAR_TOP标记，则栈情况变为:A B。如果没有添加这个标记，则栈的情况将会变为：A B C D B 。<br>也就是说，如果设置了FLAG_ACTIVITY_CLEAR_TOP标记，并且目标Activity在栈中已存在，<br>则会把位于该目标Activity之上的Activity从栈中弹出销毁。</p>\n<h5 id=\"三、FLAG-ACTIVITY-NO-HISTORY\"><a href=\"#三、FLAG-ACTIVITY-NO-HISTORY\" class=\"headerlink\" title=\"三、FLAG_ACTIVITY_NO_HISTORY:\"></a>三、FLAG_ACTIVITY_NO_HISTORY:</h5><p>例如现在栈的情况为：A B C 。C通过intent跳转到D，这个intent添加FLAG_ACTIVITY_NO_HISTORY标志，此时界面显示D的内容，但是它并不会压入栈中。<br>如果按返回键，返回到C，栈的情况是：A  B  C。如果D中又跳转到E，栈的情况为：A B C E,此时按返回键会回到C，因为D根本就没有被压入栈中。</p>\n<h5 id=\"四、FLAG-ACTIVITY-SINGLE-TOP\"><a href=\"#四、FLAG-ACTIVITY-SINGLE-TOP\" class=\"headerlink\" title=\"四、FLAG_ACTIVITY_SINGLE_TOP:\"></a>四、FLAG_ACTIVITY_SINGLE_TOP:</h5><p>和Activity的Launch mode的singleTop类似。如果某个intent设置了这个标志，并且这个intent的目标Activity就是栈顶的Activity，那么将不会新建一个实例压入栈中。<br>简言之，目标Activity已在栈顶则跳转过去，不在栈顶则在栈顶新建Activity。</p>\n<ul>\n<li>如果遇到这种错误</li>\n</ul>\n<pre><code class=\"java\">\nCaused by: android.util.AndroidRuntimeException: Calling startActivity() from outside of an Activity  context requires the FLAG_ACTIVITY_NEW_TASK flag. Is this really what you want?\n</code></pre>\n<p>Context中有一个startActivity方法，Activity继承自Context，覆写了startActivity方法。<br>如果使用Activity的startActivity方法，不会有任何问题，而如果使用Context的startActivity方法，<br>就必须新建一个Activity栈，遇到上面的异常，是因为使用了Context的startActivity方法。</p>\n<p>解决的办法是：为intent设置一个flag，即</p>\n<pre><code class=\"java\">intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</code></pre>\n<p>这样就可以在新的Activity栈里启动这个Activity了。</p>\n"},{"title":"Android 中的单例模式","date":"2021-06-22T07:01:37.000Z","_content":"\n\n### Android 中的单例模式\n\n#### 单例模式的优缺点\n\n1、主要优点:\n\n* 提供了对唯一实例的受控访问。\n* 由于在系统内存中只存在一个对象，因此可以节约系统资源，对于一些需要频繁创建和销毁的对象单例模式无疑可以提高系统的性能。\n* 允许可变数目的实例\n\n2、主要缺点:\n\n* 由于单利模式中没有抽象层，因此单例类的扩展有很大的困难。\n* 单例类的职责过重，在一定程度上违背了“单一职责原则”。\n* 滥用单例将带来一些负面问题，如为了节省资源将数据库连接池对象设计为的单例类，可能会导致共享连接池对象的程序过多而出现连接池溢出；如果实例化的对象长时间不被利用，系统会认为是垃圾而被回收，这将导致对象状态的丢失。\n\n#### Java中的几种单例模式\n\n> 懒汉式、 饿汉式、 DCL双重校验模式、 静态内部类单例模式、 枚举单例、 使用容器实现单例模式\n\n#### 懒汉式(线程不安全)\n\n```java\n\n//懒汉式单例类.在第一次调用的时候实例化自己   \npublic class Singleton {  \n    //私有的构造函数\n    private Singleton() {} \n    //私有的静态变量 \n    private static Singleton single = null;  \n    //暴露的公有静态方法   \n    public static Singleton getInstance() {  \n         if (single == null) {    \n             single = new Singleton();  \n         }    \n        return single;  \n    }  \n}\n\n```\n\n* 如果多个线程同时调用 getInstance 方法，可能存在同时判断 instance 变量是否为空的情况，上面的代码中很容易导致重复创建多个实例，这违背了单例模式的目的。\n* 这种方式创建的缺点是存在线程不安全的问题，解决的办法就是使用synchronized 关键字，便是单例模式的第二种写法了。\n\n#### 懒汉式(线程安全)\n\n```java\n\npublic class Singleton {  \n    //私有的静态变量\n    private static Singleton instance;  \n    //私有的构造方法\n    private Singleton (){};\n    //公有的同步静态方法\n    public static synchronized Singleton getInstance() {  \n    if (instance == null) {  \n        instance = new Singleton();  \n    }  \n    return instance;  \n    }  \n}\n\n```\n\n* 这种单例实现方式的getInstance（）方法中添加了synchronized 关键字，也就是告诉Java（JVM）getInstance是一个同步方法。\n* 同步的意思是当两个并发线程访问同一个类中的这个synchronized同步方法时，一个时间内只能有一个线程得到执行，另一个线程必须等待当前线程执行完才能执行，因此同步方法使得线程安全，保证了单例只有唯一个实例。\n* 缺点也很明显 每次每次调用getInstance（）都进行同步，造成了不必要的同步开销。这种模式一般不建议使用。效率低\n\n#### 饿汉式(天生线程安全)\n\n```java\n\n//饿汉式单例类.在类初始化时，已经自行实例化   \npublic class Singleton {  \n    //static修饰的静态变量在内存中一旦创建，便永久存在\n    private static Singleton instance = new Singleton();  \n    private Singleton (){}  \n    public static Singleton getInstance() {  \n    return instance;  \n    }  \n}\n\n```\n\n* 饿汉式的例子一看就懂，不管三七二十一先创建了对象再说，不同的进程通过 getInstance 获取的都是同一个对象，所以是线程安全的。\n* 缺点: 如果某个类创建过程会消耗很多资源，但程序运行中没有调用过 getInstance 方法，那么就存在资源浪费的情况，如果一个系统存在非常多此类情况那么这个系统可能存在性能上的问题。\n* 所以，我们需要的是一种延迟加载的功能。\n\n#### DCL双重校验模式(推荐使用)\n\n```java\n\npublic class Singleton {  \n    private volatile static Singleton singleton;  //静态变量\n    private Singleton (){}  //私有构造函数\n    public static Singleton getInstance() {  \n      if (singleton == null) {  //第一层校验\n          synchronized (Singleton.class) {  \n          if (singleton == null) {  //第二层校验\n              singleton = new Singleton();  \n          }  \n        }  \n      }  \n    return singleton;  \n    }  \n}\n\n```\n* 这种写法也是用的最多的 增加了效率的同时 也是线程安全的\n\n#### 静态内部类(推荐使用)\n\n```java\n\npublic class Singleton {  \n    private Singleton (){} ;//私有的构造函数\n    public static final Singleton getInstance() {  \n        return SingletonHolder.INSTANCE;  \n    }  \n    //定义的静态内部类\n    private static class SingletonHolder {  \n        private static final Singleton INSTANCE = new Singleton();  //创建实例的地方\n    }  \n}\n\n```\n\n* 这种方法也可以做到延迟加载，但是它又不同于饿汉式。\n* 因为只有调用 getInstance 时，SingletonHolder 才会进行初始化。\n* Android中涉及到图片缓存加载的时候经常会看到一些开源组件有各类 ImageHolder 的代码，原理正是如此。\n\n#### 枚举类型\n\n```java\n\npublic enum Singleton {  //enum枚举类\n    INSTANCE;  \n    public void whateverMethod() {  \n\n    }  \n}\n\n```\n\n* 枚举单例模式最大的优点就是写法简单，枚举在java中与普通的类是一样的，不仅能够有字段，还能够有自己的方法，最重要的是默认枚举实例是线程安全的，并且在任何情况下，它都是一个单例。即使是在反序列化的过程，枚举单例也不会重新生成新的实例。\n\n我们只需要 Singleton.INSTANCE.whateverMethod() 来访问实例的方法，这比调用getInstance()方法简单多了\n\n#### 容器式\n\n```\n\npublic class SingletonManager { \n　　private static Map<String, Object> objMap = new HashMap<String,Object>();//使用HashMap作为缓存容器\n　　private Singleton() { }\n　　public static void registerService(String key, Objectinstance) {\n　　　　if (!objMap.containsKey(key) ) {\n　　　　　　objMap.put(key, instance) ;//第一次是存入Map\n　　　　}\n　　}\n　　public static ObjectgetService(String key) {\n　　　　return objMap.get(key) ;//返回与key相对应的对象\n　　}\n}\n\n```\n\n* 在程序的初始，将多种单例模式注入到一个统一的管理类中，在使用时根据key获取对应类型的对象。\n\n总结 推荐使用 DCL 和 静态内部类的方式\n\n\n\n","source":"_posts/Android-中的单例模式.md","raw":"---\ntitle: Android 中的单例模式\ndate: 2021-06-22 15:01:37\ncategory:\n- Android\ntags:\n- 单例模式\n---\n\n\n### Android 中的单例模式\n\n#### 单例模式的优缺点\n\n1、主要优点:\n\n* 提供了对唯一实例的受控访问。\n* 由于在系统内存中只存在一个对象，因此可以节约系统资源，对于一些需要频繁创建和销毁的对象单例模式无疑可以提高系统的性能。\n* 允许可变数目的实例\n\n2、主要缺点:\n\n* 由于单利模式中没有抽象层，因此单例类的扩展有很大的困难。\n* 单例类的职责过重，在一定程度上违背了“单一职责原则”。\n* 滥用单例将带来一些负面问题，如为了节省资源将数据库连接池对象设计为的单例类，可能会导致共享连接池对象的程序过多而出现连接池溢出；如果实例化的对象长时间不被利用，系统会认为是垃圾而被回收，这将导致对象状态的丢失。\n\n#### Java中的几种单例模式\n\n> 懒汉式、 饿汉式、 DCL双重校验模式、 静态内部类单例模式、 枚举单例、 使用容器实现单例模式\n\n#### 懒汉式(线程不安全)\n\n```java\n\n//懒汉式单例类.在第一次调用的时候实例化自己   \npublic class Singleton {  \n    //私有的构造函数\n    private Singleton() {} \n    //私有的静态变量 \n    private static Singleton single = null;  \n    //暴露的公有静态方法   \n    public static Singleton getInstance() {  \n         if (single == null) {    \n             single = new Singleton();  \n         }    \n        return single;  \n    }  \n}\n\n```\n\n* 如果多个线程同时调用 getInstance 方法，可能存在同时判断 instance 变量是否为空的情况，上面的代码中很容易导致重复创建多个实例，这违背了单例模式的目的。\n* 这种方式创建的缺点是存在线程不安全的问题，解决的办法就是使用synchronized 关键字，便是单例模式的第二种写法了。\n\n#### 懒汉式(线程安全)\n\n```java\n\npublic class Singleton {  \n    //私有的静态变量\n    private static Singleton instance;  \n    //私有的构造方法\n    private Singleton (){};\n    //公有的同步静态方法\n    public static synchronized Singleton getInstance() {  \n    if (instance == null) {  \n        instance = new Singleton();  \n    }  \n    return instance;  \n    }  \n}\n\n```\n\n* 这种单例实现方式的getInstance（）方法中添加了synchronized 关键字，也就是告诉Java（JVM）getInstance是一个同步方法。\n* 同步的意思是当两个并发线程访问同一个类中的这个synchronized同步方法时，一个时间内只能有一个线程得到执行，另一个线程必须等待当前线程执行完才能执行，因此同步方法使得线程安全，保证了单例只有唯一个实例。\n* 缺点也很明显 每次每次调用getInstance（）都进行同步，造成了不必要的同步开销。这种模式一般不建议使用。效率低\n\n#### 饿汉式(天生线程安全)\n\n```java\n\n//饿汉式单例类.在类初始化时，已经自行实例化   \npublic class Singleton {  \n    //static修饰的静态变量在内存中一旦创建，便永久存在\n    private static Singleton instance = new Singleton();  \n    private Singleton (){}  \n    public static Singleton getInstance() {  \n    return instance;  \n    }  \n}\n\n```\n\n* 饿汉式的例子一看就懂，不管三七二十一先创建了对象再说，不同的进程通过 getInstance 获取的都是同一个对象，所以是线程安全的。\n* 缺点: 如果某个类创建过程会消耗很多资源，但程序运行中没有调用过 getInstance 方法，那么就存在资源浪费的情况，如果一个系统存在非常多此类情况那么这个系统可能存在性能上的问题。\n* 所以，我们需要的是一种延迟加载的功能。\n\n#### DCL双重校验模式(推荐使用)\n\n```java\n\npublic class Singleton {  \n    private volatile static Singleton singleton;  //静态变量\n    private Singleton (){}  //私有构造函数\n    public static Singleton getInstance() {  \n      if (singleton == null) {  //第一层校验\n          synchronized (Singleton.class) {  \n          if (singleton == null) {  //第二层校验\n              singleton = new Singleton();  \n          }  \n        }  \n      }  \n    return singleton;  \n    }  \n}\n\n```\n* 这种写法也是用的最多的 增加了效率的同时 也是线程安全的\n\n#### 静态内部类(推荐使用)\n\n```java\n\npublic class Singleton {  \n    private Singleton (){} ;//私有的构造函数\n    public static final Singleton getInstance() {  \n        return SingletonHolder.INSTANCE;  \n    }  \n    //定义的静态内部类\n    private static class SingletonHolder {  \n        private static final Singleton INSTANCE = new Singleton();  //创建实例的地方\n    }  \n}\n\n```\n\n* 这种方法也可以做到延迟加载，但是它又不同于饿汉式。\n* 因为只有调用 getInstance 时，SingletonHolder 才会进行初始化。\n* Android中涉及到图片缓存加载的时候经常会看到一些开源组件有各类 ImageHolder 的代码，原理正是如此。\n\n#### 枚举类型\n\n```java\n\npublic enum Singleton {  //enum枚举类\n    INSTANCE;  \n    public void whateverMethod() {  \n\n    }  \n}\n\n```\n\n* 枚举单例模式最大的优点就是写法简单，枚举在java中与普通的类是一样的，不仅能够有字段，还能够有自己的方法，最重要的是默认枚举实例是线程安全的，并且在任何情况下，它都是一个单例。即使是在反序列化的过程，枚举单例也不会重新生成新的实例。\n\n我们只需要 Singleton.INSTANCE.whateverMethod() 来访问实例的方法，这比调用getInstance()方法简单多了\n\n#### 容器式\n\n```\n\npublic class SingletonManager { \n　　private static Map<String, Object> objMap = new HashMap<String,Object>();//使用HashMap作为缓存容器\n　　private Singleton() { }\n　　public static void registerService(String key, Objectinstance) {\n　　　　if (!objMap.containsKey(key) ) {\n　　　　　　objMap.put(key, instance) ;//第一次是存入Map\n　　　　}\n　　}\n　　public static ObjectgetService(String key) {\n　　　　return objMap.get(key) ;//返回与key相对应的对象\n　　}\n}\n\n```\n\n* 在程序的初始，将多种单例模式注入到一个统一的管理类中，在使用时根据key获取对应类型的对象。\n\n总结 推荐使用 DCL 和 静态内部类的方式\n\n\n\n","slug":"Android-中的单例模式","published":1,"updated":"2021-06-22T08:00:49.914Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmw5000b3ys26jyt7yf8","content":"<h3 id=\"Android-中的单例模式\"><a href=\"#Android-中的单例模式\" class=\"headerlink\" title=\"Android 中的单例模式\"></a>Android 中的单例模式</h3><h4 id=\"单例模式的优缺点\"><a href=\"#单例模式的优缺点\" class=\"headerlink\" title=\"单例模式的优缺点\"></a>单例模式的优缺点</h4><p>1、主要优点:</p>\n<ul>\n<li>提供了对唯一实例的受控访问。</li>\n<li>由于在系统内存中只存在一个对象，因此可以节约系统资源，对于一些需要频繁创建和销毁的对象单例模式无疑可以提高系统的性能。</li>\n<li>允许可变数目的实例</li>\n</ul>\n<p>2、主要缺点:</p>\n<ul>\n<li>由于单利模式中没有抽象层，因此单例类的扩展有很大的困难。</li>\n<li>单例类的职责过重，在一定程度上违背了“单一职责原则”。</li>\n<li>滥用单例将带来一些负面问题，如为了节省资源将数据库连接池对象设计为的单例类，可能会导致共享连接池对象的程序过多而出现连接池溢出；如果实例化的对象长时间不被利用，系统会认为是垃圾而被回收，这将导致对象状态的丢失。</li>\n</ul>\n<h4 id=\"Java中的几种单例模式\"><a href=\"#Java中的几种单例模式\" class=\"headerlink\" title=\"Java中的几种单例模式\"></a>Java中的几种单例模式</h4><blockquote>\n<p>懒汉式、 饿汉式、 DCL双重校验模式、 静态内部类单例模式、 枚举单例、 使用容器实现单例模式</p>\n</blockquote>\n<h4 id=\"懒汉式-线程不安全\"><a href=\"#懒汉式-线程不安全\" class=\"headerlink\" title=\"懒汉式(线程不安全)\"></a>懒汉式(线程不安全)</h4><pre class=\"line-numbers language-java\"><code class=\"language-java\">\n<span class=\"token comment\" spellcheck=\"true\">//懒汉式单例类.在第一次调用的时候实例化自己   </span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Singleton</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token comment\" spellcheck=\"true\">//私有的构造函数</span>\n    <span class=\"token keyword\">private</span> <span class=\"token function\">Singleton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span> \n    <span class=\"token comment\" spellcheck=\"true\">//私有的静态变量 </span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> Singleton single <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>  \n    <span class=\"token comment\" spellcheck=\"true\">//暴露的公有静态方法   </span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> Singleton <span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>single <span class=\"token operator\">==</span> null<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>    \n             single <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Singleton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n         <span class=\"token punctuation\">}</span>    \n        <span class=\"token keyword\">return</span> single<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<ul>\n<li>如果多个线程同时调用 getInstance 方法，可能存在同时判断 instance 变量是否为空的情况，上面的代码中很容易导致重复创建多个实例，这违背了单例模式的目的。</li>\n<li>这种方式创建的缺点是存在线程不安全的问题，解决的办法就是使用synchronized 关键字，便是单例模式的第二种写法了。</li>\n</ul>\n<h4 id=\"懒汉式-线程安全\"><a href=\"#懒汉式-线程安全\" class=\"headerlink\" title=\"懒汉式(线程安全)\"></a>懒汉式(线程安全)</h4><pre class=\"line-numbers language-java\"><code class=\"language-java\">\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Singleton</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token comment\" spellcheck=\"true\">//私有的静态变量</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> Singleton instance<span class=\"token punctuation\">;</span>  \n    <span class=\"token comment\" spellcheck=\"true\">//私有的构造方法</span>\n    <span class=\"token keyword\">private</span> <span class=\"token function\">Singleton</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">//公有的同步静态方法</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">synchronized</span> Singleton <span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>instance <span class=\"token operator\">==</span> null<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        instance <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Singleton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n    <span class=\"token keyword\">return</span> instance<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<ul>\n<li>这种单例实现方式的getInstance（）方法中添加了synchronized 关键字，也就是告诉Java（JVM）getInstance是一个同步方法。</li>\n<li>同步的意思是当两个并发线程访问同一个类中的这个synchronized同步方法时，一个时间内只能有一个线程得到执行，另一个线程必须等待当前线程执行完才能执行，因此同步方法使得线程安全，保证了单例只有唯一个实例。</li>\n<li>缺点也很明显 每次每次调用getInstance（）都进行同步，造成了不必要的同步开销。这种模式一般不建议使用。效率低</li>\n</ul>\n<h4 id=\"饿汉式-天生线程安全\"><a href=\"#饿汉式-天生线程安全\" class=\"headerlink\" title=\"饿汉式(天生线程安全)\"></a>饿汉式(天生线程安全)</h4><pre class=\"line-numbers language-java\"><code class=\"language-java\">\n<span class=\"token comment\" spellcheck=\"true\">//饿汉式单例类.在类初始化时，已经自行实例化   </span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Singleton</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token comment\" spellcheck=\"true\">//static修饰的静态变量在内存中一旦创建，便永久存在</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> Singleton instance <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Singleton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token function\">Singleton</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> Singleton <span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token keyword\">return</span> instance<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<ul>\n<li>饿汉式的例子一看就懂，不管三七二十一先创建了对象再说，不同的进程通过 getInstance 获取的都是同一个对象，所以是线程安全的。</li>\n<li>缺点: 如果某个类创建过程会消耗很多资源，但程序运行中没有调用过 getInstance 方法，那么就存在资源浪费的情况，如果一个系统存在非常多此类情况那么这个系统可能存在性能上的问题。</li>\n<li>所以，我们需要的是一种延迟加载的功能。</li>\n</ul>\n<h4 id=\"DCL双重校验模式-推荐使用\"><a href=\"#DCL双重校验模式-推荐使用\" class=\"headerlink\" title=\"DCL双重校验模式(推荐使用)\"></a>DCL双重校验模式(推荐使用)</h4><pre class=\"line-numbers language-java\"><code class=\"language-java\">\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Singleton</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">volatile</span> <span class=\"token keyword\">static</span> Singleton singleton<span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">//静态变量</span>\n    <span class=\"token keyword\">private</span> <span class=\"token function\">Singleton</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>  <span class=\"token comment\" spellcheck=\"true\">//私有构造函数</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> Singleton <span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>singleton <span class=\"token operator\">==</span> null<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  <span class=\"token comment\" spellcheck=\"true\">//第一层校验</span>\n          <span class=\"token keyword\">synchronized</span> <span class=\"token punctuation\">(</span>Singleton<span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>singleton <span class=\"token operator\">==</span> null<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  <span class=\"token comment\" spellcheck=\"true\">//第二层校验</span>\n              singleton <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Singleton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n          <span class=\"token punctuation\">}</span>  \n        <span class=\"token punctuation\">}</span>  \n      <span class=\"token punctuation\">}</span>  \n    <span class=\"token keyword\">return</span> singleton<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<ul>\n<li>这种写法也是用的最多的 增加了效率的同时 也是线程安全的</li>\n</ul>\n<h4 id=\"静态内部类-推荐使用\"><a href=\"#静态内部类-推荐使用\" class=\"headerlink\" title=\"静态内部类(推荐使用)\"></a>静态内部类(推荐使用)</h4><pre class=\"line-numbers language-java\"><code class=\"language-java\">\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Singleton</span> <span class=\"token punctuation\">{</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token function\">Singleton</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">;</span><span class=\"token comment\" spellcheck=\"true\">//私有的构造函数</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> Singleton <span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">return</span> SingletonHolder<span class=\"token punctuation\">.</span>INSTANCE<span class=\"token punctuation\">;</span>  \n    <span class=\"token punctuation\">}</span>  \n    <span class=\"token comment\" spellcheck=\"true\">//定义的静态内部类</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SingletonHolder</span> <span class=\"token punctuation\">{</span>  \n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> Singleton INSTANCE <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Singleton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">//创建实例的地方</span>\n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<ul>\n<li>这种方法也可以做到延迟加载，但是它又不同于饿汉式。</li>\n<li>因为只有调用 getInstance 时，SingletonHolder 才会进行初始化。</li>\n<li>Android中涉及到图片缓存加载的时候经常会看到一些开源组件有各类 ImageHolder 的代码，原理正是如此。</li>\n</ul>\n<h4 id=\"枚举类型\"><a href=\"#枚举类型\" class=\"headerlink\" title=\"枚举类型\"></a>枚举类型</h4><pre class=\"line-numbers language-java\"><code class=\"language-java\">\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">enum</span> Singleton <span class=\"token punctuation\">{</span>  <span class=\"token comment\" spellcheck=\"true\">//enum枚举类</span>\n    INSTANCE<span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">whateverMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n\n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<ul>\n<li>枚举单例模式最大的优点就是写法简单，枚举在java中与普通的类是一样的，不仅能够有字段，还能够有自己的方法，最重要的是默认枚举实例是线程安全的，并且在任何情况下，它都是一个单例。即使是在反序列化的过程，枚举单例也不会重新生成新的实例。</li>\n</ul>\n<p>我们只需要 Singleton.INSTANCE.whateverMethod() 来访问实例的方法，这比调用getInstance()方法简单多了</p>\n<h4 id=\"容器式\"><a href=\"#容器式\" class=\"headerlink\" title=\"容器式\"></a>容器式</h4><pre><code>\npublic class SingletonManager { \n　　private static Map&lt;String, Object&gt; objMap = new HashMap&lt;String,Object&gt;();//使用HashMap作为缓存容器\n　　private Singleton() { }\n　　public static void registerService(String key, Objectinstance) {\n　　　　if (!objMap.containsKey(key) ) {\n　　　　　　objMap.put(key, instance) ;//第一次是存入Map\n　　　　}\n　　}\n　　public static ObjectgetService(String key) {\n　　　　return objMap.get(key) ;//返回与key相对应的对象\n　　}\n}\n</code></pre>\n<ul>\n<li>在程序的初始，将多种单例模式注入到一个统一的管理类中，在使用时根据key获取对应类型的对象。</li>\n</ul>\n<p>总结 推荐使用 DCL 和 静态内部类的方式</p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"Android-中的单例模式\"><a href=\"#Android-中的单例模式\" class=\"headerlink\" title=\"Android 中的单例模式\"></a>Android 中的单例模式</h3><h4 id=\"单例模式的优缺点\"><a href=\"#单例模式的优缺点\" class=\"headerlink\" title=\"单例模式的优缺点\"></a>单例模式的优缺点</h4><p>1、主要优点:</p>\n<ul>\n<li>提供了对唯一实例的受控访问。</li>\n<li>由于在系统内存中只存在一个对象，因此可以节约系统资源，对于一些需要频繁创建和销毁的对象单例模式无疑可以提高系统的性能。</li>\n<li>允许可变数目的实例</li>\n</ul>\n<p>2、主要缺点:</p>\n<ul>\n<li>由于单利模式中没有抽象层，因此单例类的扩展有很大的困难。</li>\n<li>单例类的职责过重，在一定程度上违背了“单一职责原则”。</li>\n<li>滥用单例将带来一些负面问题，如为了节省资源将数据库连接池对象设计为的单例类，可能会导致共享连接池对象的程序过多而出现连接池溢出；如果实例化的对象长时间不被利用，系统会认为是垃圾而被回收，这将导致对象状态的丢失。</li>\n</ul>\n<h4 id=\"Java中的几种单例模式\"><a href=\"#Java中的几种单例模式\" class=\"headerlink\" title=\"Java中的几种单例模式\"></a>Java中的几种单例模式</h4><blockquote>\n<p>懒汉式、 饿汉式、 DCL双重校验模式、 静态内部类单例模式、 枚举单例、 使用容器实现单例模式</p>\n</blockquote>\n<h4 id=\"懒汉式-线程不安全\"><a href=\"#懒汉式-线程不安全\" class=\"headerlink\" title=\"懒汉式(线程不安全)\"></a>懒汉式(线程不安全)</h4><pre><code class=\"java\">\n//懒汉式单例类.在第一次调用的时候实例化自己   \npublic class Singleton &#123;  \n    //私有的构造函数\n    private Singleton() &#123;&#125; \n    //私有的静态变量 \n    private static Singleton single = null;  \n    //暴露的公有静态方法   \n    public static Singleton getInstance() &#123;  \n         if (single == null) &#123;    \n             single = new Singleton();  \n         &#125;    \n        return single;  \n    &#125;  \n&#125;\n</code></pre>\n<ul>\n<li>如果多个线程同时调用 getInstance 方法，可能存在同时判断 instance 变量是否为空的情况，上面的代码中很容易导致重复创建多个实例，这违背了单例模式的目的。</li>\n<li>这种方式创建的缺点是存在线程不安全的问题，解决的办法就是使用synchronized 关键字，便是单例模式的第二种写法了。</li>\n</ul>\n<h4 id=\"懒汉式-线程安全\"><a href=\"#懒汉式-线程安全\" class=\"headerlink\" title=\"懒汉式(线程安全)\"></a>懒汉式(线程安全)</h4><pre><code class=\"java\">\npublic class Singleton &#123;  \n    //私有的静态变量\n    private static Singleton instance;  \n    //私有的构造方法\n    private Singleton ()&#123;&#125;;\n    //公有的同步静态方法\n    public static synchronized Singleton getInstance() &#123;  \n    if (instance == null) &#123;  \n        instance = new Singleton();  \n    &#125;  \n    return instance;  \n    &#125;  \n&#125;\n</code></pre>\n<ul>\n<li>这种单例实现方式的getInstance（）方法中添加了synchronized 关键字，也就是告诉Java（JVM）getInstance是一个同步方法。</li>\n<li>同步的意思是当两个并发线程访问同一个类中的这个synchronized同步方法时，一个时间内只能有一个线程得到执行，另一个线程必须等待当前线程执行完才能执行，因此同步方法使得线程安全，保证了单例只有唯一个实例。</li>\n<li>缺点也很明显 每次每次调用getInstance（）都进行同步，造成了不必要的同步开销。这种模式一般不建议使用。效率低</li>\n</ul>\n<h4 id=\"饿汉式-天生线程安全\"><a href=\"#饿汉式-天生线程安全\" class=\"headerlink\" title=\"饿汉式(天生线程安全)\"></a>饿汉式(天生线程安全)</h4><pre><code class=\"java\">\n//饿汉式单例类.在类初始化时，已经自行实例化   \npublic class Singleton &#123;  \n    //static修饰的静态变量在内存中一旦创建，便永久存在\n    private static Singleton instance = new Singleton();  \n    private Singleton ()&#123;&#125;  \n    public static Singleton getInstance() &#123;  \n    return instance;  \n    &#125;  \n&#125;\n</code></pre>\n<ul>\n<li>饿汉式的例子一看就懂，不管三七二十一先创建了对象再说，不同的进程通过 getInstance 获取的都是同一个对象，所以是线程安全的。</li>\n<li>缺点: 如果某个类创建过程会消耗很多资源，但程序运行中没有调用过 getInstance 方法，那么就存在资源浪费的情况，如果一个系统存在非常多此类情况那么这个系统可能存在性能上的问题。</li>\n<li>所以，我们需要的是一种延迟加载的功能。</li>\n</ul>\n<h4 id=\"DCL双重校验模式-推荐使用\"><a href=\"#DCL双重校验模式-推荐使用\" class=\"headerlink\" title=\"DCL双重校验模式(推荐使用)\"></a>DCL双重校验模式(推荐使用)</h4><pre><code class=\"java\">\npublic class Singleton &#123;  \n    private volatile static Singleton singleton;  //静态变量\n    private Singleton ()&#123;&#125;  //私有构造函数\n    public static Singleton getInstance() &#123;  \n      if (singleton == null) &#123;  //第一层校验\n          synchronized (Singleton.class) &#123;  \n          if (singleton == null) &#123;  //第二层校验\n              singleton = new Singleton();  \n          &#125;  \n        &#125;  \n      &#125;  \n    return singleton;  \n    &#125;  \n&#125;\n</code></pre>\n<ul>\n<li>这种写法也是用的最多的 增加了效率的同时 也是线程安全的</li>\n</ul>\n<h4 id=\"静态内部类-推荐使用\"><a href=\"#静态内部类-推荐使用\" class=\"headerlink\" title=\"静态内部类(推荐使用)\"></a>静态内部类(推荐使用)</h4><pre><code class=\"java\">\npublic class Singleton &#123;  \n    private Singleton ()&#123;&#125; ;//私有的构造函数\n    public static final Singleton getInstance() &#123;  \n        return SingletonHolder.INSTANCE;  \n    &#125;  \n    //定义的静态内部类\n    private static class SingletonHolder &#123;  \n        private static final Singleton INSTANCE = new Singleton();  //创建实例的地方\n    &#125;  \n&#125;\n</code></pre>\n<ul>\n<li>这种方法也可以做到延迟加载，但是它又不同于饿汉式。</li>\n<li>因为只有调用 getInstance 时，SingletonHolder 才会进行初始化。</li>\n<li>Android中涉及到图片缓存加载的时候经常会看到一些开源组件有各类 ImageHolder 的代码，原理正是如此。</li>\n</ul>\n<h4 id=\"枚举类型\"><a href=\"#枚举类型\" class=\"headerlink\" title=\"枚举类型\"></a>枚举类型</h4><pre><code class=\"java\">\npublic enum Singleton &#123;  //enum枚举类\n    INSTANCE;  \n    public void whateverMethod() &#123;  \n\n    &#125;  \n&#125;\n</code></pre>\n<ul>\n<li>枚举单例模式最大的优点就是写法简单，枚举在java中与普通的类是一样的，不仅能够有字段，还能够有自己的方法，最重要的是默认枚举实例是线程安全的，并且在任何情况下，它都是一个单例。即使是在反序列化的过程，枚举单例也不会重新生成新的实例。</li>\n</ul>\n<p>我们只需要 Singleton.INSTANCE.whateverMethod() 来访问实例的方法，这比调用getInstance()方法简单多了</p>\n<h4 id=\"容器式\"><a href=\"#容器式\" class=\"headerlink\" title=\"容器式\"></a>容器式</h4><pre><code>\npublic class SingletonManager &#123; \n　　private static Map&lt;String, Object&gt; objMap = new HashMap&lt;String,Object&gt;();//使用HashMap作为缓存容器\n　　private Singleton() &#123; &#125;\n　　public static void registerService(String key, Objectinstance) &#123;\n　　　　if (!objMap.containsKey(key) ) &#123;\n　　　　　　objMap.put(key, instance) ;//第一次是存入Map\n　　　　&#125;\n　　&#125;\n　　public static ObjectgetService(String key) &#123;\n　　　　return objMap.get(key) ;//返回与key相对应的对象\n　　&#125;\n&#125;\n</code></pre>\n<ul>\n<li>在程序的初始，将多种单例模式注入到一个统一的管理类中，在使用时根据key获取对应类型的对象。</li>\n</ul>\n<p>总结 推荐使用 DCL 和 静态内部类的方式</p>\n"},{"title":"Android-如何监听前后台","date":"2020-10-21T08:32:40.000Z","_content":"\n#### Android-如何监听前后台\n\n简单讲讲android如何判断应用切换到后台和应用切换到前台。这个其实很简单，之前需要做一个功能，当app由后台进入前台时需要完成一些逻辑操作，所以在网上查找如何判断app由后台进入前台，最终是解决了问题。这里记录一下。\n\n##### 一、使用ActivityLifecycleCallbacks简单app进入后台\n\n有时需要监听到应用在前后台切换并做些处理，一般的做法可能是建立一个BaseActivity，然后全部的Activity都继承它，在BaseActivity的onStart和onStop中计数去处理。这样并不是最好的方式，不做详细介绍，有更好的方式，道理其实差不多，就是借助ActivityLifecycleCallbacks来实现。\n\n1、 写了一个帮助类\n\n``` java\npackage com.cadae.helpers;\n\nimport android.app.Activity;\nimport android.app.Application;\nimport android.os.Bundle;\n\npublic class AppFrontBackHelper {\n  private OnAppStatusListener mOnAppStatusListener;\n\n\n  public AppFrontBackHelper() {\n\n  }\n\n  /**\n   * 注册状态监听，仅在Application中使用\n   * @param application\n   * @param listener\n   */\n  public void register(Application application, OnAppStatusListener listener){\n    mOnAppStatusListener = listener;\n    application.registerActivityLifecycleCallbacks(activityLifecycleCallbacks);\n  }\n\n  public void unRegister(Application application){\n    application.unregisterActivityLifecycleCallbacks(activityLifecycleCallbacks);\n  }\n\n  private Application.ActivityLifecycleCallbacks activityLifecycleCallbacks = new Application.ActivityLifecycleCallbacks() {\n    //打开的Activity数量统计\n    private int activityStartCount = 0;\n\n    @Override\n    public void onActivityCreated(Activity activity, Bundle savedInstanceState) {\n\n    }\n\n    @Override\n    public void onActivityStarted(Activity activity) {\n      activityStartCount++;\n      //数值从0变到1说明是从后台切到前台\n      if (activityStartCount == 1){\n        //从后台切到前台\n        if(mOnAppStatusListener != null){\n          mOnAppStatusListener.onFront();\n        }\n      }\n    }\n\n    @Override\n    public void onActivityResumed(Activity activity) {\n\n    }\n\n    @Override\n    public void onActivityPaused(Activity activity) {\n\n    }\n\n    @Override\n    public void onActivityStopped(Activity activity) {\n      activityStartCount--;\n      //数值从1到0说明是从前台切到后台\n      if (activityStartCount == 0){\n        //从前台切到后台\n        if(mOnAppStatusListener != null){\n          mOnAppStatusListener.onBack();\n        }\n      }\n    }\n\n    @Override\n    public void onActivitySaveInstanceState(Activity activity, Bundle outState) {\n\n    }\n\n    @Override\n    public void onActivityDestroyed(Activity activity) {\n\n    }\n  };\n\n  public interface OnAppStatusListener{\n    void onFront();\n    void onBack();\n  }\n}\n\n```\n\n##### 二、Application中使用（注意：仅在Application中才能使用，因为Application的生命周期能监听到每个Activity）\n\n``` java\npublic class MyApp extends Application {\n    \n    @Override\n    public void onCreate() {\n        super.onCreate();\n \n        AppFrontBackHelper helper = new AppFrontBackHelper();\n        helper.register(MyApp.this, new AppFrontBackHelper.OnAppStatusListener() {\n            @Override\n            public void onFront() {\n                //应用切到前台处理\n \n            }\n \n            @Override\n            public void onBack() {\n                //应用切到后台处理\n \n            }\n        });\n    }\n \n}\n```\n\n这里在后台我们就可以去做一些事情比如开始一个计时任务 超时时退出登录\n\n``` java\npublic class MyApp extends Application {\n\n    private Timer mTimer; // 计时器，每1秒执行一次任务\n    private MyTimerTask mTimerTask; // 计时任务，判断是否未操作时间到达ns\n    private long mLastActionTime; // 上一次操作时间\n\n    @Override\n    public void onCreate() {\n        super.onCreate();\n \n        AppFrontBackHelper helper = new AppFrontBackHelper();\n        helper.register(MyApp.this, new AppFrontBackHelper.OnAppStatusListener() {\n            @Override\n            public void onFront() {\n                //应用切到前台处理\n                Log.i(\"TAG\", \"在前台\");\n                mLastActionTime = System.currentTimeMillis();\n                if (mTimer != null){\n                     mTimer.cancel();\n                 }\n            }\n \n            @Override\n            public void onBack() {\n                //应用切到后台处理\n                Log.i(\"TAG\", \"在后台\");\n                if (SharedPrefsHelper.isLogin()) {\n                  startTimer();\n                }\n            }\n        });\n    }\n\n  // 登录成功，开始计时\n  private void startTimer() {\n    if (mTimer != null){\n      mTimer.cancel();\n    }\n    mTimer = new Timer();\n    mTimerTask = new MyTimerTask();\n    // 初始化上次操作时间为登录成功的时间\n    mLastActionTime = System.currentTimeMillis();\n    // 每过1s检查一次\n    mTimer.schedule(mTimerTask, 0, 1000);\n    Log.i(\"TAG\", \"开始计时了。。。。。。。。。\");\n  }\n\n  private class MyTimerTask extends TimerTask {\n\n    @Override\n    public void run() {\n      Log.i(\"TAG\", \"计时中……\");\n      // 一小时未操作停止计时并退出登录\n      if (System.currentTimeMillis() - mLastActionTime > 1000 * 3600) {\n        stopTimer();// 停止计时任务\n        LogOutAuto();//退出登录状态\n      }\n    }\n  }\n\n  // 停止计时任务\n  public void stopTimer() {\n    mTimer.cancel();\n    // 计时任务是否完成 赋值\n    SharedPrefsHelper.setBoolean(Constants.IS_TIMER_TASK_FINISHED,true);\n    // 用户按下后退键 初始化值\n    SharedPrefsHelper.setBoolean(Constants.USER_PRESSED_BACK,false);\n    Log.i(\"TAG\",\"结束了\");\n    Log.e(\"TAG\", \"取消计时\");\n  }\n \n}\n```\n","source":"_posts/Android-如何监听前后台.md","raw":"---\ntitle: Android-如何监听前后台\ndate: 2020-10-21 16:32:40\ncategories:\n- Android\ntags:\n- Android\n---\n\n#### Android-如何监听前后台\n\n简单讲讲android如何判断应用切换到后台和应用切换到前台。这个其实很简单，之前需要做一个功能，当app由后台进入前台时需要完成一些逻辑操作，所以在网上查找如何判断app由后台进入前台，最终是解决了问题。这里记录一下。\n\n##### 一、使用ActivityLifecycleCallbacks简单app进入后台\n\n有时需要监听到应用在前后台切换并做些处理，一般的做法可能是建立一个BaseActivity，然后全部的Activity都继承它，在BaseActivity的onStart和onStop中计数去处理。这样并不是最好的方式，不做详细介绍，有更好的方式，道理其实差不多，就是借助ActivityLifecycleCallbacks来实现。\n\n1、 写了一个帮助类\n\n``` java\npackage com.cadae.helpers;\n\nimport android.app.Activity;\nimport android.app.Application;\nimport android.os.Bundle;\n\npublic class AppFrontBackHelper {\n  private OnAppStatusListener mOnAppStatusListener;\n\n\n  public AppFrontBackHelper() {\n\n  }\n\n  /**\n   * 注册状态监听，仅在Application中使用\n   * @param application\n   * @param listener\n   */\n  public void register(Application application, OnAppStatusListener listener){\n    mOnAppStatusListener = listener;\n    application.registerActivityLifecycleCallbacks(activityLifecycleCallbacks);\n  }\n\n  public void unRegister(Application application){\n    application.unregisterActivityLifecycleCallbacks(activityLifecycleCallbacks);\n  }\n\n  private Application.ActivityLifecycleCallbacks activityLifecycleCallbacks = new Application.ActivityLifecycleCallbacks() {\n    //打开的Activity数量统计\n    private int activityStartCount = 0;\n\n    @Override\n    public void onActivityCreated(Activity activity, Bundle savedInstanceState) {\n\n    }\n\n    @Override\n    public void onActivityStarted(Activity activity) {\n      activityStartCount++;\n      //数值从0变到1说明是从后台切到前台\n      if (activityStartCount == 1){\n        //从后台切到前台\n        if(mOnAppStatusListener != null){\n          mOnAppStatusListener.onFront();\n        }\n      }\n    }\n\n    @Override\n    public void onActivityResumed(Activity activity) {\n\n    }\n\n    @Override\n    public void onActivityPaused(Activity activity) {\n\n    }\n\n    @Override\n    public void onActivityStopped(Activity activity) {\n      activityStartCount--;\n      //数值从1到0说明是从前台切到后台\n      if (activityStartCount == 0){\n        //从前台切到后台\n        if(mOnAppStatusListener != null){\n          mOnAppStatusListener.onBack();\n        }\n      }\n    }\n\n    @Override\n    public void onActivitySaveInstanceState(Activity activity, Bundle outState) {\n\n    }\n\n    @Override\n    public void onActivityDestroyed(Activity activity) {\n\n    }\n  };\n\n  public interface OnAppStatusListener{\n    void onFront();\n    void onBack();\n  }\n}\n\n```\n\n##### 二、Application中使用（注意：仅在Application中才能使用，因为Application的生命周期能监听到每个Activity）\n\n``` java\npublic class MyApp extends Application {\n    \n    @Override\n    public void onCreate() {\n        super.onCreate();\n \n        AppFrontBackHelper helper = new AppFrontBackHelper();\n        helper.register(MyApp.this, new AppFrontBackHelper.OnAppStatusListener() {\n            @Override\n            public void onFront() {\n                //应用切到前台处理\n \n            }\n \n            @Override\n            public void onBack() {\n                //应用切到后台处理\n \n            }\n        });\n    }\n \n}\n```\n\n这里在后台我们就可以去做一些事情比如开始一个计时任务 超时时退出登录\n\n``` java\npublic class MyApp extends Application {\n\n    private Timer mTimer; // 计时器，每1秒执行一次任务\n    private MyTimerTask mTimerTask; // 计时任务，判断是否未操作时间到达ns\n    private long mLastActionTime; // 上一次操作时间\n\n    @Override\n    public void onCreate() {\n        super.onCreate();\n \n        AppFrontBackHelper helper = new AppFrontBackHelper();\n        helper.register(MyApp.this, new AppFrontBackHelper.OnAppStatusListener() {\n            @Override\n            public void onFront() {\n                //应用切到前台处理\n                Log.i(\"TAG\", \"在前台\");\n                mLastActionTime = System.currentTimeMillis();\n                if (mTimer != null){\n                     mTimer.cancel();\n                 }\n            }\n \n            @Override\n            public void onBack() {\n                //应用切到后台处理\n                Log.i(\"TAG\", \"在后台\");\n                if (SharedPrefsHelper.isLogin()) {\n                  startTimer();\n                }\n            }\n        });\n    }\n\n  // 登录成功，开始计时\n  private void startTimer() {\n    if (mTimer != null){\n      mTimer.cancel();\n    }\n    mTimer = new Timer();\n    mTimerTask = new MyTimerTask();\n    // 初始化上次操作时间为登录成功的时间\n    mLastActionTime = System.currentTimeMillis();\n    // 每过1s检查一次\n    mTimer.schedule(mTimerTask, 0, 1000);\n    Log.i(\"TAG\", \"开始计时了。。。。。。。。。\");\n  }\n\n  private class MyTimerTask extends TimerTask {\n\n    @Override\n    public void run() {\n      Log.i(\"TAG\", \"计时中……\");\n      // 一小时未操作停止计时并退出登录\n      if (System.currentTimeMillis() - mLastActionTime > 1000 * 3600) {\n        stopTimer();// 停止计时任务\n        LogOutAuto();//退出登录状态\n      }\n    }\n  }\n\n  // 停止计时任务\n  public void stopTimer() {\n    mTimer.cancel();\n    // 计时任务是否完成 赋值\n    SharedPrefsHelper.setBoolean(Constants.IS_TIMER_TASK_FINISHED,true);\n    // 用户按下后退键 初始化值\n    SharedPrefsHelper.setBoolean(Constants.USER_PRESSED_BACK,false);\n    Log.i(\"TAG\",\"结束了\");\n    Log.e(\"TAG\", \"取消计时\");\n  }\n \n}\n```\n","slug":"Android-如何监听前后台","published":1,"updated":"2020-10-21T08:58:50.246Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmw7000f3ys250pk94x8","content":"<h4 id=\"Android-如何监听前后台\"><a href=\"#Android-如何监听前后台\" class=\"headerlink\" title=\"Android-如何监听前后台\"></a>Android-如何监听前后台</h4><p>简单讲讲android如何判断应用切换到后台和应用切换到前台。这个其实很简单，之前需要做一个功能，当app由后台进入前台时需要完成一些逻辑操作，所以在网上查找如何判断app由后台进入前台，最终是解决了问题。这里记录一下。</p>\n<h5 id=\"一、使用ActivityLifecycleCallbacks简单app进入后台\"><a href=\"#一、使用ActivityLifecycleCallbacks简单app进入后台\" class=\"headerlink\" title=\"一、使用ActivityLifecycleCallbacks简单app进入后台\"></a>一、使用ActivityLifecycleCallbacks简单app进入后台</h5><p>有时需要监听到应用在前后台切换并做些处理，一般的做法可能是建立一个BaseActivity，然后全部的Activity都继承它，在BaseActivity的onStart和onStop中计数去处理。这样并不是最好的方式，不做详细介绍，有更好的方式，道理其实差不多，就是借助ActivityLifecycleCallbacks来实现。</p>\n<p>1、 写了一个帮助类</p>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> com<span class=\"token punctuation\">.</span>cadae<span class=\"token punctuation\">.</span>helpers<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> android<span class=\"token punctuation\">.</span>app<span class=\"token punctuation\">.</span>Activity<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> android<span class=\"token punctuation\">.</span>app<span class=\"token punctuation\">.</span>Application<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> android<span class=\"token punctuation\">.</span>os<span class=\"token punctuation\">.</span>Bundle<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AppFrontBackHelper</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> OnAppStatusListener mOnAppStatusListener<span class=\"token punctuation\">;</span>\n\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">AppFrontBackHelper</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">/**\n   * 注册状态监听，仅在Application中使用\n   * @param application\n   * @param listener\n   */</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">register</span><span class=\"token punctuation\">(</span>Application application<span class=\"token punctuation\">,</span> OnAppStatusListener listener<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    mOnAppStatusListener <span class=\"token operator\">=</span> listener<span class=\"token punctuation\">;</span>\n    application<span class=\"token punctuation\">.</span><span class=\"token function\">registerActivityLifecycleCallbacks</span><span class=\"token punctuation\">(</span>activityLifecycleCallbacks<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">unRegister</span><span class=\"token punctuation\">(</span>Application application<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    application<span class=\"token punctuation\">.</span><span class=\"token function\">unregisterActivityLifecycleCallbacks</span><span class=\"token punctuation\">(</span>activityLifecycleCallbacks<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> Application<span class=\"token punctuation\">.</span>ActivityLifecycleCallbacks activityLifecycleCallbacks <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Application<span class=\"token punctuation\">.</span>ActivityLifecycleCallbacks</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\" spellcheck=\"true\">//打开的Activity数量统计</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> activityStartCount <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onActivityCreated</span><span class=\"token punctuation\">(</span>Activity activity<span class=\"token punctuation\">,</span> Bundle savedInstanceState<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onActivityStarted</span><span class=\"token punctuation\">(</span>Activity activity<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      activityStartCount<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\" spellcheck=\"true\">//数值从0变到1说明是从后台切到前台</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>activityStartCount <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token comment\" spellcheck=\"true\">//从后台切到前台</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>mOnAppStatusListener <span class=\"token operator\">!=</span> null<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n          mOnAppStatusListener<span class=\"token punctuation\">.</span><span class=\"token function\">onFront</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onActivityResumed</span><span class=\"token punctuation\">(</span>Activity activity<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onActivityPaused</span><span class=\"token punctuation\">(</span>Activity activity<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onActivityStopped</span><span class=\"token punctuation\">(</span>Activity activity<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      activityStartCount<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\" spellcheck=\"true\">//数值从1到0说明是从前台切到后台</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>activityStartCount <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token comment\" spellcheck=\"true\">//从前台切到后台</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>mOnAppStatusListener <span class=\"token operator\">!=</span> null<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n          mOnAppStatusListener<span class=\"token punctuation\">.</span><span class=\"token function\">onBack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onActivitySaveInstanceState</span><span class=\"token punctuation\">(</span>Activity activity<span class=\"token punctuation\">,</span> Bundle outState<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onActivityDestroyed</span><span class=\"token punctuation\">(</span>Activity activity<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">OnAppStatusListener</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">onFront</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">onBack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h5 id=\"二、Application中使用（注意：仅在Application中才能使用，因为Application的生命周期能监听到每个Activity）\"><a href=\"#二、Application中使用（注意：仅在Application中才能使用，因为Application的生命周期能监听到每个Activity）\" class=\"headerlink\" title=\"二、Application中使用（注意：仅在Application中才能使用，因为Application的生命周期能监听到每个Activity）\"></a>二、Application中使用（注意：仅在Application中才能使用，因为Application的生命周期能监听到每个Activity）</h5><pre class=\"line-numbers language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyApp</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Application</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onCreate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onCreate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        AppFrontBackHelper helper <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AppFrontBackHelper</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        helper<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span>MyApp<span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AppFrontBackHelper<span class=\"token punctuation\">.</span>OnAppStatusListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token annotation punctuation\">@Override</span>\n            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onFront</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\" spellcheck=\"true\">//应用切到前台处理</span>\n\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token annotation punctuation\">@Override</span>\n            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onBack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\" spellcheck=\"true\">//应用切到后台处理</span>\n\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>这里在后台我们就可以去做一些事情比如开始一个计时任务 超时时退出登录</p>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyApp</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Application</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> Timer mTimer<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">// 计时器，每1秒执行一次任务</span>\n    <span class=\"token keyword\">private</span> MyTimerTask mTimerTask<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">// 计时任务，判断是否未操作时间到达ns</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">long</span> mLastActionTime<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">// 上一次操作时间</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onCreate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onCreate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        AppFrontBackHelper helper <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AppFrontBackHelper</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        helper<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span>MyApp<span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AppFrontBackHelper<span class=\"token punctuation\">.</span>OnAppStatusListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token annotation punctuation\">@Override</span>\n            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onFront</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\" spellcheck=\"true\">//应用切到前台处理</span>\n                Log<span class=\"token punctuation\">.</span><span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TAG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"在前台\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                mLastActionTime <span class=\"token operator\">=</span> System<span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mTimer <span class=\"token operator\">!=</span> null<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n                     mTimer<span class=\"token punctuation\">.</span><span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                 <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token annotation punctuation\">@Override</span>\n            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onBack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\" spellcheck=\"true\">//应用切到后台处理</span>\n                Log<span class=\"token punctuation\">.</span><span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TAG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"在后台\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>SharedPrefsHelper<span class=\"token punctuation\">.</span><span class=\"token function\">isLogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                  <span class=\"token function\">startTimer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">// 登录成功，开始计时</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">startTimer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mTimer <span class=\"token operator\">!=</span> null<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      mTimer<span class=\"token punctuation\">.</span><span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    mTimer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Timer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mTimerTask <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MyTimerTask</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">// 初始化上次操作时间为登录成功的时间</span>\n    mLastActionTime <span class=\"token operator\">=</span> System<span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">// 每过1s检查一次</span>\n    mTimer<span class=\"token punctuation\">.</span><span class=\"token function\">schedule</span><span class=\"token punctuation\">(</span>mTimerTask<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Log<span class=\"token punctuation\">.</span><span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TAG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"开始计时了。。。。。。。。。\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyTimerTask</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TimerTask</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      Log<span class=\"token punctuation\">.</span><span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TAG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"计时中……\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\" spellcheck=\"true\">// 一小时未操作停止计时并退出登录</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>System<span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> mLastActionTime <span class=\"token operator\">></span> <span class=\"token number\">1000</span> <span class=\"token operator\">*</span> <span class=\"token number\">3600</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">stopTimer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\" spellcheck=\"true\">// 停止计时任务</span>\n        <span class=\"token function\">LogOutAuto</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\" spellcheck=\"true\">//退出登录状态</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">// 停止计时任务</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">stopTimer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    mTimer<span class=\"token punctuation\">.</span><span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">// 计时任务是否完成 赋值</span>\n    SharedPrefsHelper<span class=\"token punctuation\">.</span><span class=\"token function\">setBoolean</span><span class=\"token punctuation\">(</span>Constants<span class=\"token punctuation\">.</span>IS_TIMER_TASK_FINISHED<span class=\"token punctuation\">,</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">// 用户按下后退键 初始化值</span>\n    SharedPrefsHelper<span class=\"token punctuation\">.</span><span class=\"token function\">setBoolean</span><span class=\"token punctuation\">(</span>Constants<span class=\"token punctuation\">.</span>USER_PRESSED_BACK<span class=\"token punctuation\">,</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Log<span class=\"token punctuation\">.</span><span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TAG\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"结束了\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Log<span class=\"token punctuation\">.</span><span class=\"token function\">e</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TAG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"取消计时\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"Android-如何监听前后台\"><a href=\"#Android-如何监听前后台\" class=\"headerlink\" title=\"Android-如何监听前后台\"></a>Android-如何监听前后台</h4><p>简单讲讲android如何判断应用切换到后台和应用切换到前台。这个其实很简单，之前需要做一个功能，当app由后台进入前台时需要完成一些逻辑操作，所以在网上查找如何判断app由后台进入前台，最终是解决了问题。这里记录一下。</p>\n<h5 id=\"一、使用ActivityLifecycleCallbacks简单app进入后台\"><a href=\"#一、使用ActivityLifecycleCallbacks简单app进入后台\" class=\"headerlink\" title=\"一、使用ActivityLifecycleCallbacks简单app进入后台\"></a>一、使用ActivityLifecycleCallbacks简单app进入后台</h5><p>有时需要监听到应用在前后台切换并做些处理，一般的做法可能是建立一个BaseActivity，然后全部的Activity都继承它，在BaseActivity的onStart和onStop中计数去处理。这样并不是最好的方式，不做详细介绍，有更好的方式，道理其实差不多，就是借助ActivityLifecycleCallbacks来实现。</p>\n<p>1、 写了一个帮助类</p>\n<pre><code class=\"java\">package com.cadae.helpers;\n\nimport android.app.Activity;\nimport android.app.Application;\nimport android.os.Bundle;\n\npublic class AppFrontBackHelper &#123;\n  private OnAppStatusListener mOnAppStatusListener;\n\n\n  public AppFrontBackHelper() &#123;\n\n  &#125;\n\n  /**\n   * 注册状态监听，仅在Application中使用\n   * @param application\n   * @param listener\n   */\n  public void register(Application application, OnAppStatusListener listener)&#123;\n    mOnAppStatusListener = listener;\n    application.registerActivityLifecycleCallbacks(activityLifecycleCallbacks);\n  &#125;\n\n  public void unRegister(Application application)&#123;\n    application.unregisterActivityLifecycleCallbacks(activityLifecycleCallbacks);\n  &#125;\n\n  private Application.ActivityLifecycleCallbacks activityLifecycleCallbacks = new Application.ActivityLifecycleCallbacks() &#123;\n    //打开的Activity数量统计\n    private int activityStartCount = 0;\n\n    @Override\n    public void onActivityCreated(Activity activity, Bundle savedInstanceState) &#123;\n\n    &#125;\n\n    @Override\n    public void onActivityStarted(Activity activity) &#123;\n      activityStartCount++;\n      //数值从0变到1说明是从后台切到前台\n      if (activityStartCount == 1)&#123;\n        //从后台切到前台\n        if(mOnAppStatusListener != null)&#123;\n          mOnAppStatusListener.onFront();\n        &#125;\n      &#125;\n    &#125;\n\n    @Override\n    public void onActivityResumed(Activity activity) &#123;\n\n    &#125;\n\n    @Override\n    public void onActivityPaused(Activity activity) &#123;\n\n    &#125;\n\n    @Override\n    public void onActivityStopped(Activity activity) &#123;\n      activityStartCount--;\n      //数值从1到0说明是从前台切到后台\n      if (activityStartCount == 0)&#123;\n        //从前台切到后台\n        if(mOnAppStatusListener != null)&#123;\n          mOnAppStatusListener.onBack();\n        &#125;\n      &#125;\n    &#125;\n\n    @Override\n    public void onActivitySaveInstanceState(Activity activity, Bundle outState) &#123;\n\n    &#125;\n\n    @Override\n    public void onActivityDestroyed(Activity activity) &#123;\n\n    &#125;\n  &#125;;\n\n  public interface OnAppStatusListener&#123;\n    void onFront();\n    void onBack();\n  &#125;\n&#125;\n</code></pre>\n<h5 id=\"二、Application中使用（注意：仅在Application中才能使用，因为Application的生命周期能监听到每个Activity）\"><a href=\"#二、Application中使用（注意：仅在Application中才能使用，因为Application的生命周期能监听到每个Activity）\" class=\"headerlink\" title=\"二、Application中使用（注意：仅在Application中才能使用，因为Application的生命周期能监听到每个Activity）\"></a>二、Application中使用（注意：仅在Application中才能使用，因为Application的生命周期能监听到每个Activity）</h5><pre><code class=\"java\">public class MyApp extends Application &#123;\n\n    @Override\n    public void onCreate() &#123;\n        super.onCreate();\n\n        AppFrontBackHelper helper = new AppFrontBackHelper();\n        helper.register(MyApp.this, new AppFrontBackHelper.OnAppStatusListener() &#123;\n            @Override\n            public void onFront() &#123;\n                //应用切到前台处理\n\n            &#125;\n\n            @Override\n            public void onBack() &#123;\n                //应用切到后台处理\n\n            &#125;\n        &#125;);\n    &#125;\n\n&#125;</code></pre>\n<p>这里在后台我们就可以去做一些事情比如开始一个计时任务 超时时退出登录</p>\n<pre><code class=\"java\">public class MyApp extends Application &#123;\n\n    private Timer mTimer; // 计时器，每1秒执行一次任务\n    private MyTimerTask mTimerTask; // 计时任务，判断是否未操作时间到达ns\n    private long mLastActionTime; // 上一次操作时间\n\n    @Override\n    public void onCreate() &#123;\n        super.onCreate();\n\n        AppFrontBackHelper helper = new AppFrontBackHelper();\n        helper.register(MyApp.this, new AppFrontBackHelper.OnAppStatusListener() &#123;\n            @Override\n            public void onFront() &#123;\n                //应用切到前台处理\n                Log.i(&quot;TAG&quot;, &quot;在前台&quot;);\n                mLastActionTime = System.currentTimeMillis();\n                if (mTimer != null)&#123;\n                     mTimer.cancel();\n                 &#125;\n            &#125;\n\n            @Override\n            public void onBack() &#123;\n                //应用切到后台处理\n                Log.i(&quot;TAG&quot;, &quot;在后台&quot;);\n                if (SharedPrefsHelper.isLogin()) &#123;\n                  startTimer();\n                &#125;\n            &#125;\n        &#125;);\n    &#125;\n\n  // 登录成功，开始计时\n  private void startTimer() &#123;\n    if (mTimer != null)&#123;\n      mTimer.cancel();\n    &#125;\n    mTimer = new Timer();\n    mTimerTask = new MyTimerTask();\n    // 初始化上次操作时间为登录成功的时间\n    mLastActionTime = System.currentTimeMillis();\n    // 每过1s检查一次\n    mTimer.schedule(mTimerTask, 0, 1000);\n    Log.i(&quot;TAG&quot;, &quot;开始计时了。。。。。。。。。&quot;);\n  &#125;\n\n  private class MyTimerTask extends TimerTask &#123;\n\n    @Override\n    public void run() &#123;\n      Log.i(&quot;TAG&quot;, &quot;计时中……&quot;);\n      // 一小时未操作停止计时并退出登录\n      if (System.currentTimeMillis() - mLastActionTime &gt; 1000 * 3600) &#123;\n        stopTimer();// 停止计时任务\n        LogOutAuto();//退出登录状态\n      &#125;\n    &#125;\n  &#125;\n\n  // 停止计时任务\n  public void stopTimer() &#123;\n    mTimer.cancel();\n    // 计时任务是否完成 赋值\n    SharedPrefsHelper.setBoolean(Constants.IS_TIMER_TASK_FINISHED,true);\n    // 用户按下后退键 初始化值\n    SharedPrefsHelper.setBoolean(Constants.USER_PRESSED_BACK,false);\n    Log.i(&quot;TAG&quot;,&quot;结束了&quot;);\n    Log.e(&quot;TAG&quot;, &quot;取消计时&quot;);\n  &#125;\n\n&#125;</code></pre>\n"},{"title":"Android 知识总结","date":"2021-06-22T06:37:27.000Z","_content":"\n### Android 细碎知识总结\n\n##### 1、implementation、api 的区别\n\n> android studio 3.0 版本之后 gradle 也升级为了3.x版本\n>\n> compile已过时，已被 implementation 和api 取代\n>\n\n那么，他们之间的区别在哪？\n\n* implementation: 只能在内部使用此模块，比如我在一个libiary中使用implementation依赖了gson库，然后我的主项目依赖了libiary，那么，我的主项目就无法访问gson库中的方法。\n这样的好处是编译速度会加快，推荐使用implementation的方式去依赖，\n\n* api: 如果你需要提供给外部访问，那么就使用api依赖即可\n\n##### 2、Android中为什么不推荐使用 Enum (枚举)\n\n大家都说 Android 中不应该使用 Enum，而且官方文档上也写出不应该使用 Enum，好那我就不用了，\n改成 Android 注解。然后这句好就被一传十，十传百，\n所有人都记住了 “ Android 中不推荐使用枚举，请使用注解代替”。\n\n谣言 绝对的谣言\n\nJakeWharton 关于 Android 中使用枚举的一些建议：\n\nJW 认为 ProGuard 和 R8 会在编译的时候会将琐碎的枚举优化为整型，不存在效率低下的问题，enum 效率低下只是 Android 团队散布的谣言，同时 Kotlin 和 Java 中的 Enum 在编译成字节码之后是一样的。\n\n更多的时候我们不需要过分关心使用 Enum 带来的内存增长，你要记住 Enum 是一个类，它只是占用了作为一个类来说应有的内存。\n\n所以是可以使用的.\n","source":"_posts/Android-知识总结.md","raw":"---\ntitle: Android 知识总结\ndate: 2021-06-22 14:37:27\ncategory:\n- Android\ntags:\n- 总结\n---\n\n### Android 细碎知识总结\n\n##### 1、implementation、api 的区别\n\n> android studio 3.0 版本之后 gradle 也升级为了3.x版本\n>\n> compile已过时，已被 implementation 和api 取代\n>\n\n那么，他们之间的区别在哪？\n\n* implementation: 只能在内部使用此模块，比如我在一个libiary中使用implementation依赖了gson库，然后我的主项目依赖了libiary，那么，我的主项目就无法访问gson库中的方法。\n这样的好处是编译速度会加快，推荐使用implementation的方式去依赖，\n\n* api: 如果你需要提供给外部访问，那么就使用api依赖即可\n\n##### 2、Android中为什么不推荐使用 Enum (枚举)\n\n大家都说 Android 中不应该使用 Enum，而且官方文档上也写出不应该使用 Enum，好那我就不用了，\n改成 Android 注解。然后这句好就被一传十，十传百，\n所有人都记住了 “ Android 中不推荐使用枚举，请使用注解代替”。\n\n谣言 绝对的谣言\n\nJakeWharton 关于 Android 中使用枚举的一些建议：\n\nJW 认为 ProGuard 和 R8 会在编译的时候会将琐碎的枚举优化为整型，不存在效率低下的问题，enum 效率低下只是 Android 团队散布的谣言，同时 Kotlin 和 Java 中的 Enum 在编译成字节码之后是一样的。\n\n更多的时候我们不需要过分关心使用 Enum 带来的内存增长，你要记住 Enum 是一个类，它只是占用了作为一个类来说应有的内存。\n\n所以是可以使用的.\n","slug":"Android-知识总结","published":1,"updated":"2021-06-22T08:07:52.319Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmw8000g3ys2e99sgcll","content":"<h3 id=\"Android-细碎知识总结\"><a href=\"#Android-细碎知识总结\" class=\"headerlink\" title=\"Android 细碎知识总结\"></a>Android 细碎知识总结</h3><h5 id=\"1、implementation、api-的区别\"><a href=\"#1、implementation、api-的区别\" class=\"headerlink\" title=\"1、implementation、api 的区别\"></a>1、implementation、api 的区别</h5><blockquote>\n<p>android studio 3.0 版本之后 gradle 也升级为了3.x版本</p>\n<p>compile已过时，已被 implementation 和api 取代</p>\n</blockquote>\n<p>那么，他们之间的区别在哪？</p>\n<ul>\n<li><p>implementation: 只能在内部使用此模块，比如我在一个libiary中使用implementation依赖了gson库，然后我的主项目依赖了libiary，那么，我的主项目就无法访问gson库中的方法。<br>这样的好处是编译速度会加快，推荐使用implementation的方式去依赖，</p>\n</li>\n<li><p>api: 如果你需要提供给外部访问，那么就使用api依赖即可</p>\n</li>\n</ul>\n<h5 id=\"2、Android中为什么不推荐使用-Enum-枚举\"><a href=\"#2、Android中为什么不推荐使用-Enum-枚举\" class=\"headerlink\" title=\"2、Android中为什么不推荐使用 Enum (枚举)\"></a>2、Android中为什么不推荐使用 Enum (枚举)</h5><p>大家都说 Android 中不应该使用 Enum，而且官方文档上也写出不应该使用 Enum，好那我就不用了，<br>改成 Android 注解。然后这句好就被一传十，十传百，<br>所有人都记住了 “ Android 中不推荐使用枚举，请使用注解代替”。</p>\n<p>谣言 绝对的谣言</p>\n<p>JakeWharton 关于 Android 中使用枚举的一些建议：</p>\n<p>JW 认为 ProGuard 和 R8 会在编译的时候会将琐碎的枚举优化为整型，不存在效率低下的问题，enum 效率低下只是 Android 团队散布的谣言，同时 Kotlin 和 Java 中的 Enum 在编译成字节码之后是一样的。</p>\n<p>更多的时候我们不需要过分关心使用 Enum 带来的内存增长，你要记住 Enum 是一个类，它只是占用了作为一个类来说应有的内存。</p>\n<p>所以是可以使用的.</p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"Android-细碎知识总结\"><a href=\"#Android-细碎知识总结\" class=\"headerlink\" title=\"Android 细碎知识总结\"></a>Android 细碎知识总结</h3><h5 id=\"1、implementation、api-的区别\"><a href=\"#1、implementation、api-的区别\" class=\"headerlink\" title=\"1、implementation、api 的区别\"></a>1、implementation、api 的区别</h5><blockquote>\n<p>android studio 3.0 版本之后 gradle 也升级为了3.x版本</p>\n<p>compile已过时，已被 implementation 和api 取代</p>\n</blockquote>\n<p>那么，他们之间的区别在哪？</p>\n<ul>\n<li><p>implementation: 只能在内部使用此模块，比如我在一个libiary中使用implementation依赖了gson库，然后我的主项目依赖了libiary，那么，我的主项目就无法访问gson库中的方法。<br>这样的好处是编译速度会加快，推荐使用implementation的方式去依赖，</p>\n</li>\n<li><p>api: 如果你需要提供给外部访问，那么就使用api依赖即可</p>\n</li>\n</ul>\n<h5 id=\"2、Android中为什么不推荐使用-Enum-枚举\"><a href=\"#2、Android中为什么不推荐使用-Enum-枚举\" class=\"headerlink\" title=\"2、Android中为什么不推荐使用 Enum (枚举)\"></a>2、Android中为什么不推荐使用 Enum (枚举)</h5><p>大家都说 Android 中不应该使用 Enum，而且官方文档上也写出不应该使用 Enum，好那我就不用了，<br>改成 Android 注解。然后这句好就被一传十，十传百，<br>所有人都记住了 “ Android 中不推荐使用枚举，请使用注解代替”。</p>\n<p>谣言 绝对的谣言</p>\n<p>JakeWharton 关于 Android 中使用枚举的一些建议：</p>\n<p>JW 认为 ProGuard 和 R8 会在编译的时候会将琐碎的枚举优化为整型，不存在效率低下的问题，enum 效率低下只是 Android 团队散布的谣言，同时 Kotlin 和 Java 中的 Enum 在编译成字节码之后是一样的。</p>\n<p>更多的时候我们不需要过分关心使用 Enum 带来的内存增长，你要记住 Enum 是一个类，它只是占用了作为一个类来说应有的内存。</p>\n<p>所以是可以使用的.</p>\n"},{"title":"Android 逆向工程","date":"2021-05-19T09:30:53.000Z","_content":"\n### Android 逆向工程\n\n#### 一、需要的工具\n\n1、Apktool\n \n>是一款应用在Apk上的逆向工程的工具，它有编译、反编译、签名等功能\n\n使用HomeBrew安装Apktool \n\n[这里给出其他安装方式](https://ibotpeaches.github.io/Apktool/install/)\n\n```\ncd ~\nbrew install apktool\n```\n安装完以后输入\n\n```\napktool\n```\n\n如果出现 下方的东西 安装成功\n\n```\nApktool v2.5.0 - a tool for reengineering Android apk files\nwith smali v2.4.0 and baksmali v2.4.0\nCopyright 2010 Ryszard Wiśniewski <brut.alll@gmail.com>\nCopyright 2010 Connor Tumbleson <connor.tumbleson@gmail.com>\n\nusage: apktool\n -advance,--advanced   prints advance information.\n -version,--version    prints the version then exits\nusage: apktool if|install-framework [options] <framework.apk>\n -p,--frame-path <dir>   Stores framework files into <dir>.\n -t,--tag <tag>          Tag frameworks using <tag>.\nusage: apktool d[ecode] [options] <file_apk>\n -f,--force              Force delete destination directory.\n -o,--output <dir>       The name of folder that gets written. Default is apk.out\n -p,--frame-path <dir>   Uses framework files located in <dir>.\n -r,--no-res             Do not decode resources.\n -s,--no-src             Do not decode sources.\n -t,--frame-tag <tag>    Uses framework files tagged by <tag>.\nusage: apktool b[uild] [options] <app_path>\n -f,--force-all          Skip changes detection and build all files.\n -o,--output <dir>       The name of apk that gets written. Default is dist/name.apk\n -p,--frame-path <dir>   Uses framework files located in <dir>.\n\nFor additional info, see: https://ibotpeaches.github.io/Apktool/ \nFor smali/baksmali info, see: https://github.com/JesusFreke/smali\n```\n\n2、dex2jar\n \n>这款工具的作用主要是将dex文件转换成jar文件，转换成jar后我们才好借助JD-GUI来查看反编译dex后的代码\n\n[下载路径](https://github.com/geilige/dex2jar/releases)\n\n请下载最新的压缩包\n\n下载完后直接解压就行了 后面我们再说用途\n\n3、JD-GUI \n\n>一款Java反编译器GUI，通过它我们能查看到反编译后的dex的代码，通常需要配合dex2jar使用;\n\n[下载路径](http://java-decompiler.github.io/)\n\n下载完后解压 进入到文件夹双击图标的时候 如果提示打不开就去  系统偏好设置-> 安全性和隐私 -> 通用 \n\n设置一下允许\n\n#### 二、具体操作\n\n1、首先我们找到一个apk文件\n\n```\napktool d test.apk\n```\n\n运行完成后，得到一个包含资源文件和代码的文件：\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519180706.png)\n\n##### 注意：\n\n此时 dex 文件直接反编译成了 smali 文件，而我们需要的是 .dex 文件。\n\n此时再运行：\n\n```\napktool d -s -f test.apk\n```\n\n>-d 反编译 apk 文件\n>\n>-s 不反编译 dex 文件，而是将其保留\n>\n>-f 如果目标文件夹存在，则删除后重新反编译\n\n此时得到这样的文件夹：\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519180931.png)\n\n2、将上一步得到的 classes.dex 文件(可能是多个) copy到dex2jar 解压好的目录中 \n\n运行代码\n\n```\nsh d2j-dex2jar.sh classes.dex\n```\n\n如果提示：\n\n```\nd2j-dex2jar.sh: line 36: ./d2j_invoke.sh: Permission denied\n```\n\n执行\n```\nsudo chmod +x d2j_invoke.sh\n```\n\n然后在执行\n\n```\nsh d2j-dex2jar.sh classes.dex\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519181313.png)\n\n运行成功 会在当前目录下生成对应的 .jar文件\n\n3、 我们打开 可视化工具 jd-gui\n\n将刚才生成的 .jar 文件拖进去 就能看到源码了\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519181524.png)\n\n\n\n[参考文章1](https://www.zhihu.com/question/29370382)\n\n[参考文章2](https://blog.csdn.net/fengyuzhengfan/article/details/80286704)\n","source":"_posts/Android-逆向工程.md","raw":"---\ntitle: Android 逆向工程\ndate: 2021-05-19 17:30:53\ncategories: \n- Android\ntags:\n- 逆向工程\n- Mac\n---\n\n### Android 逆向工程\n\n#### 一、需要的工具\n\n1、Apktool\n \n>是一款应用在Apk上的逆向工程的工具，它有编译、反编译、签名等功能\n\n使用HomeBrew安装Apktool \n\n[这里给出其他安装方式](https://ibotpeaches.github.io/Apktool/install/)\n\n```\ncd ~\nbrew install apktool\n```\n安装完以后输入\n\n```\napktool\n```\n\n如果出现 下方的东西 安装成功\n\n```\nApktool v2.5.0 - a tool for reengineering Android apk files\nwith smali v2.4.0 and baksmali v2.4.0\nCopyright 2010 Ryszard Wiśniewski <brut.alll@gmail.com>\nCopyright 2010 Connor Tumbleson <connor.tumbleson@gmail.com>\n\nusage: apktool\n -advance,--advanced   prints advance information.\n -version,--version    prints the version then exits\nusage: apktool if|install-framework [options] <framework.apk>\n -p,--frame-path <dir>   Stores framework files into <dir>.\n -t,--tag <tag>          Tag frameworks using <tag>.\nusage: apktool d[ecode] [options] <file_apk>\n -f,--force              Force delete destination directory.\n -o,--output <dir>       The name of folder that gets written. Default is apk.out\n -p,--frame-path <dir>   Uses framework files located in <dir>.\n -r,--no-res             Do not decode resources.\n -s,--no-src             Do not decode sources.\n -t,--frame-tag <tag>    Uses framework files tagged by <tag>.\nusage: apktool b[uild] [options] <app_path>\n -f,--force-all          Skip changes detection and build all files.\n -o,--output <dir>       The name of apk that gets written. Default is dist/name.apk\n -p,--frame-path <dir>   Uses framework files located in <dir>.\n\nFor additional info, see: https://ibotpeaches.github.io/Apktool/ \nFor smali/baksmali info, see: https://github.com/JesusFreke/smali\n```\n\n2、dex2jar\n \n>这款工具的作用主要是将dex文件转换成jar文件，转换成jar后我们才好借助JD-GUI来查看反编译dex后的代码\n\n[下载路径](https://github.com/geilige/dex2jar/releases)\n\n请下载最新的压缩包\n\n下载完后直接解压就行了 后面我们再说用途\n\n3、JD-GUI \n\n>一款Java反编译器GUI，通过它我们能查看到反编译后的dex的代码，通常需要配合dex2jar使用;\n\n[下载路径](http://java-decompiler.github.io/)\n\n下载完后解压 进入到文件夹双击图标的时候 如果提示打不开就去  系统偏好设置-> 安全性和隐私 -> 通用 \n\n设置一下允许\n\n#### 二、具体操作\n\n1、首先我们找到一个apk文件\n\n```\napktool d test.apk\n```\n\n运行完成后，得到一个包含资源文件和代码的文件：\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519180706.png)\n\n##### 注意：\n\n此时 dex 文件直接反编译成了 smali 文件，而我们需要的是 .dex 文件。\n\n此时再运行：\n\n```\napktool d -s -f test.apk\n```\n\n>-d 反编译 apk 文件\n>\n>-s 不反编译 dex 文件，而是将其保留\n>\n>-f 如果目标文件夹存在，则删除后重新反编译\n\n此时得到这样的文件夹：\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519180931.png)\n\n2、将上一步得到的 classes.dex 文件(可能是多个) copy到dex2jar 解压好的目录中 \n\n运行代码\n\n```\nsh d2j-dex2jar.sh classes.dex\n```\n\n如果提示：\n\n```\nd2j-dex2jar.sh: line 36: ./d2j_invoke.sh: Permission denied\n```\n\n执行\n```\nsudo chmod +x d2j_invoke.sh\n```\n\n然后在执行\n\n```\nsh d2j-dex2jar.sh classes.dex\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519181313.png)\n\n运行成功 会在当前目录下生成对应的 .jar文件\n\n3、 我们打开 可视化工具 jd-gui\n\n将刚才生成的 .jar 文件拖进去 就能看到源码了\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519181524.png)\n\n\n\n[参考文章1](https://www.zhihu.com/question/29370382)\n\n[参考文章2](https://blog.csdn.net/fengyuzhengfan/article/details/80286704)\n","slug":"Android-逆向工程","published":1,"updated":"2021-05-19T10:16:56.069Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwa000k3ys23dyr12br","content":"<h3 id=\"Android-逆向工程\"><a href=\"#Android-逆向工程\" class=\"headerlink\" title=\"Android 逆向工程\"></a>Android 逆向工程</h3><h4 id=\"一、需要的工具\"><a href=\"#一、需要的工具\" class=\"headerlink\" title=\"一、需要的工具\"></a>一、需要的工具</h4><p>1、Apktool</p>\n<blockquote>\n<p>是一款应用在Apk上的逆向工程的工具，它有编译、反编译、签名等功能</p>\n</blockquote>\n<p>使用HomeBrew安装Apktool </p>\n<p><a href=\"https://ibotpeaches.github.io/Apktool/install/\">这里给出其他安装方式</a></p>\n<pre><code>cd ~\nbrew install apktool</code></pre>\n<p>安装完以后输入</p>\n<pre><code>apktool</code></pre>\n<p>如果出现 下方的东西 安装成功</p>\n<pre><code>Apktool v2.5.0 - a tool for reengineering Android apk files\nwith smali v2.4.0 and baksmali v2.4.0\nCopyright 2010 Ryszard Wiśniewski &lt;brut.alll@gmail.com&gt;\nCopyright 2010 Connor Tumbleson &lt;connor.tumbleson@gmail.com&gt;\n\nusage: apktool\n -advance,--advanced   prints advance information.\n -version,--version    prints the version then exits\nusage: apktool if|install-framework [options] &lt;framework.apk&gt;\n -p,--frame-path &lt;dir&gt;   Stores framework files into &lt;dir&gt;.\n -t,--tag &lt;tag&gt;          Tag frameworks using &lt;tag&gt;.\nusage: apktool d[ecode] [options] &lt;file_apk&gt;\n -f,--force              Force delete destination directory.\n -o,--output &lt;dir&gt;       The name of folder that gets written. Default is apk.out\n -p,--frame-path &lt;dir&gt;   Uses framework files located in &lt;dir&gt;.\n -r,--no-res             Do not decode resources.\n -s,--no-src             Do not decode sources.\n -t,--frame-tag &lt;tag&gt;    Uses framework files tagged by &lt;tag&gt;.\nusage: apktool b[uild] [options] &lt;app_path&gt;\n -f,--force-all          Skip changes detection and build all files.\n -o,--output &lt;dir&gt;       The name of apk that gets written. Default is dist/name.apk\n -p,--frame-path &lt;dir&gt;   Uses framework files located in &lt;dir&gt;.\n\nFor additional info, see: https://ibotpeaches.github.io/Apktool/ \nFor smali/baksmali info, see: https://github.com/JesusFreke/smali</code></pre>\n<p>2、dex2jar</p>\n<blockquote>\n<p>这款工具的作用主要是将dex文件转换成jar文件，转换成jar后我们才好借助JD-GUI来查看反编译dex后的代码</p>\n</blockquote>\n<p><a href=\"https://github.com/geilige/dex2jar/releases\">下载路径</a></p>\n<p>请下载最新的压缩包</p>\n<p>下载完后直接解压就行了 后面我们再说用途</p>\n<p>3、JD-GUI </p>\n<blockquote>\n<p>一款Java反编译器GUI，通过它我们能查看到反编译后的dex的代码，通常需要配合dex2jar使用;</p>\n</blockquote>\n<p><a href=\"http://java-decompiler.github.io/\">下载路径</a></p>\n<p>下载完后解压 进入到文件夹双击图标的时候 如果提示打不开就去  系统偏好设置-&gt; 安全性和隐私 -&gt; 通用 </p>\n<p>设置一下允许</p>\n<h4 id=\"二、具体操作\"><a href=\"#二、具体操作\" class=\"headerlink\" title=\"二、具体操作\"></a>二、具体操作</h4><p>1、首先我们找到一个apk文件</p>\n<pre><code>apktool d test.apk</code></pre>\n<p>运行完成后，得到一个包含资源文件和代码的文件：</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519180706.png\"></p>\n<h5 id=\"注意：\"><a href=\"#注意：\" class=\"headerlink\" title=\"注意：\"></a>注意：</h5><p>此时 dex 文件直接反编译成了 smali 文件，而我们需要的是 .dex 文件。</p>\n<p>此时再运行：</p>\n<pre><code>apktool d -s -f test.apk</code></pre>\n<blockquote>\n<p>-d 反编译 apk 文件</p>\n<p>-s 不反编译 dex 文件，而是将其保留</p>\n<p>-f 如果目标文件夹存在，则删除后重新反编译</p>\n</blockquote>\n<p>此时得到这样的文件夹：</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519180931.png\"></p>\n<p>2、将上一步得到的 classes.dex 文件(可能是多个) copy到dex2jar 解压好的目录中 </p>\n<p>运行代码</p>\n<pre><code>sh d2j-dex2jar.sh classes.dex</code></pre>\n<p>如果提示：</p>\n<pre><code>d2j-dex2jar.sh: line 36: ./d2j_invoke.sh: Permission denied</code></pre>\n<p>执行</p>\n<pre><code>sudo chmod +x d2j_invoke.sh</code></pre>\n<p>然后在执行</p>\n<pre><code>sh d2j-dex2jar.sh classes.dex</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519181313.png\"></p>\n<p>运行成功 会在当前目录下生成对应的 .jar文件</p>\n<p>3、 我们打开 可视化工具 jd-gui</p>\n<p>将刚才生成的 .jar 文件拖进去 就能看到源码了</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519181524.png\"></p>\n<p><a href=\"https://www.zhihu.com/question/29370382\">参考文章1</a></p>\n<p><a href=\"https://blog.csdn.net/fengyuzhengfan/article/details/80286704\">参考文章2</a></p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"Android-逆向工程\"><a href=\"#Android-逆向工程\" class=\"headerlink\" title=\"Android 逆向工程\"></a>Android 逆向工程</h3><h4 id=\"一、需要的工具\"><a href=\"#一、需要的工具\" class=\"headerlink\" title=\"一、需要的工具\"></a>一、需要的工具</h4><p>1、Apktool</p>\n<blockquote>\n<p>是一款应用在Apk上的逆向工程的工具，它有编译、反编译、签名等功能</p>\n</blockquote>\n<p>使用HomeBrew安装Apktool </p>\n<p><a href=\"https://ibotpeaches.github.io/Apktool/install/\">这里给出其他安装方式</a></p>\n<pre><code>cd ~\nbrew install apktool</code></pre>\n<p>安装完以后输入</p>\n<pre><code>apktool</code></pre>\n<p>如果出现 下方的东西 安装成功</p>\n<pre><code>Apktool v2.5.0 - a tool for reengineering Android apk files\nwith smali v2.4.0 and baksmali v2.4.0\nCopyright 2010 Ryszard Wiśniewski &lt;brut.alll@gmail.com&gt;\nCopyright 2010 Connor Tumbleson &lt;connor.tumbleson@gmail.com&gt;\n\nusage: apktool\n -advance,--advanced   prints advance information.\n -version,--version    prints the version then exits\nusage: apktool if|install-framework [options] &lt;framework.apk&gt;\n -p,--frame-path &lt;dir&gt;   Stores framework files into &lt;dir&gt;.\n -t,--tag &lt;tag&gt;          Tag frameworks using &lt;tag&gt;.\nusage: apktool d[ecode] [options] &lt;file_apk&gt;\n -f,--force              Force delete destination directory.\n -o,--output &lt;dir&gt;       The name of folder that gets written. Default is apk.out\n -p,--frame-path &lt;dir&gt;   Uses framework files located in &lt;dir&gt;.\n -r,--no-res             Do not decode resources.\n -s,--no-src             Do not decode sources.\n -t,--frame-tag &lt;tag&gt;    Uses framework files tagged by &lt;tag&gt;.\nusage: apktool b[uild] [options] &lt;app_path&gt;\n -f,--force-all          Skip changes detection and build all files.\n -o,--output &lt;dir&gt;       The name of apk that gets written. Default is dist/name.apk\n -p,--frame-path &lt;dir&gt;   Uses framework files located in &lt;dir&gt;.\n\nFor additional info, see: https://ibotpeaches.github.io/Apktool/ \nFor smali/baksmali info, see: https://github.com/JesusFreke/smali</code></pre>\n<p>2、dex2jar</p>\n<blockquote>\n<p>这款工具的作用主要是将dex文件转换成jar文件，转换成jar后我们才好借助JD-GUI来查看反编译dex后的代码</p>\n</blockquote>\n<p><a href=\"https://github.com/geilige/dex2jar/releases\">下载路径</a></p>\n<p>请下载最新的压缩包</p>\n<p>下载完后直接解压就行了 后面我们再说用途</p>\n<p>3、JD-GUI </p>\n<blockquote>\n<p>一款Java反编译器GUI，通过它我们能查看到反编译后的dex的代码，通常需要配合dex2jar使用;</p>\n</blockquote>\n<p><a href=\"http://java-decompiler.github.io/\">下载路径</a></p>\n<p>下载完后解压 进入到文件夹双击图标的时候 如果提示打不开就去  系统偏好设置-&gt; 安全性和隐私 -&gt; 通用 </p>\n<p>设置一下允许</p>\n<h4 id=\"二、具体操作\"><a href=\"#二、具体操作\" class=\"headerlink\" title=\"二、具体操作\"></a>二、具体操作</h4><p>1、首先我们找到一个apk文件</p>\n<pre><code>apktool d test.apk</code></pre>\n<p>运行完成后，得到一个包含资源文件和代码的文件：</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519180706.png\"></p>\n<h5 id=\"注意：\"><a href=\"#注意：\" class=\"headerlink\" title=\"注意：\"></a>注意：</h5><p>此时 dex 文件直接反编译成了 smali 文件，而我们需要的是 .dex 文件。</p>\n<p>此时再运行：</p>\n<pre><code>apktool d -s -f test.apk</code></pre>\n<blockquote>\n<p>-d 反编译 apk 文件</p>\n<p>-s 不反编译 dex 文件，而是将其保留</p>\n<p>-f 如果目标文件夹存在，则删除后重新反编译</p>\n</blockquote>\n<p>此时得到这样的文件夹：</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519180931.png\"></p>\n<p>2、将上一步得到的 classes.dex 文件(可能是多个) copy到dex2jar 解压好的目录中 </p>\n<p>运行代码</p>\n<pre><code>sh d2j-dex2jar.sh classes.dex</code></pre>\n<p>如果提示：</p>\n<pre><code>d2j-dex2jar.sh: line 36: ./d2j_invoke.sh: Permission denied</code></pre>\n<p>执行</p>\n<pre><code>sudo chmod +x d2j_invoke.sh</code></pre>\n<p>然后在执行</p>\n<pre><code>sh d2j-dex2jar.sh classes.dex</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519181313.png\"></p>\n<p>运行成功 会在当前目录下生成对应的 .jar文件</p>\n<p>3、 我们打开 可视化工具 jd-gui</p>\n<p>将刚才生成的 .jar 文件拖进去 就能看到源码了</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210519181524.png\"></p>\n<p><a href=\"https://www.zhihu.com/question/29370382\">参考文章1</a></p>\n<p><a href=\"https://blog.csdn.net/fengyuzhengfan/article/details/80286704\">参考文章2</a></p>\n"},{"title":"Android一些常用的背景图","date":"2020-12-18T08:52:39.000Z","_content":"\n#### Android中一些常用的xml背景图\n\n\n##### 1、绿色背景 圆角为4dp的xml背景(颜色可自行修改)\n\nres/drawable 目录下 common_bg_4_radius_green.xml\n\n```xml\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\n  android:shape=\"rectangle\">\n\n  <solid android:color=\"@color/绿色\"/>\n  <corners android:radius=\"4dp\"/>\n</shape>\n\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201218170312.png)\n\n##### 2、绿色border边框背景\n\n```xml\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\nandroid:shape=\"rectangle\">\n\n<stroke\n  android:width=\"0.6dp\"\n  android:color=\"@color/绿色\" />\n<corners android:radius=\"2dp\" />\n\n</shape>\n\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201218170216.png)\n\n##### 3、背景为圆形\n\n```xml\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\n  android:shape=\"oval\">\n\n  <solid android:color=\"@color/绿色\" />\n  <corners android:radius=\"8.3dp\" />\n\n  <size\n    android:width=\"17dp\"\n    android:height=\"17dp\" />\n</shape>\n\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201218170648.png)\n","source":"_posts/Android一些常用的背景图.md","raw":"---\ntitle: Android一些常用的背景图\ndate: 2020-12-18 16:52:39\ncategories:\n- Android\ntags:\n- Java\n- 背景图\n- Drawable\n- xml\n---\n\n#### Android中一些常用的xml背景图\n\n\n##### 1、绿色背景 圆角为4dp的xml背景(颜色可自行修改)\n\nres/drawable 目录下 common_bg_4_radius_green.xml\n\n```xml\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\n  android:shape=\"rectangle\">\n\n  <solid android:color=\"@color/绿色\"/>\n  <corners android:radius=\"4dp\"/>\n</shape>\n\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201218170312.png)\n\n##### 2、绿色border边框背景\n\n```xml\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\nandroid:shape=\"rectangle\">\n\n<stroke\n  android:width=\"0.6dp\"\n  android:color=\"@color/绿色\" />\n<corners android:radius=\"2dp\" />\n\n</shape>\n\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201218170216.png)\n\n##### 3、背景为圆形\n\n```xml\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\n  android:shape=\"oval\">\n\n  <solid android:color=\"@color/绿色\" />\n  <corners android:radius=\"8.3dp\" />\n\n  <size\n    android:width=\"17dp\"\n    android:height=\"17dp\" />\n</shape>\n\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201218170648.png)\n","slug":"Android一些常用的背景图","published":1,"updated":"2020-12-18T09:07:13.710Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwb000m3ys20fli3zpr","content":"<h4 id=\"Android中一些常用的xml背景图\"><a href=\"#Android中一些常用的xml背景图\" class=\"headerlink\" title=\"Android中一些常用的xml背景图\"></a>Android中一些常用的xml背景图</h4><h5 id=\"1、绿色背景-圆角为4dp的xml背景-颜色可自行修改\"><a href=\"#1、绿色背景-圆角为4dp的xml背景-颜色可自行修改\" class=\"headerlink\" title=\"1、绿色背景 圆角为4dp的xml背景(颜色可自行修改)\"></a>1、绿色背景 圆角为4dp的xml背景(颜色可自行修改)</h5><p>res/drawable 目录下 common_bg_4_radius_green.xml</p>\n<pre class=\"line-numbers language-xml\"><code class=\"language-xml\">\n<span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>shape</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>android</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/apk/res/android<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>shape</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>rectangle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>solid</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>color</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>@color/绿色<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>corners</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>radius</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>4dp<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>shape</span><span class=\"token punctuation\">></span></span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201218170312.png\"></p>\n<h5 id=\"2、绿色border边框背景\"><a href=\"#2、绿色border边框背景\" class=\"headerlink\" title=\"2、绿色border边框背景\"></a>2、绿色border边框背景</h5><pre class=\"line-numbers language-xml\"><code class=\"language-xml\">\n<span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>shape</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>android</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/apk/res/android<span class=\"token punctuation\">\"</span></span>\n<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>shape</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>rectangle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>stroke</span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>0.6dp<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>color</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>@color/绿色<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>corners</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>radius</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>2dp<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>shape</span><span class=\"token punctuation\">></span></span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201218170216.png\"></p>\n<h5 id=\"3、背景为圆形\"><a href=\"#3、背景为圆形\" class=\"headerlink\" title=\"3、背景为圆形\"></a>3、背景为圆形</h5><pre class=\"line-numbers language-xml\"><code class=\"language-xml\">\n<span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>shape</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>android</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/apk/res/android<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>shape</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>oval<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>solid</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>color</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>@color/绿色<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>corners</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>radius</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>8.3dp<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>size</span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>17dp<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>17dp<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>shape</span><span class=\"token punctuation\">></span></span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201218170648.png\"></p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"Android中一些常用的xml背景图\"><a href=\"#Android中一些常用的xml背景图\" class=\"headerlink\" title=\"Android中一些常用的xml背景图\"></a>Android中一些常用的xml背景图</h4><h5 id=\"1、绿色背景-圆角为4dp的xml背景-颜色可自行修改\"><a href=\"#1、绿色背景-圆角为4dp的xml背景-颜色可自行修改\" class=\"headerlink\" title=\"1、绿色背景 圆角为4dp的xml背景(颜色可自行修改)\"></a>1、绿色背景 圆角为4dp的xml背景(颜色可自行修改)</h5><p>res/drawable 目录下 common_bg_4_radius_green.xml</p>\n<pre><code class=\"xml\">\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n  android:shape=&quot;rectangle&quot;&gt;\n\n  &lt;solid android:color=&quot;@color/绿色&quot;/&gt;\n  &lt;corners android:radius=&quot;4dp&quot;/&gt;\n&lt;/shape&gt;\n</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201218170312.png\"></p>\n<h5 id=\"2、绿色border边框背景\"><a href=\"#2、绿色border边框背景\" class=\"headerlink\" title=\"2、绿色border边框背景\"></a>2、绿色border边框背景</h5><pre><code class=\"xml\">\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\nandroid:shape=&quot;rectangle&quot;&gt;\n\n&lt;stroke\n  android:width=&quot;0.6dp&quot;\n  android:color=&quot;@color/绿色&quot; /&gt;\n&lt;corners android:radius=&quot;2dp&quot; /&gt;\n\n&lt;/shape&gt;\n</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201218170216.png\"></p>\n<h5 id=\"3、背景为圆形\"><a href=\"#3、背景为圆形\" class=\"headerlink\" title=\"3、背景为圆形\"></a>3、背景为圆形</h5><pre><code class=\"xml\">\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n  android:shape=&quot;oval&quot;&gt;\n\n  &lt;solid android:color=&quot;@color/绿色&quot; /&gt;\n  &lt;corners android:radius=&quot;8.3dp&quot; /&gt;\n\n  &lt;size\n    android:width=&quot;17dp&quot;\n    android:height=&quot;17dp&quot; /&gt;\n&lt;/shape&gt;\n</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201218170648.png\"></p>\n"},{"title":"Android自定义EditText一键清除和密文查看","date":"2020-12-18T08:26:41.000Z","_content":"\n\n#### Android自定义EditText一键清除和密文查看\n\n* 先上截屏看一下效果\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/S01218-16245606.jpg)\n\n\n##### 自定义步骤\n\n##### 1、首先新建一个类PowerfulEditText.java 我放在了widgets目录中这个目录平时就用来存放一些自定义的类\n\n```java\n\n//  这个自定义EditText 有两个按钮 一键清空按钮 和 小眼睛查看明文\n//  isPassword 字段会根据输入框是否是密码框来决定是否会绘制小眼睛 很好用\npublic class PowerfulEditText extends androidx.appcompat.widget.AppCompatEditText {\n\n  private static final String TAG = \"PowerfulEditText.java\";\n\n  private static final int DEFAULT_CLEAR_RES = R.drawable.delete_edit;\n  private static final int DEFAULT_VISIBLE_RES = R.drawable.black_open_eyes;\n  private static final int DEFAULT_INVISIBLE_RES = R.drawable.black_close_eyes;\n\n  private static final int DEFAULT_STYLE_COLOR = Color.BLUE;\n\n  private final int DEFAULT_BUTTON_PADDING =\n    getResources().getDimensionPixelSize(R.dimen.btn_edit_text_padding);\n  private final int DEFAULT_BUTTON_WIDTH =\n    getResources().getDimensionPixelSize(R.dimen.btn_edit_text_width);\n\n  private static final String STYLE_RECT = \"rectangle\";\n  private static final String STYLE_ROUND_RECT = \"roundRect\";\n  private static final String STYLE_HALF_RECT = \"halfRect\";\n  private static final String STYLE_ANIMATOR = \"animator\";\n\n  private static final int DEFAULT_ROUND_RADIUS = 20;\n  private static final int ANIMATOR_TIME = 200;\n  private static final int DEFAULT_FOCUSED_STROKE_WIDTH = 8;\n  private static final int DEFAULT_UNFOCUSED_STROKE_WIDTH = 4;\n\n  //按钮间隔\n  private int mBtnPadding = 0;\n  //按钮宽度\n  private int mBtnWidth = 0;\n  //右内边距\n  private int mTextPaddingRight;\n\n  private int mClearResId = 0;\n  private int mVisibleResId = 0;\n  private int mInvisibleResId = 0;\n  private Bitmap mBitmapClear;\n  private Bitmap mBitmapVisible;\n  private Bitmap mBitmapInvisible;\n\n  private String mBorderStyle = \"\";\n  private int mStyleColor = -1;\n\n  //出现和消失动画\n  private ValueAnimator mGoneAnimator;\n  private ValueAnimator mVisibleAnimator;\n  //状态值\n  private boolean isBtnVisible = false;\n  // isPassword 字段会根据输入框是否是密码框来决定是否会绘制小眼睛\n  private boolean isPassword = false;\n  private boolean isPasswordVisible = false;\n\n  private boolean isAnimatorRunning = false;\n  private int mAnimatorProgress = 0;\n  private ObjectAnimator mAnimator;\n\n  //自定义属性动画\n  private static final Property<PowerfulEditText, Integer> BORDER_PROGRESS\n    = new Property<PowerfulEditText, Integer>(Integer.class, \"borderProgress\") {\n    @Override\n    public Integer get(PowerfulEditText powerfulEditText) {\n      return powerfulEditText.getBorderProgress();\n    }\n\n    @Override\n    public void set(PowerfulEditText powerfulEditText, Integer value) {\n      powerfulEditText.setBorderProgress(value);\n    }\n  };\n\n  private Paint mPaint;\n\n  public PowerfulEditText(Context context) {\n    this(context, null);\n  }\n\n  public PowerfulEditText(Context context, @Nullable AttributeSet attrs) {\n    super(context, attrs);\n    init(context, attrs);\n  }\n\n  public PowerfulEditText(Context context, @Nullable AttributeSet attrs, int defStyleAttr) {\n    super(context, attrs, defStyleAttr);\n    init(context, attrs);\n  }\n\n  private void init(Context context, AttributeSet attrs) {\n    //抗锯齿和位图滤波\n    mPaint = new Paint(Paint.ANTI_ALIAS_FLAG | Paint.FILTER_BITMAP_FLAG);\n\n    //读取xml文件中的配置\n    if (attrs != null) {\n      TypedArray array = context.obtainStyledAttributes(attrs, R.styleable.PowerfulEditText);\n      for (int i = 0; i < array.getIndexCount(); i++) {\n        int attr = array.getIndex(i);\n\n        switch (attr) {\n          case R.styleable.PowerfulEditText_clearDrawable:\n            mClearResId = array.getResourceId(attr, DEFAULT_CLEAR_RES);\n            break;\n\n          case R.styleable.PowerfulEditText_visibleDrawable:\n            mVisibleResId = array.getResourceId(attr, DEFAULT_VISIBLE_RES);\n            break;\n\n          case R.styleable.PowerfulEditText_invisibleDrawable:\n            mInvisibleResId = array.getResourceId(attr, DEFAULT_INVISIBLE_RES);\n            break;\n\n          case R.styleable.PowerfulEditText_BtnWidth:\n            mBtnWidth = array.getDimensionPixelSize(attr, DEFAULT_BUTTON_WIDTH);\n            break;\n\n          case R.styleable.PowerfulEditText_BtnSpacing:\n            mBtnPadding = array.getDimensionPixelSize(attr, DEFAULT_BUTTON_PADDING);\n            break;\n\n          case R.styleable.PowerfulEditText_borderStyle:\n            mBorderStyle = array.getString(attr);\n            break;\n\n          case R.styleable.PowerfulEditText_styleColor:\n            mStyleColor = array.getColor(attr, DEFAULT_STYLE_COLOR);\n            break;\n        }\n      }\n      array.recycle();\n    }\n\n    //初始化按钮显示的Bitmap\n    mBitmapClear = createBitmap(context, mClearResId, DEFAULT_CLEAR_RES);\n    mBitmapVisible = createBitmap(context, mVisibleResId, DEFAULT_VISIBLE_RES);\n    mBitmapInvisible = createBitmap(context, mInvisibleResId, DEFAULT_INVISIBLE_RES);\n    //如果自定义，则使用自定义的值，否则使用默认值\n    if (mBtnPadding == 0) {\n      mBtnPadding = DEFAULT_BUTTON_PADDING;\n    }\n    if (mBtnWidth == 0) {\n      mBtnWidth = DEFAULT_BUTTON_WIDTH;\n    }\n    //给文字设置一个padding，避免文字和按钮重叠了\n    mTextPaddingRight = mBtnPadding * 4 + mBtnWidth * 2;\n\n    //按钮出现和消失的动画\n    mGoneAnimator = ValueAnimator.ofFloat(1f, 0f).setDuration(ANIMATOR_TIME);\n    mVisibleAnimator = ValueAnimator.ofFloat(0f, 1f).setDuration(ANIMATOR_TIME);\n\n    //是否是密码样式\n    isPassword =\n      getInputType() == (InputType.TYPE_TEXT_VARIATION_PASSWORD | InputType.TYPE_CLASS_TEXT);\n\n  }\n\n  @Override\n  protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {\n    super.onMeasure(widthMeasureSpec, heightMeasureSpec);\n\n    //设置右内边距, 防止清除按钮和文字重叠\n    setPadding(getPaddingLeft(), getPaddingTop(), mTextPaddingRight, getPaddingBottom());\n  }\n\n  @Override\n  protected void onDraw(Canvas canvas) {\n    super.onDraw(canvas);\n\n    mPaint.setStyle(Paint.Style.STROKE);\n\n    //使用自定义颜色。如未定义，则使用默认颜色\n    if (mStyleColor != -1) {\n      mPaint.setColor(mStyleColor);\n    } else {\n      mPaint.setColor(DEFAULT_STYLE_COLOR);\n    }\n\n    //控件获取焦点时，加粗边框\n    if (isFocused()) {\n      mPaint.setStrokeWidth(DEFAULT_FOCUSED_STROKE_WIDTH);\n    } else {\n      mPaint.setStrokeWidth(DEFAULT_UNFOCUSED_STROKE_WIDTH);\n    }\n\n    //绘制边框\n    drawBorder(canvas);\n    //绘制清空和明文显示按钮\n    drawButtons(canvas);\n  }\n\n  private void drawBorder(Canvas canvas) {\n    int width = getWidth();\n    int height = getHeight();\n\n    switch (mBorderStyle) {\n      //矩形样式\n      case STYLE_RECT:\n        setBackground(null);\n        canvas.drawRect(0, 0, width, height, mPaint);\n        break;\n\n      //圆角矩形样式\n      case STYLE_ROUND_RECT:\n        setBackground(null);\n        float roundRectLineWidth = 0;\n        if (isFocused()) {\n          roundRectLineWidth = DEFAULT_FOCUSED_STROKE_WIDTH / 2;\n        } else {\n          roundRectLineWidth = DEFAULT_UNFOCUSED_STROKE_WIDTH / 2;\n        }\n        mPaint.setStrokeWidth(roundRectLineWidth);\n        if (Build.VERSION.SDK_INT >= 21) {\n          canvas.drawRoundRect(\n            roundRectLineWidth / 2, roundRectLineWidth / 2, width - roundRectLineWidth / 2, height - roundRectLineWidth / 2,\n            DEFAULT_ROUND_RADIUS, DEFAULT_ROUND_RADIUS,\n            mPaint);\n        } else {\n          canvas.drawRoundRect(\n            new RectF(roundRectLineWidth / 2, roundRectLineWidth / 2, width - roundRectLineWidth / 2, height - roundRectLineWidth / 2),\n            DEFAULT_ROUND_RADIUS, DEFAULT_ROUND_RADIUS,\n            mPaint);\n        }\n        break;\n\n      //半矩形样式\n      case STYLE_HALF_RECT:\n        setBackground(null);\n        canvas.drawLine(0, height, width, height, mPaint);\n        canvas.drawLine(0, height / 2, 0, height, mPaint);\n        canvas.drawLine(width, height / 2, width, height, mPaint);\n        break;\n\n      //动画特效样式\n      case STYLE_ANIMATOR:\n        setBackground(null);\n        if (isAnimatorRunning) {\n          canvas.drawLine(width / 2 - mAnimatorProgress, height, width / 2 + mAnimatorProgress, height, mPaint);\n          if (mAnimatorProgress == width / 2) {\n            isAnimatorRunning = false;\n          }\n        } else {\n          canvas.drawLine(0, height, width, height, mPaint);\n        }\n        break;\n    }\n  }\n\n  private void drawButtons(Canvas canvas) {\n    if (isBtnVisible) {\n      //播放按钮出现的动画\n      if (mVisibleAnimator.isRunning()) {\n        float scale = (float) mVisibleAnimator.getAnimatedValue();\n        drawClearButton(scale, canvas);\n        if (isPassword) {\n          drawVisibleButton(scale, canvas, isPasswordVisible);\n        }\n        invalidate();\n        //绘制静态的按钮\n      } else {\n        drawClearButton(1, canvas);\n        if (isPassword) {\n          drawVisibleButton(1, canvas, isPasswordVisible);\n        }\n      }\n    } else {\n      //播放按钮消失的动画\n      if (mGoneAnimator.isRunning()) {\n        float scale = (float) mGoneAnimator.getAnimatedValue();\n        drawClearButton(scale, canvas);\n        if (isPassword) {\n          drawVisibleButton(scale, canvas, isPasswordVisible);\n        }\n        invalidate();\n      }\n    }\n  }\n\n  private void drawClearButton(float scale, Canvas canvas) {\n\n    int right = (int) (getWidth() + getScrollX() - mBtnPadding - mBtnWidth * (1f - scale) / 2f);\n    int left = (int) (getWidth() + getScrollX() - mBtnPadding - mBtnWidth * (scale + (1f - scale) / 2f));\n    int top = (int) ((getHeight() - mBtnWidth * scale) / 2);\n    int bottom = (int) (top + mBtnWidth * scale);\n    Rect rect = new Rect(left, top, right, bottom);\n    canvas.drawBitmap(mBitmapClear, null, rect, mPaint);\n  }\n\n  private void drawVisibleButton(float scale, Canvas canvas, boolean isVisible) {\n\n    int right = (int) (getWidth() + getScrollX() - mBtnPadding * 3 - mBtnWidth - mBtnWidth * (1f - scale) / 2f);\n    int left = (int) (getWidth() + getScrollX() - mBtnPadding * 3 - mBtnWidth - mBtnWidth * (scale + (1f - scale) / 2f));\n    int top = (int) ((getHeight() - mBtnWidth * scale) / 2);\n    int bottom = (int) (top + mBtnWidth * scale);\n    Rect rect = new Rect(left, top, right, bottom);\n    if (isVisible) {\n      canvas.drawBitmap(mBitmapVisible, null, rect, mPaint);\n    } else {\n      canvas.drawBitmap(mBitmapInvisible, null, rect, mPaint);\n    }\n\n  }\n\n  // 清除按钮出现时的动画效果\n  private void startVisibleAnimator() {\n    endAllAnimator();\n    mVisibleAnimator.start();\n    invalidate();\n  }\n\n  // 清除按钮消失时的动画效果\n  private void startGoneAnimator() {\n    endAllAnimator();\n    mGoneAnimator.start();\n    invalidate();\n  }\n\n  // 结束所有动画\n  private void endAllAnimator() {\n    mGoneAnimator.end();\n    mVisibleAnimator.end();\n  }\n\n  @Override\n  protected void onFocusChanged(boolean focused, int direction, Rect previouslyFocusedRect) {\n    super.onFocusChanged(focused, direction, previouslyFocusedRect);\n\n    //播放按钮出现和消失动画\n    if (focused && getText().length() > 0) {\n      if (!isBtnVisible) {\n        isBtnVisible = true;\n        startVisibleAnimator();\n      }\n    } else {\n      if (isBtnVisible) {\n        isBtnVisible = false;\n        startGoneAnimator();\n      }\n    }\n\n    //实现动画特效样式\n    if (focused && mBorderStyle.equals(STYLE_ANIMATOR)) {\n      isAnimatorRunning = true;\n      mAnimator = ObjectAnimator.ofInt(this, BORDER_PROGRESS, 0, getWidth() / 2);\n      mAnimator.setDuration(ANIMATOR_TIME);\n      mAnimator.start();\n    }\n  }\n\n  protected void setBorderProgress(int borderProgress) {\n    mAnimatorProgress = borderProgress;\n    postInvalidate();\n  }\n\n  protected int getBorderProgress() {\n    return mAnimatorProgress;\n  }\n\n  @Override\n  protected void onTextChanged(CharSequence text, int start, int lengthBefore, int lengthAfter) {\n    super.onTextChanged(text, start, lengthBefore, lengthAfter);\n\n    if (text.length() > 0 && isFocused()) {\n      if (!isBtnVisible) {\n        isBtnVisible = true;\n        startVisibleAnimator();\n      }\n    } else {\n      if (isBtnVisible) {\n        isBtnVisible = false;\n        startGoneAnimator();\n      }\n    }\n  }\n\n  @Override\n  public boolean onTouchEvent(MotionEvent event) {\n    if (event.getAction() == MotionEvent.ACTION_UP) {\n\n      boolean clearTouched =\n        (getWidth() - mBtnPadding - mBtnWidth < event.getX())\n          && (event.getX() < getWidth() - mBtnPadding)\n          && isFocused();\n      boolean visibleTouched =\n        (getWidth() - mBtnPadding * 3 - mBtnWidth * 2 < event.getX())\n          && (event.getX() < getWidth() - mBtnPadding * 3 - mBtnWidth)\n          && isPassword && isFocused();\n\n      if (clearTouched) {\n        setError(null);\n        setText(\"\");\n        return true;\n      } else if (visibleTouched) {\n        if (isPasswordVisible) {\n          isPasswordVisible = false;\n          setInputType(InputType.TYPE_TEXT_VARIATION_PASSWORD | InputType.TYPE_CLASS_TEXT);\n          setSelection(getText().length());\n          invalidate();\n        } else {\n          isPasswordVisible = true;\n          setInputType(InputType.TYPE_TEXT_VARIATION_VISIBLE_PASSWORD);\n          setSelection(getText().length());\n          invalidate();\n        }\n        return true;\n      }\n    }\n    return super.onTouchEvent(event);\n  }\n\n  // 开始晃动的入口\n  public void startShakeAnimation() {\n    if (getAnimation() == null) {\n      setAnimation(shakeAnimation(4));\n    }\n    startAnimation(getAnimation());\n  }\n\n  /**\n   * 晃动动画\n   *\n   * @param counts 0.5秒钟晃动多少下\n   * @return\n   */\n  private Animation shakeAnimation(int counts) {\n    Animation translateAnimation = new TranslateAnimation(0, 10, 0, 0);\n    translateAnimation.setInterpolator(new CycleInterpolator(counts));\n    translateAnimation.setDuration(500);\n    return translateAnimation;\n  }\n\n  private Bitmap createBitmap(Context context, int resId, int defResId) {\n    if (resId != 0) {\n      return BitmapFactory.decodeResource(context.getResources(), resId);\n    } else {\n      return BitmapFactory.decodeResource(context.getResources(), defResId);\n    }\n  }\n}\n\n```\n\n这个类里面会用到values目录中的attrs.xml 和 dimens.xml 如果没有就自行创建\n\n##### 2、往attrs.xml中写入自定义EditText的属性\n\n```xml\n\n<resources>\n <!--  自定义EditText的属性-->\n  <declare-styleable name=\"PowerfulEditText\">\n    <!--图片资源-->\n    <attr name=\"clearDrawable\" format=\"reference\" />\n    <attr name=\"visibleDrawable\" format=\"reference\" />\n    <attr name=\"invisibleDrawable\" format=\"reference\" />\n    <!--按钮宽度大小-->\n    <attr name=\"BtnWidth\" format=\"dimension\" />\n    <!--按钮间距大小-->\n    <attr name=\"BtnSpacing\" format=\"dimension\" />\n    <!--边框颜色和样式-->\n    <attr name=\"styleColor\" format=\"color\" />\n    <attr name=\"borderStyle\" format=\"string\" />\n  </declare-styleable>\n</resources>\n\n```\n\n##### 3、往dimens.xml中写入一些大小配置\n\n```xml\n\n<resources>\n  <!-- Default screen margins, per the Android Design guidelines. 自定义editText的属性设置 -->\n  <dimen name=\"activity_horizontal_margin\">16dp</dimen>\n  <dimen name=\"activity_vertical_margin\">16dp</dimen>\n  <!--按钮间距大小-->\n  <dimen name=\"btn_edit_text_padding\">8dp</dimen>\n  <!--按钮宽度大小-->\n  <dimen name=\"btn_edit_text_width\">16dp</dimen>\n</resources>\n\n```\n\n##### 4、在布局文件中使用\n\n````xml\n\n<com.你的包名.widgets.PowerfulEditText\n          android:id=\"@+id/password_edit\"\n          android:layout_width=\"match_parent\"\n          android:layout_height=\"45dp\"\n          android:background=\"@null\"\n          android:paddingStart=\"12dp\"\n          android:textSize=\"15sp\"\n          android:hint=\"请输入密码\"\n          app:BtnWidth=\"@dimen/btn_edit_text_width\"\n          app:BtnSpacing=\"@dimen/btn_edit_text_padding\"\n          android:inputType=\"textPassword\"\n          tools:ignore=\"RtlSymmetry\" />\n\n````\n\n一共是7个样式可以在xml中使用\n\n```\n\napp:clearDrawable=\"@drawable/clear_all\"  \napp:visibleDrawable=\"@drawable/visible\"  \napp:invisibleDrawable=\"@drawable/invisible\"  \napp:BtnWidth=\"@dimen/btn_edittext_width\"  \napp:BtnSpacing=\"@dimen/btn_edittext_padding\"  \napp:borderStyle=\"halfRect\"  \napp:styleColor=\"#ff0000\"  \n\n```\n\n其中，边框样式的对应规则如下。\n\n```\n\n1、矩形样式：         app:borderStyle=\"rectangle\"\n\n2、半矩形样式：       app:borderStyle=\"halfRect\"\n\n3、圆角矩形样式：     app:borderStyle=\"roundRect\"\n\n4、动画特效样式：     app:borderStyle=\"animator\"\n\n控件抖动的效果也是利用动画实现的。调用view实例的以下方法即可实现抖动。\n\nmPEditText.startShakeAnimation()\n\n```\n\n也可以使用依赖的方式去项目中用，不过如果作者不维护, 那你的项目也就需要改动了\n\n作者的[github链接](https://github.com/AndroidWJC/PowerfulEditText)\n","source":"_posts/Android自定义EditText一键清除和密文查看.md","raw":"---\ntitle: Android自定义EditText一键清除和密文查看\ndate: 2020-12-18 16:26:41\ncategories:\n- Android\ntags:\n- EditText\n- 密文\n- 一键清除\n---\n\n\n#### Android自定义EditText一键清除和密文查看\n\n* 先上截屏看一下效果\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/S01218-16245606.jpg)\n\n\n##### 自定义步骤\n\n##### 1、首先新建一个类PowerfulEditText.java 我放在了widgets目录中这个目录平时就用来存放一些自定义的类\n\n```java\n\n//  这个自定义EditText 有两个按钮 一键清空按钮 和 小眼睛查看明文\n//  isPassword 字段会根据输入框是否是密码框来决定是否会绘制小眼睛 很好用\npublic class PowerfulEditText extends androidx.appcompat.widget.AppCompatEditText {\n\n  private static final String TAG = \"PowerfulEditText.java\";\n\n  private static final int DEFAULT_CLEAR_RES = R.drawable.delete_edit;\n  private static final int DEFAULT_VISIBLE_RES = R.drawable.black_open_eyes;\n  private static final int DEFAULT_INVISIBLE_RES = R.drawable.black_close_eyes;\n\n  private static final int DEFAULT_STYLE_COLOR = Color.BLUE;\n\n  private final int DEFAULT_BUTTON_PADDING =\n    getResources().getDimensionPixelSize(R.dimen.btn_edit_text_padding);\n  private final int DEFAULT_BUTTON_WIDTH =\n    getResources().getDimensionPixelSize(R.dimen.btn_edit_text_width);\n\n  private static final String STYLE_RECT = \"rectangle\";\n  private static final String STYLE_ROUND_RECT = \"roundRect\";\n  private static final String STYLE_HALF_RECT = \"halfRect\";\n  private static final String STYLE_ANIMATOR = \"animator\";\n\n  private static final int DEFAULT_ROUND_RADIUS = 20;\n  private static final int ANIMATOR_TIME = 200;\n  private static final int DEFAULT_FOCUSED_STROKE_WIDTH = 8;\n  private static final int DEFAULT_UNFOCUSED_STROKE_WIDTH = 4;\n\n  //按钮间隔\n  private int mBtnPadding = 0;\n  //按钮宽度\n  private int mBtnWidth = 0;\n  //右内边距\n  private int mTextPaddingRight;\n\n  private int mClearResId = 0;\n  private int mVisibleResId = 0;\n  private int mInvisibleResId = 0;\n  private Bitmap mBitmapClear;\n  private Bitmap mBitmapVisible;\n  private Bitmap mBitmapInvisible;\n\n  private String mBorderStyle = \"\";\n  private int mStyleColor = -1;\n\n  //出现和消失动画\n  private ValueAnimator mGoneAnimator;\n  private ValueAnimator mVisibleAnimator;\n  //状态值\n  private boolean isBtnVisible = false;\n  // isPassword 字段会根据输入框是否是密码框来决定是否会绘制小眼睛\n  private boolean isPassword = false;\n  private boolean isPasswordVisible = false;\n\n  private boolean isAnimatorRunning = false;\n  private int mAnimatorProgress = 0;\n  private ObjectAnimator mAnimator;\n\n  //自定义属性动画\n  private static final Property<PowerfulEditText, Integer> BORDER_PROGRESS\n    = new Property<PowerfulEditText, Integer>(Integer.class, \"borderProgress\") {\n    @Override\n    public Integer get(PowerfulEditText powerfulEditText) {\n      return powerfulEditText.getBorderProgress();\n    }\n\n    @Override\n    public void set(PowerfulEditText powerfulEditText, Integer value) {\n      powerfulEditText.setBorderProgress(value);\n    }\n  };\n\n  private Paint mPaint;\n\n  public PowerfulEditText(Context context) {\n    this(context, null);\n  }\n\n  public PowerfulEditText(Context context, @Nullable AttributeSet attrs) {\n    super(context, attrs);\n    init(context, attrs);\n  }\n\n  public PowerfulEditText(Context context, @Nullable AttributeSet attrs, int defStyleAttr) {\n    super(context, attrs, defStyleAttr);\n    init(context, attrs);\n  }\n\n  private void init(Context context, AttributeSet attrs) {\n    //抗锯齿和位图滤波\n    mPaint = new Paint(Paint.ANTI_ALIAS_FLAG | Paint.FILTER_BITMAP_FLAG);\n\n    //读取xml文件中的配置\n    if (attrs != null) {\n      TypedArray array = context.obtainStyledAttributes(attrs, R.styleable.PowerfulEditText);\n      for (int i = 0; i < array.getIndexCount(); i++) {\n        int attr = array.getIndex(i);\n\n        switch (attr) {\n          case R.styleable.PowerfulEditText_clearDrawable:\n            mClearResId = array.getResourceId(attr, DEFAULT_CLEAR_RES);\n            break;\n\n          case R.styleable.PowerfulEditText_visibleDrawable:\n            mVisibleResId = array.getResourceId(attr, DEFAULT_VISIBLE_RES);\n            break;\n\n          case R.styleable.PowerfulEditText_invisibleDrawable:\n            mInvisibleResId = array.getResourceId(attr, DEFAULT_INVISIBLE_RES);\n            break;\n\n          case R.styleable.PowerfulEditText_BtnWidth:\n            mBtnWidth = array.getDimensionPixelSize(attr, DEFAULT_BUTTON_WIDTH);\n            break;\n\n          case R.styleable.PowerfulEditText_BtnSpacing:\n            mBtnPadding = array.getDimensionPixelSize(attr, DEFAULT_BUTTON_PADDING);\n            break;\n\n          case R.styleable.PowerfulEditText_borderStyle:\n            mBorderStyle = array.getString(attr);\n            break;\n\n          case R.styleable.PowerfulEditText_styleColor:\n            mStyleColor = array.getColor(attr, DEFAULT_STYLE_COLOR);\n            break;\n        }\n      }\n      array.recycle();\n    }\n\n    //初始化按钮显示的Bitmap\n    mBitmapClear = createBitmap(context, mClearResId, DEFAULT_CLEAR_RES);\n    mBitmapVisible = createBitmap(context, mVisibleResId, DEFAULT_VISIBLE_RES);\n    mBitmapInvisible = createBitmap(context, mInvisibleResId, DEFAULT_INVISIBLE_RES);\n    //如果自定义，则使用自定义的值，否则使用默认值\n    if (mBtnPadding == 0) {\n      mBtnPadding = DEFAULT_BUTTON_PADDING;\n    }\n    if (mBtnWidth == 0) {\n      mBtnWidth = DEFAULT_BUTTON_WIDTH;\n    }\n    //给文字设置一个padding，避免文字和按钮重叠了\n    mTextPaddingRight = mBtnPadding * 4 + mBtnWidth * 2;\n\n    //按钮出现和消失的动画\n    mGoneAnimator = ValueAnimator.ofFloat(1f, 0f).setDuration(ANIMATOR_TIME);\n    mVisibleAnimator = ValueAnimator.ofFloat(0f, 1f).setDuration(ANIMATOR_TIME);\n\n    //是否是密码样式\n    isPassword =\n      getInputType() == (InputType.TYPE_TEXT_VARIATION_PASSWORD | InputType.TYPE_CLASS_TEXT);\n\n  }\n\n  @Override\n  protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {\n    super.onMeasure(widthMeasureSpec, heightMeasureSpec);\n\n    //设置右内边距, 防止清除按钮和文字重叠\n    setPadding(getPaddingLeft(), getPaddingTop(), mTextPaddingRight, getPaddingBottom());\n  }\n\n  @Override\n  protected void onDraw(Canvas canvas) {\n    super.onDraw(canvas);\n\n    mPaint.setStyle(Paint.Style.STROKE);\n\n    //使用自定义颜色。如未定义，则使用默认颜色\n    if (mStyleColor != -1) {\n      mPaint.setColor(mStyleColor);\n    } else {\n      mPaint.setColor(DEFAULT_STYLE_COLOR);\n    }\n\n    //控件获取焦点时，加粗边框\n    if (isFocused()) {\n      mPaint.setStrokeWidth(DEFAULT_FOCUSED_STROKE_WIDTH);\n    } else {\n      mPaint.setStrokeWidth(DEFAULT_UNFOCUSED_STROKE_WIDTH);\n    }\n\n    //绘制边框\n    drawBorder(canvas);\n    //绘制清空和明文显示按钮\n    drawButtons(canvas);\n  }\n\n  private void drawBorder(Canvas canvas) {\n    int width = getWidth();\n    int height = getHeight();\n\n    switch (mBorderStyle) {\n      //矩形样式\n      case STYLE_RECT:\n        setBackground(null);\n        canvas.drawRect(0, 0, width, height, mPaint);\n        break;\n\n      //圆角矩形样式\n      case STYLE_ROUND_RECT:\n        setBackground(null);\n        float roundRectLineWidth = 0;\n        if (isFocused()) {\n          roundRectLineWidth = DEFAULT_FOCUSED_STROKE_WIDTH / 2;\n        } else {\n          roundRectLineWidth = DEFAULT_UNFOCUSED_STROKE_WIDTH / 2;\n        }\n        mPaint.setStrokeWidth(roundRectLineWidth);\n        if (Build.VERSION.SDK_INT >= 21) {\n          canvas.drawRoundRect(\n            roundRectLineWidth / 2, roundRectLineWidth / 2, width - roundRectLineWidth / 2, height - roundRectLineWidth / 2,\n            DEFAULT_ROUND_RADIUS, DEFAULT_ROUND_RADIUS,\n            mPaint);\n        } else {\n          canvas.drawRoundRect(\n            new RectF(roundRectLineWidth / 2, roundRectLineWidth / 2, width - roundRectLineWidth / 2, height - roundRectLineWidth / 2),\n            DEFAULT_ROUND_RADIUS, DEFAULT_ROUND_RADIUS,\n            mPaint);\n        }\n        break;\n\n      //半矩形样式\n      case STYLE_HALF_RECT:\n        setBackground(null);\n        canvas.drawLine(0, height, width, height, mPaint);\n        canvas.drawLine(0, height / 2, 0, height, mPaint);\n        canvas.drawLine(width, height / 2, width, height, mPaint);\n        break;\n\n      //动画特效样式\n      case STYLE_ANIMATOR:\n        setBackground(null);\n        if (isAnimatorRunning) {\n          canvas.drawLine(width / 2 - mAnimatorProgress, height, width / 2 + mAnimatorProgress, height, mPaint);\n          if (mAnimatorProgress == width / 2) {\n            isAnimatorRunning = false;\n          }\n        } else {\n          canvas.drawLine(0, height, width, height, mPaint);\n        }\n        break;\n    }\n  }\n\n  private void drawButtons(Canvas canvas) {\n    if (isBtnVisible) {\n      //播放按钮出现的动画\n      if (mVisibleAnimator.isRunning()) {\n        float scale = (float) mVisibleAnimator.getAnimatedValue();\n        drawClearButton(scale, canvas);\n        if (isPassword) {\n          drawVisibleButton(scale, canvas, isPasswordVisible);\n        }\n        invalidate();\n        //绘制静态的按钮\n      } else {\n        drawClearButton(1, canvas);\n        if (isPassword) {\n          drawVisibleButton(1, canvas, isPasswordVisible);\n        }\n      }\n    } else {\n      //播放按钮消失的动画\n      if (mGoneAnimator.isRunning()) {\n        float scale = (float) mGoneAnimator.getAnimatedValue();\n        drawClearButton(scale, canvas);\n        if (isPassword) {\n          drawVisibleButton(scale, canvas, isPasswordVisible);\n        }\n        invalidate();\n      }\n    }\n  }\n\n  private void drawClearButton(float scale, Canvas canvas) {\n\n    int right = (int) (getWidth() + getScrollX() - mBtnPadding - mBtnWidth * (1f - scale) / 2f);\n    int left = (int) (getWidth() + getScrollX() - mBtnPadding - mBtnWidth * (scale + (1f - scale) / 2f));\n    int top = (int) ((getHeight() - mBtnWidth * scale) / 2);\n    int bottom = (int) (top + mBtnWidth * scale);\n    Rect rect = new Rect(left, top, right, bottom);\n    canvas.drawBitmap(mBitmapClear, null, rect, mPaint);\n  }\n\n  private void drawVisibleButton(float scale, Canvas canvas, boolean isVisible) {\n\n    int right = (int) (getWidth() + getScrollX() - mBtnPadding * 3 - mBtnWidth - mBtnWidth * (1f - scale) / 2f);\n    int left = (int) (getWidth() + getScrollX() - mBtnPadding * 3 - mBtnWidth - mBtnWidth * (scale + (1f - scale) / 2f));\n    int top = (int) ((getHeight() - mBtnWidth * scale) / 2);\n    int bottom = (int) (top + mBtnWidth * scale);\n    Rect rect = new Rect(left, top, right, bottom);\n    if (isVisible) {\n      canvas.drawBitmap(mBitmapVisible, null, rect, mPaint);\n    } else {\n      canvas.drawBitmap(mBitmapInvisible, null, rect, mPaint);\n    }\n\n  }\n\n  // 清除按钮出现时的动画效果\n  private void startVisibleAnimator() {\n    endAllAnimator();\n    mVisibleAnimator.start();\n    invalidate();\n  }\n\n  // 清除按钮消失时的动画效果\n  private void startGoneAnimator() {\n    endAllAnimator();\n    mGoneAnimator.start();\n    invalidate();\n  }\n\n  // 结束所有动画\n  private void endAllAnimator() {\n    mGoneAnimator.end();\n    mVisibleAnimator.end();\n  }\n\n  @Override\n  protected void onFocusChanged(boolean focused, int direction, Rect previouslyFocusedRect) {\n    super.onFocusChanged(focused, direction, previouslyFocusedRect);\n\n    //播放按钮出现和消失动画\n    if (focused && getText().length() > 0) {\n      if (!isBtnVisible) {\n        isBtnVisible = true;\n        startVisibleAnimator();\n      }\n    } else {\n      if (isBtnVisible) {\n        isBtnVisible = false;\n        startGoneAnimator();\n      }\n    }\n\n    //实现动画特效样式\n    if (focused && mBorderStyle.equals(STYLE_ANIMATOR)) {\n      isAnimatorRunning = true;\n      mAnimator = ObjectAnimator.ofInt(this, BORDER_PROGRESS, 0, getWidth() / 2);\n      mAnimator.setDuration(ANIMATOR_TIME);\n      mAnimator.start();\n    }\n  }\n\n  protected void setBorderProgress(int borderProgress) {\n    mAnimatorProgress = borderProgress;\n    postInvalidate();\n  }\n\n  protected int getBorderProgress() {\n    return mAnimatorProgress;\n  }\n\n  @Override\n  protected void onTextChanged(CharSequence text, int start, int lengthBefore, int lengthAfter) {\n    super.onTextChanged(text, start, lengthBefore, lengthAfter);\n\n    if (text.length() > 0 && isFocused()) {\n      if (!isBtnVisible) {\n        isBtnVisible = true;\n        startVisibleAnimator();\n      }\n    } else {\n      if (isBtnVisible) {\n        isBtnVisible = false;\n        startGoneAnimator();\n      }\n    }\n  }\n\n  @Override\n  public boolean onTouchEvent(MotionEvent event) {\n    if (event.getAction() == MotionEvent.ACTION_UP) {\n\n      boolean clearTouched =\n        (getWidth() - mBtnPadding - mBtnWidth < event.getX())\n          && (event.getX() < getWidth() - mBtnPadding)\n          && isFocused();\n      boolean visibleTouched =\n        (getWidth() - mBtnPadding * 3 - mBtnWidth * 2 < event.getX())\n          && (event.getX() < getWidth() - mBtnPadding * 3 - mBtnWidth)\n          && isPassword && isFocused();\n\n      if (clearTouched) {\n        setError(null);\n        setText(\"\");\n        return true;\n      } else if (visibleTouched) {\n        if (isPasswordVisible) {\n          isPasswordVisible = false;\n          setInputType(InputType.TYPE_TEXT_VARIATION_PASSWORD | InputType.TYPE_CLASS_TEXT);\n          setSelection(getText().length());\n          invalidate();\n        } else {\n          isPasswordVisible = true;\n          setInputType(InputType.TYPE_TEXT_VARIATION_VISIBLE_PASSWORD);\n          setSelection(getText().length());\n          invalidate();\n        }\n        return true;\n      }\n    }\n    return super.onTouchEvent(event);\n  }\n\n  // 开始晃动的入口\n  public void startShakeAnimation() {\n    if (getAnimation() == null) {\n      setAnimation(shakeAnimation(4));\n    }\n    startAnimation(getAnimation());\n  }\n\n  /**\n   * 晃动动画\n   *\n   * @param counts 0.5秒钟晃动多少下\n   * @return\n   */\n  private Animation shakeAnimation(int counts) {\n    Animation translateAnimation = new TranslateAnimation(0, 10, 0, 0);\n    translateAnimation.setInterpolator(new CycleInterpolator(counts));\n    translateAnimation.setDuration(500);\n    return translateAnimation;\n  }\n\n  private Bitmap createBitmap(Context context, int resId, int defResId) {\n    if (resId != 0) {\n      return BitmapFactory.decodeResource(context.getResources(), resId);\n    } else {\n      return BitmapFactory.decodeResource(context.getResources(), defResId);\n    }\n  }\n}\n\n```\n\n这个类里面会用到values目录中的attrs.xml 和 dimens.xml 如果没有就自行创建\n\n##### 2、往attrs.xml中写入自定义EditText的属性\n\n```xml\n\n<resources>\n <!--  自定义EditText的属性-->\n  <declare-styleable name=\"PowerfulEditText\">\n    <!--图片资源-->\n    <attr name=\"clearDrawable\" format=\"reference\" />\n    <attr name=\"visibleDrawable\" format=\"reference\" />\n    <attr name=\"invisibleDrawable\" format=\"reference\" />\n    <!--按钮宽度大小-->\n    <attr name=\"BtnWidth\" format=\"dimension\" />\n    <!--按钮间距大小-->\n    <attr name=\"BtnSpacing\" format=\"dimension\" />\n    <!--边框颜色和样式-->\n    <attr name=\"styleColor\" format=\"color\" />\n    <attr name=\"borderStyle\" format=\"string\" />\n  </declare-styleable>\n</resources>\n\n```\n\n##### 3、往dimens.xml中写入一些大小配置\n\n```xml\n\n<resources>\n  <!-- Default screen margins, per the Android Design guidelines. 自定义editText的属性设置 -->\n  <dimen name=\"activity_horizontal_margin\">16dp</dimen>\n  <dimen name=\"activity_vertical_margin\">16dp</dimen>\n  <!--按钮间距大小-->\n  <dimen name=\"btn_edit_text_padding\">8dp</dimen>\n  <!--按钮宽度大小-->\n  <dimen name=\"btn_edit_text_width\">16dp</dimen>\n</resources>\n\n```\n\n##### 4、在布局文件中使用\n\n````xml\n\n<com.你的包名.widgets.PowerfulEditText\n          android:id=\"@+id/password_edit\"\n          android:layout_width=\"match_parent\"\n          android:layout_height=\"45dp\"\n          android:background=\"@null\"\n          android:paddingStart=\"12dp\"\n          android:textSize=\"15sp\"\n          android:hint=\"请输入密码\"\n          app:BtnWidth=\"@dimen/btn_edit_text_width\"\n          app:BtnSpacing=\"@dimen/btn_edit_text_padding\"\n          android:inputType=\"textPassword\"\n          tools:ignore=\"RtlSymmetry\" />\n\n````\n\n一共是7个样式可以在xml中使用\n\n```\n\napp:clearDrawable=\"@drawable/clear_all\"  \napp:visibleDrawable=\"@drawable/visible\"  \napp:invisibleDrawable=\"@drawable/invisible\"  \napp:BtnWidth=\"@dimen/btn_edittext_width\"  \napp:BtnSpacing=\"@dimen/btn_edittext_padding\"  \napp:borderStyle=\"halfRect\"  \napp:styleColor=\"#ff0000\"  \n\n```\n\n其中，边框样式的对应规则如下。\n\n```\n\n1、矩形样式：         app:borderStyle=\"rectangle\"\n\n2、半矩形样式：       app:borderStyle=\"halfRect\"\n\n3、圆角矩形样式：     app:borderStyle=\"roundRect\"\n\n4、动画特效样式：     app:borderStyle=\"animator\"\n\n控件抖动的效果也是利用动画实现的。调用view实例的以下方法即可实现抖动。\n\nmPEditText.startShakeAnimation()\n\n```\n\n也可以使用依赖的方式去项目中用，不过如果作者不维护, 那你的项目也就需要改动了\n\n作者的[github链接](https://github.com/AndroidWJC/PowerfulEditText)\n","slug":"Android自定义EditText一键清除和密文查看","published":1,"updated":"2020-12-18T08:50:55.507Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwc000p3ys20fm4en1w","content":"<h4 id=\"Android自定义EditText一键清除和密文查看\"><a href=\"#Android自定义EditText一键清除和密文查看\" class=\"headerlink\" title=\"Android自定义EditText一键清除和密文查看\"></a>Android自定义EditText一键清除和密文查看</h4><ul>\n<li>先上截屏看一下效果<br><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/S01218-16245606.jpg\"></li>\n</ul>\n<h5 id=\"自定义步骤\"><a href=\"#自定义步骤\" class=\"headerlink\" title=\"自定义步骤\"></a>自定义步骤</h5><h5 id=\"1、首先新建一个类PowerfulEditText-java-我放在了widgets目录中这个目录平时就用来存放一些自定义的类\"><a href=\"#1、首先新建一个类PowerfulEditText-java-我放在了widgets目录中这个目录平时就用来存放一些自定义的类\" class=\"headerlink\" title=\"1、首先新建一个类PowerfulEditText.java 我放在了widgets目录中这个目录平时就用来存放一些自定义的类\"></a>1、首先新建一个类PowerfulEditText.java 我放在了widgets目录中这个目录平时就用来存放一些自定义的类</h5><pre class=\"line-numbers language-java\"><code class=\"language-java\">\n<span class=\"token comment\" spellcheck=\"true\">//  这个自定义EditText 有两个按钮 一键清空按钮 和 小眼睛查看明文</span>\n<span class=\"token comment\" spellcheck=\"true\">//  isPassword 字段会根据输入框是否是密码框来决定是否会绘制小眼睛 很好用</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PowerfulEditText</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">androidx<span class=\"token punctuation\">.</span>appcompat<span class=\"token punctuation\">.</span>widget<span class=\"token punctuation\">.</span>AppCompatEditText</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> String TAG <span class=\"token operator\">=</span> <span class=\"token string\">\"PowerfulEditText.java\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> DEFAULT_CLEAR_RES <span class=\"token operator\">=</span> R<span class=\"token punctuation\">.</span>drawable<span class=\"token punctuation\">.</span>delete_edit<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> DEFAULT_VISIBLE_RES <span class=\"token operator\">=</span> R<span class=\"token punctuation\">.</span>drawable<span class=\"token punctuation\">.</span>black_open_eyes<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> DEFAULT_INVISIBLE_RES <span class=\"token operator\">=</span> R<span class=\"token punctuation\">.</span>drawable<span class=\"token punctuation\">.</span>black_close_eyes<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> DEFAULT_STYLE_COLOR <span class=\"token operator\">=</span> Color<span class=\"token punctuation\">.</span>BLUE<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> DEFAULT_BUTTON_PADDING <span class=\"token operator\">=</span>\n    <span class=\"token function\">getResources</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getDimensionPixelSize</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>dimen<span class=\"token punctuation\">.</span>btn_edit_text_padding<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> DEFAULT_BUTTON_WIDTH <span class=\"token operator\">=</span>\n    <span class=\"token function\">getResources</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getDimensionPixelSize</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>dimen<span class=\"token punctuation\">.</span>btn_edit_text_width<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> String STYLE_RECT <span class=\"token operator\">=</span> <span class=\"token string\">\"rectangle\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> String STYLE_ROUND_RECT <span class=\"token operator\">=</span> <span class=\"token string\">\"roundRect\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> String STYLE_HALF_RECT <span class=\"token operator\">=</span> <span class=\"token string\">\"halfRect\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> String STYLE_ANIMATOR <span class=\"token operator\">=</span> <span class=\"token string\">\"animator\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> DEFAULT_ROUND_RADIUS <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> ANIMATOR_TIME <span class=\"token operator\">=</span> <span class=\"token number\">200</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> DEFAULT_FOCUSED_STROKE_WIDTH <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> DEFAULT_UNFOCUSED_STROKE_WIDTH <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">//按钮间隔</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> mBtnPadding <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\" spellcheck=\"true\">//按钮宽度</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> mBtnWidth <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\" spellcheck=\"true\">//右内边距</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> mTextPaddingRight<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> mClearResId <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> mVisibleResId <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> mInvisibleResId <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> Bitmap mBitmapClear<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> Bitmap mBitmapVisible<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> Bitmap mBitmapInvisible<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">private</span> String mBorderStyle <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> mStyleColor <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">//出现和消失动画</span>\n  <span class=\"token keyword\">private</span> ValueAnimator mGoneAnimator<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> ValueAnimator mVisibleAnimator<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\" spellcheck=\"true\">//状态值</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">boolean</span> isBtnVisible <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\" spellcheck=\"true\">// isPassword 字段会根据输入框是否是密码框来决定是否会绘制小眼睛</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">boolean</span> isPassword <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">boolean</span> isPasswordVisible <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">boolean</span> isAnimatorRunning <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> mAnimatorProgress <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> ObjectAnimator mAnimator<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">//自定义属性动画</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> Property<span class=\"token operator\">&lt;</span>PowerfulEditText<span class=\"token punctuation\">,</span> Integer<span class=\"token operator\">></span> BORDER_PROGRESS\n    <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Property</span><span class=\"token operator\">&lt;</span>PowerfulEditText<span class=\"token punctuation\">,</span> Integer<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>Integer<span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"borderProgress\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> Integer <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>PowerfulEditText powerfulEditText<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> powerfulEditText<span class=\"token punctuation\">.</span><span class=\"token function\">getBorderProgress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">set</span><span class=\"token punctuation\">(</span>PowerfulEditText powerfulEditText<span class=\"token punctuation\">,</span> Integer value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      powerfulEditText<span class=\"token punctuation\">.</span><span class=\"token function\">setBorderProgress</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">private</span> Paint mPaint<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">PowerfulEditText</span><span class=\"token punctuation\">(</span>Context context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> null<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">PowerfulEditText</span><span class=\"token punctuation\">(</span>Context context<span class=\"token punctuation\">,</span> <span class=\"token annotation punctuation\">@Nullable</span> AttributeSet attrs<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> attrs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">init</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> attrs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">PowerfulEditText</span><span class=\"token punctuation\">(</span>Context context<span class=\"token punctuation\">,</span> <span class=\"token annotation punctuation\">@Nullable</span> AttributeSet attrs<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> defStyleAttr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> attrs<span class=\"token punctuation\">,</span> defStyleAttr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">init</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> attrs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span>Context context<span class=\"token punctuation\">,</span> AttributeSet attrs<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\" spellcheck=\"true\">//抗锯齿和位图滤波</span>\n    mPaint <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Paint</span><span class=\"token punctuation\">(</span>Paint<span class=\"token punctuation\">.</span>ANTI_ALIAS_FLAG <span class=\"token operator\">|</span> Paint<span class=\"token punctuation\">.</span>FILTER_BITMAP_FLAG<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//读取xml文件中的配置</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>attrs <span class=\"token operator\">!=</span> null<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      TypedArray array <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">obtainStyledAttributes</span><span class=\"token punctuation\">(</span>attrs<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">.</span>styleable<span class=\"token punctuation\">.</span>PowerfulEditText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> array<span class=\"token punctuation\">.</span><span class=\"token function\">getIndexCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">int</span> attr <span class=\"token operator\">=</span> array<span class=\"token punctuation\">.</span><span class=\"token function\">getIndex</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>attr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">case</span> R<span class=\"token punctuation\">.</span>styleable<span class=\"token punctuation\">.</span>PowerfulEditText_clearDrawable<span class=\"token operator\">:</span>\n            mClearResId <span class=\"token operator\">=</span> array<span class=\"token punctuation\">.</span><span class=\"token function\">getResourceId</span><span class=\"token punctuation\">(</span>attr<span class=\"token punctuation\">,</span> DEFAULT_CLEAR_RES<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\n          <span class=\"token keyword\">case</span> R<span class=\"token punctuation\">.</span>styleable<span class=\"token punctuation\">.</span>PowerfulEditText_visibleDrawable<span class=\"token operator\">:</span>\n            mVisibleResId <span class=\"token operator\">=</span> array<span class=\"token punctuation\">.</span><span class=\"token function\">getResourceId</span><span class=\"token punctuation\">(</span>attr<span class=\"token punctuation\">,</span> DEFAULT_VISIBLE_RES<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\n          <span class=\"token keyword\">case</span> R<span class=\"token punctuation\">.</span>styleable<span class=\"token punctuation\">.</span>PowerfulEditText_invisibleDrawable<span class=\"token operator\">:</span>\n            mInvisibleResId <span class=\"token operator\">=</span> array<span class=\"token punctuation\">.</span><span class=\"token function\">getResourceId</span><span class=\"token punctuation\">(</span>attr<span class=\"token punctuation\">,</span> DEFAULT_INVISIBLE_RES<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\n          <span class=\"token keyword\">case</span> R<span class=\"token punctuation\">.</span>styleable<span class=\"token punctuation\">.</span>PowerfulEditText_BtnWidth<span class=\"token operator\">:</span>\n            mBtnWidth <span class=\"token operator\">=</span> array<span class=\"token punctuation\">.</span><span class=\"token function\">getDimensionPixelSize</span><span class=\"token punctuation\">(</span>attr<span class=\"token punctuation\">,</span> DEFAULT_BUTTON_WIDTH<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\n          <span class=\"token keyword\">case</span> R<span class=\"token punctuation\">.</span>styleable<span class=\"token punctuation\">.</span>PowerfulEditText_BtnSpacing<span class=\"token operator\">:</span>\n            mBtnPadding <span class=\"token operator\">=</span> array<span class=\"token punctuation\">.</span><span class=\"token function\">getDimensionPixelSize</span><span class=\"token punctuation\">(</span>attr<span class=\"token punctuation\">,</span> DEFAULT_BUTTON_PADDING<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\n          <span class=\"token keyword\">case</span> R<span class=\"token punctuation\">.</span>styleable<span class=\"token punctuation\">.</span>PowerfulEditText_borderStyle<span class=\"token operator\">:</span>\n            mBorderStyle <span class=\"token operator\">=</span> array<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span>attr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\n          <span class=\"token keyword\">case</span> R<span class=\"token punctuation\">.</span>styleable<span class=\"token punctuation\">.</span>PowerfulEditText_styleColor<span class=\"token operator\">:</span>\n            mStyleColor <span class=\"token operator\">=</span> array<span class=\"token punctuation\">.</span><span class=\"token function\">getColor</span><span class=\"token punctuation\">(</span>attr<span class=\"token punctuation\">,</span> DEFAULT_STYLE_COLOR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n      array<span class=\"token punctuation\">.</span><span class=\"token function\">recycle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//初始化按钮显示的Bitmap</span>\n    mBitmapClear <span class=\"token operator\">=</span> <span class=\"token function\">createBitmap</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> mClearResId<span class=\"token punctuation\">,</span> DEFAULT_CLEAR_RES<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mBitmapVisible <span class=\"token operator\">=</span> <span class=\"token function\">createBitmap</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> mVisibleResId<span class=\"token punctuation\">,</span> DEFAULT_VISIBLE_RES<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mBitmapInvisible <span class=\"token operator\">=</span> <span class=\"token function\">createBitmap</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> mInvisibleResId<span class=\"token punctuation\">,</span> DEFAULT_INVISIBLE_RES<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">//如果自定义，则使用自定义的值，否则使用默认值</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mBtnPadding <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      mBtnPadding <span class=\"token operator\">=</span> DEFAULT_BUTTON_PADDING<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mBtnWidth <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      mBtnWidth <span class=\"token operator\">=</span> DEFAULT_BUTTON_WIDTH<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\" spellcheck=\"true\">//给文字设置一个padding，避免文字和按钮重叠了</span>\n    mTextPaddingRight <span class=\"token operator\">=</span> mBtnPadding <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> mBtnWidth <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//按钮出现和消失的动画</span>\n    mGoneAnimator <span class=\"token operator\">=</span> ValueAnimator<span class=\"token punctuation\">.</span><span class=\"token function\">ofFloat</span><span class=\"token punctuation\">(</span><span class=\"token number\">1f</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setDuration</span><span class=\"token punctuation\">(</span>ANIMATOR_TIME<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mVisibleAnimator <span class=\"token operator\">=</span> ValueAnimator<span class=\"token punctuation\">.</span><span class=\"token function\">ofFloat</span><span class=\"token punctuation\">(</span><span class=\"token number\">0f</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setDuration</span><span class=\"token punctuation\">(</span>ANIMATOR_TIME<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//是否是密码样式</span>\n    isPassword <span class=\"token operator\">=</span>\n      <span class=\"token function\">getInputType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token punctuation\">(</span>InputType<span class=\"token punctuation\">.</span>TYPE_TEXT_VARIATION_PASSWORD <span class=\"token operator\">|</span> InputType<span class=\"token punctuation\">.</span>TYPE_CLASS_TEXT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onMeasure</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> widthMeasureSpec<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> heightMeasureSpec<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onMeasure</span><span class=\"token punctuation\">(</span>widthMeasureSpec<span class=\"token punctuation\">,</span> heightMeasureSpec<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//设置右内边距, 防止清除按钮和文字重叠</span>\n    <span class=\"token function\">setPadding</span><span class=\"token punctuation\">(</span><span class=\"token function\">getPaddingLeft</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">getPaddingTop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> mTextPaddingRight<span class=\"token punctuation\">,</span> <span class=\"token function\">getPaddingBottom</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onDraw</span><span class=\"token punctuation\">(</span>Canvas canvas<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onDraw</span><span class=\"token punctuation\">(</span>canvas<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    mPaint<span class=\"token punctuation\">.</span><span class=\"token function\">setStyle</span><span class=\"token punctuation\">(</span>Paint<span class=\"token punctuation\">.</span>Style<span class=\"token punctuation\">.</span>STROKE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//使用自定义颜色。如未定义，则使用默认颜色</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mStyleColor <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      mPaint<span class=\"token punctuation\">.</span><span class=\"token function\">setColor</span><span class=\"token punctuation\">(</span>mStyleColor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      mPaint<span class=\"token punctuation\">.</span><span class=\"token function\">setColor</span><span class=\"token punctuation\">(</span>DEFAULT_STYLE_COLOR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//控件获取焦点时，加粗边框</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isFocused</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      mPaint<span class=\"token punctuation\">.</span><span class=\"token function\">setStrokeWidth</span><span class=\"token punctuation\">(</span>DEFAULT_FOCUSED_STROKE_WIDTH<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      mPaint<span class=\"token punctuation\">.</span><span class=\"token function\">setStrokeWidth</span><span class=\"token punctuation\">(</span>DEFAULT_UNFOCUSED_STROKE_WIDTH<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//绘制边框</span>\n    <span class=\"token function\">drawBorder</span><span class=\"token punctuation\">(</span>canvas<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">//绘制清空和明文显示按钮</span>\n    <span class=\"token function\">drawButtons</span><span class=\"token punctuation\">(</span>canvas<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">drawBorder</span><span class=\"token punctuation\">(</span>Canvas canvas<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> width <span class=\"token operator\">=</span> <span class=\"token function\">getWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> height <span class=\"token operator\">=</span> <span class=\"token function\">getHeight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>mBorderStyle<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\" spellcheck=\"true\">//矩形样式</span>\n      <span class=\"token keyword\">case</span> STYLE_RECT<span class=\"token operator\">:</span>\n        <span class=\"token function\">setBackground</span><span class=\"token punctuation\">(</span>null<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        canvas<span class=\"token punctuation\">.</span><span class=\"token function\">drawRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> mPaint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\" spellcheck=\"true\">//圆角矩形样式</span>\n      <span class=\"token keyword\">case</span> STYLE_ROUND_RECT<span class=\"token operator\">:</span>\n        <span class=\"token function\">setBackground</span><span class=\"token punctuation\">(</span>null<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">float</span> roundRectLineWidth <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isFocused</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          roundRectLineWidth <span class=\"token operator\">=</span> DEFAULT_FOCUSED_STROKE_WIDTH <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n          roundRectLineWidth <span class=\"token operator\">=</span> DEFAULT_UNFOCUSED_STROKE_WIDTH <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        mPaint<span class=\"token punctuation\">.</span><span class=\"token function\">setStrokeWidth</span><span class=\"token punctuation\">(</span>roundRectLineWidth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Build<span class=\"token punctuation\">.</span>VERSION<span class=\"token punctuation\">.</span>SDK_INT <span class=\"token operator\">>=</span> <span class=\"token number\">21</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          canvas<span class=\"token punctuation\">.</span><span class=\"token function\">drawRoundRect</span><span class=\"token punctuation\">(</span>\n            roundRectLineWidth <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> roundRectLineWidth <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> width <span class=\"token operator\">-</span> roundRectLineWidth <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> height <span class=\"token operator\">-</span> roundRectLineWidth <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n            DEFAULT_ROUND_RADIUS<span class=\"token punctuation\">,</span> DEFAULT_ROUND_RADIUS<span class=\"token punctuation\">,</span>\n            mPaint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n          canvas<span class=\"token punctuation\">.</span><span class=\"token function\">drawRoundRect</span><span class=\"token punctuation\">(</span>\n            <span class=\"token keyword\">new</span> <span class=\"token class-name\">RectF</span><span class=\"token punctuation\">(</span>roundRectLineWidth <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> roundRectLineWidth <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> width <span class=\"token operator\">-</span> roundRectLineWidth <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> height <span class=\"token operator\">-</span> roundRectLineWidth <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            DEFAULT_ROUND_RADIUS<span class=\"token punctuation\">,</span> DEFAULT_ROUND_RADIUS<span class=\"token punctuation\">,</span>\n            mPaint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\" spellcheck=\"true\">//半矩形样式</span>\n      <span class=\"token keyword\">case</span> STYLE_HALF_RECT<span class=\"token operator\">:</span>\n        <span class=\"token function\">setBackground</span><span class=\"token punctuation\">(</span>null<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        canvas<span class=\"token punctuation\">.</span><span class=\"token function\">drawLine</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> mPaint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        canvas<span class=\"token punctuation\">.</span><span class=\"token function\">drawLine</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> height <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> mPaint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        canvas<span class=\"token punctuation\">.</span><span class=\"token function\">drawLine</span><span class=\"token punctuation\">(</span>width<span class=\"token punctuation\">,</span> height <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> mPaint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\" spellcheck=\"true\">//动画特效样式</span>\n      <span class=\"token keyword\">case</span> STYLE_ANIMATOR<span class=\"token operator\">:</span>\n        <span class=\"token function\">setBackground</span><span class=\"token punctuation\">(</span>null<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isAnimatorRunning<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          canvas<span class=\"token punctuation\">.</span><span class=\"token function\">drawLine</span><span class=\"token punctuation\">(</span>width <span class=\"token operator\">/</span> <span class=\"token number\">2</span> <span class=\"token operator\">-</span> mAnimatorProgress<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> width <span class=\"token operator\">/</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> mAnimatorProgress<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> mPaint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mAnimatorProgress <span class=\"token operator\">==</span> width <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            isAnimatorRunning <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n          canvas<span class=\"token punctuation\">.</span><span class=\"token function\">drawLine</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> mPaint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">drawButtons</span><span class=\"token punctuation\">(</span>Canvas canvas<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isBtnVisible<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\" spellcheck=\"true\">//播放按钮出现的动画</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mVisibleAnimator<span class=\"token punctuation\">.</span><span class=\"token function\">isRunning</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">float</span> scale <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span> mVisibleAnimator<span class=\"token punctuation\">.</span><span class=\"token function\">getAnimatedValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">drawClearButton</span><span class=\"token punctuation\">(</span>scale<span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isPassword<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">drawVisibleButton</span><span class=\"token punctuation\">(</span>scale<span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">,</span> isPasswordVisible<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token function\">invalidate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\" spellcheck=\"true\">//绘制静态的按钮</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">drawClearButton</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isPassword<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">drawVisibleButton</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">,</span> isPasswordVisible<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\" spellcheck=\"true\">//播放按钮消失的动画</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mGoneAnimator<span class=\"token punctuation\">.</span><span class=\"token function\">isRunning</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">float</span> scale <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span> mGoneAnimator<span class=\"token punctuation\">.</span><span class=\"token function\">getAnimatedValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">drawClearButton</span><span class=\"token punctuation\">(</span>scale<span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isPassword<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">drawVisibleButton</span><span class=\"token punctuation\">(</span>scale<span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">,</span> isPasswordVisible<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token function\">invalidate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">drawClearButton</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> scale<span class=\"token punctuation\">,</span> Canvas canvas<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">int</span> right <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token function\">getWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">getScrollX</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> mBtnPadding <span class=\"token operator\">-</span> mBtnWidth <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1f</span> <span class=\"token operator\">-</span> scale<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> left <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token function\">getWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">getScrollX</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> mBtnPadding <span class=\"token operator\">-</span> mBtnWidth <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>scale <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1f</span> <span class=\"token operator\">-</span> scale<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> top <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token function\">getHeight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> mBtnWidth <span class=\"token operator\">*</span> scale<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> bottom <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>top <span class=\"token operator\">+</span> mBtnWidth <span class=\"token operator\">*</span> scale<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Rect rect <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Rect</span><span class=\"token punctuation\">(</span>left<span class=\"token punctuation\">,</span> top<span class=\"token punctuation\">,</span> right<span class=\"token punctuation\">,</span> bottom<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    canvas<span class=\"token punctuation\">.</span><span class=\"token function\">drawBitmap</span><span class=\"token punctuation\">(</span>mBitmapClear<span class=\"token punctuation\">,</span> null<span class=\"token punctuation\">,</span> rect<span class=\"token punctuation\">,</span> mPaint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">drawVisibleButton</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> scale<span class=\"token punctuation\">,</span> Canvas canvas<span class=\"token punctuation\">,</span> <span class=\"token keyword\">boolean</span> isVisible<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">int</span> right <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token function\">getWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">getScrollX</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> mBtnPadding <span class=\"token operator\">*</span> <span class=\"token number\">3</span> <span class=\"token operator\">-</span> mBtnWidth <span class=\"token operator\">-</span> mBtnWidth <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1f</span> <span class=\"token operator\">-</span> scale<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> left <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token function\">getWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">getScrollX</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> mBtnPadding <span class=\"token operator\">*</span> <span class=\"token number\">3</span> <span class=\"token operator\">-</span> mBtnWidth <span class=\"token operator\">-</span> mBtnWidth <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>scale <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1f</span> <span class=\"token operator\">-</span> scale<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> top <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token function\">getHeight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> mBtnWidth <span class=\"token operator\">*</span> scale<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> bottom <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>top <span class=\"token operator\">+</span> mBtnWidth <span class=\"token operator\">*</span> scale<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Rect rect <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Rect</span><span class=\"token punctuation\">(</span>left<span class=\"token punctuation\">,</span> top<span class=\"token punctuation\">,</span> right<span class=\"token punctuation\">,</span> bottom<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isVisible<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      canvas<span class=\"token punctuation\">.</span><span class=\"token function\">drawBitmap</span><span class=\"token punctuation\">(</span>mBitmapVisible<span class=\"token punctuation\">,</span> null<span class=\"token punctuation\">,</span> rect<span class=\"token punctuation\">,</span> mPaint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      canvas<span class=\"token punctuation\">.</span><span class=\"token function\">drawBitmap</span><span class=\"token punctuation\">(</span>mBitmapInvisible<span class=\"token punctuation\">,</span> null<span class=\"token punctuation\">,</span> rect<span class=\"token punctuation\">,</span> mPaint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">// 清除按钮出现时的动画效果</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">startVisibleAnimator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">endAllAnimator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mVisibleAnimator<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">invalidate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">// 清除按钮消失时的动画效果</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">startGoneAnimator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">endAllAnimator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mGoneAnimator<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">invalidate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">// 结束所有动画</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">endAllAnimator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    mGoneAnimator<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mVisibleAnimator<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onFocusChanged</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">boolean</span> focused<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> direction<span class=\"token punctuation\">,</span> Rect previouslyFocusedRect<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onFocusChanged</span><span class=\"token punctuation\">(</span>focused<span class=\"token punctuation\">,</span> direction<span class=\"token punctuation\">,</span> previouslyFocusedRect<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//播放按钮出现和消失动画</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>focused <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">getText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isBtnVisible<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        isBtnVisible <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">startVisibleAnimator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isBtnVisible<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        isBtnVisible <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">startGoneAnimator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">//实现动画特效样式</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>focused <span class=\"token operator\">&amp;&amp;</span> mBorderStyle<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>STYLE_ANIMATOR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      isAnimatorRunning <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n      mAnimator <span class=\"token operator\">=</span> ObjectAnimator<span class=\"token punctuation\">.</span><span class=\"token function\">ofInt</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> BORDER_PROGRESS<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">getWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      mAnimator<span class=\"token punctuation\">.</span><span class=\"token function\">setDuration</span><span class=\"token punctuation\">(</span>ANIMATOR_TIME<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      mAnimator<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setBorderProgress</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> borderProgress<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    mAnimatorProgress <span class=\"token operator\">=</span> borderProgress<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">postInvalidate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">protected</span> <span class=\"token keyword\">int</span> <span class=\"token function\">getBorderProgress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> mAnimatorProgress<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onTextChanged</span><span class=\"token punctuation\">(</span>CharSequence text<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> start<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> lengthBefore<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> lengthAfter<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onTextChanged</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">,</span> start<span class=\"token punctuation\">,</span> lengthBefore<span class=\"token punctuation\">,</span> lengthAfter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">isFocused</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isBtnVisible<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        isBtnVisible <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">startVisibleAnimator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isBtnVisible<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        isBtnVisible <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">startGoneAnimator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">onTouchEvent</span><span class=\"token punctuation\">(</span>MotionEvent event<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span><span class=\"token function\">getAction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> MotionEvent<span class=\"token punctuation\">.</span>ACTION_UP<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n      <span class=\"token keyword\">boolean</span> clearTouched <span class=\"token operator\">=</span>\n        <span class=\"token punctuation\">(</span><span class=\"token function\">getWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> mBtnPadding <span class=\"token operator\">-</span> mBtnWidth <span class=\"token operator\">&lt;</span> event<span class=\"token punctuation\">.</span><span class=\"token function\">getX</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n          <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span><span class=\"token function\">getX</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token function\">getWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> mBtnPadding<span class=\"token punctuation\">)</span>\n          <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">isFocused</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">boolean</span> visibleTouched <span class=\"token operator\">=</span>\n        <span class=\"token punctuation\">(</span><span class=\"token function\">getWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> mBtnPadding <span class=\"token operator\">*</span> <span class=\"token number\">3</span> <span class=\"token operator\">-</span> mBtnWidth <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">&lt;</span> event<span class=\"token punctuation\">.</span><span class=\"token function\">getX</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n          <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span><span class=\"token function\">getX</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token function\">getWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> mBtnPadding <span class=\"token operator\">*</span> <span class=\"token number\">3</span> <span class=\"token operator\">-</span> mBtnWidth<span class=\"token punctuation\">)</span>\n          <span class=\"token operator\">&amp;&amp;</span> isPassword <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">isFocused</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>clearTouched<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">setError</span><span class=\"token punctuation\">(</span>null<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">setText</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>visibleTouched<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isPasswordVisible<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          isPasswordVisible <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">setInputType</span><span class=\"token punctuation\">(</span>InputType<span class=\"token punctuation\">.</span>TYPE_TEXT_VARIATION_PASSWORD <span class=\"token operator\">|</span> InputType<span class=\"token punctuation\">.</span>TYPE_CLASS_TEXT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">setSelection</span><span class=\"token punctuation\">(</span><span class=\"token function\">getText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">invalidate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n          isPasswordVisible <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">setInputType</span><span class=\"token punctuation\">(</span>InputType<span class=\"token punctuation\">.</span>TYPE_TEXT_VARIATION_VISIBLE_PASSWORD<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">setSelection</span><span class=\"token punctuation\">(</span><span class=\"token function\">getText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">invalidate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onTouchEvent</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">// 开始晃动的入口</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">startShakeAnimation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">getAnimation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> null<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setAnimation</span><span class=\"token punctuation\">(</span><span class=\"token function\">shakeAnimation</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">startAnimation</span><span class=\"token punctuation\">(</span><span class=\"token function\">getAnimation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">/**\n   * 晃动动画\n   *\n   * @param counts 0.5秒钟晃动多少下\n   * @return\n   */</span>\n  <span class=\"token keyword\">private</span> Animation <span class=\"token function\">shakeAnimation</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> counts<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    Animation translateAnimation <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TranslateAnimation</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    translateAnimation<span class=\"token punctuation\">.</span><span class=\"token function\">setInterpolator</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">CycleInterpolator</span><span class=\"token punctuation\">(</span>counts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    translateAnimation<span class=\"token punctuation\">.</span><span class=\"token function\">setDuration</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> translateAnimation<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> Bitmap <span class=\"token function\">createBitmap</span><span class=\"token punctuation\">(</span>Context context<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> resId<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> defResId<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>resId <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> BitmapFactory<span class=\"token punctuation\">.</span><span class=\"token function\">decodeResource</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">getResources</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> resId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> BitmapFactory<span class=\"token punctuation\">.</span><span class=\"token function\">decodeResource</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">getResources</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> defResId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>这个类里面会用到values目录中的attrs.xml 和 dimens.xml 如果没有就自行创建</p>\n<h5 id=\"2、往attrs-xml中写入自定义EditText的属性\"><a href=\"#2、往attrs-xml中写入自定义EditText的属性\" class=\"headerlink\" title=\"2、往attrs.xml中写入自定义EditText的属性\"></a>2、往attrs.xml中写入自定义EditText的属性</h5><pre class=\"line-numbers language-xml\"><code class=\"language-xml\">\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resources</span><span class=\"token punctuation\">></span></span>\n <span class=\"token comment\" spellcheck=\"true\">&lt;!--  自定义EditText的属性--></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>declare-styleable</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>PowerfulEditText<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token comment\" spellcheck=\"true\">&lt;!--图片资源--></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>attr</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>clearDrawable<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">format</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>reference<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>attr</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>visibleDrawable<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">format</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>reference<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>attr</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>invisibleDrawable<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">format</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>reference<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token comment\" spellcheck=\"true\">&lt;!--按钮宽度大小--></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>attr</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>BtnWidth<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">format</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>dimension<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token comment\" spellcheck=\"true\">&lt;!--按钮间距大小--></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>attr</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>BtnSpacing<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">format</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>dimension<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token comment\" spellcheck=\"true\">&lt;!--边框颜色和样式--></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>attr</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>styleColor<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">format</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>color<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>attr</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>borderStyle<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">format</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>string<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>declare-styleable</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resources</span><span class=\"token punctuation\">></span></span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h5 id=\"3、往dimens-xml中写入一些大小配置\"><a href=\"#3、往dimens-xml中写入一些大小配置\" class=\"headerlink\" title=\"3、往dimens.xml中写入一些大小配置\"></a>3、往dimens.xml中写入一些大小配置</h5><pre class=\"line-numbers language-xml\"><code class=\"language-xml\">\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resources</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token comment\" spellcheck=\"true\">&lt;!-- Default screen margins, per the Android Design guidelines. 自定义editText的属性设置 --></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dimen</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>activity_horizontal_margin<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>16dp<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dimen</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dimen</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>activity_vertical_margin<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>16dp<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dimen</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token comment\" spellcheck=\"true\">&lt;!--按钮间距大小--></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dimen</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>btn_edit_text_padding<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>8dp<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dimen</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token comment\" spellcheck=\"true\">&lt;!--按钮宽度大小--></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dimen</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>btn_edit_text_width<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>16dp<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dimen</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resources</span><span class=\"token punctuation\">></span></span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h5 id=\"4、在布局文件中使用\"><a href=\"#4、在布局文件中使用\" class=\"headerlink\" title=\"4、在布局文件中使用\"></a>4、在布局文件中使用</h5><pre class=\"line-numbers language-xml\"><code class=\"language-xml\">\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>com.你的包名.widgets.PowerfulEditText</span>\n          <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>@+id/password_edit<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>match_parent<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>45dp<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>background</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>@null<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>paddingStart</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>12dp<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>textSize</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>15sp<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>hint</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>请输入密码<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\"><span class=\"token namespace\">app:</span>BtnWidth</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>@dimen/btn_edit_text_width<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\"><span class=\"token namespace\">app:</span>BtnSpacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>@dimen/btn_edit_text_padding<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>inputType</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>textPassword<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\"><span class=\"token namespace\">tools:</span>ignore</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>RtlSymmetry<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>一共是7个样式可以在xml中使用</p>\n<pre><code>\napp:clearDrawable=\"@drawable/clear_all\"  \napp:visibleDrawable=\"@drawable/visible\"  \napp:invisibleDrawable=\"@drawable/invisible\"  \napp:BtnWidth=\"@dimen/btn_edittext_width\"  \napp:BtnSpacing=\"@dimen/btn_edittext_padding\"  \napp:borderStyle=\"halfRect\"  \napp:styleColor=\"#ff0000\"  \n</code></pre>\n<p>其中，边框样式的对应规则如下。</p>\n<pre><code>\n1、矩形样式：         app:borderStyle=\"rectangle\"\n\n2、半矩形样式：       app:borderStyle=\"halfRect\"\n\n3、圆角矩形样式：     app:borderStyle=\"roundRect\"\n\n4、动画特效样式：     app:borderStyle=\"animator\"\n\n控件抖动的效果也是利用动画实现的。调用view实例的以下方法即可实现抖动。\n\nmPEditText.startShakeAnimation()\n</code></pre>\n<p>也可以使用依赖的方式去项目中用，不过如果作者不维护, 那你的项目也就需要改动了</p>\n<p>作者的<a href=\"https://github.com/AndroidWJC/PowerfulEditText\">github链接</a></p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"Android自定义EditText一键清除和密文查看\"><a href=\"#Android自定义EditText一键清除和密文查看\" class=\"headerlink\" title=\"Android自定义EditText一键清除和密文查看\"></a>Android自定义EditText一键清除和密文查看</h4><ul>\n<li>先上截屏看一下效果<br><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/S01218-16245606.jpg\"></li>\n</ul>\n<h5 id=\"自定义步骤\"><a href=\"#自定义步骤\" class=\"headerlink\" title=\"自定义步骤\"></a>自定义步骤</h5><h5 id=\"1、首先新建一个类PowerfulEditText-java-我放在了widgets目录中这个目录平时就用来存放一些自定义的类\"><a href=\"#1、首先新建一个类PowerfulEditText-java-我放在了widgets目录中这个目录平时就用来存放一些自定义的类\" class=\"headerlink\" title=\"1、首先新建一个类PowerfulEditText.java 我放在了widgets目录中这个目录平时就用来存放一些自定义的类\"></a>1、首先新建一个类PowerfulEditText.java 我放在了widgets目录中这个目录平时就用来存放一些自定义的类</h5><pre><code class=\"java\">\n//  这个自定义EditText 有两个按钮 一键清空按钮 和 小眼睛查看明文\n//  isPassword 字段会根据输入框是否是密码框来决定是否会绘制小眼睛 很好用\npublic class PowerfulEditText extends androidx.appcompat.widget.AppCompatEditText &#123;\n\n  private static final String TAG = &quot;PowerfulEditText.java&quot;;\n\n  private static final int DEFAULT_CLEAR_RES = R.drawable.delete_edit;\n  private static final int DEFAULT_VISIBLE_RES = R.drawable.black_open_eyes;\n  private static final int DEFAULT_INVISIBLE_RES = R.drawable.black_close_eyes;\n\n  private static final int DEFAULT_STYLE_COLOR = Color.BLUE;\n\n  private final int DEFAULT_BUTTON_PADDING =\n    getResources().getDimensionPixelSize(R.dimen.btn_edit_text_padding);\n  private final int DEFAULT_BUTTON_WIDTH =\n    getResources().getDimensionPixelSize(R.dimen.btn_edit_text_width);\n\n  private static final String STYLE_RECT = &quot;rectangle&quot;;\n  private static final String STYLE_ROUND_RECT = &quot;roundRect&quot;;\n  private static final String STYLE_HALF_RECT = &quot;halfRect&quot;;\n  private static final String STYLE_ANIMATOR = &quot;animator&quot;;\n\n  private static final int DEFAULT_ROUND_RADIUS = 20;\n  private static final int ANIMATOR_TIME = 200;\n  private static final int DEFAULT_FOCUSED_STROKE_WIDTH = 8;\n  private static final int DEFAULT_UNFOCUSED_STROKE_WIDTH = 4;\n\n  //按钮间隔\n  private int mBtnPadding = 0;\n  //按钮宽度\n  private int mBtnWidth = 0;\n  //右内边距\n  private int mTextPaddingRight;\n\n  private int mClearResId = 0;\n  private int mVisibleResId = 0;\n  private int mInvisibleResId = 0;\n  private Bitmap mBitmapClear;\n  private Bitmap mBitmapVisible;\n  private Bitmap mBitmapInvisible;\n\n  private String mBorderStyle = &quot;&quot;;\n  private int mStyleColor = -1;\n\n  //出现和消失动画\n  private ValueAnimator mGoneAnimator;\n  private ValueAnimator mVisibleAnimator;\n  //状态值\n  private boolean isBtnVisible = false;\n  // isPassword 字段会根据输入框是否是密码框来决定是否会绘制小眼睛\n  private boolean isPassword = false;\n  private boolean isPasswordVisible = false;\n\n  private boolean isAnimatorRunning = false;\n  private int mAnimatorProgress = 0;\n  private ObjectAnimator mAnimator;\n\n  //自定义属性动画\n  private static final Property&lt;PowerfulEditText, Integer&gt; BORDER_PROGRESS\n    = new Property&lt;PowerfulEditText, Integer&gt;(Integer.class, &quot;borderProgress&quot;) &#123;\n    @Override\n    public Integer get(PowerfulEditText powerfulEditText) &#123;\n      return powerfulEditText.getBorderProgress();\n    &#125;\n\n    @Override\n    public void set(PowerfulEditText powerfulEditText, Integer value) &#123;\n      powerfulEditText.setBorderProgress(value);\n    &#125;\n  &#125;;\n\n  private Paint mPaint;\n\n  public PowerfulEditText(Context context) &#123;\n    this(context, null);\n  &#125;\n\n  public PowerfulEditText(Context context, @Nullable AttributeSet attrs) &#123;\n    super(context, attrs);\n    init(context, attrs);\n  &#125;\n\n  public PowerfulEditText(Context context, @Nullable AttributeSet attrs, int defStyleAttr) &#123;\n    super(context, attrs, defStyleAttr);\n    init(context, attrs);\n  &#125;\n\n  private void init(Context context, AttributeSet attrs) &#123;\n    //抗锯齿和位图滤波\n    mPaint = new Paint(Paint.ANTI_ALIAS_FLAG | Paint.FILTER_BITMAP_FLAG);\n\n    //读取xml文件中的配置\n    if (attrs != null) &#123;\n      TypedArray array = context.obtainStyledAttributes(attrs, R.styleable.PowerfulEditText);\n      for (int i = 0; i &lt; array.getIndexCount(); i++) &#123;\n        int attr = array.getIndex(i);\n\n        switch (attr) &#123;\n          case R.styleable.PowerfulEditText_clearDrawable:\n            mClearResId = array.getResourceId(attr, DEFAULT_CLEAR_RES);\n            break;\n\n          case R.styleable.PowerfulEditText_visibleDrawable:\n            mVisibleResId = array.getResourceId(attr, DEFAULT_VISIBLE_RES);\n            break;\n\n          case R.styleable.PowerfulEditText_invisibleDrawable:\n            mInvisibleResId = array.getResourceId(attr, DEFAULT_INVISIBLE_RES);\n            break;\n\n          case R.styleable.PowerfulEditText_BtnWidth:\n            mBtnWidth = array.getDimensionPixelSize(attr, DEFAULT_BUTTON_WIDTH);\n            break;\n\n          case R.styleable.PowerfulEditText_BtnSpacing:\n            mBtnPadding = array.getDimensionPixelSize(attr, DEFAULT_BUTTON_PADDING);\n            break;\n\n          case R.styleable.PowerfulEditText_borderStyle:\n            mBorderStyle = array.getString(attr);\n            break;\n\n          case R.styleable.PowerfulEditText_styleColor:\n            mStyleColor = array.getColor(attr, DEFAULT_STYLE_COLOR);\n            break;\n        &#125;\n      &#125;\n      array.recycle();\n    &#125;\n\n    //初始化按钮显示的Bitmap\n    mBitmapClear = createBitmap(context, mClearResId, DEFAULT_CLEAR_RES);\n    mBitmapVisible = createBitmap(context, mVisibleResId, DEFAULT_VISIBLE_RES);\n    mBitmapInvisible = createBitmap(context, mInvisibleResId, DEFAULT_INVISIBLE_RES);\n    //如果自定义，则使用自定义的值，否则使用默认值\n    if (mBtnPadding == 0) &#123;\n      mBtnPadding = DEFAULT_BUTTON_PADDING;\n    &#125;\n    if (mBtnWidth == 0) &#123;\n      mBtnWidth = DEFAULT_BUTTON_WIDTH;\n    &#125;\n    //给文字设置一个padding，避免文字和按钮重叠了\n    mTextPaddingRight = mBtnPadding * 4 + mBtnWidth * 2;\n\n    //按钮出现和消失的动画\n    mGoneAnimator = ValueAnimator.ofFloat(1f, 0f).setDuration(ANIMATOR_TIME);\n    mVisibleAnimator = ValueAnimator.ofFloat(0f, 1f).setDuration(ANIMATOR_TIME);\n\n    //是否是密码样式\n    isPassword =\n      getInputType() == (InputType.TYPE_TEXT_VARIATION_PASSWORD | InputType.TYPE_CLASS_TEXT);\n\n  &#125;\n\n  @Override\n  protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123;\n    super.onMeasure(widthMeasureSpec, heightMeasureSpec);\n\n    //设置右内边距, 防止清除按钮和文字重叠\n    setPadding(getPaddingLeft(), getPaddingTop(), mTextPaddingRight, getPaddingBottom());\n  &#125;\n\n  @Override\n  protected void onDraw(Canvas canvas) &#123;\n    super.onDraw(canvas);\n\n    mPaint.setStyle(Paint.Style.STROKE);\n\n    //使用自定义颜色。如未定义，则使用默认颜色\n    if (mStyleColor != -1) &#123;\n      mPaint.setColor(mStyleColor);\n    &#125; else &#123;\n      mPaint.setColor(DEFAULT_STYLE_COLOR);\n    &#125;\n\n    //控件获取焦点时，加粗边框\n    if (isFocused()) &#123;\n      mPaint.setStrokeWidth(DEFAULT_FOCUSED_STROKE_WIDTH);\n    &#125; else &#123;\n      mPaint.setStrokeWidth(DEFAULT_UNFOCUSED_STROKE_WIDTH);\n    &#125;\n\n    //绘制边框\n    drawBorder(canvas);\n    //绘制清空和明文显示按钮\n    drawButtons(canvas);\n  &#125;\n\n  private void drawBorder(Canvas canvas) &#123;\n    int width = getWidth();\n    int height = getHeight();\n\n    switch (mBorderStyle) &#123;\n      //矩形样式\n      case STYLE_RECT:\n        setBackground(null);\n        canvas.drawRect(0, 0, width, height, mPaint);\n        break;\n\n      //圆角矩形样式\n      case STYLE_ROUND_RECT:\n        setBackground(null);\n        float roundRectLineWidth = 0;\n        if (isFocused()) &#123;\n          roundRectLineWidth = DEFAULT_FOCUSED_STROKE_WIDTH / 2;\n        &#125; else &#123;\n          roundRectLineWidth = DEFAULT_UNFOCUSED_STROKE_WIDTH / 2;\n        &#125;\n        mPaint.setStrokeWidth(roundRectLineWidth);\n        if (Build.VERSION.SDK_INT &gt;= 21) &#123;\n          canvas.drawRoundRect(\n            roundRectLineWidth / 2, roundRectLineWidth / 2, width - roundRectLineWidth / 2, height - roundRectLineWidth / 2,\n            DEFAULT_ROUND_RADIUS, DEFAULT_ROUND_RADIUS,\n            mPaint);\n        &#125; else &#123;\n          canvas.drawRoundRect(\n            new RectF(roundRectLineWidth / 2, roundRectLineWidth / 2, width - roundRectLineWidth / 2, height - roundRectLineWidth / 2),\n            DEFAULT_ROUND_RADIUS, DEFAULT_ROUND_RADIUS,\n            mPaint);\n        &#125;\n        break;\n\n      //半矩形样式\n      case STYLE_HALF_RECT:\n        setBackground(null);\n        canvas.drawLine(0, height, width, height, mPaint);\n        canvas.drawLine(0, height / 2, 0, height, mPaint);\n        canvas.drawLine(width, height / 2, width, height, mPaint);\n        break;\n\n      //动画特效样式\n      case STYLE_ANIMATOR:\n        setBackground(null);\n        if (isAnimatorRunning) &#123;\n          canvas.drawLine(width / 2 - mAnimatorProgress, height, width / 2 + mAnimatorProgress, height, mPaint);\n          if (mAnimatorProgress == width / 2) &#123;\n            isAnimatorRunning = false;\n          &#125;\n        &#125; else &#123;\n          canvas.drawLine(0, height, width, height, mPaint);\n        &#125;\n        break;\n    &#125;\n  &#125;\n\n  private void drawButtons(Canvas canvas) &#123;\n    if (isBtnVisible) &#123;\n      //播放按钮出现的动画\n      if (mVisibleAnimator.isRunning()) &#123;\n        float scale = (float) mVisibleAnimator.getAnimatedValue();\n        drawClearButton(scale, canvas);\n        if (isPassword) &#123;\n          drawVisibleButton(scale, canvas, isPasswordVisible);\n        &#125;\n        invalidate();\n        //绘制静态的按钮\n      &#125; else &#123;\n        drawClearButton(1, canvas);\n        if (isPassword) &#123;\n          drawVisibleButton(1, canvas, isPasswordVisible);\n        &#125;\n      &#125;\n    &#125; else &#123;\n      //播放按钮消失的动画\n      if (mGoneAnimator.isRunning()) &#123;\n        float scale = (float) mGoneAnimator.getAnimatedValue();\n        drawClearButton(scale, canvas);\n        if (isPassword) &#123;\n          drawVisibleButton(scale, canvas, isPasswordVisible);\n        &#125;\n        invalidate();\n      &#125;\n    &#125;\n  &#125;\n\n  private void drawClearButton(float scale, Canvas canvas) &#123;\n\n    int right = (int) (getWidth() + getScrollX() - mBtnPadding - mBtnWidth * (1f - scale) / 2f);\n    int left = (int) (getWidth() + getScrollX() - mBtnPadding - mBtnWidth * (scale + (1f - scale) / 2f));\n    int top = (int) ((getHeight() - mBtnWidth * scale) / 2);\n    int bottom = (int) (top + mBtnWidth * scale);\n    Rect rect = new Rect(left, top, right, bottom);\n    canvas.drawBitmap(mBitmapClear, null, rect, mPaint);\n  &#125;\n\n  private void drawVisibleButton(float scale, Canvas canvas, boolean isVisible) &#123;\n\n    int right = (int) (getWidth() + getScrollX() - mBtnPadding * 3 - mBtnWidth - mBtnWidth * (1f - scale) / 2f);\n    int left = (int) (getWidth() + getScrollX() - mBtnPadding * 3 - mBtnWidth - mBtnWidth * (scale + (1f - scale) / 2f));\n    int top = (int) ((getHeight() - mBtnWidth * scale) / 2);\n    int bottom = (int) (top + mBtnWidth * scale);\n    Rect rect = new Rect(left, top, right, bottom);\n    if (isVisible) &#123;\n      canvas.drawBitmap(mBitmapVisible, null, rect, mPaint);\n    &#125; else &#123;\n      canvas.drawBitmap(mBitmapInvisible, null, rect, mPaint);\n    &#125;\n\n  &#125;\n\n  // 清除按钮出现时的动画效果\n  private void startVisibleAnimator() &#123;\n    endAllAnimator();\n    mVisibleAnimator.start();\n    invalidate();\n  &#125;\n\n  // 清除按钮消失时的动画效果\n  private void startGoneAnimator() &#123;\n    endAllAnimator();\n    mGoneAnimator.start();\n    invalidate();\n  &#125;\n\n  // 结束所有动画\n  private void endAllAnimator() &#123;\n    mGoneAnimator.end();\n    mVisibleAnimator.end();\n  &#125;\n\n  @Override\n  protected void onFocusChanged(boolean focused, int direction, Rect previouslyFocusedRect) &#123;\n    super.onFocusChanged(focused, direction, previouslyFocusedRect);\n\n    //播放按钮出现和消失动画\n    if (focused &amp;&amp; getText().length() &gt; 0) &#123;\n      if (!isBtnVisible) &#123;\n        isBtnVisible = true;\n        startVisibleAnimator();\n      &#125;\n    &#125; else &#123;\n      if (isBtnVisible) &#123;\n        isBtnVisible = false;\n        startGoneAnimator();\n      &#125;\n    &#125;\n\n    //实现动画特效样式\n    if (focused &amp;&amp; mBorderStyle.equals(STYLE_ANIMATOR)) &#123;\n      isAnimatorRunning = true;\n      mAnimator = ObjectAnimator.ofInt(this, BORDER_PROGRESS, 0, getWidth() / 2);\n      mAnimator.setDuration(ANIMATOR_TIME);\n      mAnimator.start();\n    &#125;\n  &#125;\n\n  protected void setBorderProgress(int borderProgress) &#123;\n    mAnimatorProgress = borderProgress;\n    postInvalidate();\n  &#125;\n\n  protected int getBorderProgress() &#123;\n    return mAnimatorProgress;\n  &#125;\n\n  @Override\n  protected void onTextChanged(CharSequence text, int start, int lengthBefore, int lengthAfter) &#123;\n    super.onTextChanged(text, start, lengthBefore, lengthAfter);\n\n    if (text.length() &gt; 0 &amp;&amp; isFocused()) &#123;\n      if (!isBtnVisible) &#123;\n        isBtnVisible = true;\n        startVisibleAnimator();\n      &#125;\n    &#125; else &#123;\n      if (isBtnVisible) &#123;\n        isBtnVisible = false;\n        startGoneAnimator();\n      &#125;\n    &#125;\n  &#125;\n\n  @Override\n  public boolean onTouchEvent(MotionEvent event) &#123;\n    if (event.getAction() == MotionEvent.ACTION_UP) &#123;\n\n      boolean clearTouched =\n        (getWidth() - mBtnPadding - mBtnWidth &lt; event.getX())\n          &amp;&amp; (event.getX() &lt; getWidth() - mBtnPadding)\n          &amp;&amp; isFocused();\n      boolean visibleTouched =\n        (getWidth() - mBtnPadding * 3 - mBtnWidth * 2 &lt; event.getX())\n          &amp;&amp; (event.getX() &lt; getWidth() - mBtnPadding * 3 - mBtnWidth)\n          &amp;&amp; isPassword &amp;&amp; isFocused();\n\n      if (clearTouched) &#123;\n        setError(null);\n        setText(&quot;&quot;);\n        return true;\n      &#125; else if (visibleTouched) &#123;\n        if (isPasswordVisible) &#123;\n          isPasswordVisible = false;\n          setInputType(InputType.TYPE_TEXT_VARIATION_PASSWORD | InputType.TYPE_CLASS_TEXT);\n          setSelection(getText().length());\n          invalidate();\n        &#125; else &#123;\n          isPasswordVisible = true;\n          setInputType(InputType.TYPE_TEXT_VARIATION_VISIBLE_PASSWORD);\n          setSelection(getText().length());\n          invalidate();\n        &#125;\n        return true;\n      &#125;\n    &#125;\n    return super.onTouchEvent(event);\n  &#125;\n\n  // 开始晃动的入口\n  public void startShakeAnimation() &#123;\n    if (getAnimation() == null) &#123;\n      setAnimation(shakeAnimation(4));\n    &#125;\n    startAnimation(getAnimation());\n  &#125;\n\n  /**\n   * 晃动动画\n   *\n   * @param counts 0.5秒钟晃动多少下\n   * @return\n   */\n  private Animation shakeAnimation(int counts) &#123;\n    Animation translateAnimation = new TranslateAnimation(0, 10, 0, 0);\n    translateAnimation.setInterpolator(new CycleInterpolator(counts));\n    translateAnimation.setDuration(500);\n    return translateAnimation;\n  &#125;\n\n  private Bitmap createBitmap(Context context, int resId, int defResId) &#123;\n    if (resId != 0) &#123;\n      return BitmapFactory.decodeResource(context.getResources(), resId);\n    &#125; else &#123;\n      return BitmapFactory.decodeResource(context.getResources(), defResId);\n    &#125;\n  &#125;\n&#125;\n</code></pre>\n<p>这个类里面会用到values目录中的attrs.xml 和 dimens.xml 如果没有就自行创建</p>\n<h5 id=\"2、往attrs-xml中写入自定义EditText的属性\"><a href=\"#2、往attrs-xml中写入自定义EditText的属性\" class=\"headerlink\" title=\"2、往attrs.xml中写入自定义EditText的属性\"></a>2、往attrs.xml中写入自定义EditText的属性</h5><pre><code class=\"xml\">\n&lt;resources&gt;\n &lt;!--  自定义EditText的属性--&gt;\n  &lt;declare-styleable name=&quot;PowerfulEditText&quot;&gt;\n    &lt;!--图片资源--&gt;\n    &lt;attr name=&quot;clearDrawable&quot; format=&quot;reference&quot; /&gt;\n    &lt;attr name=&quot;visibleDrawable&quot; format=&quot;reference&quot; /&gt;\n    &lt;attr name=&quot;invisibleDrawable&quot; format=&quot;reference&quot; /&gt;\n    &lt;!--按钮宽度大小--&gt;\n    &lt;attr name=&quot;BtnWidth&quot; format=&quot;dimension&quot; /&gt;\n    &lt;!--按钮间距大小--&gt;\n    &lt;attr name=&quot;BtnSpacing&quot; format=&quot;dimension&quot; /&gt;\n    &lt;!--边框颜色和样式--&gt;\n    &lt;attr name=&quot;styleColor&quot; format=&quot;color&quot; /&gt;\n    &lt;attr name=&quot;borderStyle&quot; format=&quot;string&quot; /&gt;\n  &lt;/declare-styleable&gt;\n&lt;/resources&gt;\n</code></pre>\n<h5 id=\"3、往dimens-xml中写入一些大小配置\"><a href=\"#3、往dimens-xml中写入一些大小配置\" class=\"headerlink\" title=\"3、往dimens.xml中写入一些大小配置\"></a>3、往dimens.xml中写入一些大小配置</h5><pre><code class=\"xml\">\n&lt;resources&gt;\n  &lt;!-- Default screen margins, per the Android Design guidelines. 自定义editText的属性设置 --&gt;\n  &lt;dimen name=&quot;activity_horizontal_margin&quot;&gt;16dp&lt;/dimen&gt;\n  &lt;dimen name=&quot;activity_vertical_margin&quot;&gt;16dp&lt;/dimen&gt;\n  &lt;!--按钮间距大小--&gt;\n  &lt;dimen name=&quot;btn_edit_text_padding&quot;&gt;8dp&lt;/dimen&gt;\n  &lt;!--按钮宽度大小--&gt;\n  &lt;dimen name=&quot;btn_edit_text_width&quot;&gt;16dp&lt;/dimen&gt;\n&lt;/resources&gt;\n</code></pre>\n<h5 id=\"4、在布局文件中使用\"><a href=\"#4、在布局文件中使用\" class=\"headerlink\" title=\"4、在布局文件中使用\"></a>4、在布局文件中使用</h5><pre><code class=\"xml\">\n&lt;com.你的包名.widgets.PowerfulEditText\n          android:id=&quot;@+id/password_edit&quot;\n          android:layout_width=&quot;match_parent&quot;\n          android:layout_height=&quot;45dp&quot;\n          android:background=&quot;@null&quot;\n          android:paddingStart=&quot;12dp&quot;\n          android:textSize=&quot;15sp&quot;\n          android:hint=&quot;请输入密码&quot;\n          app:BtnWidth=&quot;@dimen/btn_edit_text_width&quot;\n          app:BtnSpacing=&quot;@dimen/btn_edit_text_padding&quot;\n          android:inputType=&quot;textPassword&quot;\n          tools:ignore=&quot;RtlSymmetry&quot; /&gt;\n</code></pre>\n<p>一共是7个样式可以在xml中使用</p>\n<pre><code>\napp:clearDrawable=&quot;@drawable/clear_all&quot;  \napp:visibleDrawable=&quot;@drawable/visible&quot;  \napp:invisibleDrawable=&quot;@drawable/invisible&quot;  \napp:BtnWidth=&quot;@dimen/btn_edittext_width&quot;  \napp:BtnSpacing=&quot;@dimen/btn_edittext_padding&quot;  \napp:borderStyle=&quot;halfRect&quot;  \napp:styleColor=&quot;#ff0000&quot;  \n</code></pre>\n<p>其中，边框样式的对应规则如下。</p>\n<pre><code>\n1、矩形样式：         app:borderStyle=&quot;rectangle&quot;\n\n2、半矩形样式：       app:borderStyle=&quot;halfRect&quot;\n\n3、圆角矩形样式：     app:borderStyle=&quot;roundRect&quot;\n\n4、动画特效样式：     app:borderStyle=&quot;animator&quot;\n\n控件抖动的效果也是利用动画实现的。调用view实例的以下方法即可实现抖动。\n\nmPEditText.startShakeAnimation()\n</code></pre>\n<p>也可以使用依赖的方式去项目中用，不过如果作者不维护, 那你的项目也就需要改动了</p>\n<p>作者的<a href=\"https://github.com/AndroidWJC/PowerfulEditText\">github链接</a></p>\n"},{"title":"ETH智能合约开发","date":"2021-03-19T08:35:19.000Z","_content":"\n## ETH智能合约开发(vue + 智能合约)\n\n### 一、什么是ETH智能合约\n\n> 说白了就是一段可以运行在以太坊平台上的代码，应用中，我们可以使用 Solidity 来编写和区块链交互的智能合约，\n> 合约编写好之后，我们通过一个有余额的外部账户将合约部署到以太坊节点上，\n> 并运行合约（使用 Truffle 框架可以更好的帮助我们做这些事情）\n>\n\n### 二、Truffle 和 ganache-cli 简介\n\n> Truffle Truffle是Dapp开发框架，他可以帮我们处理掉大量无关紧要的小事情，\n> 让我们可以迅速开始写代码-编译-部署-测试-打包DApp这个流程。\n> Truffle是使用Nodejs开发的，我们首先需要安装Nodejs运行环境。\n\n> ganache-cli是以太坊节点仿真器软件ganache的命令行版本，可以方便开发者快速进行以太坊DApp的开发与测试。\n>\n\n1、Truffle安装\n\n查看node版本 没有安装node的请自行google安装\n\n```\n# Nodejs版本\n> npm -v\n6.0.0\n> node -v\nv8.9.4\n```\n\n全局安装Truffle工具。\n\n```\nnpm install -g truffle\n```\n\n安装完成后查看命令行是否安装成功\n\n```\n> truffle\nTruffle v4.1.12 - a development framework for Ethereum\n\nUsage: truffle  [options]\n\nCommands:\n  init      Initialize new and empty Ethereum project\n  compile   Compile contract source files\n  migrate   Run migrations to deploy contracts\n  deploy    (alias for migrate)\n  build     Execute build pipeline (if configuration present)\n  test      Run JavaScript and Solidity tests\n  debug     Interactively debug any transaction on the blockchain (experimental)\n  opcode    Print the compiled opcodes for a given contract\n  console   Run a console with contract abstractions and commands available\n  develop   Open a console with a local development blockchain\n  create    Helper to create new contracts, migrations and tests\n  install   Install a package from the Ethereum Package Registry\n  publish   Publish a package to the Ethereum Package Registry\n  networks  Show addresses for deployed contracts on each network\n  watch     Watch filesystem for changes and rebuild the project automatically\n  serve     Serve the build directory on localhost and watch for changes\n  exec      Execute a JS module within this Truffle environment\n  unbox     Download a Truffle Box, a pre-built Truffle project\n  version   Show version number and exit\n\nSee more at http://truffleframework.com/docs\n```\n\n2、全局安装ganache-cli\n\n```\nnpm install -g ganache-cli\n```\n\n### 三、创建项目\n\n```\n> cd ~\n> mkdir truffle-crowdfund\n> cd truffle-crowdfund\n# 初始化项目\n> truffle init\nDownloading...\nUnpacking...\nSetting up...\nUnbox successful. Sweet!\n\nCommands:\n\n  Compile:        truffle compile\n  Migrate:        truffle migrate\n  Test contracts: truffle test\n```\n\n### 四、启动测试节点\n\n```\nganache-cli\n```\n\n它会自动给我们生成10个带有100个eth的账户\n\n### 五、接下来写合约代码并部署到测试网络上\n\n#### 需求：\n\n> 假设我准备出版一本区块练技术书籍，但是不确定有多少人愿意购买这本书，于是我发起了一个众筹， 如果在一个月内，\n  能筹集到 10 个 ETH，我就进行写作，并给参与的读者每人赠送一本书，如果未能筹到足够的资金，\n  参与的读者赎回之前投入的资金。 \n  同时，为了让读者积极参与，初始时，参与众筹的价格非常低（0.02 ETH），每筹集满 1 个 ETH 时，价格上涨 0.002ETH。\n  归纳出合约三个对外动作（函数）：\n  \n> 1、汇款进合约，可通过实现合约的回退函数来实现。\n>\n> 2、读者赎回汇款，这个函数仅仅在众筹未达标之后，由读者本人调用生效。\n>\n> 3、创作者提取资金，这个函数需要在众筹达标之后，由创作者调用。\n  \n> 除此之外，还需要一个状态变量来保存以下状态：\n  \n> 1、用户众筹的金额，使用一个 mapping 来保存。\n>\n> 2、当前众筹的价格，以及一个相应的内部函数逐步上涨价格。价格可以使用一个 uint 来保存。\n>\n> 3、合约众筹的截止时间，用 uint 来保存， 在合约创建时往后追加 30 天，在构造函数中完成。\n>\n> 4、记录合约众筹的收益者，即创作者，在合约创建时在构造函数中进行赋值，合约创建者就是创作者。\n>\n> 5、再加入众筹状态，如果众筹停止阻止用户在参与。创作者提取资金时及时关闭众筹。\n\n#### 实现众筹合约\n\n我们进入到上面使用`truffle init`命令创建的项目中去\n\n在 contracts 下创建一个合约文件 Crowdfunding.sol:\n\n```\npragma solidity >=0.4.21 <0.7.0;\n\n\ncontract Crowdfunding {\n    // 创作者\n    address public author;\n\n    // 参与金额\n    mapping(address => uint) public joined;\n\n    // 众筹目标\n    uint constant Target = 10 ether;\n\n    // 众筹截止时间\n    uint public endTime;\n\n    // 记录当前众筹价格\n    uint public price  = 0.02 ether ;\n\n    // 作者提取资金之后，关闭众筹\n    bool public closed = false;\n\n    // 部署合约时调用，初始化作者以及众筹结束时间\n    constructor() public {\n        author = msg.sender;\n        endTime = now + 30 days;\n    }\n\n    // 更新价格，这是一个内部函数\n    function updatePrice() internal {\n        uint rise = address(this).balance / 1 ether * 0.002 ether;\n        price = 0.02 ether + rise;\n    }\n\n    // 用户向合约转账时 触发的回调函数\n    function () external payable {\n        require(now < endTime && !closed  , \"众筹已结束\");\n        require(joined[msg.sender] == 0 , \"你已经参与过众筹\");\n\n        require (msg.value >= price, \"出价太低了\");\n        joined[msg.sender] = msg.value;\n\n        updatePrice();\n    } \n\n    // 作者提取资金\n    function withdrawFund() external {\n        require(msg.sender == author, \"你不是作者\");\n        require(address(this).balance >= Target, \"未达到众筹目标\");\n        closed = true;   \n        msg.sender.transfer(address(this).balance);\n    }\n\n    // 读者赎回资金\n    function withdraw() external {\n        require(now > endTime, \"还未到众筹结束时间\");\n        require(!closed, \"众筹达标，众筹资金已提取\");\n        require(Target > address(this).balance, \"众筹达标，你没法提取资金\");\n        \n        msg.sender.transfer(joined[msg.sender]);\n    }\n\n}\n```\n\n> 代码的介绍，在合约代码中，使用到了 Solidity 语言中的一些知识点：\n\n> ether : 这是货币单位\n>。\n> days : 这是时间单位，1 days 对应 1 天的秒数。\n>\n> now : 这是一个 Solidity 的内置属性，用于获取当前的时间戳，单位是秒。\n>\n> require : 如果条件不满足回退交易。\n>\n> address.transfer(value) : 对某一个地址进行转账。\n>\n> 有关 Solidity 语言入门推荐大家使用官网课程 [僵尸游戏](https://cryptozombies.io/zh/course/)\n>\n\n\n#### 合约部署\n\n部署之前我们使用 `truffle compile` 命令来进行编译\n\n之后，在 migrations 下创建一个部署脚本 2_crowfunding.js ，内容如下：\n\n```\nconst crowd = artifacts.require(\"Crowdfunding\");\n\nmodule.exports = function(deployer) {\n  deployer.deploy(crowd);\n};\n```\n\n接下来你的文件目录应该是这样的:\n\n```\n├── build\n│   └── contracts\n│       ├── CrowdFunding.json\n│       └── Migrations.json\n├── contracts\n│   ├── CrowdFunding.sol\n│   └── Migrations.sol\n├── migrations\n│   ├── 1_initial_migration.js\n│   └── 2_crowdfunding_migration.js\n├── test\n└── truffle-config.js\n\n```\n注意一下这个`1_initial_migration.js`文件和 `Migrations.sol`文件 这是我们在使用`truffle init`命令初始化项目时它为我们生成的文件 这两个文件是不能删除的否则会无法进行部署，我们在`migrations`文件夹下面创建的文件要按照 1_xxx.js, 2_xxx.js 在部署的时候是按照这个顺序进行的。\n\n下面我们配置部署脚本`truffle-config.js`\n\n配置之前 我们还需要做一些事情：\n\n1、注册infura获取PROJECT-ID\n\n[infura](https://infura.io/)是基于ETH的chain公共API服务，为开发者提供链上数据查询、交易广播等功能。\n\n注册成功之后需要创建项目\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325100549.png)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325100631.png)\n\n项目名字是随便起的无所谓\n\n项目创建完之后你就能看到PROJECT-ID了这个我们待会要用\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325100830.png)\n\n2、我们还需要一个浏览器插件 [MetaMask](https://metamask.io/) 推荐大家使用Chrome浏览器 \n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325101145.png)\n\n按照步骤注册账户，并将助记词保存下来， 我们下面要用到\n\n我们需要获取ETH，以为部署是要gas费的, 测试网络可以每天给我们5个ETH 这足够我们使用了\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325103044.png)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325103155.png)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325103316.png)\n\n3、安装 `truffle-hdwallet-provider`\n\n由于需要将合约部署到测试网Ropsten，此过程需要部署者私钥进行签名再将数据进行广播，\n`truffle-hdwallet-provider`是truffle上提供交易离线签名的模块\n\n注：必须在truffle框架的代码目录下安装，否则不生效\n\n```\n> cd truffle-crowdfund\n> npm install truffle-hdwallet-provider\n```\n\n4、我们终于可以进行修改`truffle-config.js`部署脚本了\n\n```\n/**\n * Use this file to configure your truffle project. It's seeded with some\n * common settings for different networks and features like migrations,\n * compilation and testing. Uncomment the ones you need or modify\n * them to suit your project as necessary.\n *\n * More information about configuration can be found at:\n *\n * trufflesuite.com/docs/advanced/configuration\n *\n * To deploy via Infura you'll need a wallet provider (like @truffle/hdwallet-provider)\n * to sign your transactions before they're sent to a remote public node. Infura accounts\n * are available for free at: infura.io/register.\n *\n * You'll also need a mnemonic - the twelve word phrase the wallet uses to generate\n * public/private key pairs. If you're publishing your code to GitHub make sure you load this\n * phrase from a file you've .gitignored so it doesn't accidentally become public.\n *\n */\n\nconst HDWalletProvider = require('truffle-hdwallet-provider');\n// const infuraKey = \"fj4jll3k.....\";\n//\nconst fs = require('fs');\nconst mnemonic = fs.readFileSync(\".secret\").toString().trim();\n\nmodule.exports = {\n  /**\n   * Networks define how you connect to your ethereum client and let you set the\n   * defaults web3 uses to send transactions. If you don't specify one truffle\n   * will spin up a development blockchain for you on port 9545 when you\n   * run `develop` or `test`. You can ask a truffle command to use a specific\n   * network from the command line, e.g\n   *\n   * $ truffle test --network <network-name>\n   */\n\n  networks: {\n    // Useful for testing. The `development` name is special - truffle uses it by default\n    // if it's defined here and no other network is specified at the command line.\n    // You should run a client (like ganache-cli, geth or parity) in a separate terminal\n    // tab if you use this network and you must also set the `host`, `port` and `network_id`\n    // options below to some value.\n    //\n    mainnet: {\n      provider: function () {\n        // Setting the provider with the Infura Rinkeby address and Token\n        return new HDWalletProvider(mnemonic, \"https://mainnet.infura.io/v3/xxxx1cabc499dc5d569\")\n      },\n      network_id: 1\n    },\n    // development: {\n    //  host: \"127.0.0.1\",     // Localhost (default: none)\n    //  port: 8545,            // Standard Ethereum port (default: none)\n    //  network_id: \"*\",       // Any network (default: none)\n    // },\n    // Another network with more advanced options...\n    // advanced: {\n    // port: 8777,             // Custom port\n    // network_id: 1342,       // Custom network\n    // gas: 8500000,           // Gas sent with each transaction (default: ~6700000)\n    // gasPrice: 20000000000,  // 20 gwei (in wei) (default: 100 gwei)\n    // from: <address>,        // Account to send txs from (default: accounts[0])\n    // websocket: true        // Enable EventEmitter interface for web3 (default: false)\n    // },\n    // Useful for deploying to a public network.\n    // NB: It's important to wrap the provider as a function.\n    ropsten: {\n      provider: () => new HDWalletProvider(mnemonic, \"https://ropsten.infura.io/v3/xxxx1cabc499dc5d569\"),\n      network_id: 3,       // Ropsten's id\n      gas: 5500000,        // Ropsten has a lower block limit than mainnet\n      confirmations: 2,    // # of confs to wait between deployments. (default: 0)\n      timeoutBlocks: 200,  // # of blocks before a deployment times out  (minimum/default: 50)\n      skipDryRun: true     // Skip dry run before migrations? (default: false for public nets )\n    },\n    // Useful for private networks\n    // private: {\n    // provider: () => new HDWalletProvider(mnemonic, `https://network.io`),\n    // network_id: 2111,   // This network is yours, in the cloud.\n    // production: true    // Treats this network as if it was a public net. (default: false)\n    // }\n  },\n\n  // Set default mocha options here, use special reporters etc.\n  mocha: {\n    // timeout: 100000\n  },\n\n  // Configure your compilers\n  compilers: {\n    solc: {\n      // version: \"0.5.1\",    // Fetch exact version from solc-bin (default: truffle's version)\n      // docker: true,        // Use \"0.5.1\" you've installed locally with docker (default: false)\n      // settings: {          // See the solidity docs for advice about optimization and evmVersion\n      //  optimizer: {\n      //    enabled: false,\n      //    runs: 200\n      //  },\n      //  evmVersion: \"byzantium\"\n      // }\n    }\n  },\n\n  // Truffle DB is currently disabled by default; to enable it, change enabled: false to enabled: true\n  //\n  // Note: if you migrated your contracts prior to enabling this field in your Truffle project and want\n  // those previously migrated contracts available in the .db directory, you will need to run the following:\n  // $ truffle migrate --reset --compile-all\n\n  db: {\n    enabled: false\n  }\n};\n\n```\n\n注意这几行 \n\n```\nconst HDWalletProvider = require('truffle-hdwallet-provider');\n// const infuraKey = \"fj4jll3k.....\";\n//\nconst fs = require('fs');\nconst mnemonic = fs.readFileSync(\".secret\").toString().trim();\n\n...\n\nropsten: {\n  provider: () => new HDWalletProvider(mnemonic, \"https://ropsten.infura.io/v3/xxxx1cabc499dc5d569\"),\n  network_id: 3,       // Ropsten's id\n  gas: 5500000,        // Ropsten has a lower block limit than mainnet\n  confirmations: 2,    // # of confs to wait between deployments. (default: 0)\n  timeoutBlocks: 200,  // # of blocks before a deployment times out  (minimum/default: 50)\n  skipDryRun: true     // Skip dry run before migrations? (default: false for public nets )\n},\n```\n\n这里我们用到了 助记词 和 PROJECT-ID 我这里是在项目的根目录下创建了一个`.secret`文件 把助记词放到了文件里, 这样比较好，\n你也可以使用变量进行保存 `const infuraKey = \"fj4jll3k.....\"`\n\n5、部署到Ropsten测试网络\n\n执行`truffle migrate --network ropsten` 即可部署至Ropsten\n\n如需要重新编译所有合约，可执行`truffle migrate --network ropsten --reset --compile-all`\n\n```\nCompiling your contracts...\n===========================\n> Everything is up to date, there is nothing to compile.\n\n\n\nStarting migrations...\n======================\n> Network name:    'ropsten'\n> Network id:      3\n> Block gas limit: 8000000 (0x7a1200)\n\n\n1_initial_migration.js\n======================\n\n   Deploying 'Migrations'\n   ----------------------\n   > transaction hash:    0xe27c86dc48219fa193d23843b301d6878a6820dcc93fd92a20e24d1ec9c49b31\n   > Blocks: 3            Seconds: 14\n   > contract address:    0x2e2982D9d1914b6580139Ec4E356B708478C875F\n   > block number:        9898882\n   > block timestamp:     1616554032\n   > account:             0x270dF7D1f4612063abA065389b3fCbeF7993caA9\n   > balance:             4.93502452\n   > gas used:            193243 (0x2f2db)\n   > gas price:           20 gwei\n   > value sent:          0 ETH\n   > total cost:          0.00386486 ETH\n\n   Pausing for 2 confirmations...\n   ------------------------------\n   > confirmation number: 1 (block: 9898884)\n   > confirmation number: 2 (block: 9898885)\n\n   > Saving migration to chain.\n   > Saving artifacts\n   -------------------------------------\n   > Total cost:          0.00386486 ETH\n\n\n2_crowdfunding_migration.js\n===========================\n\n   Deploying 'CrowdFunding'\n   ------------------------\n   > transaction hash:    0x0f787b4d1567a00a8da4b28970632238fc50eb43ee7e33fb8d5c3d92fcbf5880\n   > Blocks: 2            Seconds: 25\n   > contract address:    0x3e32bF1e0Af404ed7DbCEf538BEba75ea2a76510\n   > block number:        9898889\n   > block timestamp:     1616554105\n   > account:             0x270dF7D1f4612063abA065389b3fCbeF7993caA9\n   > balance:             4.9224565\n   > gas used:            582663 (0x8e407)\n   > gas price:           20 gwei\n   > value sent:          0 ETH\n   > total cost:          0.01165326 ETH\n\n   Pausing for 2 confirmations...\n   ------------------------------\n   > confirmation number: 1 (block: 9898890)\n   > confirmation number: 2 (block: 9898891)\n\n   > Saving migration to chain.\n   > Saving artifacts\n   -------------------------------------\n   > Total cost:          0.01165326 ETH\n\n\nSummary\n=======\n> Total deployments:   2\n> Final cost:          0.01551812 ETH\n\n```\n\n### 六、使用vue项目与合约进行交互 \n\n> 利用 CrowdFund.vue 来众筹界面，众筹界面需要显示以下几个部分：\n  \n>  1、当前众筹到金额。\n>\n>  2、众筹的截止时间。\n>\n>  3、当前众筹的价格，参与众筹按钮。\n>\n>  4、如果是已经参与，显示其参与的价格以及赎回按钮。\n>\n>  5、如果是创作者，显示一个提取资金按钮。\n\n\n1、 依然是创建一个vue项目\n\n```\nvue create crowd_funding_vue\n```\n\n我们在components文件夹下创建一个`CrowdFunding.vue`文件 我们整个的`CrowdFunding.vue`文件就像是这样\n\n```\n<template>\n    <div class=\"content\">\n        <h3> 新书众筹</h3>\n        <span>以最低的价格获取我的新书 </span>\n\n        <div class=\"status\">\n            <div v-if=\"!closed\">已众筹资金：<b>{{ total }} ETH </b></div>\n            <div v-if=\"closed\"> 众筹已完成</div>\n            <div>众筹截止时间：{{ endDate }}</div>\n        </div>\n\n        <div v-if=\"joined\" class=\"card-bkg\">\n            <div class=\"award-des\">\n                <span> 参与价格 </span>\n                <b> {{ joinPrice }} ETH </b>\n            </div>\n\n            <button :disabled=\"closed\" @click=\"withdraw\">赎回</button>\n        </div>\n\n        <div v-if=\"!joined\" class=\"card-bkg\">\n            <div class=\"award-des\">\n                <span> 当前众筹价格 </span>\n                <b> {{ price }} ETH </b>\n            </div>\n\n            <button :disabled=\"closed\" @click=\"join\">参与众筹</button>\n        </div>\n\n        <div v-if=\"isAuthor\">\n            <button :disabled=\"closed\" @click=\"withdrawFund\"> 提取资金</button>\n        </div>\n\n    </div>\n</template>\n\n<script>\n    import contract from \"truffle-contract\";\n    import crowd from '../../public/build/contracts/CrowdFunding.json';\n\n    const Web3 = require('web3');\n\n    export default {\n        name: 'CrowdFund',\n        // 定义上面HTML模板中使用的变量\n        data() {\n            return {\n                price: null,\n                total: 0,\n                closed: true,\n                joinPrice: null,\n                joined: false,\n                endDate: \"null\",\n                isAuthor: true,\n            }\n        },\n        // 当前Vue组件被创建时回调的hook 函数\n        async created() {\n            //  初始化 web3及账号\n            await this.initWeb3Account()\n            //  初始化合约实例\n            await this.initContract()\n            //  获取合约的状态信息\n            await this.getCrowdInfo()\n        },\n        methods: {\n            async initWeb3Account() {\n                console.log(\"initWeb3Account 方法执行了-------\");\n                // 检查新版MetaMask\n                if (window.ethereum) {\n                    this.provider = window.ethereum;\n                    try {\n                        // 请求用户账号授权\n                        await window.ethereum.enable();\n                    } catch (error) {\n                        // 用户拒绝了访问\n                        console.log(\"User denied account access\");\n                    }\n                }\n                // 老版 MetaMask\n                else if (window.web3) {\n                    this.provider = window.web3.currentProvider;\n                }\n                // 如果没有注入的web3实例，回退到使用 Ganache\n                else {\n                    alert(\"请安装MetaMask!\");\n                     this.provider = new Web3.providers.HttpProvider(\"http://127.0.0.1:7545\");\n                }\n                this.web3 = new Web3(this.provider);\n                this.web3.eth.getAccounts().then(accs => {\n                    this.account = accs[0]\n                    console.log(accs)\n                })\n            },\n            async initContract() {\n                const crowdContract = contract(crowd)\n                crowdContract.setProvider(this.provider)\n                this.crowdFund = await crowdContract.deployed()\n            },\n            async getCrowdInfo() {\n                // 获取合约的余额\n                this.web3.eth.getBalance(this.crowdFund.address).then(\n                    r => {\n                        this.total = this.web3.utils.fromWei(r)\n                    }\n                )\n\n                // 获取读者的参与金额\n                this.crowdFund.joined(this.account).then(\n                    r => {\n                        if (r > 0) {\n                            this.joined = true\n                            this.joinPrice = this.web3.utils.fromWei(r)\n                        }\n                    }\n                )\n\n                // 获取合约的关闭状态\n                this.crowdFund.closed().then(\n                    r => this.closed = r\n                )\n\n                // 获取当前的众筹价格\n                this.crowdFund.price().then(\n                    r => this.price = this.web3.utils.fromWei(r)\n                )\n\n                // 获取众筹截止时间\n                this.crowdFund.endTime().then(r => {\n                    var endTime = new Date(r * 1000)\n                    // 把时间戳转化为本地时间\n                    this.endDate = endTime.toLocaleDateString().replace(/\\//g, \"-\") + \" \" + endTime.toTimeString().substr(0, 8);\n                })\n\n                // 获取众筹创作者地址\n                this.crowdFund.author().then(r => {\n                    if (this.account === r) {\n                        this.isAuthor = true\n                    } else {\n                        this.isAuthor = false\n                    }\n                })\n            },\n            // 读者参与众筹的 join()函数\n            join() {\n                this.web3.eth.sendTransaction({\n                    from: this.account,\n                    to: this.crowdFund.address,\n                    value: this.web3.utils.toWei(this.price)\n                }).then(() =>\n                    this.getCrowdInfo()\n                )\n            },\n            // 读者赎回的 withdraw()函数\n            withdraw() {\n                this.crowdFund.withdraw({\n                    from: this.account\n                }).then(() => {\n                    this.getCrowdInfo()\n                })\n            },\n            // 创作者提取资金的 withdrawFund()函数\n            withdrawFund() {\n                this.crowdFund.withdrawFund({\n                    from: this.account\n                }).then(() => {\n                    this.getCrowdInfo()\n                })\n            }\n        }\n    }\n</script>\n```\n\n2、与合约进行交互\n\n前端界面与合约进行交互时，需要使用到 `truffle-contract` 及 `web3` ，因为 Vue 工程本身也是通过 NPM 进行包管理，\n因此可以直接通过 npm 进行安装，命令如下：\n\n```\nnpm install --save truffle-contract web3\n```\n\n如果创建vue项目的时候已经启动了vue项目 那么你需要重新启动一下vue项目 因为安装了包之后需要重新启动 这样使用import导入包的时候\n才不会报错。\n\n3、将智能合约项目编译产生的`build`文件夹放进vue项目中的`public`文件夹下 注意看上面的这句话\n\n```\nimport crowd from '../../public/build/contracts/CrowdFunding.json';\n```\n\n4、启动vue项目进行交互 看起来就像这样\n\n```\nnpm run serve\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325105129.png)\n\n\n#### 特别感谢一下博文\n\n1、[如何使用Vue.js 开发以太坊DApp](https://learnblockchain.cn/2019/12/20/vue-dapp)\n\n2、[以太坊ETH-智能合约开发-solidity源码分析-truffle进阶](https://blog.csdn.net/u010159567/article/details/104895457)\n\n3、[Infura：一键接入以太坊](https://blog.csdn.net/TurkeyCock/article/details/85103434)\n\n4、[Truffle 和 MetaMask 配合](https://learnblockchain.cn/docs/truffle/getting-started/truffle-with-metamask.html)\n\n5、[详解 Truffle Migrations （迁移）- 合约部署不再困惑](https://www.chainnews.com/articles/823921189500.htm)\n\n6、[以太坊开发资源全面指南](http://blog.hubwiz.com/2019/09/13/ethereum-dev-tools-2019/#%E6%96%B0%E6%89%8B%E5%85%A5%E9%97%A8)\n\n","source":"_posts/ETH智能合约开发.md","raw":"---\ntitle: ETH智能合约开发\ndate: 2021-03-19 16:35:19\ncategories:\n- ETH智能合约\ntags:\n- Mac\n- Solidity\n---\n\n## ETH智能合约开发(vue + 智能合约)\n\n### 一、什么是ETH智能合约\n\n> 说白了就是一段可以运行在以太坊平台上的代码，应用中，我们可以使用 Solidity 来编写和区块链交互的智能合约，\n> 合约编写好之后，我们通过一个有余额的外部账户将合约部署到以太坊节点上，\n> 并运行合约（使用 Truffle 框架可以更好的帮助我们做这些事情）\n>\n\n### 二、Truffle 和 ganache-cli 简介\n\n> Truffle Truffle是Dapp开发框架，他可以帮我们处理掉大量无关紧要的小事情，\n> 让我们可以迅速开始写代码-编译-部署-测试-打包DApp这个流程。\n> Truffle是使用Nodejs开发的，我们首先需要安装Nodejs运行环境。\n\n> ganache-cli是以太坊节点仿真器软件ganache的命令行版本，可以方便开发者快速进行以太坊DApp的开发与测试。\n>\n\n1、Truffle安装\n\n查看node版本 没有安装node的请自行google安装\n\n```\n# Nodejs版本\n> npm -v\n6.0.0\n> node -v\nv8.9.4\n```\n\n全局安装Truffle工具。\n\n```\nnpm install -g truffle\n```\n\n安装完成后查看命令行是否安装成功\n\n```\n> truffle\nTruffle v4.1.12 - a development framework for Ethereum\n\nUsage: truffle  [options]\n\nCommands:\n  init      Initialize new and empty Ethereum project\n  compile   Compile contract source files\n  migrate   Run migrations to deploy contracts\n  deploy    (alias for migrate)\n  build     Execute build pipeline (if configuration present)\n  test      Run JavaScript and Solidity tests\n  debug     Interactively debug any transaction on the blockchain (experimental)\n  opcode    Print the compiled opcodes for a given contract\n  console   Run a console with contract abstractions and commands available\n  develop   Open a console with a local development blockchain\n  create    Helper to create new contracts, migrations and tests\n  install   Install a package from the Ethereum Package Registry\n  publish   Publish a package to the Ethereum Package Registry\n  networks  Show addresses for deployed contracts on each network\n  watch     Watch filesystem for changes and rebuild the project automatically\n  serve     Serve the build directory on localhost and watch for changes\n  exec      Execute a JS module within this Truffle environment\n  unbox     Download a Truffle Box, a pre-built Truffle project\n  version   Show version number and exit\n\nSee more at http://truffleframework.com/docs\n```\n\n2、全局安装ganache-cli\n\n```\nnpm install -g ganache-cli\n```\n\n### 三、创建项目\n\n```\n> cd ~\n> mkdir truffle-crowdfund\n> cd truffle-crowdfund\n# 初始化项目\n> truffle init\nDownloading...\nUnpacking...\nSetting up...\nUnbox successful. Sweet!\n\nCommands:\n\n  Compile:        truffle compile\n  Migrate:        truffle migrate\n  Test contracts: truffle test\n```\n\n### 四、启动测试节点\n\n```\nganache-cli\n```\n\n它会自动给我们生成10个带有100个eth的账户\n\n### 五、接下来写合约代码并部署到测试网络上\n\n#### 需求：\n\n> 假设我准备出版一本区块练技术书籍，但是不确定有多少人愿意购买这本书，于是我发起了一个众筹， 如果在一个月内，\n  能筹集到 10 个 ETH，我就进行写作，并给参与的读者每人赠送一本书，如果未能筹到足够的资金，\n  参与的读者赎回之前投入的资金。 \n  同时，为了让读者积极参与，初始时，参与众筹的价格非常低（0.02 ETH），每筹集满 1 个 ETH 时，价格上涨 0.002ETH。\n  归纳出合约三个对外动作（函数）：\n  \n> 1、汇款进合约，可通过实现合约的回退函数来实现。\n>\n> 2、读者赎回汇款，这个函数仅仅在众筹未达标之后，由读者本人调用生效。\n>\n> 3、创作者提取资金，这个函数需要在众筹达标之后，由创作者调用。\n  \n> 除此之外，还需要一个状态变量来保存以下状态：\n  \n> 1、用户众筹的金额，使用一个 mapping 来保存。\n>\n> 2、当前众筹的价格，以及一个相应的内部函数逐步上涨价格。价格可以使用一个 uint 来保存。\n>\n> 3、合约众筹的截止时间，用 uint 来保存， 在合约创建时往后追加 30 天，在构造函数中完成。\n>\n> 4、记录合约众筹的收益者，即创作者，在合约创建时在构造函数中进行赋值，合约创建者就是创作者。\n>\n> 5、再加入众筹状态，如果众筹停止阻止用户在参与。创作者提取资金时及时关闭众筹。\n\n#### 实现众筹合约\n\n我们进入到上面使用`truffle init`命令创建的项目中去\n\n在 contracts 下创建一个合约文件 Crowdfunding.sol:\n\n```\npragma solidity >=0.4.21 <0.7.0;\n\n\ncontract Crowdfunding {\n    // 创作者\n    address public author;\n\n    // 参与金额\n    mapping(address => uint) public joined;\n\n    // 众筹目标\n    uint constant Target = 10 ether;\n\n    // 众筹截止时间\n    uint public endTime;\n\n    // 记录当前众筹价格\n    uint public price  = 0.02 ether ;\n\n    // 作者提取资金之后，关闭众筹\n    bool public closed = false;\n\n    // 部署合约时调用，初始化作者以及众筹结束时间\n    constructor() public {\n        author = msg.sender;\n        endTime = now + 30 days;\n    }\n\n    // 更新价格，这是一个内部函数\n    function updatePrice() internal {\n        uint rise = address(this).balance / 1 ether * 0.002 ether;\n        price = 0.02 ether + rise;\n    }\n\n    // 用户向合约转账时 触发的回调函数\n    function () external payable {\n        require(now < endTime && !closed  , \"众筹已结束\");\n        require(joined[msg.sender] == 0 , \"你已经参与过众筹\");\n\n        require (msg.value >= price, \"出价太低了\");\n        joined[msg.sender] = msg.value;\n\n        updatePrice();\n    } \n\n    // 作者提取资金\n    function withdrawFund() external {\n        require(msg.sender == author, \"你不是作者\");\n        require(address(this).balance >= Target, \"未达到众筹目标\");\n        closed = true;   \n        msg.sender.transfer(address(this).balance);\n    }\n\n    // 读者赎回资金\n    function withdraw() external {\n        require(now > endTime, \"还未到众筹结束时间\");\n        require(!closed, \"众筹达标，众筹资金已提取\");\n        require(Target > address(this).balance, \"众筹达标，你没法提取资金\");\n        \n        msg.sender.transfer(joined[msg.sender]);\n    }\n\n}\n```\n\n> 代码的介绍，在合约代码中，使用到了 Solidity 语言中的一些知识点：\n\n> ether : 这是货币单位\n>。\n> days : 这是时间单位，1 days 对应 1 天的秒数。\n>\n> now : 这是一个 Solidity 的内置属性，用于获取当前的时间戳，单位是秒。\n>\n> require : 如果条件不满足回退交易。\n>\n> address.transfer(value) : 对某一个地址进行转账。\n>\n> 有关 Solidity 语言入门推荐大家使用官网课程 [僵尸游戏](https://cryptozombies.io/zh/course/)\n>\n\n\n#### 合约部署\n\n部署之前我们使用 `truffle compile` 命令来进行编译\n\n之后，在 migrations 下创建一个部署脚本 2_crowfunding.js ，内容如下：\n\n```\nconst crowd = artifacts.require(\"Crowdfunding\");\n\nmodule.exports = function(deployer) {\n  deployer.deploy(crowd);\n};\n```\n\n接下来你的文件目录应该是这样的:\n\n```\n├── build\n│   └── contracts\n│       ├── CrowdFunding.json\n│       └── Migrations.json\n├── contracts\n│   ├── CrowdFunding.sol\n│   └── Migrations.sol\n├── migrations\n│   ├── 1_initial_migration.js\n│   └── 2_crowdfunding_migration.js\n├── test\n└── truffle-config.js\n\n```\n注意一下这个`1_initial_migration.js`文件和 `Migrations.sol`文件 这是我们在使用`truffle init`命令初始化项目时它为我们生成的文件 这两个文件是不能删除的否则会无法进行部署，我们在`migrations`文件夹下面创建的文件要按照 1_xxx.js, 2_xxx.js 在部署的时候是按照这个顺序进行的。\n\n下面我们配置部署脚本`truffle-config.js`\n\n配置之前 我们还需要做一些事情：\n\n1、注册infura获取PROJECT-ID\n\n[infura](https://infura.io/)是基于ETH的chain公共API服务，为开发者提供链上数据查询、交易广播等功能。\n\n注册成功之后需要创建项目\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325100549.png)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325100631.png)\n\n项目名字是随便起的无所谓\n\n项目创建完之后你就能看到PROJECT-ID了这个我们待会要用\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325100830.png)\n\n2、我们还需要一个浏览器插件 [MetaMask](https://metamask.io/) 推荐大家使用Chrome浏览器 \n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325101145.png)\n\n按照步骤注册账户，并将助记词保存下来， 我们下面要用到\n\n我们需要获取ETH，以为部署是要gas费的, 测试网络可以每天给我们5个ETH 这足够我们使用了\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325103044.png)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325103155.png)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325103316.png)\n\n3、安装 `truffle-hdwallet-provider`\n\n由于需要将合约部署到测试网Ropsten，此过程需要部署者私钥进行签名再将数据进行广播，\n`truffle-hdwallet-provider`是truffle上提供交易离线签名的模块\n\n注：必须在truffle框架的代码目录下安装，否则不生效\n\n```\n> cd truffle-crowdfund\n> npm install truffle-hdwallet-provider\n```\n\n4、我们终于可以进行修改`truffle-config.js`部署脚本了\n\n```\n/**\n * Use this file to configure your truffle project. It's seeded with some\n * common settings for different networks and features like migrations,\n * compilation and testing. Uncomment the ones you need or modify\n * them to suit your project as necessary.\n *\n * More information about configuration can be found at:\n *\n * trufflesuite.com/docs/advanced/configuration\n *\n * To deploy via Infura you'll need a wallet provider (like @truffle/hdwallet-provider)\n * to sign your transactions before they're sent to a remote public node. Infura accounts\n * are available for free at: infura.io/register.\n *\n * You'll also need a mnemonic - the twelve word phrase the wallet uses to generate\n * public/private key pairs. If you're publishing your code to GitHub make sure you load this\n * phrase from a file you've .gitignored so it doesn't accidentally become public.\n *\n */\n\nconst HDWalletProvider = require('truffle-hdwallet-provider');\n// const infuraKey = \"fj4jll3k.....\";\n//\nconst fs = require('fs');\nconst mnemonic = fs.readFileSync(\".secret\").toString().trim();\n\nmodule.exports = {\n  /**\n   * Networks define how you connect to your ethereum client and let you set the\n   * defaults web3 uses to send transactions. If you don't specify one truffle\n   * will spin up a development blockchain for you on port 9545 when you\n   * run `develop` or `test`. You can ask a truffle command to use a specific\n   * network from the command line, e.g\n   *\n   * $ truffle test --network <network-name>\n   */\n\n  networks: {\n    // Useful for testing. The `development` name is special - truffle uses it by default\n    // if it's defined here and no other network is specified at the command line.\n    // You should run a client (like ganache-cli, geth or parity) in a separate terminal\n    // tab if you use this network and you must also set the `host`, `port` and `network_id`\n    // options below to some value.\n    //\n    mainnet: {\n      provider: function () {\n        // Setting the provider with the Infura Rinkeby address and Token\n        return new HDWalletProvider(mnemonic, \"https://mainnet.infura.io/v3/xxxx1cabc499dc5d569\")\n      },\n      network_id: 1\n    },\n    // development: {\n    //  host: \"127.0.0.1\",     // Localhost (default: none)\n    //  port: 8545,            // Standard Ethereum port (default: none)\n    //  network_id: \"*\",       // Any network (default: none)\n    // },\n    // Another network with more advanced options...\n    // advanced: {\n    // port: 8777,             // Custom port\n    // network_id: 1342,       // Custom network\n    // gas: 8500000,           // Gas sent with each transaction (default: ~6700000)\n    // gasPrice: 20000000000,  // 20 gwei (in wei) (default: 100 gwei)\n    // from: <address>,        // Account to send txs from (default: accounts[0])\n    // websocket: true        // Enable EventEmitter interface for web3 (default: false)\n    // },\n    // Useful for deploying to a public network.\n    // NB: It's important to wrap the provider as a function.\n    ropsten: {\n      provider: () => new HDWalletProvider(mnemonic, \"https://ropsten.infura.io/v3/xxxx1cabc499dc5d569\"),\n      network_id: 3,       // Ropsten's id\n      gas: 5500000,        // Ropsten has a lower block limit than mainnet\n      confirmations: 2,    // # of confs to wait between deployments. (default: 0)\n      timeoutBlocks: 200,  // # of blocks before a deployment times out  (minimum/default: 50)\n      skipDryRun: true     // Skip dry run before migrations? (default: false for public nets )\n    },\n    // Useful for private networks\n    // private: {\n    // provider: () => new HDWalletProvider(mnemonic, `https://network.io`),\n    // network_id: 2111,   // This network is yours, in the cloud.\n    // production: true    // Treats this network as if it was a public net. (default: false)\n    // }\n  },\n\n  // Set default mocha options here, use special reporters etc.\n  mocha: {\n    // timeout: 100000\n  },\n\n  // Configure your compilers\n  compilers: {\n    solc: {\n      // version: \"0.5.1\",    // Fetch exact version from solc-bin (default: truffle's version)\n      // docker: true,        // Use \"0.5.1\" you've installed locally with docker (default: false)\n      // settings: {          // See the solidity docs for advice about optimization and evmVersion\n      //  optimizer: {\n      //    enabled: false,\n      //    runs: 200\n      //  },\n      //  evmVersion: \"byzantium\"\n      // }\n    }\n  },\n\n  // Truffle DB is currently disabled by default; to enable it, change enabled: false to enabled: true\n  //\n  // Note: if you migrated your contracts prior to enabling this field in your Truffle project and want\n  // those previously migrated contracts available in the .db directory, you will need to run the following:\n  // $ truffle migrate --reset --compile-all\n\n  db: {\n    enabled: false\n  }\n};\n\n```\n\n注意这几行 \n\n```\nconst HDWalletProvider = require('truffle-hdwallet-provider');\n// const infuraKey = \"fj4jll3k.....\";\n//\nconst fs = require('fs');\nconst mnemonic = fs.readFileSync(\".secret\").toString().trim();\n\n...\n\nropsten: {\n  provider: () => new HDWalletProvider(mnemonic, \"https://ropsten.infura.io/v3/xxxx1cabc499dc5d569\"),\n  network_id: 3,       // Ropsten's id\n  gas: 5500000,        // Ropsten has a lower block limit than mainnet\n  confirmations: 2,    // # of confs to wait between deployments. (default: 0)\n  timeoutBlocks: 200,  // # of blocks before a deployment times out  (minimum/default: 50)\n  skipDryRun: true     // Skip dry run before migrations? (default: false for public nets )\n},\n```\n\n这里我们用到了 助记词 和 PROJECT-ID 我这里是在项目的根目录下创建了一个`.secret`文件 把助记词放到了文件里, 这样比较好，\n你也可以使用变量进行保存 `const infuraKey = \"fj4jll3k.....\"`\n\n5、部署到Ropsten测试网络\n\n执行`truffle migrate --network ropsten` 即可部署至Ropsten\n\n如需要重新编译所有合约，可执行`truffle migrate --network ropsten --reset --compile-all`\n\n```\nCompiling your contracts...\n===========================\n> Everything is up to date, there is nothing to compile.\n\n\n\nStarting migrations...\n======================\n> Network name:    'ropsten'\n> Network id:      3\n> Block gas limit: 8000000 (0x7a1200)\n\n\n1_initial_migration.js\n======================\n\n   Deploying 'Migrations'\n   ----------------------\n   > transaction hash:    0xe27c86dc48219fa193d23843b301d6878a6820dcc93fd92a20e24d1ec9c49b31\n   > Blocks: 3            Seconds: 14\n   > contract address:    0x2e2982D9d1914b6580139Ec4E356B708478C875F\n   > block number:        9898882\n   > block timestamp:     1616554032\n   > account:             0x270dF7D1f4612063abA065389b3fCbeF7993caA9\n   > balance:             4.93502452\n   > gas used:            193243 (0x2f2db)\n   > gas price:           20 gwei\n   > value sent:          0 ETH\n   > total cost:          0.00386486 ETH\n\n   Pausing for 2 confirmations...\n   ------------------------------\n   > confirmation number: 1 (block: 9898884)\n   > confirmation number: 2 (block: 9898885)\n\n   > Saving migration to chain.\n   > Saving artifacts\n   -------------------------------------\n   > Total cost:          0.00386486 ETH\n\n\n2_crowdfunding_migration.js\n===========================\n\n   Deploying 'CrowdFunding'\n   ------------------------\n   > transaction hash:    0x0f787b4d1567a00a8da4b28970632238fc50eb43ee7e33fb8d5c3d92fcbf5880\n   > Blocks: 2            Seconds: 25\n   > contract address:    0x3e32bF1e0Af404ed7DbCEf538BEba75ea2a76510\n   > block number:        9898889\n   > block timestamp:     1616554105\n   > account:             0x270dF7D1f4612063abA065389b3fCbeF7993caA9\n   > balance:             4.9224565\n   > gas used:            582663 (0x8e407)\n   > gas price:           20 gwei\n   > value sent:          0 ETH\n   > total cost:          0.01165326 ETH\n\n   Pausing for 2 confirmations...\n   ------------------------------\n   > confirmation number: 1 (block: 9898890)\n   > confirmation number: 2 (block: 9898891)\n\n   > Saving migration to chain.\n   > Saving artifacts\n   -------------------------------------\n   > Total cost:          0.01165326 ETH\n\n\nSummary\n=======\n> Total deployments:   2\n> Final cost:          0.01551812 ETH\n\n```\n\n### 六、使用vue项目与合约进行交互 \n\n> 利用 CrowdFund.vue 来众筹界面，众筹界面需要显示以下几个部分：\n  \n>  1、当前众筹到金额。\n>\n>  2、众筹的截止时间。\n>\n>  3、当前众筹的价格，参与众筹按钮。\n>\n>  4、如果是已经参与，显示其参与的价格以及赎回按钮。\n>\n>  5、如果是创作者，显示一个提取资金按钮。\n\n\n1、 依然是创建一个vue项目\n\n```\nvue create crowd_funding_vue\n```\n\n我们在components文件夹下创建一个`CrowdFunding.vue`文件 我们整个的`CrowdFunding.vue`文件就像是这样\n\n```\n<template>\n    <div class=\"content\">\n        <h3> 新书众筹</h3>\n        <span>以最低的价格获取我的新书 </span>\n\n        <div class=\"status\">\n            <div v-if=\"!closed\">已众筹资金：<b>{{ total }} ETH </b></div>\n            <div v-if=\"closed\"> 众筹已完成</div>\n            <div>众筹截止时间：{{ endDate }}</div>\n        </div>\n\n        <div v-if=\"joined\" class=\"card-bkg\">\n            <div class=\"award-des\">\n                <span> 参与价格 </span>\n                <b> {{ joinPrice }} ETH </b>\n            </div>\n\n            <button :disabled=\"closed\" @click=\"withdraw\">赎回</button>\n        </div>\n\n        <div v-if=\"!joined\" class=\"card-bkg\">\n            <div class=\"award-des\">\n                <span> 当前众筹价格 </span>\n                <b> {{ price }} ETH </b>\n            </div>\n\n            <button :disabled=\"closed\" @click=\"join\">参与众筹</button>\n        </div>\n\n        <div v-if=\"isAuthor\">\n            <button :disabled=\"closed\" @click=\"withdrawFund\"> 提取资金</button>\n        </div>\n\n    </div>\n</template>\n\n<script>\n    import contract from \"truffle-contract\";\n    import crowd from '../../public/build/contracts/CrowdFunding.json';\n\n    const Web3 = require('web3');\n\n    export default {\n        name: 'CrowdFund',\n        // 定义上面HTML模板中使用的变量\n        data() {\n            return {\n                price: null,\n                total: 0,\n                closed: true,\n                joinPrice: null,\n                joined: false,\n                endDate: \"null\",\n                isAuthor: true,\n            }\n        },\n        // 当前Vue组件被创建时回调的hook 函数\n        async created() {\n            //  初始化 web3及账号\n            await this.initWeb3Account()\n            //  初始化合约实例\n            await this.initContract()\n            //  获取合约的状态信息\n            await this.getCrowdInfo()\n        },\n        methods: {\n            async initWeb3Account() {\n                console.log(\"initWeb3Account 方法执行了-------\");\n                // 检查新版MetaMask\n                if (window.ethereum) {\n                    this.provider = window.ethereum;\n                    try {\n                        // 请求用户账号授权\n                        await window.ethereum.enable();\n                    } catch (error) {\n                        // 用户拒绝了访问\n                        console.log(\"User denied account access\");\n                    }\n                }\n                // 老版 MetaMask\n                else if (window.web3) {\n                    this.provider = window.web3.currentProvider;\n                }\n                // 如果没有注入的web3实例，回退到使用 Ganache\n                else {\n                    alert(\"请安装MetaMask!\");\n                     this.provider = new Web3.providers.HttpProvider(\"http://127.0.0.1:7545\");\n                }\n                this.web3 = new Web3(this.provider);\n                this.web3.eth.getAccounts().then(accs => {\n                    this.account = accs[0]\n                    console.log(accs)\n                })\n            },\n            async initContract() {\n                const crowdContract = contract(crowd)\n                crowdContract.setProvider(this.provider)\n                this.crowdFund = await crowdContract.deployed()\n            },\n            async getCrowdInfo() {\n                // 获取合约的余额\n                this.web3.eth.getBalance(this.crowdFund.address).then(\n                    r => {\n                        this.total = this.web3.utils.fromWei(r)\n                    }\n                )\n\n                // 获取读者的参与金额\n                this.crowdFund.joined(this.account).then(\n                    r => {\n                        if (r > 0) {\n                            this.joined = true\n                            this.joinPrice = this.web3.utils.fromWei(r)\n                        }\n                    }\n                )\n\n                // 获取合约的关闭状态\n                this.crowdFund.closed().then(\n                    r => this.closed = r\n                )\n\n                // 获取当前的众筹价格\n                this.crowdFund.price().then(\n                    r => this.price = this.web3.utils.fromWei(r)\n                )\n\n                // 获取众筹截止时间\n                this.crowdFund.endTime().then(r => {\n                    var endTime = new Date(r * 1000)\n                    // 把时间戳转化为本地时间\n                    this.endDate = endTime.toLocaleDateString().replace(/\\//g, \"-\") + \" \" + endTime.toTimeString().substr(0, 8);\n                })\n\n                // 获取众筹创作者地址\n                this.crowdFund.author().then(r => {\n                    if (this.account === r) {\n                        this.isAuthor = true\n                    } else {\n                        this.isAuthor = false\n                    }\n                })\n            },\n            // 读者参与众筹的 join()函数\n            join() {\n                this.web3.eth.sendTransaction({\n                    from: this.account,\n                    to: this.crowdFund.address,\n                    value: this.web3.utils.toWei(this.price)\n                }).then(() =>\n                    this.getCrowdInfo()\n                )\n            },\n            // 读者赎回的 withdraw()函数\n            withdraw() {\n                this.crowdFund.withdraw({\n                    from: this.account\n                }).then(() => {\n                    this.getCrowdInfo()\n                })\n            },\n            // 创作者提取资金的 withdrawFund()函数\n            withdrawFund() {\n                this.crowdFund.withdrawFund({\n                    from: this.account\n                }).then(() => {\n                    this.getCrowdInfo()\n                })\n            }\n        }\n    }\n</script>\n```\n\n2、与合约进行交互\n\n前端界面与合约进行交互时，需要使用到 `truffle-contract` 及 `web3` ，因为 Vue 工程本身也是通过 NPM 进行包管理，\n因此可以直接通过 npm 进行安装，命令如下：\n\n```\nnpm install --save truffle-contract web3\n```\n\n如果创建vue项目的时候已经启动了vue项目 那么你需要重新启动一下vue项目 因为安装了包之后需要重新启动 这样使用import导入包的时候\n才不会报错。\n\n3、将智能合约项目编译产生的`build`文件夹放进vue项目中的`public`文件夹下 注意看上面的这句话\n\n```\nimport crowd from '../../public/build/contracts/CrowdFunding.json';\n```\n\n4、启动vue项目进行交互 看起来就像这样\n\n```\nnpm run serve\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325105129.png)\n\n\n#### 特别感谢一下博文\n\n1、[如何使用Vue.js 开发以太坊DApp](https://learnblockchain.cn/2019/12/20/vue-dapp)\n\n2、[以太坊ETH-智能合约开发-solidity源码分析-truffle进阶](https://blog.csdn.net/u010159567/article/details/104895457)\n\n3、[Infura：一键接入以太坊](https://blog.csdn.net/TurkeyCock/article/details/85103434)\n\n4、[Truffle 和 MetaMask 配合](https://learnblockchain.cn/docs/truffle/getting-started/truffle-with-metamask.html)\n\n5、[详解 Truffle Migrations （迁移）- 合约部署不再困惑](https://www.chainnews.com/articles/823921189500.htm)\n\n6、[以太坊开发资源全面指南](http://blog.hubwiz.com/2019/09/13/ethereum-dev-tools-2019/#%E6%96%B0%E6%89%8B%E5%85%A5%E9%97%A8)\n\n","slug":"ETH智能合约开发","published":1,"updated":"2021-03-25T03:09:50.048Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwd000s3ys28j7adx9g","content":"<h2 id=\"ETH智能合约开发-vue-智能合约\"><a href=\"#ETH智能合约开发-vue-智能合约\" class=\"headerlink\" title=\"ETH智能合约开发(vue + 智能合约)\"></a>ETH智能合约开发(vue + 智能合约)</h2><h3 id=\"一、什么是ETH智能合约\"><a href=\"#一、什么是ETH智能合约\" class=\"headerlink\" title=\"一、什么是ETH智能合约\"></a>一、什么是ETH智能合约</h3><blockquote>\n<p>说白了就是一段可以运行在以太坊平台上的代码，应用中，我们可以使用 Solidity 来编写和区块链交互的智能合约，<br>合约编写好之后，我们通过一个有余额的外部账户将合约部署到以太坊节点上，<br>并运行合约（使用 Truffle 框架可以更好的帮助我们做这些事情）</p>\n</blockquote>\n<h3 id=\"二、Truffle-和-ganache-cli-简介\"><a href=\"#二、Truffle-和-ganache-cli-简介\" class=\"headerlink\" title=\"二、Truffle 和 ganache-cli 简介\"></a>二、Truffle 和 ganache-cli 简介</h3><blockquote>\n<p>Truffle Truffle是Dapp开发框架，他可以帮我们处理掉大量无关紧要的小事情，<br>让我们可以迅速开始写代码-编译-部署-测试-打包DApp这个流程。<br>Truffle是使用Nodejs开发的，我们首先需要安装Nodejs运行环境。</p>\n</blockquote>\n<blockquote>\n<p>ganache-cli是以太坊节点仿真器软件ganache的命令行版本，可以方便开发者快速进行以太坊DApp的开发与测试。</p>\n</blockquote>\n<p>1、Truffle安装</p>\n<p>查看node版本 没有安装node的请自行google安装</p>\n<pre><code># Nodejs版本\n&gt; npm -v\n6.0.0\n&gt; node -v\nv8.9.4</code></pre>\n<p>全局安装Truffle工具。</p>\n<pre><code>npm install -g truffle</code></pre>\n<p>安装完成后查看命令行是否安装成功</p>\n<pre><code>&gt; truffle\nTruffle v4.1.12 - a development framework for Ethereum\n\nUsage: truffle  [options]\n\nCommands:\n  init      Initialize new and empty Ethereum project\n  compile   Compile contract source files\n  migrate   Run migrations to deploy contracts\n  deploy    (alias for migrate)\n  build     Execute build pipeline (if configuration present)\n  test      Run JavaScript and Solidity tests\n  debug     Interactively debug any transaction on the blockchain (experimental)\n  opcode    Print the compiled opcodes for a given contract\n  console   Run a console with contract abstractions and commands available\n  develop   Open a console with a local development blockchain\n  create    Helper to create new contracts, migrations and tests\n  install   Install a package from the Ethereum Package Registry\n  publish   Publish a package to the Ethereum Package Registry\n  networks  Show addresses for deployed contracts on each network\n  watch     Watch filesystem for changes and rebuild the project automatically\n  serve     Serve the build directory on localhost and watch for changes\n  exec      Execute a JS module within this Truffle environment\n  unbox     Download a Truffle Box, a pre-built Truffle project\n  version   Show version number and exit\n\nSee more at http://truffleframework.com/docs</code></pre>\n<p>2、全局安装ganache-cli</p>\n<pre><code>npm install -g ganache-cli</code></pre>\n<h3 id=\"三、创建项目\"><a href=\"#三、创建项目\" class=\"headerlink\" title=\"三、创建项目\"></a>三、创建项目</h3><pre><code>&gt; cd ~\n&gt; mkdir truffle-crowdfund\n&gt; cd truffle-crowdfund\n# 初始化项目\n&gt; truffle init\nDownloading...\nUnpacking...\nSetting up...\nUnbox successful. Sweet!\n\nCommands:\n\n  Compile:        truffle compile\n  Migrate:        truffle migrate\n  Test contracts: truffle test</code></pre>\n<h3 id=\"四、启动测试节点\"><a href=\"#四、启动测试节点\" class=\"headerlink\" title=\"四、启动测试节点\"></a>四、启动测试节点</h3><pre><code>ganache-cli</code></pre>\n<p>它会自动给我们生成10个带有100个eth的账户</p>\n<h3 id=\"五、接下来写合约代码并部署到测试网络上\"><a href=\"#五、接下来写合约代码并部署到测试网络上\" class=\"headerlink\" title=\"五、接下来写合约代码并部署到测试网络上\"></a>五、接下来写合约代码并部署到测试网络上</h3><h4 id=\"需求：\"><a href=\"#需求：\" class=\"headerlink\" title=\"需求：\"></a>需求：</h4><blockquote>\n<p>假设我准备出版一本区块练技术书籍，但是不确定有多少人愿意购买这本书，于是我发起了一个众筹， 如果在一个月内，<br>  能筹集到 10 个 ETH，我就进行写作，并给参与的读者每人赠送一本书，如果未能筹到足够的资金，<br>  参与的读者赎回之前投入的资金。<br>  同时，为了让读者积极参与，初始时，参与众筹的价格非常低（0.02 ETH），每筹集满 1 个 ETH 时，价格上涨 0.002ETH。<br>  归纳出合约三个对外动作（函数）：</p>\n</blockquote>\n<blockquote>\n<p>1、汇款进合约，可通过实现合约的回退函数来实现。</p>\n<p>2、读者赎回汇款，这个函数仅仅在众筹未达标之后，由读者本人调用生效。</p>\n<p>3、创作者提取资金，这个函数需要在众筹达标之后，由创作者调用。</p>\n</blockquote>\n<blockquote>\n<p>除此之外，还需要一个状态变量来保存以下状态：</p>\n</blockquote>\n<blockquote>\n<p>1、用户众筹的金额，使用一个 mapping 来保存。</p>\n<p>2、当前众筹的价格，以及一个相应的内部函数逐步上涨价格。价格可以使用一个 uint 来保存。</p>\n<p>3、合约众筹的截止时间，用 uint 来保存， 在合约创建时往后追加 30 天，在构造函数中完成。</p>\n<p>4、记录合约众筹的收益者，即创作者，在合约创建时在构造函数中进行赋值，合约创建者就是创作者。</p>\n<p>5、再加入众筹状态，如果众筹停止阻止用户在参与。创作者提取资金时及时关闭众筹。</p>\n</blockquote>\n<h4 id=\"实现众筹合约\"><a href=\"#实现众筹合约\" class=\"headerlink\" title=\"实现众筹合约\"></a>实现众筹合约</h4><p>我们进入到上面使用<code>truffle init</code>命令创建的项目中去</p>\n<p>在 contracts 下创建一个合约文件 Crowdfunding.sol:</p>\n<pre><code>pragma solidity &gt;=0.4.21 &lt;0.7.0;\n\n\ncontract Crowdfunding {\n    // 创作者\n    address public author;\n\n    // 参与金额\n    mapping(address =&gt; uint) public joined;\n\n    // 众筹目标\n    uint constant Target = 10 ether;\n\n    // 众筹截止时间\n    uint public endTime;\n\n    // 记录当前众筹价格\n    uint public price  = 0.02 ether ;\n\n    // 作者提取资金之后，关闭众筹\n    bool public closed = false;\n\n    // 部署合约时调用，初始化作者以及众筹结束时间\n    constructor() public {\n        author = msg.sender;\n        endTime = now + 30 days;\n    }\n\n    // 更新价格，这是一个内部函数\n    function updatePrice() internal {\n        uint rise = address(this).balance / 1 ether * 0.002 ether;\n        price = 0.02 ether + rise;\n    }\n\n    // 用户向合约转账时 触发的回调函数\n    function () external payable {\n        require(now &lt; endTime &amp;&amp; !closed  , \"众筹已结束\");\n        require(joined[msg.sender] == 0 , \"你已经参与过众筹\");\n\n        require (msg.value &gt;= price, \"出价太低了\");\n        joined[msg.sender] = msg.value;\n\n        updatePrice();\n    } \n\n    // 作者提取资金\n    function withdrawFund() external {\n        require(msg.sender == author, \"你不是作者\");\n        require(address(this).balance &gt;= Target, \"未达到众筹目标\");\n        closed = true;   \n        msg.sender.transfer(address(this).balance);\n    }\n\n    // 读者赎回资金\n    function withdraw() external {\n        require(now &gt; endTime, \"还未到众筹结束时间\");\n        require(!closed, \"众筹达标，众筹资金已提取\");\n        require(Target &gt; address(this).balance, \"众筹达标，你没法提取资金\");\n\n        msg.sender.transfer(joined[msg.sender]);\n    }\n\n}</code></pre>\n<blockquote>\n<p>代码的介绍，在合约代码中，使用到了 Solidity 语言中的一些知识点：</p>\n</blockquote>\n<blockquote>\n<p>ether : 这是货币单位<br>。<br>days : 这是时间单位，1 days 对应 1 天的秒数。</p>\n<p>now : 这是一个 Solidity 的内置属性，用于获取当前的时间戳，单位是秒。</p>\n<p>require : 如果条件不满足回退交易。</p>\n<p>address.transfer(value) : 对某一个地址进行转账。</p>\n<p>有关 Solidity 语言入门推荐大家使用官网课程 <a href=\"https://cryptozombies.io/zh/course/\">僵尸游戏</a></p>\n</blockquote>\n<h4 id=\"合约部署\"><a href=\"#合约部署\" class=\"headerlink\" title=\"合约部署\"></a>合约部署</h4><p>部署之前我们使用 <code>truffle compile</code> 命令来进行编译</p>\n<p>之后，在 migrations 下创建一个部署脚本 2_crowfunding.js ，内容如下：</p>\n<pre><code>const crowd = artifacts.require(\"Crowdfunding\");\n\nmodule.exports = function(deployer) {\n  deployer.deploy(crowd);\n};</code></pre>\n<p>接下来你的文件目录应该是这样的:</p>\n<pre><code>├── build\n│&nbsp;&nbsp; └── contracts\n│&nbsp;&nbsp;     ├── CrowdFunding.json\n│&nbsp;&nbsp;     └── Migrations.json\n├── contracts\n│&nbsp;&nbsp; ├── CrowdFunding.sol\n│&nbsp;&nbsp; └── Migrations.sol\n├── migrations\n│&nbsp;&nbsp; ├── 1_initial_migration.js\n│&nbsp;&nbsp; └── 2_crowdfunding_migration.js\n├── test\n└── truffle-config.js\n</code></pre>\n<p>注意一下这个<code>1_initial_migration.js</code>文件和 <code>Migrations.sol</code>文件 这是我们在使用<code>truffle init</code>命令初始化项目时它为我们生成的文件 这两个文件是不能删除的否则会无法进行部署，我们在<code>migrations</code>文件夹下面创建的文件要按照 1_xxx.js, 2_xxx.js 在部署的时候是按照这个顺序进行的。</p>\n<p>下面我们配置部署脚本<code>truffle-config.js</code></p>\n<p>配置之前 我们还需要做一些事情：</p>\n<p>1、注册infura获取PROJECT-ID</p>\n<p><a href=\"https://infura.io/\">infura</a>是基于ETH的chain公共API服务，为开发者提供链上数据查询、交易广播等功能。</p>\n<p>注册成功之后需要创建项目</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325100549.png\"></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325100631.png\"></p>\n<p>项目名字是随便起的无所谓</p>\n<p>项目创建完之后你就能看到PROJECT-ID了这个我们待会要用</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325100830.png\"></p>\n<p>2、我们还需要一个浏览器插件 <a href=\"https://metamask.io/\">MetaMask</a> 推荐大家使用Chrome浏览器 </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325101145.png\"></p>\n<p>按照步骤注册账户，并将助记词保存下来， 我们下面要用到</p>\n<p>我们需要获取ETH，以为部署是要gas费的, 测试网络可以每天给我们5个ETH 这足够我们使用了</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325103044.png\"></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325103155.png\"></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325103316.png\"></p>\n<p>3、安装 <code>truffle-hdwallet-provider</code></p>\n<p>由于需要将合约部署到测试网Ropsten，此过程需要部署者私钥进行签名再将数据进行广播，<br><code>truffle-hdwallet-provider</code>是truffle上提供交易离线签名的模块</p>\n<p>注：必须在truffle框架的代码目录下安装，否则不生效</p>\n<pre><code>&gt; cd truffle-crowdfund\n&gt; npm install truffle-hdwallet-provider</code></pre>\n<p>4、我们终于可以进行修改<code>truffle-config.js</code>部署脚本了</p>\n<pre><code>/**\n * Use this file to configure your truffle project. It's seeded with some\n * common settings for different networks and features like migrations,\n * compilation and testing. Uncomment the ones you need or modify\n * them to suit your project as necessary.\n *\n * More information about configuration can be found at:\n *\n * trufflesuite.com/docs/advanced/configuration\n *\n * To deploy via Infura you'll need a wallet provider (like @truffle/hdwallet-provider)\n * to sign your transactions before they're sent to a remote public node. Infura accounts\n * are available for free at: infura.io/register.\n *\n * You'll also need a mnemonic - the twelve word phrase the wallet uses to generate\n * public/private key pairs. If you're publishing your code to GitHub make sure you load this\n * phrase from a file you've .gitignored so it doesn't accidentally become public.\n *\n */\n\nconst HDWalletProvider = require('truffle-hdwallet-provider');\n// const infuraKey = \"fj4jll3k.....\";\n//\nconst fs = require('fs');\nconst mnemonic = fs.readFileSync(\".secret\").toString().trim();\n\nmodule.exports = {\n  /**\n   * Networks define how you connect to your ethereum client and let you set the\n   * defaults web3 uses to send transactions. If you don't specify one truffle\n   * will spin up a development blockchain for you on port 9545 when you\n   * run `develop` or `test`. You can ask a truffle command to use a specific\n   * network from the command line, e.g\n   *\n   * $ truffle test --network &lt;network-name&gt;\n   */\n\n  networks: {\n    // Useful for testing. The `development` name is special - truffle uses it by default\n    // if it's defined here and no other network is specified at the command line.\n    // You should run a client (like ganache-cli, geth or parity) in a separate terminal\n    // tab if you use this network and you must also set the `host`, `port` and `network_id`\n    // options below to some value.\n    //\n    mainnet: {\n      provider: function () {\n        // Setting the provider with the Infura Rinkeby address and Token\n        return new HDWalletProvider(mnemonic, \"https://mainnet.infura.io/v3/xxxx1cabc499dc5d569\")\n      },\n      network_id: 1\n    },\n    // development: {\n    //  host: \"127.0.0.1\",     // Localhost (default: none)\n    //  port: 8545,            // Standard Ethereum port (default: none)\n    //  network_id: \"*\",       // Any network (default: none)\n    // },\n    // Another network with more advanced options...\n    // advanced: {\n    // port: 8777,             // Custom port\n    // network_id: 1342,       // Custom network\n    // gas: 8500000,           // Gas sent with each transaction (default: ~6700000)\n    // gasPrice: 20000000000,  // 20 gwei (in wei) (default: 100 gwei)\n    // from: &lt;address&gt;,        // Account to send txs from (default: accounts[0])\n    // websocket: true        // Enable EventEmitter interface for web3 (default: false)\n    // },\n    // Useful for deploying to a public network.\n    // NB: It's important to wrap the provider as a function.\n    ropsten: {\n      provider: () =&gt; new HDWalletProvider(mnemonic, \"https://ropsten.infura.io/v3/xxxx1cabc499dc5d569\"),\n      network_id: 3,       // Ropsten's id\n      gas: 5500000,        // Ropsten has a lower block limit than mainnet\n      confirmations: 2,    // # of confs to wait between deployments. (default: 0)\n      timeoutBlocks: 200,  // # of blocks before a deployment times out  (minimum/default: 50)\n      skipDryRun: true     // Skip dry run before migrations? (default: false for public nets )\n    },\n    // Useful for private networks\n    // private: {\n    // provider: () =&gt; new HDWalletProvider(mnemonic, `https://network.io`),\n    // network_id: 2111,   // This network is yours, in the cloud.\n    // production: true    // Treats this network as if it was a public net. (default: false)\n    // }\n  },\n\n  // Set default mocha options here, use special reporters etc.\n  mocha: {\n    // timeout: 100000\n  },\n\n  // Configure your compilers\n  compilers: {\n    solc: {\n      // version: \"0.5.1\",    // Fetch exact version from solc-bin (default: truffle's version)\n      // docker: true,        // Use \"0.5.1\" you've installed locally with docker (default: false)\n      // settings: {          // See the solidity docs for advice about optimization and evmVersion\n      //  optimizer: {\n      //    enabled: false,\n      //    runs: 200\n      //  },\n      //  evmVersion: \"byzantium\"\n      // }\n    }\n  },\n\n  // Truffle DB is currently disabled by default; to enable it, change enabled: false to enabled: true\n  //\n  // Note: if you migrated your contracts prior to enabling this field in your Truffle project and want\n  // those previously migrated contracts available in the .db directory, you will need to run the following:\n  // $ truffle migrate --reset --compile-all\n\n  db: {\n    enabled: false\n  }\n};\n</code></pre>\n<p>注意这几行 </p>\n<pre><code>const HDWalletProvider = require('truffle-hdwallet-provider');\n// const infuraKey = \"fj4jll3k.....\";\n//\nconst fs = require('fs');\nconst mnemonic = fs.readFileSync(\".secret\").toString().trim();\n\n...\n\nropsten: {\n  provider: () =&gt; new HDWalletProvider(mnemonic, \"https://ropsten.infura.io/v3/xxxx1cabc499dc5d569\"),\n  network_id: 3,       // Ropsten's id\n  gas: 5500000,        // Ropsten has a lower block limit than mainnet\n  confirmations: 2,    // # of confs to wait between deployments. (default: 0)\n  timeoutBlocks: 200,  // # of blocks before a deployment times out  (minimum/default: 50)\n  skipDryRun: true     // Skip dry run before migrations? (default: false for public nets )\n},</code></pre>\n<p>这里我们用到了 助记词 和 PROJECT-ID 我这里是在项目的根目录下创建了一个<code>.secret</code>文件 把助记词放到了文件里, 这样比较好，<br>你也可以使用变量进行保存 <code>const infuraKey = \"fj4jll3k.....\"</code></p>\n<p>5、部署到Ropsten测试网络</p>\n<p>执行<code>truffle migrate --network ropsten</code> 即可部署至Ropsten</p>\n<p>如需要重新编译所有合约，可执行<code>truffle migrate --network ropsten --reset --compile-all</code></p>\n<pre><code>Compiling your contracts...\n===========================\n&gt; Everything is up to date, there is nothing to compile.\n\n\n\nStarting migrations...\n======================\n&gt; Network name:    'ropsten'\n&gt; Network id:      3\n&gt; Block gas limit: 8000000 (0x7a1200)\n\n\n1_initial_migration.js\n======================\n\n   Deploying 'Migrations'\n   ----------------------\n   &gt; transaction hash:    0xe27c86dc48219fa193d23843b301d6878a6820dcc93fd92a20e24d1ec9c49b31\n   &gt; Blocks: 3            Seconds: 14\n   &gt; contract address:    0x2e2982D9d1914b6580139Ec4E356B708478C875F\n   &gt; block number:        9898882\n   &gt; block timestamp:     1616554032\n   &gt; account:             0x270dF7D1f4612063abA065389b3fCbeF7993caA9\n   &gt; balance:             4.93502452\n   &gt; gas used:            193243 (0x2f2db)\n   &gt; gas price:           20 gwei\n   &gt; value sent:          0 ETH\n   &gt; total cost:          0.00386486 ETH\n\n   Pausing for 2 confirmations...\n   ------------------------------\n   &gt; confirmation number: 1 (block: 9898884)\n   &gt; confirmation number: 2 (block: 9898885)\n\n   &gt; Saving migration to chain.\n   &gt; Saving artifacts\n   -------------------------------------\n   &gt; Total cost:          0.00386486 ETH\n\n\n2_crowdfunding_migration.js\n===========================\n\n   Deploying 'CrowdFunding'\n   ------------------------\n   &gt; transaction hash:    0x0f787b4d1567a00a8da4b28970632238fc50eb43ee7e33fb8d5c3d92fcbf5880\n   &gt; Blocks: 2            Seconds: 25\n   &gt; contract address:    0x3e32bF1e0Af404ed7DbCEf538BEba75ea2a76510\n   &gt; block number:        9898889\n   &gt; block timestamp:     1616554105\n   &gt; account:             0x270dF7D1f4612063abA065389b3fCbeF7993caA9\n   &gt; balance:             4.9224565\n   &gt; gas used:            582663 (0x8e407)\n   &gt; gas price:           20 gwei\n   &gt; value sent:          0 ETH\n   &gt; total cost:          0.01165326 ETH\n\n   Pausing for 2 confirmations...\n   ------------------------------\n   &gt; confirmation number: 1 (block: 9898890)\n   &gt; confirmation number: 2 (block: 9898891)\n\n   &gt; Saving migration to chain.\n   &gt; Saving artifacts\n   -------------------------------------\n   &gt; Total cost:          0.01165326 ETH\n\n\nSummary\n=======\n&gt; Total deployments:   2\n&gt; Final cost:          0.01551812 ETH\n</code></pre>\n<h3 id=\"六、使用vue项目与合约进行交互\"><a href=\"#六、使用vue项目与合约进行交互\" class=\"headerlink\" title=\"六、使用vue项目与合约进行交互\"></a>六、使用vue项目与合约进行交互</h3><blockquote>\n<p>利用 CrowdFund.vue 来众筹界面，众筹界面需要显示以下几个部分：</p>\n</blockquote>\n<blockquote>\n<p> 1、当前众筹到金额。</p>\n<p> 2、众筹的截止时间。</p>\n<p> 3、当前众筹的价格，参与众筹按钮。</p>\n<p> 4、如果是已经参与，显示其参与的价格以及赎回按钮。</p>\n<p> 5、如果是创作者，显示一个提取资金按钮。</p>\n</blockquote>\n<p>1、 依然是创建一个vue项目</p>\n<pre><code>vue create crowd_funding_vue</code></pre>\n<p>我们在components文件夹下创建一个<code>CrowdFunding.vue</code>文件 我们整个的<code>CrowdFunding.vue</code>文件就像是这样</p>\n<pre><code>&lt;template&gt;\n    &lt;div class=\"content\"&gt;\n        &lt;h3&gt; 新书众筹&lt;/h3&gt;\n        &lt;span&gt;以最低的价格获取我的新书 &lt;/span&gt;\n\n        &lt;div class=\"status\"&gt;\n            &lt;div v-if=\"!closed\"&gt;已众筹资金：&lt;b&gt;{{ total }} ETH &lt;/b&gt;&lt;/div&gt;\n            &lt;div v-if=\"closed\"&gt; 众筹已完成&lt;/div&gt;\n            &lt;div&gt;众筹截止时间：{{ endDate }}&lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div v-if=\"joined\" class=\"card-bkg\"&gt;\n            &lt;div class=\"award-des\"&gt;\n                &lt;span&gt; 参与价格 &lt;/span&gt;\n                &lt;b&gt; {{ joinPrice }} ETH &lt;/b&gt;\n            &lt;/div&gt;\n\n            &lt;button :disabled=\"closed\" @click=\"withdraw\"&gt;赎回&lt;/button&gt;\n        &lt;/div&gt;\n\n        &lt;div v-if=\"!joined\" class=\"card-bkg\"&gt;\n            &lt;div class=\"award-des\"&gt;\n                &lt;span&gt; 当前众筹价格 &lt;/span&gt;\n                &lt;b&gt; {{ price }} ETH &lt;/b&gt;\n            &lt;/div&gt;\n\n            &lt;button :disabled=\"closed\" @click=\"join\"&gt;参与众筹&lt;/button&gt;\n        &lt;/div&gt;\n\n        &lt;div v-if=\"isAuthor\"&gt;\n            &lt;button :disabled=\"closed\" @click=\"withdrawFund\"&gt; 提取资金&lt;/button&gt;\n        &lt;/div&gt;\n\n    &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\n    import contract from \"truffle-contract\";\n    import crowd from '../../public/build/contracts/CrowdFunding.json';\n\n    const Web3 = require('web3');\n\n    export default {\n        name: 'CrowdFund',\n        // 定义上面HTML模板中使用的变量\n        data() {\n            return {\n                price: null,\n                total: 0,\n                closed: true,\n                joinPrice: null,\n                joined: false,\n                endDate: \"null\",\n                isAuthor: true,\n            }\n        },\n        // 当前Vue组件被创建时回调的hook 函数\n        async created() {\n            //  初始化 web3及账号\n            await this.initWeb3Account()\n            //  初始化合约实例\n            await this.initContract()\n            //  获取合约的状态信息\n            await this.getCrowdInfo()\n        },\n        methods: {\n            async initWeb3Account() {\n                console.log(\"initWeb3Account 方法执行了-------\");\n                // 检查新版MetaMask\n                if (window.ethereum) {\n                    this.provider = window.ethereum;\n                    try {\n                        // 请求用户账号授权\n                        await window.ethereum.enable();\n                    } catch (error) {\n                        // 用户拒绝了访问\n                        console.log(\"User denied account access\");\n                    }\n                }\n                // 老版 MetaMask\n                else if (window.web3) {\n                    this.provider = window.web3.currentProvider;\n                }\n                // 如果没有注入的web3实例，回退到使用 Ganache\n                else {\n                    alert(\"请安装MetaMask!\");\n                     this.provider = new Web3.providers.HttpProvider(\"http://127.0.0.1:7545\");\n                }\n                this.web3 = new Web3(this.provider);\n                this.web3.eth.getAccounts().then(accs =&gt; {\n                    this.account = accs[0]\n                    console.log(accs)\n                })\n            },\n            async initContract() {\n                const crowdContract = contract(crowd)\n                crowdContract.setProvider(this.provider)\n                this.crowdFund = await crowdContract.deployed()\n            },\n            async getCrowdInfo() {\n                // 获取合约的余额\n                this.web3.eth.getBalance(this.crowdFund.address).then(\n                    r =&gt; {\n                        this.total = this.web3.utils.fromWei(r)\n                    }\n                )\n\n                // 获取读者的参与金额\n                this.crowdFund.joined(this.account).then(\n                    r =&gt; {\n                        if (r &gt; 0) {\n                            this.joined = true\n                            this.joinPrice = this.web3.utils.fromWei(r)\n                        }\n                    }\n                )\n\n                // 获取合约的关闭状态\n                this.crowdFund.closed().then(\n                    r =&gt; this.closed = r\n                )\n\n                // 获取当前的众筹价格\n                this.crowdFund.price().then(\n                    r =&gt; this.price = this.web3.utils.fromWei(r)\n                )\n\n                // 获取众筹截止时间\n                this.crowdFund.endTime().then(r =&gt; {\n                    var endTime = new Date(r * 1000)\n                    // 把时间戳转化为本地时间\n                    this.endDate = endTime.toLocaleDateString().replace(/\\//g, \"-\") + \" \" + endTime.toTimeString().substr(0, 8);\n                })\n\n                // 获取众筹创作者地址\n                this.crowdFund.author().then(r =&gt; {\n                    if (this.account === r) {\n                        this.isAuthor = true\n                    } else {\n                        this.isAuthor = false\n                    }\n                })\n            },\n            // 读者参与众筹的 join()函数\n            join() {\n                this.web3.eth.sendTransaction({\n                    from: this.account,\n                    to: this.crowdFund.address,\n                    value: this.web3.utils.toWei(this.price)\n                }).then(() =&gt;\n                    this.getCrowdInfo()\n                )\n            },\n            // 读者赎回的 withdraw()函数\n            withdraw() {\n                this.crowdFund.withdraw({\n                    from: this.account\n                }).then(() =&gt; {\n                    this.getCrowdInfo()\n                })\n            },\n            // 创作者提取资金的 withdrawFund()函数\n            withdrawFund() {\n                this.crowdFund.withdrawFund({\n                    from: this.account\n                }).then(() =&gt; {\n                    this.getCrowdInfo()\n                })\n            }\n        }\n    }\n&lt;/script&gt;</code></pre>\n<p>2、与合约进行交互</p>\n<p>前端界面与合约进行交互时，需要使用到 <code>truffle-contract</code> 及 <code>web3</code> ，因为 Vue 工程本身也是通过 NPM 进行包管理，<br>因此可以直接通过 npm 进行安装，命令如下：</p>\n<pre><code>npm install --save truffle-contract web3</code></pre>\n<p>如果创建vue项目的时候已经启动了vue项目 那么你需要重新启动一下vue项目 因为安装了包之后需要重新启动 这样使用import导入包的时候<br>才不会报错。</p>\n<p>3、将智能合约项目编译产生的<code>build</code>文件夹放进vue项目中的<code>public</code>文件夹下 注意看上面的这句话</p>\n<pre><code>import crowd from '../../public/build/contracts/CrowdFunding.json';</code></pre>\n<p>4、启动vue项目进行交互 看起来就像这样</p>\n<pre><code>npm run serve</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325105129.png\"></p>\n<h4 id=\"特别感谢一下博文\"><a href=\"#特别感谢一下博文\" class=\"headerlink\" title=\"特别感谢一下博文\"></a>特别感谢一下博文</h4><p>1、<a href=\"https://learnblockchain.cn/2019/12/20/vue-dapp\">如何使用Vue.js 开发以太坊DApp</a></p>\n<p>2、<a href=\"https://blog.csdn.net/u010159567/article/details/104895457\">以太坊ETH-智能合约开发-solidity源码分析-truffle进阶</a></p>\n<p>3、<a href=\"https://blog.csdn.net/TurkeyCock/article/details/85103434\">Infura：一键接入以太坊</a></p>\n<p>4、<a href=\"https://learnblockchain.cn/docs/truffle/getting-started/truffle-with-metamask.html\">Truffle 和 MetaMask 配合</a></p>\n<p>5、<a href=\"https://www.chainnews.com/articles/823921189500.htm\">详解 Truffle Migrations （迁移）- 合约部署不再困惑</a></p>\n<p>6、<a href=\"http://blog.hubwiz.com/2019/09/13/ethereum-dev-tools-2019/#%E6%96%B0%E6%89%8B%E5%85%A5%E9%97%A8\">以太坊开发资源全面指南</a></p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h2 id=\"ETH智能合约开发-vue-智能合约\"><a href=\"#ETH智能合约开发-vue-智能合约\" class=\"headerlink\" title=\"ETH智能合约开发(vue + 智能合约)\"></a>ETH智能合约开发(vue + 智能合约)</h2><h3 id=\"一、什么是ETH智能合约\"><a href=\"#一、什么是ETH智能合约\" class=\"headerlink\" title=\"一、什么是ETH智能合约\"></a>一、什么是ETH智能合约</h3><blockquote>\n<p>说白了就是一段可以运行在以太坊平台上的代码，应用中，我们可以使用 Solidity 来编写和区块链交互的智能合约，<br>合约编写好之后，我们通过一个有余额的外部账户将合约部署到以太坊节点上，<br>并运行合约（使用 Truffle 框架可以更好的帮助我们做这些事情）</p>\n</blockquote>\n<h3 id=\"二、Truffle-和-ganache-cli-简介\"><a href=\"#二、Truffle-和-ganache-cli-简介\" class=\"headerlink\" title=\"二、Truffle 和 ganache-cli 简介\"></a>二、Truffle 和 ganache-cli 简介</h3><blockquote>\n<p>Truffle Truffle是Dapp开发框架，他可以帮我们处理掉大量无关紧要的小事情，<br>让我们可以迅速开始写代码-编译-部署-测试-打包DApp这个流程。<br>Truffle是使用Nodejs开发的，我们首先需要安装Nodejs运行环境。</p>\n</blockquote>\n<blockquote>\n<p>ganache-cli是以太坊节点仿真器软件ganache的命令行版本，可以方便开发者快速进行以太坊DApp的开发与测试。</p>\n</blockquote>\n<p>1、Truffle安装</p>\n<p>查看node版本 没有安装node的请自行google安装</p>\n<pre><code># Nodejs版本\n&gt; npm -v\n6.0.0\n&gt; node -v\nv8.9.4</code></pre>\n<p>全局安装Truffle工具。</p>\n<pre><code>npm install -g truffle</code></pre>\n<p>安装完成后查看命令行是否安装成功</p>\n<pre><code>&gt; truffle\nTruffle v4.1.12 - a development framework for Ethereum\n\nUsage: truffle  [options]\n\nCommands:\n  init      Initialize new and empty Ethereum project\n  compile   Compile contract source files\n  migrate   Run migrations to deploy contracts\n  deploy    (alias for migrate)\n  build     Execute build pipeline (if configuration present)\n  test      Run JavaScript and Solidity tests\n  debug     Interactively debug any transaction on the blockchain (experimental)\n  opcode    Print the compiled opcodes for a given contract\n  console   Run a console with contract abstractions and commands available\n  develop   Open a console with a local development blockchain\n  create    Helper to create new contracts, migrations and tests\n  install   Install a package from the Ethereum Package Registry\n  publish   Publish a package to the Ethereum Package Registry\n  networks  Show addresses for deployed contracts on each network\n  watch     Watch filesystem for changes and rebuild the project automatically\n  serve     Serve the build directory on localhost and watch for changes\n  exec      Execute a JS module within this Truffle environment\n  unbox     Download a Truffle Box, a pre-built Truffle project\n  version   Show version number and exit\n\nSee more at http://truffleframework.com/docs</code></pre>\n<p>2、全局安装ganache-cli</p>\n<pre><code>npm install -g ganache-cli</code></pre>\n<h3 id=\"三、创建项目\"><a href=\"#三、创建项目\" class=\"headerlink\" title=\"三、创建项目\"></a>三、创建项目</h3><pre><code>&gt; cd ~\n&gt; mkdir truffle-crowdfund\n&gt; cd truffle-crowdfund\n# 初始化项目\n&gt; truffle init\nDownloading...\nUnpacking...\nSetting up...\nUnbox successful. Sweet!\n\nCommands:\n\n  Compile:        truffle compile\n  Migrate:        truffle migrate\n  Test contracts: truffle test</code></pre>\n<h3 id=\"四、启动测试节点\"><a href=\"#四、启动测试节点\" class=\"headerlink\" title=\"四、启动测试节点\"></a>四、启动测试节点</h3><pre><code>ganache-cli</code></pre>\n<p>它会自动给我们生成10个带有100个eth的账户</p>\n<h3 id=\"五、接下来写合约代码并部署到测试网络上\"><a href=\"#五、接下来写合约代码并部署到测试网络上\" class=\"headerlink\" title=\"五、接下来写合约代码并部署到测试网络上\"></a>五、接下来写合约代码并部署到测试网络上</h3><h4 id=\"需求：\"><a href=\"#需求：\" class=\"headerlink\" title=\"需求：\"></a>需求：</h4><blockquote>\n<p>假设我准备出版一本区块练技术书籍，但是不确定有多少人愿意购买这本书，于是我发起了一个众筹， 如果在一个月内，<br>  能筹集到 10 个 ETH，我就进行写作，并给参与的读者每人赠送一本书，如果未能筹到足够的资金，<br>  参与的读者赎回之前投入的资金。<br>  同时，为了让读者积极参与，初始时，参与众筹的价格非常低（0.02 ETH），每筹集满 1 个 ETH 时，价格上涨 0.002ETH。<br>  归纳出合约三个对外动作（函数）：</p>\n</blockquote>\n<blockquote>\n<p>1、汇款进合约，可通过实现合约的回退函数来实现。</p>\n<p>2、读者赎回汇款，这个函数仅仅在众筹未达标之后，由读者本人调用生效。</p>\n<p>3、创作者提取资金，这个函数需要在众筹达标之后，由创作者调用。</p>\n</blockquote>\n<blockquote>\n<p>除此之外，还需要一个状态变量来保存以下状态：</p>\n</blockquote>\n<blockquote>\n<p>1、用户众筹的金额，使用一个 mapping 来保存。</p>\n<p>2、当前众筹的价格，以及一个相应的内部函数逐步上涨价格。价格可以使用一个 uint 来保存。</p>\n<p>3、合约众筹的截止时间，用 uint 来保存， 在合约创建时往后追加 30 天，在构造函数中完成。</p>\n<p>4、记录合约众筹的收益者，即创作者，在合约创建时在构造函数中进行赋值，合约创建者就是创作者。</p>\n<p>5、再加入众筹状态，如果众筹停止阻止用户在参与。创作者提取资金时及时关闭众筹。</p>\n</blockquote>\n<h4 id=\"实现众筹合约\"><a href=\"#实现众筹合约\" class=\"headerlink\" title=\"实现众筹合约\"></a>实现众筹合约</h4><p>我们进入到上面使用<code>truffle init</code>命令创建的项目中去</p>\n<p>在 contracts 下创建一个合约文件 Crowdfunding.sol:</p>\n<pre><code>pragma solidity &gt;=0.4.21 &lt;0.7.0;\n\n\ncontract Crowdfunding &#123;\n    // 创作者\n    address public author;\n\n    // 参与金额\n    mapping(address =&gt; uint) public joined;\n\n    // 众筹目标\n    uint constant Target = 10 ether;\n\n    // 众筹截止时间\n    uint public endTime;\n\n    // 记录当前众筹价格\n    uint public price  = 0.02 ether ;\n\n    // 作者提取资金之后，关闭众筹\n    bool public closed = false;\n\n    // 部署合约时调用，初始化作者以及众筹结束时间\n    constructor() public &#123;\n        author = msg.sender;\n        endTime = now + 30 days;\n    &#125;\n\n    // 更新价格，这是一个内部函数\n    function updatePrice() internal &#123;\n        uint rise = address(this).balance / 1 ether * 0.002 ether;\n        price = 0.02 ether + rise;\n    &#125;\n\n    // 用户向合约转账时 触发的回调函数\n    function () external payable &#123;\n        require(now &lt; endTime &amp;&amp; !closed  , &quot;众筹已结束&quot;);\n        require(joined[msg.sender] == 0 , &quot;你已经参与过众筹&quot;);\n\n        require (msg.value &gt;= price, &quot;出价太低了&quot;);\n        joined[msg.sender] = msg.value;\n\n        updatePrice();\n    &#125; \n\n    // 作者提取资金\n    function withdrawFund() external &#123;\n        require(msg.sender == author, &quot;你不是作者&quot;);\n        require(address(this).balance &gt;= Target, &quot;未达到众筹目标&quot;);\n        closed = true;   \n        msg.sender.transfer(address(this).balance);\n    &#125;\n\n    // 读者赎回资金\n    function withdraw() external &#123;\n        require(now &gt; endTime, &quot;还未到众筹结束时间&quot;);\n        require(!closed, &quot;众筹达标，众筹资金已提取&quot;);\n        require(Target &gt; address(this).balance, &quot;众筹达标，你没法提取资金&quot;);\n\n        msg.sender.transfer(joined[msg.sender]);\n    &#125;\n\n&#125;</code></pre>\n<blockquote>\n<p>代码的介绍，在合约代码中，使用到了 Solidity 语言中的一些知识点：</p>\n</blockquote>\n<blockquote>\n<p>ether : 这是货币单位<br>。<br>days : 这是时间单位，1 days 对应 1 天的秒数。</p>\n<p>now : 这是一个 Solidity 的内置属性，用于获取当前的时间戳，单位是秒。</p>\n<p>require : 如果条件不满足回退交易。</p>\n<p>address.transfer(value) : 对某一个地址进行转账。</p>\n<p>有关 Solidity 语言入门推荐大家使用官网课程 <a href=\"https://cryptozombies.io/zh/course/\">僵尸游戏</a></p>\n</blockquote>\n<h4 id=\"合约部署\"><a href=\"#合约部署\" class=\"headerlink\" title=\"合约部署\"></a>合约部署</h4><p>部署之前我们使用 <code>truffle compile</code> 命令来进行编译</p>\n<p>之后，在 migrations 下创建一个部署脚本 2_crowfunding.js ，内容如下：</p>\n<pre><code>const crowd = artifacts.require(&quot;Crowdfunding&quot;);\n\nmodule.exports = function(deployer) &#123;\n  deployer.deploy(crowd);\n&#125;;</code></pre>\n<p>接下来你的文件目录应该是这样的:</p>\n<pre><code>├── build\n│   └── contracts\n│       ├── CrowdFunding.json\n│       └── Migrations.json\n├── contracts\n│   ├── CrowdFunding.sol\n│   └── Migrations.sol\n├── migrations\n│   ├── 1_initial_migration.js\n│   └── 2_crowdfunding_migration.js\n├── test\n└── truffle-config.js\n</code></pre>\n<p>注意一下这个<code>1_initial_migration.js</code>文件和 <code>Migrations.sol</code>文件 这是我们在使用<code>truffle init</code>命令初始化项目时它为我们生成的文件 这两个文件是不能删除的否则会无法进行部署，我们在<code>migrations</code>文件夹下面创建的文件要按照 1_xxx.js, 2_xxx.js 在部署的时候是按照这个顺序进行的。</p>\n<p>下面我们配置部署脚本<code>truffle-config.js</code></p>\n<p>配置之前 我们还需要做一些事情：</p>\n<p>1、注册infura获取PROJECT-ID</p>\n<p><a href=\"https://infura.io/\">infura</a>是基于ETH的chain公共API服务，为开发者提供链上数据查询、交易广播等功能。</p>\n<p>注册成功之后需要创建项目</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325100549.png\"></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325100631.png\"></p>\n<p>项目名字是随便起的无所谓</p>\n<p>项目创建完之后你就能看到PROJECT-ID了这个我们待会要用</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325100830.png\"></p>\n<p>2、我们还需要一个浏览器插件 <a href=\"https://metamask.io/\">MetaMask</a> 推荐大家使用Chrome浏览器 </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325101145.png\"></p>\n<p>按照步骤注册账户，并将助记词保存下来， 我们下面要用到</p>\n<p>我们需要获取ETH，以为部署是要gas费的, 测试网络可以每天给我们5个ETH 这足够我们使用了</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325103044.png\"></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325103155.png\"></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325103316.png\"></p>\n<p>3、安装 <code>truffle-hdwallet-provider</code></p>\n<p>由于需要将合约部署到测试网Ropsten，此过程需要部署者私钥进行签名再将数据进行广播，<br><code>truffle-hdwallet-provider</code>是truffle上提供交易离线签名的模块</p>\n<p>注：必须在truffle框架的代码目录下安装，否则不生效</p>\n<pre><code>&gt; cd truffle-crowdfund\n&gt; npm install truffle-hdwallet-provider</code></pre>\n<p>4、我们终于可以进行修改<code>truffle-config.js</code>部署脚本了</p>\n<pre><code>/**\n * Use this file to configure your truffle project. It&#39;s seeded with some\n * common settings for different networks and features like migrations,\n * compilation and testing. Uncomment the ones you need or modify\n * them to suit your project as necessary.\n *\n * More information about configuration can be found at:\n *\n * trufflesuite.com/docs/advanced/configuration\n *\n * To deploy via Infura you&#39;ll need a wallet provider (like @truffle/hdwallet-provider)\n * to sign your transactions before they&#39;re sent to a remote public node. Infura accounts\n * are available for free at: infura.io/register.\n *\n * You&#39;ll also need a mnemonic - the twelve word phrase the wallet uses to generate\n * public/private key pairs. If you&#39;re publishing your code to GitHub make sure you load this\n * phrase from a file you&#39;ve .gitignored so it doesn&#39;t accidentally become public.\n *\n */\n\nconst HDWalletProvider = require(&#39;truffle-hdwallet-provider&#39;);\n// const infuraKey = &quot;fj4jll3k.....&quot;;\n//\nconst fs = require(&#39;fs&#39;);\nconst mnemonic = fs.readFileSync(&quot;.secret&quot;).toString().trim();\n\nmodule.exports = &#123;\n  /**\n   * Networks define how you connect to your ethereum client and let you set the\n   * defaults web3 uses to send transactions. If you don&#39;t specify one truffle\n   * will spin up a development blockchain for you on port 9545 when you\n   * run `develop` or `test`. You can ask a truffle command to use a specific\n   * network from the command line, e.g\n   *\n   * $ truffle test --network &lt;network-name&gt;\n   */\n\n  networks: &#123;\n    // Useful for testing. The `development` name is special - truffle uses it by default\n    // if it&#39;s defined here and no other network is specified at the command line.\n    // You should run a client (like ganache-cli, geth or parity) in a separate terminal\n    // tab if you use this network and you must also set the `host`, `port` and `network_id`\n    // options below to some value.\n    //\n    mainnet: &#123;\n      provider: function () &#123;\n        // Setting the provider with the Infura Rinkeby address and Token\n        return new HDWalletProvider(mnemonic, &quot;https://mainnet.infura.io/v3/xxxx1cabc499dc5d569&quot;)\n      &#125;,\n      network_id: 1\n    &#125;,\n    // development: &#123;\n    //  host: &quot;127.0.0.1&quot;,     // Localhost (default: none)\n    //  port: 8545,            // Standard Ethereum port (default: none)\n    //  network_id: &quot;*&quot;,       // Any network (default: none)\n    // &#125;,\n    // Another network with more advanced options...\n    // advanced: &#123;\n    // port: 8777,             // Custom port\n    // network_id: 1342,       // Custom network\n    // gas: 8500000,           // Gas sent with each transaction (default: ~6700000)\n    // gasPrice: 20000000000,  // 20 gwei (in wei) (default: 100 gwei)\n    // from: &lt;address&gt;,        // Account to send txs from (default: accounts[0])\n    // websocket: true        // Enable EventEmitter interface for web3 (default: false)\n    // &#125;,\n    // Useful for deploying to a public network.\n    // NB: It&#39;s important to wrap the provider as a function.\n    ropsten: &#123;\n      provider: () =&gt; new HDWalletProvider(mnemonic, &quot;https://ropsten.infura.io/v3/xxxx1cabc499dc5d569&quot;),\n      network_id: 3,       // Ropsten&#39;s id\n      gas: 5500000,        // Ropsten has a lower block limit than mainnet\n      confirmations: 2,    // # of confs to wait between deployments. (default: 0)\n      timeoutBlocks: 200,  // # of blocks before a deployment times out  (minimum/default: 50)\n      skipDryRun: true     // Skip dry run before migrations? (default: false for public nets )\n    &#125;,\n    // Useful for private networks\n    // private: &#123;\n    // provider: () =&gt; new HDWalletProvider(mnemonic, `https://network.io`),\n    // network_id: 2111,   // This network is yours, in the cloud.\n    // production: true    // Treats this network as if it was a public net. (default: false)\n    // &#125;\n  &#125;,\n\n  // Set default mocha options here, use special reporters etc.\n  mocha: &#123;\n    // timeout: 100000\n  &#125;,\n\n  // Configure your compilers\n  compilers: &#123;\n    solc: &#123;\n      // version: &quot;0.5.1&quot;,    // Fetch exact version from solc-bin (default: truffle&#39;s version)\n      // docker: true,        // Use &quot;0.5.1&quot; you&#39;ve installed locally with docker (default: false)\n      // settings: &#123;          // See the solidity docs for advice about optimization and evmVersion\n      //  optimizer: &#123;\n      //    enabled: false,\n      //    runs: 200\n      //  &#125;,\n      //  evmVersion: &quot;byzantium&quot;\n      // &#125;\n    &#125;\n  &#125;,\n\n  // Truffle DB is currently disabled by default; to enable it, change enabled: false to enabled: true\n  //\n  // Note: if you migrated your contracts prior to enabling this field in your Truffle project and want\n  // those previously migrated contracts available in the .db directory, you will need to run the following:\n  // $ truffle migrate --reset --compile-all\n\n  db: &#123;\n    enabled: false\n  &#125;\n&#125;;\n</code></pre>\n<p>注意这几行 </p>\n<pre><code>const HDWalletProvider = require(&#39;truffle-hdwallet-provider&#39;);\n// const infuraKey = &quot;fj4jll3k.....&quot;;\n//\nconst fs = require(&#39;fs&#39;);\nconst mnemonic = fs.readFileSync(&quot;.secret&quot;).toString().trim();\n\n...\n\nropsten: &#123;\n  provider: () =&gt; new HDWalletProvider(mnemonic, &quot;https://ropsten.infura.io/v3/xxxx1cabc499dc5d569&quot;),\n  network_id: 3,       // Ropsten&#39;s id\n  gas: 5500000,        // Ropsten has a lower block limit than mainnet\n  confirmations: 2,    // # of confs to wait between deployments. (default: 0)\n  timeoutBlocks: 200,  // # of blocks before a deployment times out  (minimum/default: 50)\n  skipDryRun: true     // Skip dry run before migrations? (default: false for public nets )\n&#125;,</code></pre>\n<p>这里我们用到了 助记词 和 PROJECT-ID 我这里是在项目的根目录下创建了一个<code>.secret</code>文件 把助记词放到了文件里, 这样比较好，<br>你也可以使用变量进行保存 <code>const infuraKey = &quot;fj4jll3k.....&quot;</code></p>\n<p>5、部署到Ropsten测试网络</p>\n<p>执行<code>truffle migrate --network ropsten</code> 即可部署至Ropsten</p>\n<p>如需要重新编译所有合约，可执行<code>truffle migrate --network ropsten --reset --compile-all</code></p>\n<pre><code>Compiling your contracts...\n===========================\n&gt; Everything is up to date, there is nothing to compile.\n\n\n\nStarting migrations...\n======================\n&gt; Network name:    &#39;ropsten&#39;\n&gt; Network id:      3\n&gt; Block gas limit: 8000000 (0x7a1200)\n\n\n1_initial_migration.js\n======================\n\n   Deploying &#39;Migrations&#39;\n   ----------------------\n   &gt; transaction hash:    0xe27c86dc48219fa193d23843b301d6878a6820dcc93fd92a20e24d1ec9c49b31\n   &gt; Blocks: 3            Seconds: 14\n   &gt; contract address:    0x2e2982D9d1914b6580139Ec4E356B708478C875F\n   &gt; block number:        9898882\n   &gt; block timestamp:     1616554032\n   &gt; account:             0x270dF7D1f4612063abA065389b3fCbeF7993caA9\n   &gt; balance:             4.93502452\n   &gt; gas used:            193243 (0x2f2db)\n   &gt; gas price:           20 gwei\n   &gt; value sent:          0 ETH\n   &gt; total cost:          0.00386486 ETH\n\n   Pausing for 2 confirmations...\n   ------------------------------\n   &gt; confirmation number: 1 (block: 9898884)\n   &gt; confirmation number: 2 (block: 9898885)\n\n   &gt; Saving migration to chain.\n   &gt; Saving artifacts\n   -------------------------------------\n   &gt; Total cost:          0.00386486 ETH\n\n\n2_crowdfunding_migration.js\n===========================\n\n   Deploying &#39;CrowdFunding&#39;\n   ------------------------\n   &gt; transaction hash:    0x0f787b4d1567a00a8da4b28970632238fc50eb43ee7e33fb8d5c3d92fcbf5880\n   &gt; Blocks: 2            Seconds: 25\n   &gt; contract address:    0x3e32bF1e0Af404ed7DbCEf538BEba75ea2a76510\n   &gt; block number:        9898889\n   &gt; block timestamp:     1616554105\n   &gt; account:             0x270dF7D1f4612063abA065389b3fCbeF7993caA9\n   &gt; balance:             4.9224565\n   &gt; gas used:            582663 (0x8e407)\n   &gt; gas price:           20 gwei\n   &gt; value sent:          0 ETH\n   &gt; total cost:          0.01165326 ETH\n\n   Pausing for 2 confirmations...\n   ------------------------------\n   &gt; confirmation number: 1 (block: 9898890)\n   &gt; confirmation number: 2 (block: 9898891)\n\n   &gt; Saving migration to chain.\n   &gt; Saving artifacts\n   -------------------------------------\n   &gt; Total cost:          0.01165326 ETH\n\n\nSummary\n=======\n&gt; Total deployments:   2\n&gt; Final cost:          0.01551812 ETH\n</code></pre>\n<h3 id=\"六、使用vue项目与合约进行交互\"><a href=\"#六、使用vue项目与合约进行交互\" class=\"headerlink\" title=\"六、使用vue项目与合约进行交互\"></a>六、使用vue项目与合约进行交互</h3><blockquote>\n<p>利用 CrowdFund.vue 来众筹界面，众筹界面需要显示以下几个部分：</p>\n</blockquote>\n<blockquote>\n<p> 1、当前众筹到金额。</p>\n<p> 2、众筹的截止时间。</p>\n<p> 3、当前众筹的价格，参与众筹按钮。</p>\n<p> 4、如果是已经参与，显示其参与的价格以及赎回按钮。</p>\n<p> 5、如果是创作者，显示一个提取资金按钮。</p>\n</blockquote>\n<p>1、 依然是创建一个vue项目</p>\n<pre><code>vue create crowd_funding_vue</code></pre>\n<p>我们在components文件夹下创建一个<code>CrowdFunding.vue</code>文件 我们整个的<code>CrowdFunding.vue</code>文件就像是这样</p>\n<pre><code>&lt;template&gt;\n    &lt;div class=&quot;content&quot;&gt;\n        &lt;h3&gt; 新书众筹&lt;/h3&gt;\n        &lt;span&gt;以最低的价格获取我的新书 &lt;/span&gt;\n\n        &lt;div class=&quot;status&quot;&gt;\n            &lt;div v-if=&quot;!closed&quot;&gt;已众筹资金：&lt;b&gt;&#123;&#123; total &#125;&#125; ETH &lt;/b&gt;&lt;/div&gt;\n            &lt;div v-if=&quot;closed&quot;&gt; 众筹已完成&lt;/div&gt;\n            &lt;div&gt;众筹截止时间：&#123;&#123; endDate &#125;&#125;&lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div v-if=&quot;joined&quot; class=&quot;card-bkg&quot;&gt;\n            &lt;div class=&quot;award-des&quot;&gt;\n                &lt;span&gt; 参与价格 &lt;/span&gt;\n                &lt;b&gt; &#123;&#123; joinPrice &#125;&#125; ETH &lt;/b&gt;\n            &lt;/div&gt;\n\n            &lt;button :disabled=&quot;closed&quot; @click=&quot;withdraw&quot;&gt;赎回&lt;/button&gt;\n        &lt;/div&gt;\n\n        &lt;div v-if=&quot;!joined&quot; class=&quot;card-bkg&quot;&gt;\n            &lt;div class=&quot;award-des&quot;&gt;\n                &lt;span&gt; 当前众筹价格 &lt;/span&gt;\n                &lt;b&gt; &#123;&#123; price &#125;&#125; ETH &lt;/b&gt;\n            &lt;/div&gt;\n\n            &lt;button :disabled=&quot;closed&quot; @click=&quot;join&quot;&gt;参与众筹&lt;/button&gt;\n        &lt;/div&gt;\n\n        &lt;div v-if=&quot;isAuthor&quot;&gt;\n            &lt;button :disabled=&quot;closed&quot; @click=&quot;withdrawFund&quot;&gt; 提取资金&lt;/button&gt;\n        &lt;/div&gt;\n\n    &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\n    import contract from &quot;truffle-contract&quot;;\n    import crowd from &#39;../../public/build/contracts/CrowdFunding.json&#39;;\n\n    const Web3 = require(&#39;web3&#39;);\n\n    export default &#123;\n        name: &#39;CrowdFund&#39;,\n        // 定义上面HTML模板中使用的变量\n        data() &#123;\n            return &#123;\n                price: null,\n                total: 0,\n                closed: true,\n                joinPrice: null,\n                joined: false,\n                endDate: &quot;null&quot;,\n                isAuthor: true,\n            &#125;\n        &#125;,\n        // 当前Vue组件被创建时回调的hook 函数\n        async created() &#123;\n            //  初始化 web3及账号\n            await this.initWeb3Account()\n            //  初始化合约实例\n            await this.initContract()\n            //  获取合约的状态信息\n            await this.getCrowdInfo()\n        &#125;,\n        methods: &#123;\n            async initWeb3Account() &#123;\n                console.log(&quot;initWeb3Account 方法执行了-------&quot;);\n                // 检查新版MetaMask\n                if (window.ethereum) &#123;\n                    this.provider = window.ethereum;\n                    try &#123;\n                        // 请求用户账号授权\n                        await window.ethereum.enable();\n                    &#125; catch (error) &#123;\n                        // 用户拒绝了访问\n                        console.log(&quot;User denied account access&quot;);\n                    &#125;\n                &#125;\n                // 老版 MetaMask\n                else if (window.web3) &#123;\n                    this.provider = window.web3.currentProvider;\n                &#125;\n                // 如果没有注入的web3实例，回退到使用 Ganache\n                else &#123;\n                    alert(&quot;请安装MetaMask!&quot;);\n                     this.provider = new Web3.providers.HttpProvider(&quot;http://127.0.0.1:7545&quot;);\n                &#125;\n                this.web3 = new Web3(this.provider);\n                this.web3.eth.getAccounts().then(accs =&gt; &#123;\n                    this.account = accs[0]\n                    console.log(accs)\n                &#125;)\n            &#125;,\n            async initContract() &#123;\n                const crowdContract = contract(crowd)\n                crowdContract.setProvider(this.provider)\n                this.crowdFund = await crowdContract.deployed()\n            &#125;,\n            async getCrowdInfo() &#123;\n                // 获取合约的余额\n                this.web3.eth.getBalance(this.crowdFund.address).then(\n                    r =&gt; &#123;\n                        this.total = this.web3.utils.fromWei(r)\n                    &#125;\n                )\n\n                // 获取读者的参与金额\n                this.crowdFund.joined(this.account).then(\n                    r =&gt; &#123;\n                        if (r &gt; 0) &#123;\n                            this.joined = true\n                            this.joinPrice = this.web3.utils.fromWei(r)\n                        &#125;\n                    &#125;\n                )\n\n                // 获取合约的关闭状态\n                this.crowdFund.closed().then(\n                    r =&gt; this.closed = r\n                )\n\n                // 获取当前的众筹价格\n                this.crowdFund.price().then(\n                    r =&gt; this.price = this.web3.utils.fromWei(r)\n                )\n\n                // 获取众筹截止时间\n                this.crowdFund.endTime().then(r =&gt; &#123;\n                    var endTime = new Date(r * 1000)\n                    // 把时间戳转化为本地时间\n                    this.endDate = endTime.toLocaleDateString().replace(/\\//g, &quot;-&quot;) + &quot; &quot; + endTime.toTimeString().substr(0, 8);\n                &#125;)\n\n                // 获取众筹创作者地址\n                this.crowdFund.author().then(r =&gt; &#123;\n                    if (this.account === r) &#123;\n                        this.isAuthor = true\n                    &#125; else &#123;\n                        this.isAuthor = false\n                    &#125;\n                &#125;)\n            &#125;,\n            // 读者参与众筹的 join()函数\n            join() &#123;\n                this.web3.eth.sendTransaction(&#123;\n                    from: this.account,\n                    to: this.crowdFund.address,\n                    value: this.web3.utils.toWei(this.price)\n                &#125;).then(() =&gt;\n                    this.getCrowdInfo()\n                )\n            &#125;,\n            // 读者赎回的 withdraw()函数\n            withdraw() &#123;\n                this.crowdFund.withdraw(&#123;\n                    from: this.account\n                &#125;).then(() =&gt; &#123;\n                    this.getCrowdInfo()\n                &#125;)\n            &#125;,\n            // 创作者提取资金的 withdrawFund()函数\n            withdrawFund() &#123;\n                this.crowdFund.withdrawFund(&#123;\n                    from: this.account\n                &#125;).then(() =&gt; &#123;\n                    this.getCrowdInfo()\n                &#125;)\n            &#125;\n        &#125;\n    &#125;\n&lt;/script&gt;</code></pre>\n<p>2、与合约进行交互</p>\n<p>前端界面与合约进行交互时，需要使用到 <code>truffle-contract</code> 及 <code>web3</code> ，因为 Vue 工程本身也是通过 NPM 进行包管理，<br>因此可以直接通过 npm 进行安装，命令如下：</p>\n<pre><code>npm install --save truffle-contract web3</code></pre>\n<p>如果创建vue项目的时候已经启动了vue项目 那么你需要重新启动一下vue项目 因为安装了包之后需要重新启动 这样使用import导入包的时候<br>才不会报错。</p>\n<p>3、将智能合约项目编译产生的<code>build</code>文件夹放进vue项目中的<code>public</code>文件夹下 注意看上面的这句话</p>\n<pre><code>import crowd from &#39;../../public/build/contracts/CrowdFunding.json&#39;;</code></pre>\n<p>4、启动vue项目进行交互 看起来就像这样</p>\n<pre><code>npm run serve</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210325105129.png\"></p>\n<h4 id=\"特别感谢一下博文\"><a href=\"#特别感谢一下博文\" class=\"headerlink\" title=\"特别感谢一下博文\"></a>特别感谢一下博文</h4><p>1、<a href=\"https://learnblockchain.cn/2019/12/20/vue-dapp\">如何使用Vue.js 开发以太坊DApp</a></p>\n<p>2、<a href=\"https://blog.csdn.net/u010159567/article/details/104895457\">以太坊ETH-智能合约开发-solidity源码分析-truffle进阶</a></p>\n<p>3、<a href=\"https://blog.csdn.net/TurkeyCock/article/details/85103434\">Infura：一键接入以太坊</a></p>\n<p>4、<a href=\"https://learnblockchain.cn/docs/truffle/getting-started/truffle-with-metamask.html\">Truffle 和 MetaMask 配合</a></p>\n<p>5、<a href=\"https://www.chainnews.com/articles/823921189500.htm\">详解 Truffle Migrations （迁移）- 合约部署不再困惑</a></p>\n<p>6、<a href=\"http://blog.hubwiz.com/2019/09/13/ethereum-dev-tools-2019/#%E6%96%B0%E6%89%8B%E5%85%A5%E9%97%A8\">以太坊开发资源全面指南</a></p>\n"},{"title":"IDEA 破解","date":"2020-10-21T04:57:23.000Z","_content":"\n#### 2020-09-024 亲测有效：IntelliJ IDEA 2020.2 最新全家桶系列产品激活破解方法, JetBrains 全家桶激活\n\n##### 激活方法\n\n##### 1、下载最新版的idea 正常安装\n##### 2、选择免费试用30天\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201021130024.png)\n##### 3、进入到idea中后 将压缩包拖进idea 并重启\n**[[jetbrains-agent.zip 下载地址](https://justcode.ikeepstudying.com/wp-content/uploads/2020/09/jetbrains-agent.zip)]**\n##### 4、输入安装参数\n```\nLFq51qqupnaiTNn39w6zATiOTxZI2JYuRJEBlzmUDv4zeeNlXhMgJZVb0q5QkLr+CIUrSuNB7ucifrGXawLB4qswPOXYG7+ItDNUR/9UkLTUWlnHLX07hnR1USOrWIjTmbytcIKEdaI6x0RskyotuItj84xxoSBP/iRBW2EHpOc\n\n```\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201021130345.png)\n##### 5、会询问你是否重启，重启就完事了\n\n## 下面是原文地址\n**[[原文地址](https://justcode.ikeepstudying.com/2020/09/2020-09-09-%e4%ba%b2%e6%b5%8b%e6%9c%89%e6%95%88%ef%bc%9aintellij-idea-2020-2-%e6%9c%80%e6%96%b0%e5%85%a8%e5%ae%b6%e6%a1%b6%e7%b3%bb%e5%88%97%e4%ba%a7%e5%93%81%e6%bf%80%e6%b4%bb%e7%a0%b4%e8%a7%a3/)]**","source":"_posts/IDEA-破解.md","raw":"---\ntitle: IDEA 破解\ndate: 2020-10-21 12:57:23\ncategories:\n- IDEA\ntags:\n- IDEA\n---\n\n#### 2020-09-024 亲测有效：IntelliJ IDEA 2020.2 最新全家桶系列产品激活破解方法, JetBrains 全家桶激活\n\n##### 激活方法\n\n##### 1、下载最新版的idea 正常安装\n##### 2、选择免费试用30天\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201021130024.png)\n##### 3、进入到idea中后 将压缩包拖进idea 并重启\n**[[jetbrains-agent.zip 下载地址](https://justcode.ikeepstudying.com/wp-content/uploads/2020/09/jetbrains-agent.zip)]**\n##### 4、输入安装参数\n```\nLFq51qqupnaiTNn39w6zATiOTxZI2JYuRJEBlzmUDv4zeeNlXhMgJZVb0q5QkLr+CIUrSuNB7ucifrGXawLB4qswPOXYG7+ItDNUR/9UkLTUWlnHLX07hnR1USOrWIjTmbytcIKEdaI6x0RskyotuItj84xxoSBP/iRBW2EHpOc\n\n```\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201021130345.png)\n##### 5、会询问你是否重启，重启就完事了\n\n## 下面是原文地址\n**[[原文地址](https://justcode.ikeepstudying.com/2020/09/2020-09-09-%e4%ba%b2%e6%b5%8b%e6%9c%89%e6%95%88%ef%bc%9aintellij-idea-2020-2-%e6%9c%80%e6%96%b0%e5%85%a8%e5%ae%b6%e6%a1%b6%e7%b3%bb%e5%88%97%e4%ba%a7%e5%93%81%e6%bf%80%e6%b4%bb%e7%a0%b4%e8%a7%a3/)]**","slug":"IDEA-破解","published":1,"updated":"2020-10-21T05:10:46.645Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwe000w3ys2bv7u6671","content":"<h4 id=\"2020-09-024-亲测有效：IntelliJ-IDEA-2020-2-最新全家桶系列产品激活破解方法-JetBrains-全家桶激活\"><a href=\"#2020-09-024-亲测有效：IntelliJ-IDEA-2020-2-最新全家桶系列产品激活破解方法-JetBrains-全家桶激活\" class=\"headerlink\" title=\"2020-09-024 亲测有效：IntelliJ IDEA 2020.2 最新全家桶系列产品激活破解方法, JetBrains 全家桶激活\"></a>2020-09-024 亲测有效：IntelliJ IDEA 2020.2 最新全家桶系列产品激活破解方法, JetBrains 全家桶激活</h4><h5 id=\"激活方法\"><a href=\"#激活方法\" class=\"headerlink\" title=\"激活方法\"></a>激活方法</h5><h5 id=\"1、下载最新版的idea-正常安装\"><a href=\"#1、下载最新版的idea-正常安装\" class=\"headerlink\" title=\"1、下载最新版的idea 正常安装\"></a>1、下载最新版的idea 正常安装</h5><h5 id=\"2、选择免费试用30天\"><a href=\"#2、选择免费试用30天\" class=\"headerlink\" title=\"2、选择免费试用30天\"></a>2、选择免费试用30天</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201021130024.png\"></p>\n<h5 id=\"3、进入到idea中后-将压缩包拖进idea-并重启\"><a href=\"#3、进入到idea中后-将压缩包拖进idea-并重启\" class=\"headerlink\" title=\"3、进入到idea中后 将压缩包拖进idea 并重启\"></a>3、进入到idea中后 将压缩包拖进idea 并重启</h5><p><strong>[<a href=\"https://justcode.ikeepstudying.com/wp-content/uploads/2020/09/jetbrains-agent.zip\">jetbrains-agent.zip 下载地址</a>]</strong></p>\n<h5 id=\"4、输入安装参数\"><a href=\"#4、输入安装参数\" class=\"headerlink\" title=\"4、输入安装参数\"></a>4、输入安装参数</h5><pre><code>LFq51qqupnaiTNn39w6zATiOTxZI2JYuRJEBlzmUDv4zeeNlXhMgJZVb0q5QkLr+CIUrSuNB7ucifrGXawLB4qswPOXYG7+ItDNUR/9UkLTUWlnHLX07hnR1USOrWIjTmbytcIKEdaI6x0RskyotuItj84xxoSBP/iRBW2EHpOc\n</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201021130345.png\"></p>\n<h5 id=\"5、会询问你是否重启，重启就完事了\"><a href=\"#5、会询问你是否重启，重启就完事了\" class=\"headerlink\" title=\"5、会询问你是否重启，重启就完事了\"></a>5、会询问你是否重启，重启就完事了</h5><h2 id=\"下面是原文地址\"><a href=\"#下面是原文地址\" class=\"headerlink\" title=\"下面是原文地址\"></a>下面是原文地址</h2><p><strong>[<a href=\"https://justcode.ikeepstudying.com/2020/09/2020-09-09-%e4%ba%b2%e6%b5%8b%e6%9c%89%e6%95%88%ef%bc%9aintellij-idea-2020-2-%e6%9c%80%e6%96%b0%e5%85%a8%e5%ae%b6%e6%a1%b6%e7%b3%bb%e5%88%97%e4%ba%a7%e5%93%81%e6%bf%80%e6%b4%bb%e7%a0%b4%e8%a7%a3/\">原文地址</a>]</strong></p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"2020-09-024-亲测有效：IntelliJ-IDEA-2020-2-最新全家桶系列产品激活破解方法-JetBrains-全家桶激活\"><a href=\"#2020-09-024-亲测有效：IntelliJ-IDEA-2020-2-最新全家桶系列产品激活破解方法-JetBrains-全家桶激活\" class=\"headerlink\" title=\"2020-09-024 亲测有效：IntelliJ IDEA 2020.2 最新全家桶系列产品激活破解方法, JetBrains 全家桶激活\"></a>2020-09-024 亲测有效：IntelliJ IDEA 2020.2 最新全家桶系列产品激活破解方法, JetBrains 全家桶激活</h4><h5 id=\"激活方法\"><a href=\"#激活方法\" class=\"headerlink\" title=\"激活方法\"></a>激活方法</h5><h5 id=\"1、下载最新版的idea-正常安装\"><a href=\"#1、下载最新版的idea-正常安装\" class=\"headerlink\" title=\"1、下载最新版的idea 正常安装\"></a>1、下载最新版的idea 正常安装</h5><h5 id=\"2、选择免费试用30天\"><a href=\"#2、选择免费试用30天\" class=\"headerlink\" title=\"2、选择免费试用30天\"></a>2、选择免费试用30天</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201021130024.png\"></p>\n<h5 id=\"3、进入到idea中后-将压缩包拖进idea-并重启\"><a href=\"#3、进入到idea中后-将压缩包拖进idea-并重启\" class=\"headerlink\" title=\"3、进入到idea中后 将压缩包拖进idea 并重启\"></a>3、进入到idea中后 将压缩包拖进idea 并重启</h5><p><strong>[<a href=\"https://justcode.ikeepstudying.com/wp-content/uploads/2020/09/jetbrains-agent.zip\">jetbrains-agent.zip 下载地址</a>]</strong></p>\n<h5 id=\"4、输入安装参数\"><a href=\"#4、输入安装参数\" class=\"headerlink\" title=\"4、输入安装参数\"></a>4、输入安装参数</h5><pre><code>LFq51qqupnaiTNn39w6zATiOTxZI2JYuRJEBlzmUDv4zeeNlXhMgJZVb0q5QkLr+CIUrSuNB7ucifrGXawLB4qswPOXYG7+ItDNUR/9UkLTUWlnHLX07hnR1USOrWIjTmbytcIKEdaI6x0RskyotuItj84xxoSBP/iRBW2EHpOc\n</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201021130345.png\"></p>\n<h5 id=\"5、会询问你是否重启，重启就完事了\"><a href=\"#5、会询问你是否重启，重启就完事了\" class=\"headerlink\" title=\"5、会询问你是否重启，重启就完事了\"></a>5、会询问你是否重启，重启就完事了</h5><h2 id=\"下面是原文地址\"><a href=\"#下面是原文地址\" class=\"headerlink\" title=\"下面是原文地址\"></a>下面是原文地址</h2><p><strong>[<a href=\"https://justcode.ikeepstudying.com/2020/09/2020-09-09-%e4%ba%b2%e6%b5%8b%e6%9c%89%e6%95%88%ef%bc%9aintellij-idea-2020-2-%e6%9c%80%e6%96%b0%e5%85%a8%e5%ae%b6%e6%a1%b6%e7%b3%bb%e5%88%97%e4%ba%a7%e5%93%81%e6%bf%80%e6%b4%bb%e7%a0%b4%e8%a7%a3/\">原文地址</a>]</strong></p>\n"},{"title":"Linux 运维方面的知识","date":"2020-12-02T03:50:46.000Z","_content":"\n### Linux 常用命令\n\n##### 1、怎么看Linux系统版本\n\n登陆Linux，在终端输入\n\n```Linux\ncat /proc/version\n````\n##### 2、查看服务器内存使用情况\n```linux\nfree -m\n```\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201202120027.png)\n\n#### 参数解释：\nMem行（单位均为M）：\n* total：内存总数\n* used：已使用内存数\n* free：空闲内存数\n* shared：当前废弃不用\n* buffers：缓存内存数（Buffer）\n* cached：缓存内舒数（Page）\n\n(-/+ buffers/cache)行：\n* （-buffers/cache）: 真正使用的内存数，指的是第一部分的 used - buffers - cached\n* （+buffers/cache）: 可用的内存数，指的是第一部分的 free + buffers + cached\n\nSwap行指交换分区。\n\n实际上不要看free少就觉得内存不足了，buffers和cached都是可以在使用内存时拿来用的，应该以(-/+ buffers/cache)行的free和used来看。只要没发现swap的使用，就不用太担心，如果swap用了很多，那就要考虑增加物理内存了。\n\n#### 3、 查看CPU使用情况\n\n```\ntop\n```\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201202120433.png)\n\n\n","source":"_posts/Linux-运维方面的知识.md","raw":"---\ntitle: Linux 运维方面的知识\ndate: 2020-12-02 11:50:46\ncategories:\n- Linux\ntags:\n- 运维\n- 防火墙\n- Linux命令\n---\n\n### Linux 常用命令\n\n##### 1、怎么看Linux系统版本\n\n登陆Linux，在终端输入\n\n```Linux\ncat /proc/version\n````\n##### 2、查看服务器内存使用情况\n```linux\nfree -m\n```\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201202120027.png)\n\n#### 参数解释：\nMem行（单位均为M）：\n* total：内存总数\n* used：已使用内存数\n* free：空闲内存数\n* shared：当前废弃不用\n* buffers：缓存内存数（Buffer）\n* cached：缓存内舒数（Page）\n\n(-/+ buffers/cache)行：\n* （-buffers/cache）: 真正使用的内存数，指的是第一部分的 used - buffers - cached\n* （+buffers/cache）: 可用的内存数，指的是第一部分的 free + buffers + cached\n\nSwap行指交换分区。\n\n实际上不要看free少就觉得内存不足了，buffers和cached都是可以在使用内存时拿来用的，应该以(-/+ buffers/cache)行的free和used来看。只要没发现swap的使用，就不用太担心，如果swap用了很多，那就要考虑增加物理内存了。\n\n#### 3、 查看CPU使用情况\n\n```\ntop\n```\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201202120433.png)\n\n\n","slug":"Linux-运维方面的知识","published":1,"updated":"2020-12-02T04:05:05.798Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwe000z3ys29l42gh36","content":"<h3 id=\"Linux-常用命令\"><a href=\"#Linux-常用命令\" class=\"headerlink\" title=\"Linux 常用命令\"></a>Linux 常用命令</h3><h5 id=\"1、怎么看Linux系统版本\"><a href=\"#1、怎么看Linux系统版本\" class=\"headerlink\" title=\"1、怎么看Linux系统版本\"></a>1、怎么看Linux系统版本</h5><p>登陆Linux，在终端输入</p>\n<pre class=\"line-numbers language-Linux\"><code class=\"language-Linux\">cat /proc/version<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h5 id=\"2、查看服务器内存使用情况\"><a href=\"#2、查看服务器内存使用情况\" class=\"headerlink\" title=\"2、查看服务器内存使用情况\"></a>2、查看服务器内存使用情况</h5><pre class=\"line-numbers language-linux\"><code class=\"language-linux\">free -m<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201202120027.png\"></p>\n<h4 id=\"参数解释：\"><a href=\"#参数解释：\" class=\"headerlink\" title=\"参数解释：\"></a>参数解释：</h4><p>Mem行（单位均为M）：</p>\n<ul>\n<li>total：内存总数</li>\n<li>used：已使用内存数</li>\n<li>free：空闲内存数</li>\n<li>shared：当前废弃不用</li>\n<li>buffers：缓存内存数（Buffer）</li>\n<li>cached：缓存内舒数（Page）</li>\n</ul>\n<p>(-/+ buffers/cache)行：</p>\n<ul>\n<li>（-buffers/cache）: 真正使用的内存数，指的是第一部分的 used - buffers - cached</li>\n<li>（+buffers/cache）: 可用的内存数，指的是第一部分的 free + buffers + cached</li>\n</ul>\n<p>Swap行指交换分区。</p>\n<p>实际上不要看free少就觉得内存不足了，buffers和cached都是可以在使用内存时拿来用的，应该以(-/+ buffers/cache)行的free和used来看。只要没发现swap的使用，就不用太担心，如果swap用了很多，那就要考虑增加物理内存了。</p>\n<h4 id=\"3、-查看CPU使用情况\"><a href=\"#3、-查看CPU使用情况\" class=\"headerlink\" title=\"3、 查看CPU使用情况\"></a>3、 查看CPU使用情况</h4><pre><code>top</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201202120433.png\"></p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"Linux-常用命令\"><a href=\"#Linux-常用命令\" class=\"headerlink\" title=\"Linux 常用命令\"></a>Linux 常用命令</h3><h5 id=\"1、怎么看Linux系统版本\"><a href=\"#1、怎么看Linux系统版本\" class=\"headerlink\" title=\"1、怎么看Linux系统版本\"></a>1、怎么看Linux系统版本</h5><p>登陆Linux，在终端输入</p>\n<pre><code class=\"Linux\">cat /proc/version</code></pre>\n<h5 id=\"2、查看服务器内存使用情况\"><a href=\"#2、查看服务器内存使用情况\" class=\"headerlink\" title=\"2、查看服务器内存使用情况\"></a>2、查看服务器内存使用情况</h5><pre><code class=\"linux\">free -m</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201202120027.png\"></p>\n<h4 id=\"参数解释：\"><a href=\"#参数解释：\" class=\"headerlink\" title=\"参数解释：\"></a>参数解释：</h4><p>Mem行（单位均为M）：</p>\n<ul>\n<li>total：内存总数</li>\n<li>used：已使用内存数</li>\n<li>free：空闲内存数</li>\n<li>shared：当前废弃不用</li>\n<li>buffers：缓存内存数（Buffer）</li>\n<li>cached：缓存内舒数（Page）</li>\n</ul>\n<p>(-/+ buffers/cache)行：</p>\n<ul>\n<li>（-buffers/cache）: 真正使用的内存数，指的是第一部分的 used - buffers - cached</li>\n<li>（+buffers/cache）: 可用的内存数，指的是第一部分的 free + buffers + cached</li>\n</ul>\n<p>Swap行指交换分区。</p>\n<p>实际上不要看free少就觉得内存不足了，buffers和cached都是可以在使用内存时拿来用的，应该以(-/+ buffers/cache)行的free和used来看。只要没发现swap的使用，就不用太担心，如果swap用了很多，那就要考虑增加物理内存了。</p>\n<h4 id=\"3、-查看CPU使用情况\"><a href=\"#3、-查看CPU使用情况\" class=\"headerlink\" title=\"3、 查看CPU使用情况\"></a>3、 查看CPU使用情况</h4><pre><code>top</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201202120433.png\"></p>\n"},{"title":"Rust 琐碎知识记录板","date":"2020-10-21T03:03:59.000Z","_content":"\n### 下面是Rust的一些琐碎知识\n\n##### 1、format!宏\n* format!: write formatted text to String  这个宏可以将一个文本格式化成String类型（可变字符串，在堆上面分配空间），类似于C#中的String.Format方法。\n\n``` rust\nlet world = \"world\";\nlet text = format!(\"Hello {}!\", world);\n```\n这样text的类型就会是String\n","source":"_posts/Rust-琐碎知识记录板.md","raw":"---\ntitle: Rust 琐碎知识记录板\ndate: 2020-10-21 11:03:59\ncategories:\n- Rust\ntags:\n- Rust\n---\n\n### 下面是Rust的一些琐碎知识\n\n##### 1、format!宏\n* format!: write formatted text to String  这个宏可以将一个文本格式化成String类型（可变字符串，在堆上面分配空间），类似于C#中的String.Format方法。\n\n``` rust\nlet world = \"world\";\nlet text = format!(\"Hello {}!\", world);\n```\n这样text的类型就会是String\n","slug":"Rust-琐碎知识记录板","published":1,"updated":"2020-10-21T03:15:43.965Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwf00113ys2a6xjgg65","content":"<h3 id=\"下面是Rust的一些琐碎知识\"><a href=\"#下面是Rust的一些琐碎知识\" class=\"headerlink\" title=\"下面是Rust的一些琐碎知识\"></a>下面是Rust的一些琐碎知识</h3><h5 id=\"1、format-宏\"><a href=\"#1、format-宏\" class=\"headerlink\" title=\"1、format!宏\"></a>1、format!宏</h5><ul>\n<li>format!: write formatted text to String  这个宏可以将一个文本格式化成String类型（可变字符串，在堆上面分配空间），类似于C#中的String.Format方法。</li>\n</ul>\n<pre class=\"line-numbers language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">let</span> world <span class=\"token operator\">=</span> <span class=\"token string\">\"world\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> text <span class=\"token operator\">=</span> <span class=\"token function\">format!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello {}!\"</span><span class=\"token punctuation\">,</span> world<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>这样text的类型就会是String</p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"下面是Rust的一些琐碎知识\"><a href=\"#下面是Rust的一些琐碎知识\" class=\"headerlink\" title=\"下面是Rust的一些琐碎知识\"></a>下面是Rust的一些琐碎知识</h3><h5 id=\"1、format-宏\"><a href=\"#1、format-宏\" class=\"headerlink\" title=\"1、format!宏\"></a>1、format!宏</h5><ul>\n<li>format!: write formatted text to String  这个宏可以将一个文本格式化成String类型（可变字符串，在堆上面分配空间），类似于C#中的String.Format方法。</li>\n</ul>\n<pre><code class=\"rust\">let world = &quot;world&quot;;\nlet text = format!(&quot;Hello &#123;&#125;!&quot;, world);</code></pre>\n<p>这样text的类型就会是String</p>\n"},{"title":"Rust 闭包","date":"2020-10-21T07:04:15.000Z","_content":"\n#### 快速掌握Rust闭包\n\n*闭包(Closure) : 也叫Lambda表达式或匿名函数。*\n\n不像普通函数，闭包可以对参数和返回类型进行推断，大多数时候都不需要写出来。以下定义都是合法的：\n\n``` rust\n|| 42;\n|x| x + 1;\n|x:i32| x + 1;\n|x:i32| -> i32 { x + 1 };\n```\n\n在上面的例子中，如果是单行语句且没有标注返回类型的时候，花括号是可选的。\n\n* 闭包可以像任何其他对象一样绑定到某个变量,然后可以像调用函数一样调用闭包\n\n``` rust\nlet f = |x| x + 1;\nprintln!(\"x is {}\", f(5))\n```\n打印结果如下：\n\n``` rust\nx is 6\n```\n\n也可以在定义的地方直接调用:\n\n``` rust\nlet r = (|x| x + 1)(2); // r == 3\n```\n\n* 闭包可以捕获外部的环境变量（自由变量）。\n\n闭包捕获变量的方式分为三类：引用（&T）、可变引用（&mut T）和值（T）。捕获变量时，闭包会根据上面列出的顺序（从约束最少到约束最多），优先按引用捕获，必要时才会使用后面的捕获方式：\n\n``` rust\nlet x = 10;\n// 闭包按引用捕获变量x，因为println!只需要引用参数\nlet show_x = || println!(\"x = {}\", x);\nshow_x();\n```\n外部变量的引用保存在show_x对象中，对外部变量的借用持续到show_x离开作用域为止。\n\n下面是一个捕获可变引用的例子：\n\n``` rust\nlet mut count = 0;\n// 闭包按可变引用捕获变量count \n// incr也必须是可变的，因为它持有可变引用，调用incr会改变闭包的状态\nlet mut incr = || { count += 1; println!(\"count = {}\", count); };\nincr();\n```\n\n下面的代码演示了闭包转移捕获变量所有权时的情况（捕获变量的值）：\n\n``` rust\nuse std::mem;\n\n// b是不可复制类型，因此按值捕获时所有权会转移\nlet b = Box::new(12);\nlet f = || {\n    println!(\"b = {}\", b);\n    // drop函数取T类型，因此闭包会按值捕获变量b\n    mem::drop(b);\n};\nf();\n```\n\n调用闭包后b的所有权已经转移，无法再访问：\n\n``` rust\n// 编译错误\nprintln!(\"b = {}\", b);\n```\n同样，因为b的所有权已经转移，无法再次调用这个闭包：\n\n``` rust\n// 编译错误\nf();\n```\n\n如果要强制按值捕获，可以在闭包前添加关键字move：\n\n``` rust\nlet f = move || {\n    println!(\"b = {}\", b);\n};\nf();\n```\n\n同样地，调用闭包后b的所有权已经转移，无法再访问。\n\n\n","source":"_posts/Rust-闭包.md","raw":"---\ntitle: Rust 闭包\ndate: 2020-10-21 15:04:15\ncategories:\n- Rust\ntags:\n- closure\n- 函数式编程\n- Rust 编程\n---\n\n#### 快速掌握Rust闭包\n\n*闭包(Closure) : 也叫Lambda表达式或匿名函数。*\n\n不像普通函数，闭包可以对参数和返回类型进行推断，大多数时候都不需要写出来。以下定义都是合法的：\n\n``` rust\n|| 42;\n|x| x + 1;\n|x:i32| x + 1;\n|x:i32| -> i32 { x + 1 };\n```\n\n在上面的例子中，如果是单行语句且没有标注返回类型的时候，花括号是可选的。\n\n* 闭包可以像任何其他对象一样绑定到某个变量,然后可以像调用函数一样调用闭包\n\n``` rust\nlet f = |x| x + 1;\nprintln!(\"x is {}\", f(5))\n```\n打印结果如下：\n\n``` rust\nx is 6\n```\n\n也可以在定义的地方直接调用:\n\n``` rust\nlet r = (|x| x + 1)(2); // r == 3\n```\n\n* 闭包可以捕获外部的环境变量（自由变量）。\n\n闭包捕获变量的方式分为三类：引用（&T）、可变引用（&mut T）和值（T）。捕获变量时，闭包会根据上面列出的顺序（从约束最少到约束最多），优先按引用捕获，必要时才会使用后面的捕获方式：\n\n``` rust\nlet x = 10;\n// 闭包按引用捕获变量x，因为println!只需要引用参数\nlet show_x = || println!(\"x = {}\", x);\nshow_x();\n```\n外部变量的引用保存在show_x对象中，对外部变量的借用持续到show_x离开作用域为止。\n\n下面是一个捕获可变引用的例子：\n\n``` rust\nlet mut count = 0;\n// 闭包按可变引用捕获变量count \n// incr也必须是可变的，因为它持有可变引用，调用incr会改变闭包的状态\nlet mut incr = || { count += 1; println!(\"count = {}\", count); };\nincr();\n```\n\n下面的代码演示了闭包转移捕获变量所有权时的情况（捕获变量的值）：\n\n``` rust\nuse std::mem;\n\n// b是不可复制类型，因此按值捕获时所有权会转移\nlet b = Box::new(12);\nlet f = || {\n    println!(\"b = {}\", b);\n    // drop函数取T类型，因此闭包会按值捕获变量b\n    mem::drop(b);\n};\nf();\n```\n\n调用闭包后b的所有权已经转移，无法再访问：\n\n``` rust\n// 编译错误\nprintln!(\"b = {}\", b);\n```\n同样，因为b的所有权已经转移，无法再次调用这个闭包：\n\n``` rust\n// 编译错误\nf();\n```\n\n如果要强制按值捕获，可以在闭包前添加关键字move：\n\n``` rust\nlet f = move || {\n    println!(\"b = {}\", b);\n};\nf();\n```\n\n同样地，调用闭包后b的所有权已经转移，无法再访问。\n\n\n","slug":"Rust-闭包","published":1,"updated":"2020-10-21T08:02:39.164Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwg00143ys2dd2q6a65","content":"<h4 id=\"快速掌握Rust闭包\"><a href=\"#快速掌握Rust闭包\" class=\"headerlink\" title=\"快速掌握Rust闭包\"></a>快速掌握Rust闭包</h4><p><em>闭包(Closure) : 也叫Lambda表达式或匿名函数。</em></p>\n<p>不像普通函数，闭包可以对参数和返回类型进行推断，大多数时候都不需要写出来。以下定义都是合法的：</p>\n<pre class=\"line-numbers language-rust\"><code class=\"language-rust\"><span class=\"token operator\">||</span> <span class=\"token number\">42</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">|</span>x<span class=\"token operator\">|</span> x <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">|</span>x<span class=\"token punctuation\">:</span>i32<span class=\"token operator\">|</span> x <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token closure-params\"><span class=\"token punctuation\">|</span>x<span class=\"token punctuation\">:</span>i32<span class=\"token punctuation\">|</span></span> <span class=\"token punctuation\">-></span> i32 <span class=\"token punctuation\">{</span> x <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>在上面的例子中，如果是单行语句且没有标注返回类型的时候，花括号是可选的。</p>\n<ul>\n<li>闭包可以像任何其他对象一样绑定到某个变量,然后可以像调用函数一样调用闭包</li>\n</ul>\n<pre class=\"line-numbers language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">let</span> f <span class=\"token operator\">=</span> <span class=\"token operator\">|</span>x<span class=\"token operator\">|</span> x <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x is {}\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>打印结果如下：</p>\n<pre class=\"line-numbers language-rust\"><code class=\"language-rust\">x is <span class=\"token number\">6</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>也可以在定义的地方直接调用:</p>\n<pre class=\"line-numbers language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">let</span> r <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">|</span>x<span class=\"token operator\">|</span> x <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">// r == 3</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>闭包可以捕获外部的环境变量（自由变量）。</li>\n</ul>\n<p>闭包捕获变量的方式分为三类：引用（&amp;T）、可变引用（&amp;mut T）和值（T）。捕获变量时，闭包会根据上面列出的顺序（从约束最少到约束最多），优先按引用捕获，必要时才会使用后面的捕获方式：</p>\n<pre class=\"line-numbers language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">let</span> x <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\" spellcheck=\"true\">// 闭包按引用捕获变量x，因为println!只需要引用参数</span>\n<span class=\"token keyword\">let</span> show_x <span class=\"token operator\">=</span> <span class=\"token operator\">||</span> <span class=\"token function\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x = {}\"</span><span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">show_x</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>外部变量的引用保存在show_x对象中，对外部变量的借用持续到show_x离开作用域为止。</p>\n<p>下面是一个捕获可变引用的例子：</p>\n<pre class=\"line-numbers language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> count <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\" spellcheck=\"true\">// 闭包按可变引用捕获变量count </span>\n<span class=\"token comment\" spellcheck=\"true\">// incr也必须是可变的，因为它持有可变引用，调用incr会改变闭包的状态</span>\n<span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> incr <span class=\"token operator\">=</span> <span class=\"token closure-params\"><span class=\"token punctuation\">|</span><span class=\"token punctuation\">|</span></span> <span class=\"token punctuation\">{</span> count <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token function\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"count = {}\"</span><span class=\"token punctuation\">,</span> count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">incr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>下面的代码演示了闭包转移捕获变量所有权时的情况（捕获变量的值）：</p>\n<pre class=\"line-numbers language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">use</span> std<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>mem<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">// b是不可复制类型，因此按值捕获时所有权会转移</span>\n<span class=\"token keyword\">let</span> b <span class=\"token operator\">=</span> Box<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> f <span class=\"token operator\">=</span> <span class=\"token closure-params\"><span class=\"token punctuation\">|</span><span class=\"token punctuation\">|</span></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"b = {}\"</span><span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">// drop函数取T类型，因此闭包会按值捕获变量b</span>\n    mem<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">drop</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>调用闭包后b的所有权已经转移，无法再访问：</p>\n<pre class=\"line-numbers language-rust\"><code class=\"language-rust\"><span class=\"token comment\" spellcheck=\"true\">// 编译错误</span>\n<span class=\"token function\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"b = {}\"</span><span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>同样，因为b的所有权已经转移，无法再次调用这个闭包：</p>\n<pre class=\"line-numbers language-rust\"><code class=\"language-rust\"><span class=\"token comment\" spellcheck=\"true\">// 编译错误</span>\n<span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>如果要强制按值捕获，可以在闭包前添加关键字move：</p>\n<pre class=\"line-numbers language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">let</span> f <span class=\"token operator\">=</span> <span class=\"token keyword\">move</span> <span class=\"token closure-params\"><span class=\"token punctuation\">|</span><span class=\"token punctuation\">|</span></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"b = {}\"</span><span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>同样地，调用闭包后b的所有权已经转移，无法再访问。</p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"快速掌握Rust闭包\"><a href=\"#快速掌握Rust闭包\" class=\"headerlink\" title=\"快速掌握Rust闭包\"></a>快速掌握Rust闭包</h4><p><em>闭包(Closure) : 也叫Lambda表达式或匿名函数。</em></p>\n<p>不像普通函数，闭包可以对参数和返回类型进行推断，大多数时候都不需要写出来。以下定义都是合法的：</p>\n<pre><code class=\"rust\">|| 42;\n|x| x + 1;\n|x:i32| x + 1;\n|x:i32| -&gt; i32 &#123; x + 1 &#125;;</code></pre>\n<p>在上面的例子中，如果是单行语句且没有标注返回类型的时候，花括号是可选的。</p>\n<ul>\n<li>闭包可以像任何其他对象一样绑定到某个变量,然后可以像调用函数一样调用闭包</li>\n</ul>\n<pre><code class=\"rust\">let f = |x| x + 1;\nprintln!(&quot;x is &#123;&#125;&quot;, f(5))</code></pre>\n<p>打印结果如下：</p>\n<pre><code class=\"rust\">x is 6</code></pre>\n<p>也可以在定义的地方直接调用:</p>\n<pre><code class=\"rust\">let r = (|x| x + 1)(2); // r == 3</code></pre>\n<ul>\n<li>闭包可以捕获外部的环境变量（自由变量）。</li>\n</ul>\n<p>闭包捕获变量的方式分为三类：引用（&amp;T）、可变引用（&amp;mut T）和值（T）。捕获变量时，闭包会根据上面列出的顺序（从约束最少到约束最多），优先按引用捕获，必要时才会使用后面的捕获方式：</p>\n<pre><code class=\"rust\">let x = 10;\n// 闭包按引用捕获变量x，因为println!只需要引用参数\nlet show_x = || println!(&quot;x = &#123;&#125;&quot;, x);\nshow_x();</code></pre>\n<p>外部变量的引用保存在show_x对象中，对外部变量的借用持续到show_x离开作用域为止。</p>\n<p>下面是一个捕获可变引用的例子：</p>\n<pre><code class=\"rust\">let mut count = 0;\n// 闭包按可变引用捕获变量count \n// incr也必须是可变的，因为它持有可变引用，调用incr会改变闭包的状态\nlet mut incr = || &#123; count += 1; println!(&quot;count = &#123;&#125;&quot;, count); &#125;;\nincr();</code></pre>\n<p>下面的代码演示了闭包转移捕获变量所有权时的情况（捕获变量的值）：</p>\n<pre><code class=\"rust\">use std::mem;\n\n// b是不可复制类型，因此按值捕获时所有权会转移\nlet b = Box::new(12);\nlet f = || &#123;\n    println!(&quot;b = &#123;&#125;&quot;, b);\n    // drop函数取T类型，因此闭包会按值捕获变量b\n    mem::drop(b);\n&#125;;\nf();</code></pre>\n<p>调用闭包后b的所有权已经转移，无法再访问：</p>\n<pre><code class=\"rust\">// 编译错误\nprintln!(&quot;b = &#123;&#125;&quot;, b);</code></pre>\n<p>同样，因为b的所有权已经转移，无法再次调用这个闭包：</p>\n<pre><code class=\"rust\">// 编译错误\nf();</code></pre>\n<p>如果要强制按值捕获，可以在闭包前添加关键字move：</p>\n<pre><code class=\"rust\">let f = move || &#123;\n    println!(&quot;b = &#123;&#125;&quot;, b);\n&#125;;\nf();</code></pre>\n<p>同样地，调用闭包后b的所有权已经转移，无法再访问。</p>\n"},{"title":"Ubuntu权限详解","date":"2021-03-29T08:40:43.000Z","_content":"\n### Ubuntu权限详解\n\n在Linux系统中，文件的权限控制着文件的所有操作，比如一个文件的读写权限、执行权限、是否为目录等等。\n以下操作全部在终端中执行\n\n输入ls -altrh\n\n```\nuser1@wzjing-win10:/mnt/c/Users/user1$ ls -l\ntotal 458391864\ndrwxrwxrwx 0 root root       512 May 13 00:51 AppData\ndrwxrwxrwx 0 root root       512 Apr 25 00:10 CLionProjects\ndrwxrwxrwx 0 root root       512 May 22 09:32 compile\ndrwxrwxrwx 0 root root       512 May 28 14:08 Desktop\n-rwxrwxrwx 0 root root       512 May 28 14:08 test.apk\n```\n\n每一行的含义分别如下:\n\n|  权限   | incode | 所属用户 | 所属用户组 | 文件大小    | 修改时间    | 文件或文件名|\n|  ----  | ----   | ----     | ----      | ----   |    ---- | ---- |\n| drwxrwxrwx  | 0 |root | root | 512  | May 13 00:51 | AppData |\n\n每一行的第一个字段，如`drwxrwxrwx`代表了这个文件的权限详情，共分为10位，由 d r w x - 五种标识符组成，\n\n* `d` 是否为目录\n* `r` 代表用户是否有读取权限\n* `w` 代表用户是否有写入权限\n* `x` 代表用户是否有执行权限\n* `-` 代表此项为空，也就是没有此项权限的意思\n\n| 位置 | 属性 | 含义 |\n| ---- | ---- | ----- |\n| 第1位 | d   | 代表是否为文件夹 |\n| 第2-4位 | rwx | 代表所属用户的读 写 执行权限 | \n| 第5-7位 | rwx | 代表所属用户组的读 写 执行权限 | \n| 第8-10位 | rwx | 代表其他用户的读 写 执行权限 | \n\n如第一位是`d`代表是文件夹， 第一位如果是-代表不是文件夹（那不就是文件喽）\n`rwx`代表有读取、写入、执行权限，如果为`-wd`代表无读取、有写入、有执行权限\n好吧，现在来理解这一行\n\n```\ndrwxrwxrwx 0 root root       512 May 13 00:51 AppData\n```\n\n* 第1位 `d` 是文件夹\n* 2-4位 `rwx` 所属用户root有 读取、写入、执行 三项权限\n* 5-7位 `rwx` 所属用户组root有 读取、写入、执行 三项权限\n* 8-10位 `rwx` 其他用户user1有 读取、写入、执行 三项权限\n\n### 使用`chmod`命令更改文件权限\n\n语法`chmod [权限操作] [文件名]`\n你不能把一个文件改成文件夹或者把文件夹改成文件，所以你只能改后9位\n使用 `u g o a` 代表要更改的权限群组，\n\n* `u` [代表所属用户]\n* `g` [代表所属用户组]\n* `o` [代表其他用户]\n* `a` [代表以上所有三个]\n* `-` [代表删除权限]\n* `+` [代表增加权限]\n* `=` [代表将权限设置为]\n\n**示例**（如果提示你没权限修改的话，就在命令前边增加`sudo`）\n\n`chmod u+x test.apk` 代表增加所属用户对test.apk的可执行权限\n\n`chmod a-w AppData` 代表删除所有人对AppData这个文件夹的写入权限\n\n`chmod -w AppData` a可以省略，此条命令和上边这条完全相同\n\n**也可以一次设置多个权限**\n\n`chmod g+rwx AppData` 代表添加所属用户组可读取、可写入、可执行权限\n\n`chmod g=rwx AppData` 代表把所属用户组的权限设置为可读取、可写入、可执行\n\n**Tip:**  其实`+`和`=`的区别不是很大\n\n**有一种更为简便的写法：**\n\nLinux系统内部设定： `r=4 w=2 x=1 -=0`\n\n`r w x`任意一种组合的三个值相加的结果都不同\n\n如：\n\nrwx=7\n\n-wx=3\n\nr-x=5\n\nrw-=6\n\n所以可以这么写命令：\n\n`chmod 777 test.apk` 设置权限为 -rwxrwxrwx\n\n`chmod 755 test.apk` 设置权限为 -rwxr-xr-x\n\n`chmod 666 test.apk` 设置权限为 -rw-rw-rw-\n\n\n\n\n\n","source":"_posts/Ubuntu权限详解.md","raw":"---\ntitle: Ubuntu权限详解\ndate: 2021-03-29 16:40:43\ncategories:\n- Linux\ntags:\n- ubuntu\n---\n\n### Ubuntu权限详解\n\n在Linux系统中，文件的权限控制着文件的所有操作，比如一个文件的读写权限、执行权限、是否为目录等等。\n以下操作全部在终端中执行\n\n输入ls -altrh\n\n```\nuser1@wzjing-win10:/mnt/c/Users/user1$ ls -l\ntotal 458391864\ndrwxrwxrwx 0 root root       512 May 13 00:51 AppData\ndrwxrwxrwx 0 root root       512 Apr 25 00:10 CLionProjects\ndrwxrwxrwx 0 root root       512 May 22 09:32 compile\ndrwxrwxrwx 0 root root       512 May 28 14:08 Desktop\n-rwxrwxrwx 0 root root       512 May 28 14:08 test.apk\n```\n\n每一行的含义分别如下:\n\n|  权限   | incode | 所属用户 | 所属用户组 | 文件大小    | 修改时间    | 文件或文件名|\n|  ----  | ----   | ----     | ----      | ----   |    ---- | ---- |\n| drwxrwxrwx  | 0 |root | root | 512  | May 13 00:51 | AppData |\n\n每一行的第一个字段，如`drwxrwxrwx`代表了这个文件的权限详情，共分为10位，由 d r w x - 五种标识符组成，\n\n* `d` 是否为目录\n* `r` 代表用户是否有读取权限\n* `w` 代表用户是否有写入权限\n* `x` 代表用户是否有执行权限\n* `-` 代表此项为空，也就是没有此项权限的意思\n\n| 位置 | 属性 | 含义 |\n| ---- | ---- | ----- |\n| 第1位 | d   | 代表是否为文件夹 |\n| 第2-4位 | rwx | 代表所属用户的读 写 执行权限 | \n| 第5-7位 | rwx | 代表所属用户组的读 写 执行权限 | \n| 第8-10位 | rwx | 代表其他用户的读 写 执行权限 | \n\n如第一位是`d`代表是文件夹， 第一位如果是-代表不是文件夹（那不就是文件喽）\n`rwx`代表有读取、写入、执行权限，如果为`-wd`代表无读取、有写入、有执行权限\n好吧，现在来理解这一行\n\n```\ndrwxrwxrwx 0 root root       512 May 13 00:51 AppData\n```\n\n* 第1位 `d` 是文件夹\n* 2-4位 `rwx` 所属用户root有 读取、写入、执行 三项权限\n* 5-7位 `rwx` 所属用户组root有 读取、写入、执行 三项权限\n* 8-10位 `rwx` 其他用户user1有 读取、写入、执行 三项权限\n\n### 使用`chmod`命令更改文件权限\n\n语法`chmod [权限操作] [文件名]`\n你不能把一个文件改成文件夹或者把文件夹改成文件，所以你只能改后9位\n使用 `u g o a` 代表要更改的权限群组，\n\n* `u` [代表所属用户]\n* `g` [代表所属用户组]\n* `o` [代表其他用户]\n* `a` [代表以上所有三个]\n* `-` [代表删除权限]\n* `+` [代表增加权限]\n* `=` [代表将权限设置为]\n\n**示例**（如果提示你没权限修改的话，就在命令前边增加`sudo`）\n\n`chmod u+x test.apk` 代表增加所属用户对test.apk的可执行权限\n\n`chmod a-w AppData` 代表删除所有人对AppData这个文件夹的写入权限\n\n`chmod -w AppData` a可以省略，此条命令和上边这条完全相同\n\n**也可以一次设置多个权限**\n\n`chmod g+rwx AppData` 代表添加所属用户组可读取、可写入、可执行权限\n\n`chmod g=rwx AppData` 代表把所属用户组的权限设置为可读取、可写入、可执行\n\n**Tip:**  其实`+`和`=`的区别不是很大\n\n**有一种更为简便的写法：**\n\nLinux系统内部设定： `r=4 w=2 x=1 -=0`\n\n`r w x`任意一种组合的三个值相加的结果都不同\n\n如：\n\nrwx=7\n\n-wx=3\n\nr-x=5\n\nrw-=6\n\n所以可以这么写命令：\n\n`chmod 777 test.apk` 设置权限为 -rwxrwxrwx\n\n`chmod 755 test.apk` 设置权限为 -rwxr-xr-x\n\n`chmod 666 test.apk` 设置权限为 -rw-rw-rw-\n\n\n\n\n\n","slug":"Ubuntu权限详解","published":1,"updated":"2021-03-29T09:08:50.055Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwh00173ys2d3vp0fwo","content":"<h3 id=\"Ubuntu权限详解\"><a href=\"#Ubuntu权限详解\" class=\"headerlink\" title=\"Ubuntu权限详解\"></a>Ubuntu权限详解</h3><p>在Linux系统中，文件的权限控制着文件的所有操作，比如一个文件的读写权限、执行权限、是否为目录等等。<br>以下操作全部在终端中执行</p>\n<p>输入ls -altrh</p>\n<pre><code>user1@wzjing-win10:/mnt/c/Users/user1$ ls -l\ntotal 458391864\ndrwxrwxrwx 0 root root       512 May 13 00:51 AppData\ndrwxrwxrwx 0 root root       512 Apr 25 00:10 CLionProjects\ndrwxrwxrwx 0 root root       512 May 22 09:32 compile\ndrwxrwxrwx 0 root root       512 May 28 14:08 Desktop\n-rwxrwxrwx 0 root root       512 May 28 14:08 test.apk</code></pre>\n<p>每一行的含义分别如下:</p>\n<table>\n<thead>\n<tr>\n<th>权限</th>\n<th>incode</th>\n<th>所属用户</th>\n<th>所属用户组</th>\n<th>文件大小</th>\n<th>修改时间</th>\n<th>文件或文件名</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>drwxrwxrwx</td>\n<td>0</td>\n<td>root</td>\n<td>root</td>\n<td>512</td>\n<td>May 13 00:51</td>\n<td>AppData</td>\n</tr>\n</tbody></table>\n<p>每一行的第一个字段，如<code>drwxrwxrwx</code>代表了这个文件的权限详情，共分为10位，由 d r w x - 五种标识符组成，</p>\n<ul>\n<li><code>d</code> 是否为目录</li>\n<li><code>r</code> 代表用户是否有读取权限</li>\n<li><code>w</code> 代表用户是否有写入权限</li>\n<li><code>x</code> 代表用户是否有执行权限</li>\n<li><code>-</code> 代表此项为空，也就是没有此项权限的意思</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>位置</th>\n<th>属性</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>第1位</td>\n<td>d</td>\n<td>代表是否为文件夹</td>\n</tr>\n<tr>\n<td>第2-4位</td>\n<td>rwx</td>\n<td>代表所属用户的读 写 执行权限</td>\n</tr>\n<tr>\n<td>第5-7位</td>\n<td>rwx</td>\n<td>代表所属用户组的读 写 执行权限</td>\n</tr>\n<tr>\n<td>第8-10位</td>\n<td>rwx</td>\n<td>代表其他用户的读 写 执行权限</td>\n</tr>\n</tbody></table>\n<p>如第一位是<code>d</code>代表是文件夹， 第一位如果是-代表不是文件夹（那不就是文件喽）<br><code>rwx</code>代表有读取、写入、执行权限，如果为<code>-wd</code>代表无读取、有写入、有执行权限<br>好吧，现在来理解这一行</p>\n<pre><code>drwxrwxrwx 0 root root       512 May 13 00:51 AppData</code></pre>\n<ul>\n<li>第1位 <code>d</code> 是文件夹</li>\n<li>2-4位 <code>rwx</code> 所属用户root有 读取、写入、执行 三项权限</li>\n<li>5-7位 <code>rwx</code> 所属用户组root有 读取、写入、执行 三项权限</li>\n<li>8-10位 <code>rwx</code> 其他用户user1有 读取、写入、执行 三项权限</li>\n</ul>\n<h3 id=\"使用chmod命令更改文件权限\"><a href=\"#使用chmod命令更改文件权限\" class=\"headerlink\" title=\"使用chmod命令更改文件权限\"></a>使用<code>chmod</code>命令更改文件权限</h3><p>语法<code>chmod [权限操作] [文件名]</code><br>你不能把一个文件改成文件夹或者把文件夹改成文件，所以你只能改后9位<br>使用 <code>u g o a</code> 代表要更改的权限群组，</p>\n<ul>\n<li><code>u</code> [代表所属用户]</li>\n<li><code>g</code> [代表所属用户组]</li>\n<li><code>o</code> [代表其他用户]</li>\n<li><code>a</code> [代表以上所有三个]</li>\n<li><code>-</code> [代表删除权限]</li>\n<li><code>+</code> [代表增加权限]</li>\n<li><code>=</code> [代表将权限设置为]</li>\n</ul>\n<p><strong>示例</strong>（如果提示你没权限修改的话，就在命令前边增加<code>sudo</code>）</p>\n<p><code>chmod u+x test.apk</code> 代表增加所属用户对test.apk的可执行权限</p>\n<p><code>chmod a-w AppData</code> 代表删除所有人对AppData这个文件夹的写入权限</p>\n<p><code>chmod -w AppData</code> a可以省略，此条命令和上边这条完全相同</p>\n<p><strong>也可以一次设置多个权限</strong></p>\n<p><code>chmod g+rwx AppData</code> 代表添加所属用户组可读取、可写入、可执行权限</p>\n<p><code>chmod g=rwx AppData</code> 代表把所属用户组的权限设置为可读取、可写入、可执行</p>\n<p><strong>Tip:</strong>  其实<code>+</code>和<code>=</code>的区别不是很大</p>\n<p><strong>有一种更为简便的写法：</strong></p>\n<p>Linux系统内部设定： <code>r=4 w=2 x=1 -=0</code></p>\n<p><code>r w x</code>任意一种组合的三个值相加的结果都不同</p>\n<p>如：</p>\n<p>rwx=7</p>\n<p>-wx=3</p>\n<p>r-x=5</p>\n<p>rw-=6</p>\n<p>所以可以这么写命令：</p>\n<p><code>chmod 777 test.apk</code> 设置权限为 -rwxrwxrwx</p>\n<p><code>chmod 755 test.apk</code> 设置权限为 -rwxr-xr-x</p>\n<p><code>chmod 666 test.apk</code> 设置权限为 -rw-rw-rw-</p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"Ubuntu权限详解\"><a href=\"#Ubuntu权限详解\" class=\"headerlink\" title=\"Ubuntu权限详解\"></a>Ubuntu权限详解</h3><p>在Linux系统中，文件的权限控制着文件的所有操作，比如一个文件的读写权限、执行权限、是否为目录等等。<br>以下操作全部在终端中执行</p>\n<p>输入ls -altrh</p>\n<pre><code>user1@wzjing-win10:/mnt/c/Users/user1$ ls -l\ntotal 458391864\ndrwxrwxrwx 0 root root       512 May 13 00:51 AppData\ndrwxrwxrwx 0 root root       512 Apr 25 00:10 CLionProjects\ndrwxrwxrwx 0 root root       512 May 22 09:32 compile\ndrwxrwxrwx 0 root root       512 May 28 14:08 Desktop\n-rwxrwxrwx 0 root root       512 May 28 14:08 test.apk</code></pre>\n<p>每一行的含义分别如下:</p>\n<table>\n<thead>\n<tr>\n<th>权限</th>\n<th>incode</th>\n<th>所属用户</th>\n<th>所属用户组</th>\n<th>文件大小</th>\n<th>修改时间</th>\n<th>文件或文件名</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>drwxrwxrwx</td>\n<td>0</td>\n<td>root</td>\n<td>root</td>\n<td>512</td>\n<td>May 13 00:51</td>\n<td>AppData</td>\n</tr>\n</tbody></table>\n<p>每一行的第一个字段，如<code>drwxrwxrwx</code>代表了这个文件的权限详情，共分为10位，由 d r w x - 五种标识符组成，</p>\n<ul>\n<li><code>d</code> 是否为目录</li>\n<li><code>r</code> 代表用户是否有读取权限</li>\n<li><code>w</code> 代表用户是否有写入权限</li>\n<li><code>x</code> 代表用户是否有执行权限</li>\n<li><code>-</code> 代表此项为空，也就是没有此项权限的意思</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>位置</th>\n<th>属性</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>第1位</td>\n<td>d</td>\n<td>代表是否为文件夹</td>\n</tr>\n<tr>\n<td>第2-4位</td>\n<td>rwx</td>\n<td>代表所属用户的读 写 执行权限</td>\n</tr>\n<tr>\n<td>第5-7位</td>\n<td>rwx</td>\n<td>代表所属用户组的读 写 执行权限</td>\n</tr>\n<tr>\n<td>第8-10位</td>\n<td>rwx</td>\n<td>代表其他用户的读 写 执行权限</td>\n</tr>\n</tbody></table>\n<p>如第一位是<code>d</code>代表是文件夹， 第一位如果是-代表不是文件夹（那不就是文件喽）<br><code>rwx</code>代表有读取、写入、执行权限，如果为<code>-wd</code>代表无读取、有写入、有执行权限<br>好吧，现在来理解这一行</p>\n<pre><code>drwxrwxrwx 0 root root       512 May 13 00:51 AppData</code></pre>\n<ul>\n<li>第1位 <code>d</code> 是文件夹</li>\n<li>2-4位 <code>rwx</code> 所属用户root有 读取、写入、执行 三项权限</li>\n<li>5-7位 <code>rwx</code> 所属用户组root有 读取、写入、执行 三项权限</li>\n<li>8-10位 <code>rwx</code> 其他用户user1有 读取、写入、执行 三项权限</li>\n</ul>\n<h3 id=\"使用chmod命令更改文件权限\"><a href=\"#使用chmod命令更改文件权限\" class=\"headerlink\" title=\"使用chmod命令更改文件权限\"></a>使用<code>chmod</code>命令更改文件权限</h3><p>语法<code>chmod [权限操作] [文件名]</code><br>你不能把一个文件改成文件夹或者把文件夹改成文件，所以你只能改后9位<br>使用 <code>u g o a</code> 代表要更改的权限群组，</p>\n<ul>\n<li><code>u</code> [代表所属用户]</li>\n<li><code>g</code> [代表所属用户组]</li>\n<li><code>o</code> [代表其他用户]</li>\n<li><code>a</code> [代表以上所有三个]</li>\n<li><code>-</code> [代表删除权限]</li>\n<li><code>+</code> [代表增加权限]</li>\n<li><code>=</code> [代表将权限设置为]</li>\n</ul>\n<p><strong>示例</strong>（如果提示你没权限修改的话，就在命令前边增加<code>sudo</code>）</p>\n<p><code>chmod u+x test.apk</code> 代表增加所属用户对test.apk的可执行权限</p>\n<p><code>chmod a-w AppData</code> 代表删除所有人对AppData这个文件夹的写入权限</p>\n<p><code>chmod -w AppData</code> a可以省略，此条命令和上边这条完全相同</p>\n<p><strong>也可以一次设置多个权限</strong></p>\n<p><code>chmod g+rwx AppData</code> 代表添加所属用户组可读取、可写入、可执行权限</p>\n<p><code>chmod g=rwx AppData</code> 代表把所属用户组的权限设置为可读取、可写入、可执行</p>\n<p><strong>Tip:</strong>  其实<code>+</code>和<code>=</code>的区别不是很大</p>\n<p><strong>有一种更为简便的写法：</strong></p>\n<p>Linux系统内部设定： <code>r=4 w=2 x=1 -=0</code></p>\n<p><code>r w x</code>任意一种组合的三个值相加的结果都不同</p>\n<p>如：</p>\n<p>rwx=7</p>\n<p>-wx=3</p>\n<p>r-x=5</p>\n<p>rw-=6</p>\n<p>所以可以这么写命令：</p>\n<p><code>chmod 777 test.apk</code> 设置权限为 -rwxrwxrwx</p>\n<p><code>chmod 755 test.apk</code> 设置权限为 -rwxr-xr-x</p>\n<p><code>chmod 666 test.apk</code> 设置权限为 -rw-rw-rw-</p>\n"},{"title":"appium自动化测试","date":"2021-10-12T08:15:16.000Z","_content":"\n#### 使用Appium对Android App 进行自动化测试\n\n##### 一、环境\n\n* node v16.3.0\n* python 2.7\n* java 13.0.1\n* android sdk 31\n\n#### 二、概述\n\n>Appium是一个自动化开源工具，支持iOS、Android和Windows桌面平台上的原生、移动Web和混合应用的自动化。\n>Appium是跨平台的：它允许你用同样的API对多平台（iOS、Android、Windows）写测试。\n>做到在iOS、Android和Windows测试套件之间复用代码。\n\n#### 三、下载安装环境配置\n\n1、 安装python安装Appium-Python-Client库（写python自动化测试脚本会用到）\n\n```python\npip install Appium-Python-Client\n```\n\n2、安装SDK\n\n自行安装即可\n\n3、安装JDK\n\n(1) 在[oracle](https://www.oracle.com/java/technologies/downloads/)官网下载安装JDK，安装JDK8及以上的版本。\n\n(2) 安装完成后，设置JDK的环境变量\n\n(3) 我这里使用的是oh my zsh\n\n```shell\ncd ~\nvim .zshrc\n```\n\n```shell\n# 配置ANDROID_HOME环境变量\nexport ANDROID_HOME=\"/Users/liwenyang/Library/Android/sdk/\"\n\n# 配置JAVA_HOME环境变量\nexport JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk-13.0.1.jdk/Contents/Home\nexport PATH=$JAVA_HOME/bin:$PATH\n\n# 配置Android sdk tools adb\nexport PATH=\"$PATH:/Users/liwenyang/Library/Android/sdk/platform-tools\"\n```\n\n将jdk版本号、用户名换成自己的 \n\n然后 `source .zshrc`\n\n#### 四、安装appium server\n\n1、在[appium官网](https://github.com/appium/appium-desktop/releases/tag/v1.22.0)下载\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012163841.png)\n\n下载完之后进行安装就行了\n\n2、设置\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164022.png)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164101.png)\n\n保存并重启就行了\n\n3、启动\n\n点击上图中的 start server 出现这个说明启动成功 \n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164215.png)\n\n#### 五、还需要一个东西\n\n1、用来定位你app页面中的元素的 写自动化脚本会用到\n\n[点击这个下载](https://github.com/appium/appium-inspector/releases/tag/v2021.9.2)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164617.png)\n\n正常安装即可\n\n2、配置\n\n真机测试 \n\nUSB连接手机，打开手机开发者模式，打开开发者选项中的USB调试、USB安装，小米手机还需要打开USB调试（安全设置），然后在CMD命令行输入adb devices回车，如果出现了手机的设备号，说明连接成功。\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012165710.png)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012165003.png)\n\n```json\n{\n\"platformName\": \"Android\", # 声明是ios还是Android系统\n\"platformVersion\": \"8.1.0\", # Android内核版本号\n\"deviceName\": \"MI_5X\", # 连接的设备名称\n\"appPackage\": \"com.tencent.qqmusic\", # apk的包名\n\"appActivity\": \".activity.AppStarterActivity\", # apk的launcherActivity\n\"resetKeyboard\": True,\n\"noReset\": True # 在开始会话之前不要重置应用程序状态\n}\n```\n\n截图中的 appium前缀是勾选那个就可以加上了\n \n下面点击 start session 就可以了\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012165937.png)\n\n这个工具就是方便我们进行定位app内的元素用的\n\n#### 六、写自动化测试脚本\n\n随便找一个地方写个 autoTest.py\n\n```python\nimport time\nfrom appium import webdriver\n\n\ncaps = {\n    \"platformName\": \"Android\",\n    \"platformVersion\": \"9\",\n    \"deviceName\": \"Note9\",\n    \"appPackage\": \"com.easylife.house.customer\",\n    \"appActivity\": \".ui.pub.GuideActivity\",\n    \"resetKeyboard\": True,\n    \"noReset\": True\n}\ndriver = webdriver.Remote(\"http://localhost:4723/wd/hub\", caps)\n\nlunch = driver.find_element_by_id(\"com.easylife.house.customer:id/activity_launch\")\nlunch.click()\ntime.sleep(5)\n\ndriver.find_element_by_id(\"com.easylife.house.customer:id/iv_icon2\").click()\ntime.sleep(5)\ndriver.swipe(500, 1550, 500, 400)\n\ndriver.find_element_by_id(\"com.easylife.house.customer:id/iv_icon3\").click()\ntime.sleep(3)\ndriver.swipe(500, 1550, 500, 400)\n\ndriver.find_element_by_id(\"com.easylife.house.customer:id/iv_icon4\").click()\ntime.sleep(3)\ndriver.swipe(500, 1550, 500, 400)\n\ndriver.find_element_by_id(\"com.easylife.house.customer:id/iv_icon5\").click()\ntime.sleep(3)\ndriver.swipe(500, 1550, 500, 400)\ntime.sleep(3)\n\n#点击首页\ndriver.find_element_by_id(\"com.easylife.house.customer:id/iv_icon1\").click()\ntime.sleep(3)\ndriver.find_element_by_id(\"com.easylife.house.customer:id/newHouse\").click()\ntime.sleep(3)\ndriver.swipe(500, 1550, 500, 400)\n\ndriver.quit()\n\n```\n\n运行这个脚本 `python3 autoTest.py`\n脚本就可以自动的进行点击 滑动 等操作了\n","source":"_posts/appium自动化测试.md","raw":"---\ntitle: appium自动化测试\ndate: 2021-10-12 16:15:16\ncategory:\n- Appium\ntags:\n- Android\n- Mac\n- 自动化测试\n---\n\n#### 使用Appium对Android App 进行自动化测试\n\n##### 一、环境\n\n* node v16.3.0\n* python 2.7\n* java 13.0.1\n* android sdk 31\n\n#### 二、概述\n\n>Appium是一个自动化开源工具，支持iOS、Android和Windows桌面平台上的原生、移动Web和混合应用的自动化。\n>Appium是跨平台的：它允许你用同样的API对多平台（iOS、Android、Windows）写测试。\n>做到在iOS、Android和Windows测试套件之间复用代码。\n\n#### 三、下载安装环境配置\n\n1、 安装python安装Appium-Python-Client库（写python自动化测试脚本会用到）\n\n```python\npip install Appium-Python-Client\n```\n\n2、安装SDK\n\n自行安装即可\n\n3、安装JDK\n\n(1) 在[oracle](https://www.oracle.com/java/technologies/downloads/)官网下载安装JDK，安装JDK8及以上的版本。\n\n(2) 安装完成后，设置JDK的环境变量\n\n(3) 我这里使用的是oh my zsh\n\n```shell\ncd ~\nvim .zshrc\n```\n\n```shell\n# 配置ANDROID_HOME环境变量\nexport ANDROID_HOME=\"/Users/liwenyang/Library/Android/sdk/\"\n\n# 配置JAVA_HOME环境变量\nexport JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk-13.0.1.jdk/Contents/Home\nexport PATH=$JAVA_HOME/bin:$PATH\n\n# 配置Android sdk tools adb\nexport PATH=\"$PATH:/Users/liwenyang/Library/Android/sdk/platform-tools\"\n```\n\n将jdk版本号、用户名换成自己的 \n\n然后 `source .zshrc`\n\n#### 四、安装appium server\n\n1、在[appium官网](https://github.com/appium/appium-desktop/releases/tag/v1.22.0)下载\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012163841.png)\n\n下载完之后进行安装就行了\n\n2、设置\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164022.png)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164101.png)\n\n保存并重启就行了\n\n3、启动\n\n点击上图中的 start server 出现这个说明启动成功 \n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164215.png)\n\n#### 五、还需要一个东西\n\n1、用来定位你app页面中的元素的 写自动化脚本会用到\n\n[点击这个下载](https://github.com/appium/appium-inspector/releases/tag/v2021.9.2)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164617.png)\n\n正常安装即可\n\n2、配置\n\n真机测试 \n\nUSB连接手机，打开手机开发者模式，打开开发者选项中的USB调试、USB安装，小米手机还需要打开USB调试（安全设置），然后在CMD命令行输入adb devices回车，如果出现了手机的设备号，说明连接成功。\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012165710.png)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012165003.png)\n\n```json\n{\n\"platformName\": \"Android\", # 声明是ios还是Android系统\n\"platformVersion\": \"8.1.0\", # Android内核版本号\n\"deviceName\": \"MI_5X\", # 连接的设备名称\n\"appPackage\": \"com.tencent.qqmusic\", # apk的包名\n\"appActivity\": \".activity.AppStarterActivity\", # apk的launcherActivity\n\"resetKeyboard\": True,\n\"noReset\": True # 在开始会话之前不要重置应用程序状态\n}\n```\n\n截图中的 appium前缀是勾选那个就可以加上了\n \n下面点击 start session 就可以了\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012165937.png)\n\n这个工具就是方便我们进行定位app内的元素用的\n\n#### 六、写自动化测试脚本\n\n随便找一个地方写个 autoTest.py\n\n```python\nimport time\nfrom appium import webdriver\n\n\ncaps = {\n    \"platformName\": \"Android\",\n    \"platformVersion\": \"9\",\n    \"deviceName\": \"Note9\",\n    \"appPackage\": \"com.easylife.house.customer\",\n    \"appActivity\": \".ui.pub.GuideActivity\",\n    \"resetKeyboard\": True,\n    \"noReset\": True\n}\ndriver = webdriver.Remote(\"http://localhost:4723/wd/hub\", caps)\n\nlunch = driver.find_element_by_id(\"com.easylife.house.customer:id/activity_launch\")\nlunch.click()\ntime.sleep(5)\n\ndriver.find_element_by_id(\"com.easylife.house.customer:id/iv_icon2\").click()\ntime.sleep(5)\ndriver.swipe(500, 1550, 500, 400)\n\ndriver.find_element_by_id(\"com.easylife.house.customer:id/iv_icon3\").click()\ntime.sleep(3)\ndriver.swipe(500, 1550, 500, 400)\n\ndriver.find_element_by_id(\"com.easylife.house.customer:id/iv_icon4\").click()\ntime.sleep(3)\ndriver.swipe(500, 1550, 500, 400)\n\ndriver.find_element_by_id(\"com.easylife.house.customer:id/iv_icon5\").click()\ntime.sleep(3)\ndriver.swipe(500, 1550, 500, 400)\ntime.sleep(3)\n\n#点击首页\ndriver.find_element_by_id(\"com.easylife.house.customer:id/iv_icon1\").click()\ntime.sleep(3)\ndriver.find_element_by_id(\"com.easylife.house.customer:id/newHouse\").click()\ntime.sleep(3)\ndriver.swipe(500, 1550, 500, 400)\n\ndriver.quit()\n\n```\n\n运行这个脚本 `python3 autoTest.py`\n脚本就可以自动的进行点击 滑动 等操作了\n","slug":"appium自动化测试","published":1,"updated":"2021-10-12T09:03:33.987Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwh001a3ys2g8ywb8y8","content":"<h4 id=\"使用Appium对Android-App-进行自动化测试\"><a href=\"#使用Appium对Android-App-进行自动化测试\" class=\"headerlink\" title=\"使用Appium对Android App 进行自动化测试\"></a>使用Appium对Android App 进行自动化测试</h4><h5 id=\"一、环境\"><a href=\"#一、环境\" class=\"headerlink\" title=\"一、环境\"></a>一、环境</h5><ul>\n<li>node v16.3.0</li>\n<li>python 2.7</li>\n<li>java 13.0.1</li>\n<li>android sdk 31</li>\n</ul>\n<h4 id=\"二、概述\"><a href=\"#二、概述\" class=\"headerlink\" title=\"二、概述\"></a>二、概述</h4><blockquote>\n<p>Appium是一个自动化开源工具，支持iOS、Android和Windows桌面平台上的原生、移动Web和混合应用的自动化。<br>Appium是跨平台的：它允许你用同样的API对多平台（iOS、Android、Windows）写测试。<br>做到在iOS、Android和Windows测试套件之间复用代码。</p>\n</blockquote>\n<h4 id=\"三、下载安装环境配置\"><a href=\"#三、下载安装环境配置\" class=\"headerlink\" title=\"三、下载安装环境配置\"></a>三、下载安装环境配置</h4><p>1、 安装python安装Appium-Python-Client库（写python自动化测试脚本会用到）</p>\n<pre class=\"line-numbers language-python\"><code class=\"language-python\">pip install Appium<span class=\"token operator\">-</span>Python<span class=\"token operator\">-</span>Client<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>2、安装SDK</p>\n<p>自行安装即可</p>\n<p>3、安装JDK</p>\n<p>(1) 在<a href=\"https://www.oracle.com/java/technologies/downloads/\">oracle</a>官网下载安装JDK，安装JDK8及以上的版本。</p>\n<p>(2) 安装完成后，设置JDK的环境变量</p>\n<p>(3) 我这里使用的是oh my zsh</p>\n<pre class=\"line-numbers language-shell\"><code class=\"language-shell\">cd ~\nvim .zshrc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-shell\"><code class=\"language-shell\"># 配置ANDROID_HOME环境变量\nexport ANDROID_HOME=\"/Users/liwenyang/Library/Android/sdk/\"\n\n# 配置JAVA_HOME环境变量\nexport JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk-13.0.1.jdk/Contents/Home\nexport PATH=$JAVA_HOME/bin:$PATH\n\n# 配置Android sdk tools adb\nexport PATH=\"$PATH:/Users/liwenyang/Library/Android/sdk/platform-tools\"<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>将jdk版本号、用户名换成自己的 </p>\n<p>然后 <code>source .zshrc</code></p>\n<h4 id=\"四、安装appium-server\"><a href=\"#四、安装appium-server\" class=\"headerlink\" title=\"四、安装appium server\"></a>四、安装appium server</h4><p>1、在<a href=\"https://github.com/appium/appium-desktop/releases/tag/v1.22.0\">appium官网</a>下载</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012163841.png\"></p>\n<p>下载完之后进行安装就行了</p>\n<p>2、设置</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164022.png\"></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164101.png\"></p>\n<p>保存并重启就行了</p>\n<p>3、启动</p>\n<p>点击上图中的 start server 出现这个说明启动成功 </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164215.png\"></p>\n<h4 id=\"五、还需要一个东西\"><a href=\"#五、还需要一个东西\" class=\"headerlink\" title=\"五、还需要一个东西\"></a>五、还需要一个东西</h4><p>1、用来定位你app页面中的元素的 写自动化脚本会用到</p>\n<p><a href=\"https://github.com/appium/appium-inspector/releases/tag/v2021.9.2\">点击这个下载</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164617.png\"></p>\n<p>正常安装即可</p>\n<p>2、配置</p>\n<p>真机测试 </p>\n<p>USB连接手机，打开手机开发者模式，打开开发者选项中的USB调试、USB安装，小米手机还需要打开USB调试（安全设置），然后在CMD命令行输入adb devices回车，如果出现了手机的设备号，说明连接成功。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012165710.png\"></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012165003.png\"></p>\n<pre class=\"line-numbers language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n<span class=\"token property\">\"platformName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Android\"</span><span class=\"token punctuation\">,</span> # 声明是ios还是Android系统\n<span class=\"token property\">\"platformVersion\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"8.1.0\"</span><span class=\"token punctuation\">,</span> # Android内核版本号\n<span class=\"token property\">\"deviceName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"MI_5X\"</span><span class=\"token punctuation\">,</span> # 连接的设备名称\n<span class=\"token property\">\"appPackage\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"com.tencent.qqmusic\"</span><span class=\"token punctuation\">,</span> # apk的包名\n<span class=\"token property\">\"appActivity\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\".activity.AppStarterActivity\"</span><span class=\"token punctuation\">,</span> # apk的launcherActivity\n<span class=\"token property\">\"resetKeyboard\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"noReset\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">True</span> # 在开始会话之前不要重置应用程序状态\n<span class=\"token punctuation\">}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>截图中的 appium前缀是勾选那个就可以加上了</p>\n<p>下面点击 start session 就可以了</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012165937.png\"></p>\n<p>这个工具就是方便我们进行定位app内的元素用的</p>\n<h4 id=\"六、写自动化测试脚本\"><a href=\"#六、写自动化测试脚本\" class=\"headerlink\" title=\"六、写自动化测试脚本\"></a>六、写自动化测试脚本</h4><p>随便找一个地方写个 autoTest.py</p>\n<pre class=\"line-numbers language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> time\n<span class=\"token keyword\">from</span> appium <span class=\"token keyword\">import</span> webdriver\n\n\ncaps <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"platformName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Android\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"platformVersion\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"9\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"deviceName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Note9\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"appPackage\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"com.easylife.house.customer\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"appActivity\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\".ui.pub.GuideActivity\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"resetKeyboard\"</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"noReset\"</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span>\n<span class=\"token punctuation\">}</span>\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Remote<span class=\"token punctuation\">(</span><span class=\"token string\">\"http://localhost:4723/wd/hub\"</span><span class=\"token punctuation\">,</span> caps<span class=\"token punctuation\">)</span>\n\nlunch <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"com.easylife.house.customer:id/activity_launch\"</span><span class=\"token punctuation\">)</span>\nlunch<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"com.easylife.house.customer:id/iv_icon2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>swipe<span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1550</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"com.easylife.house.customer:id/iv_icon3\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>swipe<span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1550</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"com.easylife.house.customer:id/iv_icon4\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>swipe<span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1550</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"com.easylife.house.customer:id/iv_icon5\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>swipe<span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1550</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\" spellcheck=\"true\">#点击首页</span>\ndriver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"com.easylife.house.customer:id/iv_icon1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"com.easylife.house.customer:id/newHouse\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>swipe<span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1550</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>运行这个脚本 <code>python3 autoTest.py</code><br>脚本就可以自动的进行点击 滑动 等操作了</p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"使用Appium对Android-App-进行自动化测试\"><a href=\"#使用Appium对Android-App-进行自动化测试\" class=\"headerlink\" title=\"使用Appium对Android App 进行自动化测试\"></a>使用Appium对Android App 进行自动化测试</h4><h5 id=\"一、环境\"><a href=\"#一、环境\" class=\"headerlink\" title=\"一、环境\"></a>一、环境</h5><ul>\n<li>node v16.3.0</li>\n<li>python 2.7</li>\n<li>java 13.0.1</li>\n<li>android sdk 31</li>\n</ul>\n<h4 id=\"二、概述\"><a href=\"#二、概述\" class=\"headerlink\" title=\"二、概述\"></a>二、概述</h4><blockquote>\n<p>Appium是一个自动化开源工具，支持iOS、Android和Windows桌面平台上的原生、移动Web和混合应用的自动化。<br>Appium是跨平台的：它允许你用同样的API对多平台（iOS、Android、Windows）写测试。<br>做到在iOS、Android和Windows测试套件之间复用代码。</p>\n</blockquote>\n<h4 id=\"三、下载安装环境配置\"><a href=\"#三、下载安装环境配置\" class=\"headerlink\" title=\"三、下载安装环境配置\"></a>三、下载安装环境配置</h4><p>1、 安装python安装Appium-Python-Client库（写python自动化测试脚本会用到）</p>\n<pre><code class=\"python\">pip install Appium-Python-Client</code></pre>\n<p>2、安装SDK</p>\n<p>自行安装即可</p>\n<p>3、安装JDK</p>\n<p>(1) 在<a href=\"https://www.oracle.com/java/technologies/downloads/\">oracle</a>官网下载安装JDK，安装JDK8及以上的版本。</p>\n<p>(2) 安装完成后，设置JDK的环境变量</p>\n<p>(3) 我这里使用的是oh my zsh</p>\n<pre><code class=\"shell\">cd ~\nvim .zshrc</code></pre>\n<pre><code class=\"shell\"># 配置ANDROID_HOME环境变量\nexport ANDROID_HOME=&quot;/Users/liwenyang/Library/Android/sdk/&quot;\n\n# 配置JAVA_HOME环境变量\nexport JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk-13.0.1.jdk/Contents/Home\nexport PATH=$JAVA_HOME/bin:$PATH\n\n# 配置Android sdk tools adb\nexport PATH=&quot;$PATH:/Users/liwenyang/Library/Android/sdk/platform-tools&quot;</code></pre>\n<p>将jdk版本号、用户名换成自己的 </p>\n<p>然后 <code>source .zshrc</code></p>\n<h4 id=\"四、安装appium-server\"><a href=\"#四、安装appium-server\" class=\"headerlink\" title=\"四、安装appium server\"></a>四、安装appium server</h4><p>1、在<a href=\"https://github.com/appium/appium-desktop/releases/tag/v1.22.0\">appium官网</a>下载</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012163841.png\"></p>\n<p>下载完之后进行安装就行了</p>\n<p>2、设置</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164022.png\"></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164101.png\"></p>\n<p>保存并重启就行了</p>\n<p>3、启动</p>\n<p>点击上图中的 start server 出现这个说明启动成功 </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164215.png\"></p>\n<h4 id=\"五、还需要一个东西\"><a href=\"#五、还需要一个东西\" class=\"headerlink\" title=\"五、还需要一个东西\"></a>五、还需要一个东西</h4><p>1、用来定位你app页面中的元素的 写自动化脚本会用到</p>\n<p><a href=\"https://github.com/appium/appium-inspector/releases/tag/v2021.9.2\">点击这个下载</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012164617.png\"></p>\n<p>正常安装即可</p>\n<p>2、配置</p>\n<p>真机测试 </p>\n<p>USB连接手机，打开手机开发者模式，打开开发者选项中的USB调试、USB安装，小米手机还需要打开USB调试（安全设置），然后在CMD命令行输入adb devices回车，如果出现了手机的设备号，说明连接成功。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012165710.png\"></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012165003.png\"></p>\n<pre><code class=\"json\">&#123;\n&quot;platformName&quot;: &quot;Android&quot;, # 声明是ios还是Android系统\n&quot;platformVersion&quot;: &quot;8.1.0&quot;, # Android内核版本号\n&quot;deviceName&quot;: &quot;MI_5X&quot;, # 连接的设备名称\n&quot;appPackage&quot;: &quot;com.tencent.qqmusic&quot;, # apk的包名\n&quot;appActivity&quot;: &quot;.activity.AppStarterActivity&quot;, # apk的launcherActivity\n&quot;resetKeyboard&quot;: True,\n&quot;noReset&quot;: True # 在开始会话之前不要重置应用程序状态\n&#125;</code></pre>\n<p>截图中的 appium前缀是勾选那个就可以加上了</p>\n<p>下面点击 start session 就可以了</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20211012165937.png\"></p>\n<p>这个工具就是方便我们进行定位app内的元素用的</p>\n<h4 id=\"六、写自动化测试脚本\"><a href=\"#六、写自动化测试脚本\" class=\"headerlink\" title=\"六、写自动化测试脚本\"></a>六、写自动化测试脚本</h4><p>随便找一个地方写个 autoTest.py</p>\n<pre><code class=\"python\">import time\nfrom appium import webdriver\n\n\ncaps = &#123;\n    &quot;platformName&quot;: &quot;Android&quot;,\n    &quot;platformVersion&quot;: &quot;9&quot;,\n    &quot;deviceName&quot;: &quot;Note9&quot;,\n    &quot;appPackage&quot;: &quot;com.easylife.house.customer&quot;,\n    &quot;appActivity&quot;: &quot;.ui.pub.GuideActivity&quot;,\n    &quot;resetKeyboard&quot;: True,\n    &quot;noReset&quot;: True\n&#125;\ndriver = webdriver.Remote(&quot;http://localhost:4723/wd/hub&quot;, caps)\n\nlunch = driver.find_element_by_id(&quot;com.easylife.house.customer:id/activity_launch&quot;)\nlunch.click()\ntime.sleep(5)\n\ndriver.find_element_by_id(&quot;com.easylife.house.customer:id/iv_icon2&quot;).click()\ntime.sleep(5)\ndriver.swipe(500, 1550, 500, 400)\n\ndriver.find_element_by_id(&quot;com.easylife.house.customer:id/iv_icon3&quot;).click()\ntime.sleep(3)\ndriver.swipe(500, 1550, 500, 400)\n\ndriver.find_element_by_id(&quot;com.easylife.house.customer:id/iv_icon4&quot;).click()\ntime.sleep(3)\ndriver.swipe(500, 1550, 500, 400)\n\ndriver.find_element_by_id(&quot;com.easylife.house.customer:id/iv_icon5&quot;).click()\ntime.sleep(3)\ndriver.swipe(500, 1550, 500, 400)\ntime.sleep(3)\n\n#点击首页\ndriver.find_element_by_id(&quot;com.easylife.house.customer:id/iv_icon1&quot;).click()\ntime.sleep(3)\ndriver.find_element_by_id(&quot;com.easylife.house.customer:id/newHouse&quot;).click()\ntime.sleep(3)\ndriver.swipe(500, 1550, 500, 400)\n\ndriver.quit()\n</code></pre>\n<p>运行这个脚本 <code>python3 autoTest.py</code><br>脚本就可以自动的进行点击 滑动 等操作了</p>\n"},{"title":"deploy a nft art and transfer in eth testnet","date":"2021-07-30T08:57:44.000Z","_content":"\n### 如何在以太坊测试网络上发布一个NFT艺术品并转给他人\n\n#### 1、首先什么是NFT\n\n> 非同质化代币NFT是一种数字资产，具备不可分割和独一无二这两大特性，可用于代表有形和无形的物品。NFT应用场景多样，包括数字收藏品、音乐、艺术品以及游戏内代币。\n\n#### 2 、什么是ERC-721\n\nERC 代表 Ethereum Request for Comment，721 是提案标识符号。 ERC 是以太坊生态系统中的应用级标准，可以是 ERC-20 等代币的智能合约标准，ERC 的作者负责与以太坊社区建立共识，一旦提案得到以太坊社区的审查和批准社区它成为一个标准。您可以在此处跟踪最近的 ERC 提案。创建 ERC-721 是为了提出在智能合约中跟踪和传输 NFT 的功能。\n\nERC-721 是一个开放标准，描述了如何在 EVM（以太坊虚拟机）兼容的区块链上构建不可替代的代币；它是不可替代代币的标准接口；它有一套规则，可以很容易地使用 NFT。 NFT 不仅是 ERC-721 类型；它们也可以是 ERC-1155 代币。\n\n\n#### 3、我们还需要知道一个东西 `IPFS`\n\n> 星际文件系统（InterPlanetary File System，缩写为IPFS）是一个旨在创建持久且分布式存储和共享文件的网络传输协议。它是一种内容可寻址的对等超媒体分发协议。在IPFS网络中的节点将构成一个分布式文件系统。它是一个开放源代码项目，自2014年开始由协议实验室在开源社区的帮助下发展。其最初由Juan Benet设计。\n\n如果要发布一个NFT艺术品,我们需要定义这个艺术品的属性，通常我们用`json`文件来定义，我们还需要一个链接可以查看这个艺术品\n\n随便创建一个xxx.json\n\n```json\n\n{\n\"name\": \"NFT Art\",\n\"description\": \"This image shows the true nature of NFT.\",\n\"image\": \"https://ipfs.io/ipfs/QmQLzfy3Zs9S6nV4HG9to9wntbdaoJgC41wgEQMJwm6gBK\",\n}\n\n```\n\n* name 艺术品的名称\n\n* description 艺术品的描述\n\n* image 图片的链接\n\n这里我们就定义了一个简单的json文件来表示这个艺术品 \n`IPFS` 是一个去中心化的平台 我们将json文件 图片上传到这个平台 可以拿到这样的链接\n\n**下面我们来说一下如何使用`IPFS`**\n\n[IPFS官网地址](https://ipfs.io/)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730175202.png)\n\n我这里选择的是 桌面应用程序 可视化界面 好操作一些 \n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730175424.png)\n\n打开之后 选择导入 我们选择创建的xxx.json 和 一张图片也好 gif也行\n\n然后我们点击三个点 选择 分享链接 复制一下链接就行了\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730175647.png)\n\n当然 你也可以不选择`IPFS` 只要提供的链接能访问到就行。用IPFS的原因是去中心化 如果是你自己提供的链接那就可能不是去中心化了\n\n\n这里我给出我的两个链接\n```solidity\n\njson字符串 \nhttps://ipfs.io/ipfs/QmZJEQLGYSMoVMmzVrkujsPiydZiWbHHGFZQLvf8J79s8h?filename=apple.json\n\n图片链接\nhttps://ipfs.io/ipfs/QmQLzfy3Zs9S6nV4HG9to9wntbdaoJgC41wgEQMJwm6gBK?filename=spin.gif\n\n```\n\n后面的`?filename=apple.json`可以删掉也能访问到\n\n\n#### 4、编写智能合约\n\n编写NFT合约代码的话 我们可以选择一些非常成熟的库在他们的基础上进行编写自己的NFT代码 比较好的库就是`OpenZeppelin`\n\n[github地址](https://github.com/OpenZeppelin/openzeppelin-contracts/tree/master/contracts/token/ERC721/extensions)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730172037.png)\n\n他这里是提供了很多个不同功能的NFT代码给我们， 我们只需要选择红色框那个来继承就行了，这个是比较简单的， 没有别的复杂功能。\n\n#### 5、开始编写代码\n\n这里我们选择在线的`Remix`来编写我们的合约代码 \n\n[Remix中文版地址](http://remix.app.hubwiz.com/#optimize=false&runs=200&evmVersion=null&version=soljson-v0.7.4+commit.3f05b770.js)\n\n```solidity\n\n// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\nimport \"https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC721/extensions/ERC721URIStorage.sol\";\n\ncontract MobilePhoneNft is ERC721URIStorage{\n\n  uint public counter;\n\n  constructor() ERC721(\"MobilePhoneNft\", \"MPN\"){\n    counter = 0;\n  }\n\n  function createNFTs (string memory tokenURI) public returns(uint) {\n    uint tokenId = counter;\n\n    _safeMint(msg.sender, tokenId);\n    _setTokenURI(tokenId, tokenURI);\n\n    counter ++;\n    return tokenId;\n  }\n\n\n  function burn(uint256 tokenId) public virtual {\n    require(_isApprovedOrOwner(msg.sender, tokenId), \"You can not burn it, because you are not the owner!\");\n    super._burn(tokenId);\n  }\n  \n  \n}\n\n```\n\n我们讲一下这个代码 \n\n`createNFTs` 创建一个NFT 我们调用的时候需要传入一个参数 这个参数是一个地址代表你这个`NFT`的一些属性 这个地址是一串`json`字符串\n\n[https://ipfs.io/ipfs/QmZJEQLGYSMoVMmzVrkujsPiydZiWbHHGFZQLvf8J79s8h](https://ipfs.io/ipfs/QmZJEQLGYSMoVMmzVrkujsPiydZiWbHHGFZQLvf8J79s8h)\n\n`json` 字符串内容如下:\n\n```json\n\n{\n\"name\": \"NFT Art\",\n\"description\": \"This image shows the true nature of NFT.\",\n\"image\": \"https://ipfs.io/ipfs/QmQLzfy3Zs9S6nV4HG9to9wntbdaoJgC41wgEQMJwm6gBK\",\n}\n\n```\n\ntokenId 我们使用`counter ++` 自增 初始值为0\n\n有一个`burn`的方法 当你调用完`createNFTs`创建了一个NFT但是你并不满意时 可以调用这个方法来烧毁这个`NFT`。\n\n#### 6、合约部署\n\n编译一下我们的合约\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730180438.png)\n\n如果没有问题 就可以部署了\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730180645.png)\n\n我这里是部署到 Rinkeby 测试网络 部署完成之后 我们就调用一下 合约的方法 `createNFTs`\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730180909.png)\n\n填入上面那个 `json` 的链接 正常付gas费就行了 \n\n之后我们在`https://rinkeby.etherscan.io/`测试网络上查看 我们的账户就可以看到那个nft合约了 不过我们看不到图片\n\n如果想看到图片的话 需要借助`openSea` 它也是支持了`Rinkby`测试网络的\n\n[Open Sea Rinkby 测试网络](https://testnets.opensea.io/account)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730181750.png)\n\n#### 7、将这个NFT转给他人\n\n我们只需要调用 这个方法就行了 这个方法是 ERC-721 提供的方法\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730182229.png)\n\ntokenId 在rinkeby测试网可以查看 我这里是 0\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730182401.png)\n\n\n\n","source":"_posts/deploy-a-nft-art-and-transfer-in-eth-testnet.md","raw":"---\ntitle: deploy a nft art and transfer in eth testnet\ndate: 2021-07-30 16:57:44\ncategory:\n- NFT\ntags:\n- eth\n- NFT\n---\n\n### 如何在以太坊测试网络上发布一个NFT艺术品并转给他人\n\n#### 1、首先什么是NFT\n\n> 非同质化代币NFT是一种数字资产，具备不可分割和独一无二这两大特性，可用于代表有形和无形的物品。NFT应用场景多样，包括数字收藏品、音乐、艺术品以及游戏内代币。\n\n#### 2 、什么是ERC-721\n\nERC 代表 Ethereum Request for Comment，721 是提案标识符号。 ERC 是以太坊生态系统中的应用级标准，可以是 ERC-20 等代币的智能合约标准，ERC 的作者负责与以太坊社区建立共识，一旦提案得到以太坊社区的审查和批准社区它成为一个标准。您可以在此处跟踪最近的 ERC 提案。创建 ERC-721 是为了提出在智能合约中跟踪和传输 NFT 的功能。\n\nERC-721 是一个开放标准，描述了如何在 EVM（以太坊虚拟机）兼容的区块链上构建不可替代的代币；它是不可替代代币的标准接口；它有一套规则，可以很容易地使用 NFT。 NFT 不仅是 ERC-721 类型；它们也可以是 ERC-1155 代币。\n\n\n#### 3、我们还需要知道一个东西 `IPFS`\n\n> 星际文件系统（InterPlanetary File System，缩写为IPFS）是一个旨在创建持久且分布式存储和共享文件的网络传输协议。它是一种内容可寻址的对等超媒体分发协议。在IPFS网络中的节点将构成一个分布式文件系统。它是一个开放源代码项目，自2014年开始由协议实验室在开源社区的帮助下发展。其最初由Juan Benet设计。\n\n如果要发布一个NFT艺术品,我们需要定义这个艺术品的属性，通常我们用`json`文件来定义，我们还需要一个链接可以查看这个艺术品\n\n随便创建一个xxx.json\n\n```json\n\n{\n\"name\": \"NFT Art\",\n\"description\": \"This image shows the true nature of NFT.\",\n\"image\": \"https://ipfs.io/ipfs/QmQLzfy3Zs9S6nV4HG9to9wntbdaoJgC41wgEQMJwm6gBK\",\n}\n\n```\n\n* name 艺术品的名称\n\n* description 艺术品的描述\n\n* image 图片的链接\n\n这里我们就定义了一个简单的json文件来表示这个艺术品 \n`IPFS` 是一个去中心化的平台 我们将json文件 图片上传到这个平台 可以拿到这样的链接\n\n**下面我们来说一下如何使用`IPFS`**\n\n[IPFS官网地址](https://ipfs.io/)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730175202.png)\n\n我这里选择的是 桌面应用程序 可视化界面 好操作一些 \n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730175424.png)\n\n打开之后 选择导入 我们选择创建的xxx.json 和 一张图片也好 gif也行\n\n然后我们点击三个点 选择 分享链接 复制一下链接就行了\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730175647.png)\n\n当然 你也可以不选择`IPFS` 只要提供的链接能访问到就行。用IPFS的原因是去中心化 如果是你自己提供的链接那就可能不是去中心化了\n\n\n这里我给出我的两个链接\n```solidity\n\njson字符串 \nhttps://ipfs.io/ipfs/QmZJEQLGYSMoVMmzVrkujsPiydZiWbHHGFZQLvf8J79s8h?filename=apple.json\n\n图片链接\nhttps://ipfs.io/ipfs/QmQLzfy3Zs9S6nV4HG9to9wntbdaoJgC41wgEQMJwm6gBK?filename=spin.gif\n\n```\n\n后面的`?filename=apple.json`可以删掉也能访问到\n\n\n#### 4、编写智能合约\n\n编写NFT合约代码的话 我们可以选择一些非常成熟的库在他们的基础上进行编写自己的NFT代码 比较好的库就是`OpenZeppelin`\n\n[github地址](https://github.com/OpenZeppelin/openzeppelin-contracts/tree/master/contracts/token/ERC721/extensions)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730172037.png)\n\n他这里是提供了很多个不同功能的NFT代码给我们， 我们只需要选择红色框那个来继承就行了，这个是比较简单的， 没有别的复杂功能。\n\n#### 5、开始编写代码\n\n这里我们选择在线的`Remix`来编写我们的合约代码 \n\n[Remix中文版地址](http://remix.app.hubwiz.com/#optimize=false&runs=200&evmVersion=null&version=soljson-v0.7.4+commit.3f05b770.js)\n\n```solidity\n\n// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\nimport \"https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC721/extensions/ERC721URIStorage.sol\";\n\ncontract MobilePhoneNft is ERC721URIStorage{\n\n  uint public counter;\n\n  constructor() ERC721(\"MobilePhoneNft\", \"MPN\"){\n    counter = 0;\n  }\n\n  function createNFTs (string memory tokenURI) public returns(uint) {\n    uint tokenId = counter;\n\n    _safeMint(msg.sender, tokenId);\n    _setTokenURI(tokenId, tokenURI);\n\n    counter ++;\n    return tokenId;\n  }\n\n\n  function burn(uint256 tokenId) public virtual {\n    require(_isApprovedOrOwner(msg.sender, tokenId), \"You can not burn it, because you are not the owner!\");\n    super._burn(tokenId);\n  }\n  \n  \n}\n\n```\n\n我们讲一下这个代码 \n\n`createNFTs` 创建一个NFT 我们调用的时候需要传入一个参数 这个参数是一个地址代表你这个`NFT`的一些属性 这个地址是一串`json`字符串\n\n[https://ipfs.io/ipfs/QmZJEQLGYSMoVMmzVrkujsPiydZiWbHHGFZQLvf8J79s8h](https://ipfs.io/ipfs/QmZJEQLGYSMoVMmzVrkujsPiydZiWbHHGFZQLvf8J79s8h)\n\n`json` 字符串内容如下:\n\n```json\n\n{\n\"name\": \"NFT Art\",\n\"description\": \"This image shows the true nature of NFT.\",\n\"image\": \"https://ipfs.io/ipfs/QmQLzfy3Zs9S6nV4HG9to9wntbdaoJgC41wgEQMJwm6gBK\",\n}\n\n```\n\ntokenId 我们使用`counter ++` 自增 初始值为0\n\n有一个`burn`的方法 当你调用完`createNFTs`创建了一个NFT但是你并不满意时 可以调用这个方法来烧毁这个`NFT`。\n\n#### 6、合约部署\n\n编译一下我们的合约\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730180438.png)\n\n如果没有问题 就可以部署了\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730180645.png)\n\n我这里是部署到 Rinkeby 测试网络 部署完成之后 我们就调用一下 合约的方法 `createNFTs`\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730180909.png)\n\n填入上面那个 `json` 的链接 正常付gas费就行了 \n\n之后我们在`https://rinkeby.etherscan.io/`测试网络上查看 我们的账户就可以看到那个nft合约了 不过我们看不到图片\n\n如果想看到图片的话 需要借助`openSea` 它也是支持了`Rinkby`测试网络的\n\n[Open Sea Rinkby 测试网络](https://testnets.opensea.io/account)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730181750.png)\n\n#### 7、将这个NFT转给他人\n\n我们只需要调用 这个方法就行了 这个方法是 ERC-721 提供的方法\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730182229.png)\n\ntokenId 在rinkeby测试网可以查看 我这里是 0\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730182401.png)\n\n\n\n","slug":"deploy-a-nft-art-and-transfer-in-eth-testnet","published":1,"updated":"2021-10-15T01:46:40.006Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwi001e3ys24ueshkqi","content":"<h3 id=\"如何在以太坊测试网络上发布一个NFT艺术品并转给他人\"><a href=\"#如何在以太坊测试网络上发布一个NFT艺术品并转给他人\" class=\"headerlink\" title=\"如何在以太坊测试网络上发布一个NFT艺术品并转给他人\"></a>如何在以太坊测试网络上发布一个NFT艺术品并转给他人</h3><h4 id=\"1、首先什么是NFT\"><a href=\"#1、首先什么是NFT\" class=\"headerlink\" title=\"1、首先什么是NFT\"></a>1、首先什么是NFT</h4><blockquote>\n<p>非同质化代币NFT是一种数字资产，具备不可分割和独一无二这两大特性，可用于代表有形和无形的物品。NFT应用场景多样，包括数字收藏品、音乐、艺术品以及游戏内代币。</p>\n</blockquote>\n<h4 id=\"2-、什么是ERC-721\"><a href=\"#2-、什么是ERC-721\" class=\"headerlink\" title=\"2 、什么是ERC-721\"></a>2 、什么是ERC-721</h4><p>ERC 代表 Ethereum Request for Comment，721 是提案标识符号。 ERC 是以太坊生态系统中的应用级标准，可以是 ERC-20 等代币的智能合约标准，ERC 的作者负责与以太坊社区建立共识，一旦提案得到以太坊社区的审查和批准社区它成为一个标准。您可以在此处跟踪最近的 ERC 提案。创建 ERC-721 是为了提出在智能合约中跟踪和传输 NFT 的功能。</p>\n<p>ERC-721 是一个开放标准，描述了如何在 EVM（以太坊虚拟机）兼容的区块链上构建不可替代的代币；它是不可替代代币的标准接口；它有一套规则，可以很容易地使用 NFT。 NFT 不仅是 ERC-721 类型；它们也可以是 ERC-1155 代币。</p>\n<h4 id=\"3、我们还需要知道一个东西-IPFS\"><a href=\"#3、我们还需要知道一个东西-IPFS\" class=\"headerlink\" title=\"3、我们还需要知道一个东西 IPFS\"></a>3、我们还需要知道一个东西 <code>IPFS</code></h4><blockquote>\n<p>星际文件系统（InterPlanetary File System，缩写为IPFS）是一个旨在创建持久且分布式存储和共享文件的网络传输协议。它是一种内容可寻址的对等超媒体分发协议。在IPFS网络中的节点将构成一个分布式文件系统。它是一个开放源代码项目，自2014年开始由协议实验室在开源社区的帮助下发展。其最初由Juan Benet设计。</p>\n</blockquote>\n<p>如果要发布一个NFT艺术品,我们需要定义这个艺术品的属性，通常我们用<code>json</code>文件来定义，我们还需要一个链接可以查看这个艺术品</p>\n<p>随便创建一个xxx.json</p>\n<pre class=\"line-numbers language-json\"><code class=\"language-json\">\n<span class=\"token punctuation\">{</span>\n<span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"NFT Art\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"This image shows the true nature of NFT.\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"image\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://ipfs.io/ipfs/QmQLzfy3Zs9S6nV4HG9to9wntbdaoJgC41wgEQMJwm6gBK\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<ul>\n<li><p>name 艺术品的名称</p>\n</li>\n<li><p>description 艺术品的描述</p>\n</li>\n<li><p>image 图片的链接</p>\n</li>\n</ul>\n<p>这里我们就定义了一个简单的json文件来表示这个艺术品<br><code>IPFS</code> 是一个去中心化的平台 我们将json文件 图片上传到这个平台 可以拿到这样的链接</p>\n<p><strong>下面我们来说一下如何使用<code>IPFS</code></strong></p>\n<p><a href=\"https://ipfs.io/\">IPFS官网地址</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730175202.png\"></p>\n<p>我这里选择的是 桌面应用程序 可视化界面 好操作一些 </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730175424.png\"></p>\n<p>打开之后 选择导入 我们选择创建的xxx.json 和 一张图片也好 gif也行</p>\n<p>然后我们点击三个点 选择 分享链接 复制一下链接就行了</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730175647.png\"></p>\n<p>当然 你也可以不选择<code>IPFS</code> 只要提供的链接能访问到就行。用IPFS的原因是去中心化 如果是你自己提供的链接那就可能不是去中心化了</p>\n<p>这里我给出我的两个链接</p>\n<pre class=\"line-numbers language-solidity\"><code class=\"language-solidity\">\njson字符串 \nhttps://ipfs.io/ipfs/QmZJEQLGYSMoVMmzVrkujsPiydZiWbHHGFZQLvf8J79s8h?filename=apple.json\n\n图片链接\nhttps://ipfs.io/ipfs/QmQLzfy3Zs9S6nV4HG9to9wntbdaoJgC41wgEQMJwm6gBK?filename=spin.gif\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>后面的<code>?filename=apple.json</code>可以删掉也能访问到</p>\n<h4 id=\"4、编写智能合约\"><a href=\"#4、编写智能合约\" class=\"headerlink\" title=\"4、编写智能合约\"></a>4、编写智能合约</h4><p>编写NFT合约代码的话 我们可以选择一些非常成熟的库在他们的基础上进行编写自己的NFT代码 比较好的库就是<code>OpenZeppelin</code></p>\n<p><a href=\"https://github.com/OpenZeppelin/openzeppelin-contracts/tree/master/contracts/token/ERC721/extensions\">github地址</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730172037.png\"></p>\n<p>他这里是提供了很多个不同功能的NFT代码给我们， 我们只需要选择红色框那个来继承就行了，这个是比较简单的， 没有别的复杂功能。</p>\n<h4 id=\"5、开始编写代码\"><a href=\"#5、开始编写代码\" class=\"headerlink\" title=\"5、开始编写代码\"></a>5、开始编写代码</h4><p>这里我们选择在线的<code>Remix</code>来编写我们的合约代码 </p>\n<p><a href=\"http://remix.app.hubwiz.com/#optimize=false&amp;runs=200&amp;evmVersion=null&amp;version=soljson-v0.7.4+commit.3f05b770.js\">Remix中文版地址</a></p>\n<pre class=\"line-numbers language-solidity\"><code class=\"language-solidity\">\n// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\nimport \"https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC721/extensions/ERC721URIStorage.sol\";\n\ncontract MobilePhoneNft is ERC721URIStorage{\n\n  uint public counter;\n\n  constructor() ERC721(\"MobilePhoneNft\", \"MPN\"){\n    counter = 0;\n  }\n\n  function createNFTs (string memory tokenURI) public returns(uint) {\n    uint tokenId = counter;\n\n    _safeMint(msg.sender, tokenId);\n    _setTokenURI(tokenId, tokenURI);\n\n    counter ++;\n    return tokenId;\n  }\n\n\n  function burn(uint256 tokenId) public virtual {\n    require(_isApprovedOrOwner(msg.sender, tokenId), \"You can not burn it, because you are not the owner!\");\n    super._burn(tokenId);\n  }\n\n\n}\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>我们讲一下这个代码 </p>\n<p><code>createNFTs</code> 创建一个NFT 我们调用的时候需要传入一个参数 这个参数是一个地址代表你这个<code>NFT</code>的一些属性 这个地址是一串<code>json</code>字符串</p>\n<p><a href=\"https://ipfs.io/ipfs/QmZJEQLGYSMoVMmzVrkujsPiydZiWbHHGFZQLvf8J79s8h\">https://ipfs.io/ipfs/QmZJEQLGYSMoVMmzVrkujsPiydZiWbHHGFZQLvf8J79s8h</a></p>\n<p><code>json</code> 字符串内容如下:</p>\n<pre class=\"line-numbers language-json\"><code class=\"language-json\">\n<span class=\"token punctuation\">{</span>\n<span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"NFT Art\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"This image shows the true nature of NFT.\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"image\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://ipfs.io/ipfs/QmQLzfy3Zs9S6nV4HG9to9wntbdaoJgC41wgEQMJwm6gBK\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>tokenId 我们使用<code>counter ++</code> 自增 初始值为0</p>\n<p>有一个<code>burn</code>的方法 当你调用完<code>createNFTs</code>创建了一个NFT但是你并不满意时 可以调用这个方法来烧毁这个<code>NFT</code>。</p>\n<h4 id=\"6、合约部署\"><a href=\"#6、合约部署\" class=\"headerlink\" title=\"6、合约部署\"></a>6、合约部署</h4><p>编译一下我们的合约</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730180438.png\"></p>\n<p>如果没有问题 就可以部署了</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730180645.png\"></p>\n<p>我这里是部署到 Rinkeby 测试网络 部署完成之后 我们就调用一下 合约的方法 <code>createNFTs</code></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730180909.png\"></p>\n<p>填入上面那个 <code>json</code> 的链接 正常付gas费就行了 </p>\n<p>之后我们在<code>https://rinkeby.etherscan.io/</code>测试网络上查看 我们的账户就可以看到那个nft合约了 不过我们看不到图片</p>\n<p>如果想看到图片的话 需要借助<code>openSea</code> 它也是支持了<code>Rinkby</code>测试网络的</p>\n<p><a href=\"https://testnets.opensea.io/account\">Open Sea Rinkby 测试网络</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730181750.png\"></p>\n<h4 id=\"7、将这个NFT转给他人\"><a href=\"#7、将这个NFT转给他人\" class=\"headerlink\" title=\"7、将这个NFT转给他人\"></a>7、将这个NFT转给他人</h4><p>我们只需要调用 这个方法就行了 这个方法是 ERC-721 提供的方法</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730182229.png\"></p>\n<p>tokenId 在rinkeby测试网可以查看 我这里是 0</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730182401.png\"></p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"如何在以太坊测试网络上发布一个NFT艺术品并转给他人\"><a href=\"#如何在以太坊测试网络上发布一个NFT艺术品并转给他人\" class=\"headerlink\" title=\"如何在以太坊测试网络上发布一个NFT艺术品并转给他人\"></a>如何在以太坊测试网络上发布一个NFT艺术品并转给他人</h3><h4 id=\"1、首先什么是NFT\"><a href=\"#1、首先什么是NFT\" class=\"headerlink\" title=\"1、首先什么是NFT\"></a>1、首先什么是NFT</h4><blockquote>\n<p>非同质化代币NFT是一种数字资产，具备不可分割和独一无二这两大特性，可用于代表有形和无形的物品。NFT应用场景多样，包括数字收藏品、音乐、艺术品以及游戏内代币。</p>\n</blockquote>\n<h4 id=\"2-、什么是ERC-721\"><a href=\"#2-、什么是ERC-721\" class=\"headerlink\" title=\"2 、什么是ERC-721\"></a>2 、什么是ERC-721</h4><p>ERC 代表 Ethereum Request for Comment，721 是提案标识符号。 ERC 是以太坊生态系统中的应用级标准，可以是 ERC-20 等代币的智能合约标准，ERC 的作者负责与以太坊社区建立共识，一旦提案得到以太坊社区的审查和批准社区它成为一个标准。您可以在此处跟踪最近的 ERC 提案。创建 ERC-721 是为了提出在智能合约中跟踪和传输 NFT 的功能。</p>\n<p>ERC-721 是一个开放标准，描述了如何在 EVM（以太坊虚拟机）兼容的区块链上构建不可替代的代币；它是不可替代代币的标准接口；它有一套规则，可以很容易地使用 NFT。 NFT 不仅是 ERC-721 类型；它们也可以是 ERC-1155 代币。</p>\n<h4 id=\"3、我们还需要知道一个东西-IPFS\"><a href=\"#3、我们还需要知道一个东西-IPFS\" class=\"headerlink\" title=\"3、我们还需要知道一个东西 IPFS\"></a>3、我们还需要知道一个东西 <code>IPFS</code></h4><blockquote>\n<p>星际文件系统（InterPlanetary File System，缩写为IPFS）是一个旨在创建持久且分布式存储和共享文件的网络传输协议。它是一种内容可寻址的对等超媒体分发协议。在IPFS网络中的节点将构成一个分布式文件系统。它是一个开放源代码项目，自2014年开始由协议实验室在开源社区的帮助下发展。其最初由Juan Benet设计。</p>\n</blockquote>\n<p>如果要发布一个NFT艺术品,我们需要定义这个艺术品的属性，通常我们用<code>json</code>文件来定义，我们还需要一个链接可以查看这个艺术品</p>\n<p>随便创建一个xxx.json</p>\n<pre><code class=\"json\">\n&#123;\n&quot;name&quot;: &quot;NFT Art&quot;,\n&quot;description&quot;: &quot;This image shows the true nature of NFT.&quot;,\n&quot;image&quot;: &quot;https://ipfs.io/ipfs/QmQLzfy3Zs9S6nV4HG9to9wntbdaoJgC41wgEQMJwm6gBK&quot;,\n&#125;\n</code></pre>\n<ul>\n<li><p>name 艺术品的名称</p>\n</li>\n<li><p>description 艺术品的描述</p>\n</li>\n<li><p>image 图片的链接</p>\n</li>\n</ul>\n<p>这里我们就定义了一个简单的json文件来表示这个艺术品<br><code>IPFS</code> 是一个去中心化的平台 我们将json文件 图片上传到这个平台 可以拿到这样的链接</p>\n<p><strong>下面我们来说一下如何使用<code>IPFS</code></strong></p>\n<p><a href=\"https://ipfs.io/\">IPFS官网地址</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730175202.png\"></p>\n<p>我这里选择的是 桌面应用程序 可视化界面 好操作一些 </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730175424.png\"></p>\n<p>打开之后 选择导入 我们选择创建的xxx.json 和 一张图片也好 gif也行</p>\n<p>然后我们点击三个点 选择 分享链接 复制一下链接就行了</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730175647.png\"></p>\n<p>当然 你也可以不选择<code>IPFS</code> 只要提供的链接能访问到就行。用IPFS的原因是去中心化 如果是你自己提供的链接那就可能不是去中心化了</p>\n<p>这里我给出我的两个链接</p>\n<pre><code class=\"solidity\">\njson字符串 \nhttps://ipfs.io/ipfs/QmZJEQLGYSMoVMmzVrkujsPiydZiWbHHGFZQLvf8J79s8h?filename=apple.json\n\n图片链接\nhttps://ipfs.io/ipfs/QmQLzfy3Zs9S6nV4HG9to9wntbdaoJgC41wgEQMJwm6gBK?filename=spin.gif\n</code></pre>\n<p>后面的<code>?filename=apple.json</code>可以删掉也能访问到</p>\n<h4 id=\"4、编写智能合约\"><a href=\"#4、编写智能合约\" class=\"headerlink\" title=\"4、编写智能合约\"></a>4、编写智能合约</h4><p>编写NFT合约代码的话 我们可以选择一些非常成熟的库在他们的基础上进行编写自己的NFT代码 比较好的库就是<code>OpenZeppelin</code></p>\n<p><a href=\"https://github.com/OpenZeppelin/openzeppelin-contracts/tree/master/contracts/token/ERC721/extensions\">github地址</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730172037.png\"></p>\n<p>他这里是提供了很多个不同功能的NFT代码给我们， 我们只需要选择红色框那个来继承就行了，这个是比较简单的， 没有别的复杂功能。</p>\n<h4 id=\"5、开始编写代码\"><a href=\"#5、开始编写代码\" class=\"headerlink\" title=\"5、开始编写代码\"></a>5、开始编写代码</h4><p>这里我们选择在线的<code>Remix</code>来编写我们的合约代码 </p>\n<p><a href=\"http://remix.app.hubwiz.com/#optimize=false&runs=200&evmVersion=null&version=soljson-v0.7.4+commit.3f05b770.js\">Remix中文版地址</a></p>\n<pre><code class=\"solidity\">\n// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\nimport &quot;https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC721/extensions/ERC721URIStorage.sol&quot;;\n\ncontract MobilePhoneNft is ERC721URIStorage&#123;\n\n  uint public counter;\n\n  constructor() ERC721(&quot;MobilePhoneNft&quot;, &quot;MPN&quot;)&#123;\n    counter = 0;\n  &#125;\n\n  function createNFTs (string memory tokenURI) public returns(uint) &#123;\n    uint tokenId = counter;\n\n    _safeMint(msg.sender, tokenId);\n    _setTokenURI(tokenId, tokenURI);\n\n    counter ++;\n    return tokenId;\n  &#125;\n\n\n  function burn(uint256 tokenId) public virtual &#123;\n    require(_isApprovedOrOwner(msg.sender, tokenId), &quot;You can not burn it, because you are not the owner!&quot;);\n    super._burn(tokenId);\n  &#125;\n\n\n&#125;\n</code></pre>\n<p>我们讲一下这个代码 </p>\n<p><code>createNFTs</code> 创建一个NFT 我们调用的时候需要传入一个参数 这个参数是一个地址代表你这个<code>NFT</code>的一些属性 这个地址是一串<code>json</code>字符串</p>\n<p><a href=\"https://ipfs.io/ipfs/QmZJEQLGYSMoVMmzVrkujsPiydZiWbHHGFZQLvf8J79s8h\">https://ipfs.io/ipfs/QmZJEQLGYSMoVMmzVrkujsPiydZiWbHHGFZQLvf8J79s8h</a></p>\n<p><code>json</code> 字符串内容如下:</p>\n<pre><code class=\"json\">\n&#123;\n&quot;name&quot;: &quot;NFT Art&quot;,\n&quot;description&quot;: &quot;This image shows the true nature of NFT.&quot;,\n&quot;image&quot;: &quot;https://ipfs.io/ipfs/QmQLzfy3Zs9S6nV4HG9to9wntbdaoJgC41wgEQMJwm6gBK&quot;,\n&#125;\n</code></pre>\n<p>tokenId 我们使用<code>counter ++</code> 自增 初始值为0</p>\n<p>有一个<code>burn</code>的方法 当你调用完<code>createNFTs</code>创建了一个NFT但是你并不满意时 可以调用这个方法来烧毁这个<code>NFT</code>。</p>\n<h4 id=\"6、合约部署\"><a href=\"#6、合约部署\" class=\"headerlink\" title=\"6、合约部署\"></a>6、合约部署</h4><p>编译一下我们的合约</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730180438.png\"></p>\n<p>如果没有问题 就可以部署了</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730180645.png\"></p>\n<p>我这里是部署到 Rinkeby 测试网络 部署完成之后 我们就调用一下 合约的方法 <code>createNFTs</code></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730180909.png\"></p>\n<p>填入上面那个 <code>json</code> 的链接 正常付gas费就行了 </p>\n<p>之后我们在<code>https://rinkeby.etherscan.io/</code>测试网络上查看 我们的账户就可以看到那个nft合约了 不过我们看不到图片</p>\n<p>如果想看到图片的话 需要借助<code>openSea</code> 它也是支持了<code>Rinkby</code>测试网络的</p>\n<p><a href=\"https://testnets.opensea.io/account\">Open Sea Rinkby 测试网络</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730181750.png\"></p>\n<h4 id=\"7、将这个NFT转给他人\"><a href=\"#7、将这个NFT转给他人\" class=\"headerlink\" title=\"7、将这个NFT转给他人\"></a>7、将这个NFT转给他人</h4><p>我们只需要调用 这个方法就行了 这个方法是 ERC-721 提供的方法</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730182229.png\"></p>\n<p>tokenId 在rinkeby测试网可以查看 我这里是 0</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210730182401.png\"></p>\n"},{"title":"Hello World","date":"2020-10-16T06:23:47.000Z","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\ndate: 2020-10-16 14:23:47\ncategories:\n- web前端\ntags:\n- jQuery\n- 表格\n- 表单验证\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","slug":"hello-world","published":1,"updated":"2020-10-16T10:56:12.252Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwj001h3ys27gtlbaos","content":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ hexo new <span class=\"token string\">\"My New Post\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ hexo server<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ hexo generate<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ hexo deploy<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><pre><code class=\"bash\">$ hexo new &quot;My New Post&quot;</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><pre><code class=\"bash\">$ hexo server</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><pre><code class=\"bash\">$ hexo generate</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><pre><code class=\"bash\">$ hexo deploy</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n"},{"title":"hexo+github搭建一个博客","date":"2020-10-16T10:57:25.000Z","_content":"\n### 使用Hexo + Github 搭建一个博客网站 [Mac环境]\n#### 1、创建Github仓库\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018163610.png)\n* 注意Repository name 中一定要输入：你的用户名.github.io其他地方不用修改，然后直接点 ”Create repository“ 按钮完成创建即可\n#### 2、安装博客需要的框架\n\n```\n安装 Homebrew\n$ ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"\n\n查询Homebrew是否安装成功的命令\n$ brew -v\n\n安装 git\n$ brew install git\n\n查询git是否安装成功的命令\n$ git --version\n\n安装 node.js\n$ brew install node\n\n查询node是否安装成功的命令\n$ node -v\n\n安装 hexo\n$ npm install -g hexo\n\n查询hexo是否安装成功的命令\n$ hexo -v\n```\n\n#### 3、安装博客相关的插件\n\n```\n自动部署到Github上的插件  \n$ npm install hexo-deployer-git --save\n\n安装博客首页生成插件  \n$ npm install hexo-generator-index --save\n\n安装tag生成插件  \n$ npm install hexo-generator-tag --save\n\n* 到此为止，安装完毕\n```\n\n#### 4、创建博客、调试、发布\n\n* 创建本地一个目录，用来创建博客  \n    `$ hexo init Blog`   \n执行成功后会在本地创建一个Blog的文件夹\n* cd 到Blog中\n    `$ hexo new firstBlog`  \n在Blog/source/_posts中就会新建一个firstBlog.md的文件，然后你就可以编辑你的博客内容了，Visual Studio Code编辑器支持预览，还可以和印象笔记同步\n\n* 本地调试  \n    `$ sudo hexo server 或 $ sudo hexo s`  \n然后可以访问http://localhost:4000来查看结果  \n* 安装发布插件  \n在博客文件夹运行下面命令  \n`$ npm install hexo-deployer-git --save`  \n然后在Blog文件夹下的_config.yml文件修改发布的配置，最后一行改为（注意替换yourusername）  \n\n```\n# Site\n title: \"李文洋\"            \n subtitle: 'Android开发、Ruby程序员、目前正在学习Rust'\n description: '单身可撩、帅气的程序员小哥哥'\n keywords:                  \nauthor: 李文洋\nlanguage: zh-CN            \ntimezone: ''\ndeploy:\n  type: git  #使用Git 发布\n  repo: https://github.com/Naruto-1996/Naruto-1996.github.io.git  #自己的Github仓库地址\n  branch: master\n```\n* 运行生成发布\n  \n```\n$ sudo hexo g\n$ sudo hexo d\n```\n\n如果改动了站点的源码，需要在发布之前  \n\n`$ sudo hexo clean`  \n    \n如果成功了就可以通过yourusername.github.io来访问你的博客了\n\n#### 5、新建分类页面\n\ncategories 页是用来展示所有分类的页面，如果在你的博客 source 目录下还没有 categories/index.md 文件，那么你就需要新建一个，命令如下：\n```\nhexo new page \"categories\"\n```\n\n编辑你刚刚新建的页面文件 /source/categories/index.md，至少需要以下内容：\n```\n---\ntitle: categories\ndate: 2018-09-30 17:25:30\ntype: \"categories\"\nlayout: \"categories\"\n---\n```\n#### 6、新建标签页面 tags\n\ntags 页是用来展示所有标签的页面，如果在你的博客 source 目录下还没有 tags/index.md 文件，那么你就需要新建一个，命令如下：\n```\nhexo new page \"tags\"\n```\n\n编辑你刚刚新建的页面文件 /source/tags/index.md，至少需要以下内容：\n```\n---\ntitle: tags\ndate: 2018-09-30 17:25:30\ntype: \"tags\"\nlayout: \"tags\"\n---\n```\n\n#### 7、新建关于我 about 页面\n\nabout 页是用来展示关于我和我的博客信息的，如果在你的博客 source 目录下还没有 about/index.md 文件，那么你就需要新建一个，命令如下：\n```\nhexo new page \"about\"\n```\n\n编辑你刚刚新建的页面文件 /source/about/index.md，至少需要以下内容：\n```\n---\ntitle: about\ndate: 2018-09-30 17:25:30\ntype: \"about\"\nlayout: \"about\"\n---\n```\n\n#### 8、新建留言板 contact 页（可选的）\n\ncontact 页是用来展示留言板信息的，如果在你的博客 source 目录下还没有 contact/index.md 文件，那么你就需要新建一个，命令如下：\n```\nhexo new page \"contact\"\n```\n\n编辑你刚刚新建的页面文件 /source/contact/index.md，至少需要以下内容：\n```\n---\ntitle: contact\ndate: 2018-09-30 17:25:30\ntype: \"contact\"\nlayout: \"contact\"\n---\n```\n\n* 注：本留言板功能依赖于第三方评论系统，请激活你的评论系统才有效果。并且在主题的 _config.yml 文件中，第 19至 21 行的“菜单”配置，取消关于留言板的注释即可。\n\n#### 9、新建友情链接页面 friends\n\nfriends 页是用来展示好友的，如果在你的博客 source 目录下还没有 friends/index.md 文件，那么你就需要新建一个，命令如下：\n```\nhexo new page \"friends\"\n```\n\n编辑你刚刚新建的页面文件 /source/friends/index.md，至少需要以下内容：\n```\n---\ntitle: friends\ndate: 2018-09-30 17:25:30\ntype: \"friends\"\nlayout: \"friends\"\n---\n```\n\n同时，在你的博客 source 目录下新建 _data 目录，在 _data 目录中新建 friends.json 文件，文件内容如下所示：\n\n```\n[{\n    \"avatar\": \"http://image.luokangyuan.com/1_qq_27922023.jpg\",\n    \"name\": \"码酱\",\n    \"introduction\": \"我不是大佬，只是在追寻大佬的脚步\",\n    \"url\": \"http://luokangyuan.com/\",\n    \"title\": \"前去学习\"\n}, {\n    \"avatar\": \"http://image.luokangyuan.com/4027734.jpeg\",\n    \"name\": \"闪烁之狐\",\n    \"introduction\": \"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬\",\n    \"url\": \"https://blinkfox.github.io/\",\n    \"title\": \"前去学习\"\n}, {\n    \"avatar\": \"http://image.luokangyuan.com/avatar.jpg\",\n    \"name\": \"ja_rome\",\n    \"introduction\": \"平凡的脚步也可以走出伟大的行程\",\n    \"url\": \"https://me.csdn.net/jlh912008548\",\n    \"title\": \"前去学习\"\n}]\n```\n\n#### 10、接下来就是如何写博客了\n`sudo hexo new \"第一个博客\" `\n\n就会在Blog文件夹中的 source/_posts 文件夹下创建出一个 第一个博客.md 文件\n```\n---\ntitle: 第一个博客\ndate: 2020-10-16 18:57:25\ncategories:\n- Mac\ntags:\n- hexo\n- github\n---\n```\n* 注意这里的 categories 和 tag 标签 就是对文章的分类和标签 写了这些就会在前端展示出来\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018172533.png)\n\n然后就可以运行一下命令来生成和发布文章到github上了  \n```\nsudo hexo g\nsudo hexo d\n```\n#### 11、关于主题的配置我这里就不在说了可以自行Google一下 hexo主题配置  \n留个传送门供我自己使用   \n[主题传送门](https://hexo.io/themes/)\n\n\n","source":"_posts/hexo-github搭建一个博客.md","raw":"---\ntitle: hexo+github搭建一个博客\ndate: 2020-10-16 18:57:25\ncategories:\n- Mac\ntags:\n- hexo\n- github\n---\n\n### 使用Hexo + Github 搭建一个博客网站 [Mac环境]\n#### 1、创建Github仓库\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018163610.png)\n* 注意Repository name 中一定要输入：你的用户名.github.io其他地方不用修改，然后直接点 ”Create repository“ 按钮完成创建即可\n#### 2、安装博客需要的框架\n\n```\n安装 Homebrew\n$ ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"\n\n查询Homebrew是否安装成功的命令\n$ brew -v\n\n安装 git\n$ brew install git\n\n查询git是否安装成功的命令\n$ git --version\n\n安装 node.js\n$ brew install node\n\n查询node是否安装成功的命令\n$ node -v\n\n安装 hexo\n$ npm install -g hexo\n\n查询hexo是否安装成功的命令\n$ hexo -v\n```\n\n#### 3、安装博客相关的插件\n\n```\n自动部署到Github上的插件  \n$ npm install hexo-deployer-git --save\n\n安装博客首页生成插件  \n$ npm install hexo-generator-index --save\n\n安装tag生成插件  \n$ npm install hexo-generator-tag --save\n\n* 到此为止，安装完毕\n```\n\n#### 4、创建博客、调试、发布\n\n* 创建本地一个目录，用来创建博客  \n    `$ hexo init Blog`   \n执行成功后会在本地创建一个Blog的文件夹\n* cd 到Blog中\n    `$ hexo new firstBlog`  \n在Blog/source/_posts中就会新建一个firstBlog.md的文件，然后你就可以编辑你的博客内容了，Visual Studio Code编辑器支持预览，还可以和印象笔记同步\n\n* 本地调试  \n    `$ sudo hexo server 或 $ sudo hexo s`  \n然后可以访问http://localhost:4000来查看结果  \n* 安装发布插件  \n在博客文件夹运行下面命令  \n`$ npm install hexo-deployer-git --save`  \n然后在Blog文件夹下的_config.yml文件修改发布的配置，最后一行改为（注意替换yourusername）  \n\n```\n# Site\n title: \"李文洋\"            \n subtitle: 'Android开发、Ruby程序员、目前正在学习Rust'\n description: '单身可撩、帅气的程序员小哥哥'\n keywords:                  \nauthor: 李文洋\nlanguage: zh-CN            \ntimezone: ''\ndeploy:\n  type: git  #使用Git 发布\n  repo: https://github.com/Naruto-1996/Naruto-1996.github.io.git  #自己的Github仓库地址\n  branch: master\n```\n* 运行生成发布\n  \n```\n$ sudo hexo g\n$ sudo hexo d\n```\n\n如果改动了站点的源码，需要在发布之前  \n\n`$ sudo hexo clean`  \n    \n如果成功了就可以通过yourusername.github.io来访问你的博客了\n\n#### 5、新建分类页面\n\ncategories 页是用来展示所有分类的页面，如果在你的博客 source 目录下还没有 categories/index.md 文件，那么你就需要新建一个，命令如下：\n```\nhexo new page \"categories\"\n```\n\n编辑你刚刚新建的页面文件 /source/categories/index.md，至少需要以下内容：\n```\n---\ntitle: categories\ndate: 2018-09-30 17:25:30\ntype: \"categories\"\nlayout: \"categories\"\n---\n```\n#### 6、新建标签页面 tags\n\ntags 页是用来展示所有标签的页面，如果在你的博客 source 目录下还没有 tags/index.md 文件，那么你就需要新建一个，命令如下：\n```\nhexo new page \"tags\"\n```\n\n编辑你刚刚新建的页面文件 /source/tags/index.md，至少需要以下内容：\n```\n---\ntitle: tags\ndate: 2018-09-30 17:25:30\ntype: \"tags\"\nlayout: \"tags\"\n---\n```\n\n#### 7、新建关于我 about 页面\n\nabout 页是用来展示关于我和我的博客信息的，如果在你的博客 source 目录下还没有 about/index.md 文件，那么你就需要新建一个，命令如下：\n```\nhexo new page \"about\"\n```\n\n编辑你刚刚新建的页面文件 /source/about/index.md，至少需要以下内容：\n```\n---\ntitle: about\ndate: 2018-09-30 17:25:30\ntype: \"about\"\nlayout: \"about\"\n---\n```\n\n#### 8、新建留言板 contact 页（可选的）\n\ncontact 页是用来展示留言板信息的，如果在你的博客 source 目录下还没有 contact/index.md 文件，那么你就需要新建一个，命令如下：\n```\nhexo new page \"contact\"\n```\n\n编辑你刚刚新建的页面文件 /source/contact/index.md，至少需要以下内容：\n```\n---\ntitle: contact\ndate: 2018-09-30 17:25:30\ntype: \"contact\"\nlayout: \"contact\"\n---\n```\n\n* 注：本留言板功能依赖于第三方评论系统，请激活你的评论系统才有效果。并且在主题的 _config.yml 文件中，第 19至 21 行的“菜单”配置，取消关于留言板的注释即可。\n\n#### 9、新建友情链接页面 friends\n\nfriends 页是用来展示好友的，如果在你的博客 source 目录下还没有 friends/index.md 文件，那么你就需要新建一个，命令如下：\n```\nhexo new page \"friends\"\n```\n\n编辑你刚刚新建的页面文件 /source/friends/index.md，至少需要以下内容：\n```\n---\ntitle: friends\ndate: 2018-09-30 17:25:30\ntype: \"friends\"\nlayout: \"friends\"\n---\n```\n\n同时，在你的博客 source 目录下新建 _data 目录，在 _data 目录中新建 friends.json 文件，文件内容如下所示：\n\n```\n[{\n    \"avatar\": \"http://image.luokangyuan.com/1_qq_27922023.jpg\",\n    \"name\": \"码酱\",\n    \"introduction\": \"我不是大佬，只是在追寻大佬的脚步\",\n    \"url\": \"http://luokangyuan.com/\",\n    \"title\": \"前去学习\"\n}, {\n    \"avatar\": \"http://image.luokangyuan.com/4027734.jpeg\",\n    \"name\": \"闪烁之狐\",\n    \"introduction\": \"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬\",\n    \"url\": \"https://blinkfox.github.io/\",\n    \"title\": \"前去学习\"\n}, {\n    \"avatar\": \"http://image.luokangyuan.com/avatar.jpg\",\n    \"name\": \"ja_rome\",\n    \"introduction\": \"平凡的脚步也可以走出伟大的行程\",\n    \"url\": \"https://me.csdn.net/jlh912008548\",\n    \"title\": \"前去学习\"\n}]\n```\n\n#### 10、接下来就是如何写博客了\n`sudo hexo new \"第一个博客\" `\n\n就会在Blog文件夹中的 source/_posts 文件夹下创建出一个 第一个博客.md 文件\n```\n---\ntitle: 第一个博客\ndate: 2020-10-16 18:57:25\ncategories:\n- Mac\ntags:\n- hexo\n- github\n---\n```\n* 注意这里的 categories 和 tag 标签 就是对文章的分类和标签 写了这些就会在前端展示出来\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018172533.png)\n\n然后就可以运行一下命令来生成和发布文章到github上了  \n```\nsudo hexo g\nsudo hexo d\n```\n#### 11、关于主题的配置我这里就不在说了可以自行Google一下 hexo主题配置  \n留个传送门供我自己使用   \n[主题传送门](https://hexo.io/themes/)\n\n\n","slug":"hexo-github搭建一个博客","published":1,"updated":"2020-10-18T09:58:26.292Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwk001l3ys22zazgtm1","content":"<h3 id=\"使用Hexo-Github-搭建一个博客网站-Mac环境\"><a href=\"#使用Hexo-Github-搭建一个博客网站-Mac环境\" class=\"headerlink\" title=\"使用Hexo + Github 搭建一个博客网站 [Mac环境]\"></a>使用Hexo + Github 搭建一个博客网站 [Mac环境]</h3><h4 id=\"1、创建Github仓库\"><a href=\"#1、创建Github仓库\" class=\"headerlink\" title=\"1、创建Github仓库\"></a>1、创建Github仓库</h4><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018163610.png\"></p>\n<ul>\n<li>注意Repository name 中一定要输入：你的用户名.github.io其他地方不用修改，然后直接点 ”Create repository“ 按钮完成创建即可<h4 id=\"2、安装博客需要的框架\"><a href=\"#2、安装博客需要的框架\" class=\"headerlink\" title=\"2、安装博客需要的框架\"></a>2、安装博客需要的框架</h4></li>\n</ul>\n<pre><code>安装 Homebrew\n$ ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"\n\n查询Homebrew是否安装成功的命令\n$ brew -v\n\n安装 git\n$ brew install git\n\n查询git是否安装成功的命令\n$ git --version\n\n安装 node.js\n$ brew install node\n\n查询node是否安装成功的命令\n$ node -v\n\n安装 hexo\n$ npm install -g hexo\n\n查询hexo是否安装成功的命令\n$ hexo -v</code></pre>\n<h4 id=\"3、安装博客相关的插件\"><a href=\"#3、安装博客相关的插件\" class=\"headerlink\" title=\"3、安装博客相关的插件\"></a>3、安装博客相关的插件</h4><pre><code>自动部署到Github上的插件  \n$ npm install hexo-deployer-git --save\n\n安装博客首页生成插件  \n$ npm install hexo-generator-index --save\n\n安装tag生成插件  \n$ npm install hexo-generator-tag --save\n\n* 到此为止，安装完毕</code></pre>\n<h4 id=\"4、创建博客、调试、发布\"><a href=\"#4、创建博客、调试、发布\" class=\"headerlink\" title=\"4、创建博客、调试、发布\"></a>4、创建博客、调试、发布</h4><ul>\n<li><p>创建本地一个目录，用来创建博客<br>  <code>$ hexo init Blog</code><br>执行成功后会在本地创建一个Blog的文件夹</p>\n</li>\n<li><p>cd 到Blog中<br>  <code>$ hexo new firstBlog</code><br>在Blog/source/_posts中就会新建一个firstBlog.md的文件，然后你就可以编辑你的博客内容了，Visual Studio Code编辑器支持预览，还可以和印象笔记同步</p>\n</li>\n<li><p>本地调试<br>  <code>$ sudo hexo server 或 $ sudo hexo s</code><br>然后可以访问<a href=\"http://localhost:4000来查看结果\">http://localhost:4000来查看结果</a>  </p>\n</li>\n<li><p>安装发布插件<br>在博客文件夹运行下面命令<br><code>$ npm install hexo-deployer-git --save</code><br>然后在Blog文件夹下的_config.yml文件修改发布的配置，最后一行改为（注意替换yourusername）  </p>\n</li>\n</ul>\n<pre><code># Site\n title: \"李文洋\"            \n subtitle: 'Android开发、Ruby程序员、目前正在学习Rust'\n description: '单身可撩、帅气的程序员小哥哥'\n keywords:                  \nauthor: 李文洋\nlanguage: zh-CN            \ntimezone: ''\ndeploy:\n  type: git  #使用Git 发布\n  repo: https://github.com/Naruto-1996/Naruto-1996.github.io.git  #自己的Github仓库地址\n  branch: master</code></pre>\n<ul>\n<li>运行生成发布</li>\n</ul>\n<pre><code>$ sudo hexo g\n$ sudo hexo d</code></pre>\n<p>如果改动了站点的源码，需要在发布之前  </p>\n<p><code>$ sudo hexo clean</code>  </p>\n<p>如果成功了就可以通过yourusername.github.io来访问你的博客了</p>\n<h4 id=\"5、新建分类页面\"><a href=\"#5、新建分类页面\" class=\"headerlink\" title=\"5、新建分类页面\"></a>5、新建分类页面</h4><p>categories 页是用来展示所有分类的页面，如果在你的博客 source 目录下还没有 categories/index.md 文件，那么你就需要新建一个，命令如下：</p>\n<pre><code>hexo new page \"categories\"</code></pre>\n<p>编辑你刚刚新建的页面文件 /source/categories/index.md，至少需要以下内容：</p>\n<pre><code>---\ntitle: categories\ndate: 2018-09-30 17:25:30\ntype: \"categories\"\nlayout: \"categories\"\n---</code></pre>\n<h4 id=\"6、新建标签页面-tags\"><a href=\"#6、新建标签页面-tags\" class=\"headerlink\" title=\"6、新建标签页面 tags\"></a>6、新建标签页面 tags</h4><p>tags 页是用来展示所有标签的页面，如果在你的博客 source 目录下还没有 tags/index.md 文件，那么你就需要新建一个，命令如下：</p>\n<pre><code>hexo new page \"tags\"</code></pre>\n<p>编辑你刚刚新建的页面文件 /source/tags/index.md，至少需要以下内容：</p>\n<pre><code>---\ntitle: tags\ndate: 2018-09-30 17:25:30\ntype: \"tags\"\nlayout: \"tags\"\n---</code></pre>\n<h4 id=\"7、新建关于我-about-页面\"><a href=\"#7、新建关于我-about-页面\" class=\"headerlink\" title=\"7、新建关于我 about 页面\"></a>7、新建关于我 about 页面</h4><p>about 页是用来展示关于我和我的博客信息的，如果在你的博客 source 目录下还没有 about/index.md 文件，那么你就需要新建一个，命令如下：</p>\n<pre><code>hexo new page \"about\"</code></pre>\n<p>编辑你刚刚新建的页面文件 /source/about/index.md，至少需要以下内容：</p>\n<pre><code>---\ntitle: about\ndate: 2018-09-30 17:25:30\ntype: \"about\"\nlayout: \"about\"\n---</code></pre>\n<h4 id=\"8、新建留言板-contact-页（可选的）\"><a href=\"#8、新建留言板-contact-页（可选的）\" class=\"headerlink\" title=\"8、新建留言板 contact 页（可选的）\"></a>8、新建留言板 contact 页（可选的）</h4><p>contact 页是用来展示留言板信息的，如果在你的博客 source 目录下还没有 contact/index.md 文件，那么你就需要新建一个，命令如下：</p>\n<pre><code>hexo new page \"contact\"</code></pre>\n<p>编辑你刚刚新建的页面文件 /source/contact/index.md，至少需要以下内容：</p>\n<pre><code>---\ntitle: contact\ndate: 2018-09-30 17:25:30\ntype: \"contact\"\nlayout: \"contact\"\n---</code></pre>\n<ul>\n<li>注：本留言板功能依赖于第三方评论系统，请激活你的评论系统才有效果。并且在主题的 _config.yml 文件中，第 19至 21 行的“菜单”配置，取消关于留言板的注释即可。</li>\n</ul>\n<h4 id=\"9、新建友情链接页面-friends\"><a href=\"#9、新建友情链接页面-friends\" class=\"headerlink\" title=\"9、新建友情链接页面 friends\"></a>9、新建友情链接页面 friends</h4><p>friends 页是用来展示好友的，如果在你的博客 source 目录下还没有 friends/index.md 文件，那么你就需要新建一个，命令如下：</p>\n<pre><code>hexo new page \"friends\"</code></pre>\n<p>编辑你刚刚新建的页面文件 /source/friends/index.md，至少需要以下内容：</p>\n<pre><code>---\ntitle: friends\ndate: 2018-09-30 17:25:30\ntype: \"friends\"\nlayout: \"friends\"\n---</code></pre>\n<p>同时，在你的博客 source 目录下新建 _data 目录，在 _data 目录中新建 friends.json 文件，文件内容如下所示：</p>\n<pre><code>[{\n    \"avatar\": \"http://image.luokangyuan.com/1_qq_27922023.jpg\",\n    \"name\": \"码酱\",\n    \"introduction\": \"我不是大佬，只是在追寻大佬的脚步\",\n    \"url\": \"http://luokangyuan.com/\",\n    \"title\": \"前去学习\"\n}, {\n    \"avatar\": \"http://image.luokangyuan.com/4027734.jpeg\",\n    \"name\": \"闪烁之狐\",\n    \"introduction\": \"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬\",\n    \"url\": \"https://blinkfox.github.io/\",\n    \"title\": \"前去学习\"\n}, {\n    \"avatar\": \"http://image.luokangyuan.com/avatar.jpg\",\n    \"name\": \"ja_rome\",\n    \"introduction\": \"平凡的脚步也可以走出伟大的行程\",\n    \"url\": \"https://me.csdn.net/jlh912008548\",\n    \"title\": \"前去学习\"\n}]</code></pre>\n<h4 id=\"10、接下来就是如何写博客了\"><a href=\"#10、接下来就是如何写博客了\" class=\"headerlink\" title=\"10、接下来就是如何写博客了\"></a>10、接下来就是如何写博客了</h4><p><code>sudo hexo new \"第一个博客\" </code></p>\n<p>就会在Blog文件夹中的 source/_posts 文件夹下创建出一个 第一个博客.md 文件</p>\n<pre><code>---\ntitle: 第一个博客\ndate: 2020-10-16 18:57:25\ncategories:\n- Mac\ntags:\n- hexo\n- github\n---</code></pre>\n<ul>\n<li>注意这里的 categories 和 tag 标签 就是对文章的分类和标签 写了这些就会在前端展示出来<br><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018172533.png\"></li>\n</ul>\n<p>然后就可以运行一下命令来生成和发布文章到github上了  </p>\n<pre><code>sudo hexo g\nsudo hexo d</code></pre>\n<h4 id=\"11、关于主题的配置我这里就不在说了可以自行Google一下-hexo主题配置\"><a href=\"#11、关于主题的配置我这里就不在说了可以自行Google一下-hexo主题配置\" class=\"headerlink\" title=\"11、关于主题的配置我这里就不在说了可以自行Google一下 hexo主题配置\"></a>11、关于主题的配置我这里就不在说了可以自行Google一下 hexo主题配置</h4><p>留个传送门供我自己使用<br><a href=\"https://hexo.io/themes/\">主题传送门</a></p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"使用Hexo-Github-搭建一个博客网站-Mac环境\"><a href=\"#使用Hexo-Github-搭建一个博客网站-Mac环境\" class=\"headerlink\" title=\"使用Hexo + Github 搭建一个博客网站 [Mac环境]\"></a>使用Hexo + Github 搭建一个博客网站 [Mac环境]</h3><h4 id=\"1、创建Github仓库\"><a href=\"#1、创建Github仓库\" class=\"headerlink\" title=\"1、创建Github仓库\"></a>1、创建Github仓库</h4><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018163610.png\"></p>\n<ul>\n<li>注意Repository name 中一定要输入：你的用户名.github.io其他地方不用修改，然后直接点 ”Create repository“ 按钮完成创建即可<h4 id=\"2、安装博客需要的框架\"><a href=\"#2、安装博客需要的框架\" class=\"headerlink\" title=\"2、安装博客需要的框架\"></a>2、安装博客需要的框架</h4></li>\n</ul>\n<pre><code>安装 Homebrew\n$ ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;\n\n查询Homebrew是否安装成功的命令\n$ brew -v\n\n安装 git\n$ brew install git\n\n查询git是否安装成功的命令\n$ git --version\n\n安装 node.js\n$ brew install node\n\n查询node是否安装成功的命令\n$ node -v\n\n安装 hexo\n$ npm install -g hexo\n\n查询hexo是否安装成功的命令\n$ hexo -v</code></pre>\n<h4 id=\"3、安装博客相关的插件\"><a href=\"#3、安装博客相关的插件\" class=\"headerlink\" title=\"3、安装博客相关的插件\"></a>3、安装博客相关的插件</h4><pre><code>自动部署到Github上的插件  \n$ npm install hexo-deployer-git --save\n\n安装博客首页生成插件  \n$ npm install hexo-generator-index --save\n\n安装tag生成插件  \n$ npm install hexo-generator-tag --save\n\n* 到此为止，安装完毕</code></pre>\n<h4 id=\"4、创建博客、调试、发布\"><a href=\"#4、创建博客、调试、发布\" class=\"headerlink\" title=\"4、创建博客、调试、发布\"></a>4、创建博客、调试、发布</h4><ul>\n<li><p>创建本地一个目录，用来创建博客<br>  <code>$ hexo init Blog</code><br>执行成功后会在本地创建一个Blog的文件夹</p>\n</li>\n<li><p>cd 到Blog中<br>  <code>$ hexo new firstBlog</code><br>在Blog/source/_posts中就会新建一个firstBlog.md的文件，然后你就可以编辑你的博客内容了，Visual Studio Code编辑器支持预览，还可以和印象笔记同步</p>\n</li>\n<li><p>本地调试<br>  <code>$ sudo hexo server 或 $ sudo hexo s</code><br>然后可以访问<a href=\"http://localhost:4000来查看结果\">http://localhost:4000来查看结果</a>  </p>\n</li>\n<li><p>安装发布插件<br>在博客文件夹运行下面命令<br><code>$ npm install hexo-deployer-git --save</code><br>然后在Blog文件夹下的_config.yml文件修改发布的配置，最后一行改为（注意替换yourusername）  </p>\n</li>\n</ul>\n<pre><code># Site\n title: &quot;李文洋&quot;            \n subtitle: &#39;Android开发、Ruby程序员、目前正在学习Rust&#39;\n description: &#39;单身可撩、帅气的程序员小哥哥&#39;\n keywords:                  \nauthor: 李文洋\nlanguage: zh-CN            \ntimezone: &#39;&#39;\ndeploy:\n  type: git  #使用Git 发布\n  repo: https://github.com/Naruto-1996/Naruto-1996.github.io.git  #自己的Github仓库地址\n  branch: master</code></pre>\n<ul>\n<li>运行生成发布</li>\n</ul>\n<pre><code>$ sudo hexo g\n$ sudo hexo d</code></pre>\n<p>如果改动了站点的源码，需要在发布之前  </p>\n<p><code>$ sudo hexo clean</code>  </p>\n<p>如果成功了就可以通过yourusername.github.io来访问你的博客了</p>\n<h4 id=\"5、新建分类页面\"><a href=\"#5、新建分类页面\" class=\"headerlink\" title=\"5、新建分类页面\"></a>5、新建分类页面</h4><p>categories 页是用来展示所有分类的页面，如果在你的博客 source 目录下还没有 categories/index.md 文件，那么你就需要新建一个，命令如下：</p>\n<pre><code>hexo new page &quot;categories&quot;</code></pre>\n<p>编辑你刚刚新建的页面文件 /source/categories/index.md，至少需要以下内容：</p>\n<pre><code>---\ntitle: categories\ndate: 2018-09-30 17:25:30\ntype: &quot;categories&quot;\nlayout: &quot;categories&quot;\n---</code></pre>\n<h4 id=\"6、新建标签页面-tags\"><a href=\"#6、新建标签页面-tags\" class=\"headerlink\" title=\"6、新建标签页面 tags\"></a>6、新建标签页面 tags</h4><p>tags 页是用来展示所有标签的页面，如果在你的博客 source 目录下还没有 tags/index.md 文件，那么你就需要新建一个，命令如下：</p>\n<pre><code>hexo new page &quot;tags&quot;</code></pre>\n<p>编辑你刚刚新建的页面文件 /source/tags/index.md，至少需要以下内容：</p>\n<pre><code>---\ntitle: tags\ndate: 2018-09-30 17:25:30\ntype: &quot;tags&quot;\nlayout: &quot;tags&quot;\n---</code></pre>\n<h4 id=\"7、新建关于我-about-页面\"><a href=\"#7、新建关于我-about-页面\" class=\"headerlink\" title=\"7、新建关于我 about 页面\"></a>7、新建关于我 about 页面</h4><p>about 页是用来展示关于我和我的博客信息的，如果在你的博客 source 目录下还没有 about/index.md 文件，那么你就需要新建一个，命令如下：</p>\n<pre><code>hexo new page &quot;about&quot;</code></pre>\n<p>编辑你刚刚新建的页面文件 /source/about/index.md，至少需要以下内容：</p>\n<pre><code>---\ntitle: about\ndate: 2018-09-30 17:25:30\ntype: &quot;about&quot;\nlayout: &quot;about&quot;\n---</code></pre>\n<h4 id=\"8、新建留言板-contact-页（可选的）\"><a href=\"#8、新建留言板-contact-页（可选的）\" class=\"headerlink\" title=\"8、新建留言板 contact 页（可选的）\"></a>8、新建留言板 contact 页（可选的）</h4><p>contact 页是用来展示留言板信息的，如果在你的博客 source 目录下还没有 contact/index.md 文件，那么你就需要新建一个，命令如下：</p>\n<pre><code>hexo new page &quot;contact&quot;</code></pre>\n<p>编辑你刚刚新建的页面文件 /source/contact/index.md，至少需要以下内容：</p>\n<pre><code>---\ntitle: contact\ndate: 2018-09-30 17:25:30\ntype: &quot;contact&quot;\nlayout: &quot;contact&quot;\n---</code></pre>\n<ul>\n<li>注：本留言板功能依赖于第三方评论系统，请激活你的评论系统才有效果。并且在主题的 _config.yml 文件中，第 19至 21 行的“菜单”配置，取消关于留言板的注释即可。</li>\n</ul>\n<h4 id=\"9、新建友情链接页面-friends\"><a href=\"#9、新建友情链接页面-friends\" class=\"headerlink\" title=\"9、新建友情链接页面 friends\"></a>9、新建友情链接页面 friends</h4><p>friends 页是用来展示好友的，如果在你的博客 source 目录下还没有 friends/index.md 文件，那么你就需要新建一个，命令如下：</p>\n<pre><code>hexo new page &quot;friends&quot;</code></pre>\n<p>编辑你刚刚新建的页面文件 /source/friends/index.md，至少需要以下内容：</p>\n<pre><code>---\ntitle: friends\ndate: 2018-09-30 17:25:30\ntype: &quot;friends&quot;\nlayout: &quot;friends&quot;\n---</code></pre>\n<p>同时，在你的博客 source 目录下新建 _data 目录，在 _data 目录中新建 friends.json 文件，文件内容如下所示：</p>\n<pre><code>[&#123;\n    &quot;avatar&quot;: &quot;http://image.luokangyuan.com/1_qq_27922023.jpg&quot;,\n    &quot;name&quot;: &quot;码酱&quot;,\n    &quot;introduction&quot;: &quot;我不是大佬，只是在追寻大佬的脚步&quot;,\n    &quot;url&quot;: &quot;http://luokangyuan.com/&quot;,\n    &quot;title&quot;: &quot;前去学习&quot;\n&#125;, &#123;\n    &quot;avatar&quot;: &quot;http://image.luokangyuan.com/4027734.jpeg&quot;,\n    &quot;name&quot;: &quot;闪烁之狐&quot;,\n    &quot;introduction&quot;: &quot;编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬&quot;,\n    &quot;url&quot;: &quot;https://blinkfox.github.io/&quot;,\n    &quot;title&quot;: &quot;前去学习&quot;\n&#125;, &#123;\n    &quot;avatar&quot;: &quot;http://image.luokangyuan.com/avatar.jpg&quot;,\n    &quot;name&quot;: &quot;ja_rome&quot;,\n    &quot;introduction&quot;: &quot;平凡的脚步也可以走出伟大的行程&quot;,\n    &quot;url&quot;: &quot;https://me.csdn.net/jlh912008548&quot;,\n    &quot;title&quot;: &quot;前去学习&quot;\n&#125;]</code></pre>\n<h4 id=\"10、接下来就是如何写博客了\"><a href=\"#10、接下来就是如何写博客了\" class=\"headerlink\" title=\"10、接下来就是如何写博客了\"></a>10、接下来就是如何写博客了</h4><p><code>sudo hexo new &quot;第一个博客&quot; </code></p>\n<p>就会在Blog文件夹中的 source/_posts 文件夹下创建出一个 第一个博客.md 文件</p>\n<pre><code>---\ntitle: 第一个博客\ndate: 2020-10-16 18:57:25\ncategories:\n- Mac\ntags:\n- hexo\n- github\n---</code></pre>\n<ul>\n<li>注意这里的 categories 和 tag 标签 就是对文章的分类和标签 写了这些就会在前端展示出来<br><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018172533.png\"></li>\n</ul>\n<p>然后就可以运行一下命令来生成和发布文章到github上了  </p>\n<pre><code>sudo hexo g\nsudo hexo d</code></pre>\n<h4 id=\"11、关于主题的配置我这里就不在说了可以自行Google一下-hexo主题配置\"><a href=\"#11、关于主题的配置我这里就不在说了可以自行Google一下-hexo主题配置\" class=\"headerlink\" title=\"11、关于主题的配置我这里就不在说了可以自行Google一下 hexo主题配置\"></a>11、关于主题的配置我这里就不在说了可以自行Google一下 hexo主题配置</h4><p>留个传送门供我自己使用<br><a href=\"https://hexo.io/themes/\">主题传送门</a></p>\n"},{"title":"linux(ubuntu) - 使用fail2ban 为nginx保驾护航","date":"2020-12-09T07:40:46.000Z","_content":"\n#### Linux(ubuntu) - 使用fail2ban 为nginx保驾护航\n\n#### 1、安装\n\nFail2ban软件包包含在默认的Ubuntu 20.04存储库中。 要安装它，请以root或具有sudo特权的用户身份输入以下命令：\n\n```\nsudo apt update\nsudo apt install fail2ban\n```\n\n安装完成后，Fail2ban服务将自动启动。 您可以通过检查服务状态来验证它：\n\n```\nsudo systemctl status fail2ban\n```\n\n输出将如下所示：\n\n```\n fail2ban.service - Fail2Ban Service\n     Loaded: loaded (/lib/systemd/system/fail2ban.service; enabled; vendor preset: enabled)\n     Active: active (running) since Wed 2020-08-19 06:16:29 UTC; 27s ago\n       Docs: man:fail2ban(1)\n   Main PID: 1251 (f2b/server)\n      Tasks: 5 (limit: 1079)\n     Memory: 13.8M\n     CGroup: /system.slice/fail2ban.service\n             └─1251 /usr/bin/python3 /usr/bin/fail2ban-server -xf start\n```\n\n#### 2、Fail2ban配置\n\n默认的`Fail2ban`安装带有两个配置文件， `/etc/fail2ban/jail.conf` 和 `/etc/fail2ban/jail.d/defaults-debian.conf`。 不建议修改这些文件，因为更新软件包时它们可能会被覆盖。\n\n最好的做法是：\n\n```\nsudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local \n或者新建\nsudo vim /etc/fail2ban/jail.local \n```\n\n然后修改 jail.local的内容\n\n```\n[nginx-req-limit]\n\nenabled = true\nfilter = nginx-req-limit\naction = iptables-multiport[name=ReqLimit, port=\"http,https\", protocol=tcp]\nlogpath = /var/log/nginx/access.log\nfindtime = 60\nmaxretry = 600\nbantime = 600\n```\n\n新增文件：`/etc/fail2ban/filter.d/nginx-req-limit.conf`\n\n```\n# Fail2Ban configuration file\n#\n# supports: ngx_http_limit_req_module module\n\n[Definition]\n\nfailregex =  -.*- .*HTTP/1.* .* .*$\n\n# Option: ignoreregex\n# Notes.: regex to ignore. If this regex matches, the line is ignored.\n# Values: TEXT\n#\nignoreregex =\n```\n#### 将IP地址列入白名单\n\n您可以将要排除在外的IP地址，IP范围或主机添加到 `ignoreip` 指示。 在这里，您应该添加您的本地PC IP地址和所有其他要列入白名单的计算机。\n\n`/etc/fail2ban/jail.local`\n\n```\nignoreip = 127.0.0.1/8 ::1 123.123.123.123 192.168.1.0/24\n```\n\n* 每次编辑配置文件时，都需要重新启动Fail2ban服务以使更改生效：\n\n```\nsudo systemctl restart fail2ban\n```\n\n#### Fail2ban客户端 命令\n\n* 检查监狱状态：\n\n`sudo fail2ban-client status sshd`\n\n* 解禁IP：\n\n`sudo fail2ban-client set sshd unbanip 23.34.45.56`\n\n* 禁止IP\n\n`sudo fail2ban-client set sshd banip 23.34.45.56`\n\n","source":"_posts/linux-ubuntu-使用fail2ban-为nginx保驾护航.md","raw":"---\ntitle: linux(ubuntu) - 使用fail2ban 为nginx保驾护航\ndate: 2020-12-09 15:40:46\ncategories:\n- Fail2ban\ntags:\n- Linux\n- ubuntu\n---\n\n#### Linux(ubuntu) - 使用fail2ban 为nginx保驾护航\n\n#### 1、安装\n\nFail2ban软件包包含在默认的Ubuntu 20.04存储库中。 要安装它，请以root或具有sudo特权的用户身份输入以下命令：\n\n```\nsudo apt update\nsudo apt install fail2ban\n```\n\n安装完成后，Fail2ban服务将自动启动。 您可以通过检查服务状态来验证它：\n\n```\nsudo systemctl status fail2ban\n```\n\n输出将如下所示：\n\n```\n fail2ban.service - Fail2Ban Service\n     Loaded: loaded (/lib/systemd/system/fail2ban.service; enabled; vendor preset: enabled)\n     Active: active (running) since Wed 2020-08-19 06:16:29 UTC; 27s ago\n       Docs: man:fail2ban(1)\n   Main PID: 1251 (f2b/server)\n      Tasks: 5 (limit: 1079)\n     Memory: 13.8M\n     CGroup: /system.slice/fail2ban.service\n             └─1251 /usr/bin/python3 /usr/bin/fail2ban-server -xf start\n```\n\n#### 2、Fail2ban配置\n\n默认的`Fail2ban`安装带有两个配置文件， `/etc/fail2ban/jail.conf` 和 `/etc/fail2ban/jail.d/defaults-debian.conf`。 不建议修改这些文件，因为更新软件包时它们可能会被覆盖。\n\n最好的做法是：\n\n```\nsudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local \n或者新建\nsudo vim /etc/fail2ban/jail.local \n```\n\n然后修改 jail.local的内容\n\n```\n[nginx-req-limit]\n\nenabled = true\nfilter = nginx-req-limit\naction = iptables-multiport[name=ReqLimit, port=\"http,https\", protocol=tcp]\nlogpath = /var/log/nginx/access.log\nfindtime = 60\nmaxretry = 600\nbantime = 600\n```\n\n新增文件：`/etc/fail2ban/filter.d/nginx-req-limit.conf`\n\n```\n# Fail2Ban configuration file\n#\n# supports: ngx_http_limit_req_module module\n\n[Definition]\n\nfailregex =  -.*- .*HTTP/1.* .* .*$\n\n# Option: ignoreregex\n# Notes.: regex to ignore. If this regex matches, the line is ignored.\n# Values: TEXT\n#\nignoreregex =\n```\n#### 将IP地址列入白名单\n\n您可以将要排除在外的IP地址，IP范围或主机添加到 `ignoreip` 指示。 在这里，您应该添加您的本地PC IP地址和所有其他要列入白名单的计算机。\n\n`/etc/fail2ban/jail.local`\n\n```\nignoreip = 127.0.0.1/8 ::1 123.123.123.123 192.168.1.0/24\n```\n\n* 每次编辑配置文件时，都需要重新启动Fail2ban服务以使更改生效：\n\n```\nsudo systemctl restart fail2ban\n```\n\n#### Fail2ban客户端 命令\n\n* 检查监狱状态：\n\n`sudo fail2ban-client status sshd`\n\n* 解禁IP：\n\n`sudo fail2ban-client set sshd unbanip 23.34.45.56`\n\n* 禁止IP\n\n`sudo fail2ban-client set sshd banip 23.34.45.56`\n\n","slug":"linux-ubuntu-使用fail2ban-为nginx保驾护航","published":1,"updated":"2020-12-09T09:47:03.565Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwk001n3ys26y9d0xlo","content":"<h4 id=\"Linux-ubuntu-使用fail2ban-为nginx保驾护航\"><a href=\"#Linux-ubuntu-使用fail2ban-为nginx保驾护航\" class=\"headerlink\" title=\"Linux(ubuntu) - 使用fail2ban 为nginx保驾护航\"></a>Linux(ubuntu) - 使用fail2ban 为nginx保驾护航</h4><h4 id=\"1、安装\"><a href=\"#1、安装\" class=\"headerlink\" title=\"1、安装\"></a>1、安装</h4><p>Fail2ban软件包包含在默认的Ubuntu 20.04存储库中。 要安装它，请以root或具有sudo特权的用户身份输入以下命令：</p>\n<pre><code>sudo apt update\nsudo apt install fail2ban</code></pre>\n<p>安装完成后，Fail2ban服务将自动启动。 您可以通过检查服务状态来验证它：</p>\n<pre><code>sudo systemctl status fail2ban</code></pre>\n<p>输出将如下所示：</p>\n<pre><code> fail2ban.service - Fail2Ban Service\n     Loaded: loaded (/lib/systemd/system/fail2ban.service; enabled; vendor preset: enabled)\n     Active: active (running) since Wed 2020-08-19 06:16:29 UTC; 27s ago\n       Docs: man:fail2ban(1)\n   Main PID: 1251 (f2b/server)\n      Tasks: 5 (limit: 1079)\n     Memory: 13.8M\n     CGroup: /system.slice/fail2ban.service\n             └─1251 /usr/bin/python3 /usr/bin/fail2ban-server -xf start</code></pre>\n<h4 id=\"2、Fail2ban配置\"><a href=\"#2、Fail2ban配置\" class=\"headerlink\" title=\"2、Fail2ban配置\"></a>2、Fail2ban配置</h4><p>默认的<code>Fail2ban</code>安装带有两个配置文件， <code>/etc/fail2ban/jail.conf</code> 和 <code>/etc/fail2ban/jail.d/defaults-debian.conf</code>。 不建议修改这些文件，因为更新软件包时它们可能会被覆盖。</p>\n<p>最好的做法是：</p>\n<pre><code>sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local \n或者新建\nsudo vim /etc/fail2ban/jail.local </code></pre>\n<p>然后修改 jail.local的内容</p>\n<pre><code>[nginx-req-limit]\n\nenabled = true\nfilter = nginx-req-limit\naction = iptables-multiport[name=ReqLimit, port=\"http,https\", protocol=tcp]\nlogpath = /var/log/nginx/access.log\nfindtime = 60\nmaxretry = 600\nbantime = 600</code></pre>\n<p>新增文件：<code>/etc/fail2ban/filter.d/nginx-req-limit.conf</code></p>\n<pre><code># Fail2Ban configuration file\n#\n# supports: ngx_http_limit_req_module module\n\n[Definition]\n\nfailregex =  -.*- .*HTTP/1.* .* .*$\n\n# Option: ignoreregex\n# Notes.: regex to ignore. If this regex matches, the line is ignored.\n# Values: TEXT\n#\nignoreregex =</code></pre>\n<h4 id=\"将IP地址列入白名单\"><a href=\"#将IP地址列入白名单\" class=\"headerlink\" title=\"将IP地址列入白名单\"></a>将IP地址列入白名单</h4><p>您可以将要排除在外的IP地址，IP范围或主机添加到 <code>ignoreip</code> 指示。 在这里，您应该添加您的本地PC IP地址和所有其他要列入白名单的计算机。</p>\n<p><code>/etc/fail2ban/jail.local</code></p>\n<pre><code>ignoreip = 127.0.0.1/8 ::1 123.123.123.123 192.168.1.0/24</code></pre>\n<ul>\n<li>每次编辑配置文件时，都需要重新启动Fail2ban服务以使更改生效：</li>\n</ul>\n<pre><code>sudo systemctl restart fail2ban</code></pre>\n<h4 id=\"Fail2ban客户端-命令\"><a href=\"#Fail2ban客户端-命令\" class=\"headerlink\" title=\"Fail2ban客户端 命令\"></a>Fail2ban客户端 命令</h4><ul>\n<li>检查监狱状态：</li>\n</ul>\n<p><code>sudo fail2ban-client status sshd</code></p>\n<ul>\n<li>解禁IP：</li>\n</ul>\n<p><code>sudo fail2ban-client set sshd unbanip 23.34.45.56</code></p>\n<ul>\n<li>禁止IP</li>\n</ul>\n<p><code>sudo fail2ban-client set sshd banip 23.34.45.56</code></p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"Linux-ubuntu-使用fail2ban-为nginx保驾护航\"><a href=\"#Linux-ubuntu-使用fail2ban-为nginx保驾护航\" class=\"headerlink\" title=\"Linux(ubuntu) - 使用fail2ban 为nginx保驾护航\"></a>Linux(ubuntu) - 使用fail2ban 为nginx保驾护航</h4><h4 id=\"1、安装\"><a href=\"#1、安装\" class=\"headerlink\" title=\"1、安装\"></a>1、安装</h4><p>Fail2ban软件包包含在默认的Ubuntu 20.04存储库中。 要安装它，请以root或具有sudo特权的用户身份输入以下命令：</p>\n<pre><code>sudo apt update\nsudo apt install fail2ban</code></pre>\n<p>安装完成后，Fail2ban服务将自动启动。 您可以通过检查服务状态来验证它：</p>\n<pre><code>sudo systemctl status fail2ban</code></pre>\n<p>输出将如下所示：</p>\n<pre><code> fail2ban.service - Fail2Ban Service\n     Loaded: loaded (/lib/systemd/system/fail2ban.service; enabled; vendor preset: enabled)\n     Active: active (running) since Wed 2020-08-19 06:16:29 UTC; 27s ago\n       Docs: man:fail2ban(1)\n   Main PID: 1251 (f2b/server)\n      Tasks: 5 (limit: 1079)\n     Memory: 13.8M\n     CGroup: /system.slice/fail2ban.service\n             └─1251 /usr/bin/python3 /usr/bin/fail2ban-server -xf start</code></pre>\n<h4 id=\"2、Fail2ban配置\"><a href=\"#2、Fail2ban配置\" class=\"headerlink\" title=\"2、Fail2ban配置\"></a>2、Fail2ban配置</h4><p>默认的<code>Fail2ban</code>安装带有两个配置文件， <code>/etc/fail2ban/jail.conf</code> 和 <code>/etc/fail2ban/jail.d/defaults-debian.conf</code>。 不建议修改这些文件，因为更新软件包时它们可能会被覆盖。</p>\n<p>最好的做法是：</p>\n<pre><code>sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local \n或者新建\nsudo vim /etc/fail2ban/jail.local </code></pre>\n<p>然后修改 jail.local的内容</p>\n<pre><code>[nginx-req-limit]\n\nenabled = true\nfilter = nginx-req-limit\naction = iptables-multiport[name=ReqLimit, port=&quot;http,https&quot;, protocol=tcp]\nlogpath = /var/log/nginx/access.log\nfindtime = 60\nmaxretry = 600\nbantime = 600</code></pre>\n<p>新增文件：<code>/etc/fail2ban/filter.d/nginx-req-limit.conf</code></p>\n<pre><code># Fail2Ban configuration file\n#\n# supports: ngx_http_limit_req_module module\n\n[Definition]\n\nfailregex =  -.*- .*HTTP/1.* .* .*$\n\n# Option: ignoreregex\n# Notes.: regex to ignore. If this regex matches, the line is ignored.\n# Values: TEXT\n#\nignoreregex =</code></pre>\n<h4 id=\"将IP地址列入白名单\"><a href=\"#将IP地址列入白名单\" class=\"headerlink\" title=\"将IP地址列入白名单\"></a>将IP地址列入白名单</h4><p>您可以将要排除在外的IP地址，IP范围或主机添加到 <code>ignoreip</code> 指示。 在这里，您应该添加您的本地PC IP地址和所有其他要列入白名单的计算机。</p>\n<p><code>/etc/fail2ban/jail.local</code></p>\n<pre><code>ignoreip = 127.0.0.1/8 ::1 123.123.123.123 192.168.1.0/24</code></pre>\n<ul>\n<li>每次编辑配置文件时，都需要重新启动Fail2ban服务以使更改生效：</li>\n</ul>\n<pre><code>sudo systemctl restart fail2ban</code></pre>\n<h4 id=\"Fail2ban客户端-命令\"><a href=\"#Fail2ban客户端-命令\" class=\"headerlink\" title=\"Fail2ban客户端 命令\"></a>Fail2ban客户端 命令</h4><ul>\n<li>检查监狱状态：</li>\n</ul>\n<p><code>sudo fail2ban-client status sshd</code></p>\n<ul>\n<li>解禁IP：</li>\n</ul>\n<p><code>sudo fail2ban-client set sshd unbanip 23.34.45.56</code></p>\n<ul>\n<li>禁止IP</li>\n</ul>\n<p><code>sudo fail2ban-client set sshd banip 23.34.45.56</code></p>\n"},{"title":"picture_bed","date":"2020-10-18T07:36:35.000Z","_content":"### Mac环境--如何做一个自用的图床 \n#### 1、下载PicGo\nPicGo[下载地址](https://github.com/Molunerfinn/picgo/releases)\n#### 2、创建一个Github仓库并进行设置\n##### （1）创建仓库\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018155437.png)\n##### (2) 点击头像 点击Settings\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160141.png)\n##### (3) 再点 Developer settings\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160243.png)\n##### (4) 再点 Personal access tokens\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160353.png)\n##### (5) 填写内容\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160722.png)\n##### (6) 复制生成的token (注意：网页关闭后就再也看不到这个token了) \n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018161000.png)\n#### 3、在刚才创建的仓库中新增一个项目\n    git init\n    git add .\n    git commit -m \"备注\"\n    git remote add origin 仓库地址\n    git push -u origin master\n下面是我的项目：\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018162357.png)\n#### 4、配置刚才下载的PicGo\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018161711.png)\n\n设置自定义域名：  \n    https://cdn.jsdelivr.net/gh/Naruto-1996/picture  \n    https://cdn.jsdelivr.net/gh/用户名/仓库名\n    \n配置完就可以在PicGo中上传图片了。","source":"_posts/picture-bed.md","raw":"---\ntitle: picture_bed\ndate: 2020-10-18 15:36:35\ncategories:\n- 图床\ntags:\n- github\n- jsDelivr\n- PicGo\n---\n### Mac环境--如何做一个自用的图床 \n#### 1、下载PicGo\nPicGo[下载地址](https://github.com/Molunerfinn/picgo/releases)\n#### 2、创建一个Github仓库并进行设置\n##### （1）创建仓库\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018155437.png)\n##### (2) 点击头像 点击Settings\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160141.png)\n##### (3) 再点 Developer settings\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160243.png)\n##### (4) 再点 Personal access tokens\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160353.png)\n##### (5) 填写内容\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160722.png)\n##### (6) 复制生成的token (注意：网页关闭后就再也看不到这个token了) \n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018161000.png)\n#### 3、在刚才创建的仓库中新增一个项目\n    git init\n    git add .\n    git commit -m \"备注\"\n    git remote add origin 仓库地址\n    git push -u origin master\n下面是我的项目：\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018162357.png)\n#### 4、配置刚才下载的PicGo\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018161711.png)\n\n设置自定义域名：  \n    https://cdn.jsdelivr.net/gh/Naruto-1996/picture  \n    https://cdn.jsdelivr.net/gh/用户名/仓库名\n    \n配置完就可以在PicGo中上传图片了。","slug":"picture-bed","published":1,"updated":"2020-10-18T08:25:21.317Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwl001r3ys24w7heu76","content":"<h3 id=\"Mac环境–如何做一个自用的图床\"><a href=\"#Mac环境–如何做一个自用的图床\" class=\"headerlink\" title=\"Mac环境–如何做一个自用的图床\"></a>Mac环境–如何做一个自用的图床</h3><h4 id=\"1、下载PicGo\"><a href=\"#1、下载PicGo\" class=\"headerlink\" title=\"1、下载PicGo\"></a>1、下载PicGo</h4><p>PicGo<a href=\"https://github.com/Molunerfinn/picgo/releases\">下载地址</a></p>\n<h4 id=\"2、创建一个Github仓库并进行设置\"><a href=\"#2、创建一个Github仓库并进行设置\" class=\"headerlink\" title=\"2、创建一个Github仓库并进行设置\"></a>2、创建一个Github仓库并进行设置</h4><h5 id=\"（1）创建仓库\"><a href=\"#（1）创建仓库\" class=\"headerlink\" title=\"（1）创建仓库\"></a>（1）创建仓库</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018155437.png\"></p>\n<h5 id=\"2-点击头像-点击Settings\"><a href=\"#2-点击头像-点击Settings\" class=\"headerlink\" title=\"(2) 点击头像 点击Settings\"></a>(2) 点击头像 点击Settings</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160141.png\"></p>\n<h5 id=\"3-再点-Developer-settings\"><a href=\"#3-再点-Developer-settings\" class=\"headerlink\" title=\"(3) 再点 Developer settings\"></a>(3) 再点 Developer settings</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160243.png\"></p>\n<h5 id=\"4-再点-Personal-access-tokens\"><a href=\"#4-再点-Personal-access-tokens\" class=\"headerlink\" title=\"(4) 再点 Personal access tokens\"></a>(4) 再点 Personal access tokens</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160353.png\"></p>\n<h5 id=\"5-填写内容\"><a href=\"#5-填写内容\" class=\"headerlink\" title=\"(5) 填写内容\"></a>(5) 填写内容</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160722.png\"></p>\n<h5 id=\"6-复制生成的token-注意：网页关闭后就再也看不到这个token了\"><a href=\"#6-复制生成的token-注意：网页关闭后就再也看不到这个token了\" class=\"headerlink\" title=\"(6) 复制生成的token (注意：网页关闭后就再也看不到这个token了)\"></a>(6) 复制生成的token (注意：网页关闭后就再也看不到这个token了)</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018161000.png\"></p>\n<h4 id=\"3、在刚才创建的仓库中新增一个项目\"><a href=\"#3、在刚才创建的仓库中新增一个项目\" class=\"headerlink\" title=\"3、在刚才创建的仓库中新增一个项目\"></a>3、在刚才创建的仓库中新增一个项目</h4><pre><code>git init\ngit add .\ngit commit -m \"备注\"\ngit remote add origin 仓库地址\ngit push -u origin master</code></pre>\n<p>下面是我的项目：<br><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018162357.png\"></p>\n<h4 id=\"4、配置刚才下载的PicGo\"><a href=\"#4、配置刚才下载的PicGo\" class=\"headerlink\" title=\"4、配置刚才下载的PicGo\"></a>4、配置刚才下载的PicGo</h4><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018161711.png\"></p>\n<p>设置自定义域名：<br>    <a href=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture\">https://cdn.jsdelivr.net/gh/Naruto-1996/picture</a><br>    <a href=\"https://cdn.jsdelivr.net/gh/%E7%94%A8%E6%88%B7%E5%90%8D/%E4%BB%93%E5%BA%93%E5%90%8D\">https://cdn.jsdelivr.net/gh/用户名/仓库名</a></p>\n<p>配置完就可以在PicGo中上传图片了。</p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"Mac环境–如何做一个自用的图床\"><a href=\"#Mac环境–如何做一个自用的图床\" class=\"headerlink\" title=\"Mac环境–如何做一个自用的图床\"></a>Mac环境–如何做一个自用的图床</h3><h4 id=\"1、下载PicGo\"><a href=\"#1、下载PicGo\" class=\"headerlink\" title=\"1、下载PicGo\"></a>1、下载PicGo</h4><p>PicGo<a href=\"https://github.com/Molunerfinn/picgo/releases\">下载地址</a></p>\n<h4 id=\"2、创建一个Github仓库并进行设置\"><a href=\"#2、创建一个Github仓库并进行设置\" class=\"headerlink\" title=\"2、创建一个Github仓库并进行设置\"></a>2、创建一个Github仓库并进行设置</h4><h5 id=\"（1）创建仓库\"><a href=\"#（1）创建仓库\" class=\"headerlink\" title=\"（1）创建仓库\"></a>（1）创建仓库</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018155437.png\"></p>\n<h5 id=\"2-点击头像-点击Settings\"><a href=\"#2-点击头像-点击Settings\" class=\"headerlink\" title=\"(2) 点击头像 点击Settings\"></a>(2) 点击头像 点击Settings</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160141.png\"></p>\n<h5 id=\"3-再点-Developer-settings\"><a href=\"#3-再点-Developer-settings\" class=\"headerlink\" title=\"(3) 再点 Developer settings\"></a>(3) 再点 Developer settings</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160243.png\"></p>\n<h5 id=\"4-再点-Personal-access-tokens\"><a href=\"#4-再点-Personal-access-tokens\" class=\"headerlink\" title=\"(4) 再点 Personal access tokens\"></a>(4) 再点 Personal access tokens</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160353.png\"></p>\n<h5 id=\"5-填写内容\"><a href=\"#5-填写内容\" class=\"headerlink\" title=\"(5) 填写内容\"></a>(5) 填写内容</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018160722.png\"></p>\n<h5 id=\"6-复制生成的token-注意：网页关闭后就再也看不到这个token了\"><a href=\"#6-复制生成的token-注意：网页关闭后就再也看不到这个token了\" class=\"headerlink\" title=\"(6) 复制生成的token (注意：网页关闭后就再也看不到这个token了)\"></a>(6) 复制生成的token (注意：网页关闭后就再也看不到这个token了)</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018161000.png\"></p>\n<h4 id=\"3、在刚才创建的仓库中新增一个项目\"><a href=\"#3、在刚才创建的仓库中新增一个项目\" class=\"headerlink\" title=\"3、在刚才创建的仓库中新增一个项目\"></a>3、在刚才创建的仓库中新增一个项目</h4><pre><code>git init\ngit add .\ngit commit -m &quot;备注&quot;\ngit remote add origin 仓库地址\ngit push -u origin master</code></pre>\n<p>下面是我的项目：<br><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018162357.png\"></p>\n<h4 id=\"4、配置刚才下载的PicGo\"><a href=\"#4、配置刚才下载的PicGo\" class=\"headerlink\" title=\"4、配置刚才下载的PicGo\"></a>4、配置刚才下载的PicGo</h4><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201018161711.png\"></p>\n<p>设置自定义域名：<br>    <a href=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture\">https://cdn.jsdelivr.net/gh/Naruto-1996/picture</a><br>    <a href=\"https://cdn.jsdelivr.net/gh/%E7%94%A8%E6%88%B7%E5%90%8D/%E4%BB%93%E5%BA%93%E5%90%8D\">https://cdn.jsdelivr.net/gh/用户名/仓库名</a></p>\n<p>配置完就可以在PicGo中上传图片了。</p>\n"},{"title":"rails 连接多个数据库","date":"2020-12-01T09:08:53.000Z","_content":"\n#### Rails项目中如何连接多个数据库\n\n##### 1、修改config/database.yml文件\n\n```ruby\ndefault: &default\n  adapter: mysql2\n  encoding: utf8\n  collation: utf8_general_ci\n  pool: 5\n  host: localhost\n  username: root\n  password: 123456\n\n#原数据库\ndevelopment:\n  <<: *default\n  database: cadae\n\n#你想要连接的另一个数据库\ndevelopment_main_database:\n  <<: *default\n  database: cadae_copy\n\ntest:\n  <<: *default\n  database: cadae_test\n\nproduction:\n  <<: *default\n  url: 'mysql2://root:666666@localhost:3306/coiex?pool=10&timeout=3000'\n  pool: 10\n  database: cadae\n\n```\n\n##### 2、新建一个连接类继承 ActiveRecord::Base \n\n* 比如放在app/models/ 目录下 就叫做 database_connection.rb\n\n```ruby\nclass DatabaseConnection < ActiveRecord::Base\n  #共用连接池，减少数据库连接的消耗\n  self.abstract_class = true\n  # 这里根据rails运行环境不同自动获取运行环境 转换为symbol类型   \n  establish_connection(\"#{Rails.env}_main_database\".to_sym)\n  #或者使用\n  #establish_connection(:development_main_database)\nend\n\n```\n\n* 这里有个小坑 在创建database_connection.rb文件的时候 最好不要创建一个文件夹然后把它放进去 这样可能会找不到这个文件\n\n##### 3、在需要连接另一个数据库的model中继承咱们写的这个类就行了\n\n```ruby\nclass AccountVerificationResult < DatabaseConnection\n\nend\n```\n\n","source":"_posts/rails-连接多个数据库.md","raw":"---\ntitle: rails 连接多个数据库\ndate: 2020-12-01 17:08:53\ncategories:\n- rails\ntags:\n- mysql\n- rails\n---\n\n#### Rails项目中如何连接多个数据库\n\n##### 1、修改config/database.yml文件\n\n```ruby\ndefault: &default\n  adapter: mysql2\n  encoding: utf8\n  collation: utf8_general_ci\n  pool: 5\n  host: localhost\n  username: root\n  password: 123456\n\n#原数据库\ndevelopment:\n  <<: *default\n  database: cadae\n\n#你想要连接的另一个数据库\ndevelopment_main_database:\n  <<: *default\n  database: cadae_copy\n\ntest:\n  <<: *default\n  database: cadae_test\n\nproduction:\n  <<: *default\n  url: 'mysql2://root:666666@localhost:3306/coiex?pool=10&timeout=3000'\n  pool: 10\n  database: cadae\n\n```\n\n##### 2、新建一个连接类继承 ActiveRecord::Base \n\n* 比如放在app/models/ 目录下 就叫做 database_connection.rb\n\n```ruby\nclass DatabaseConnection < ActiveRecord::Base\n  #共用连接池，减少数据库连接的消耗\n  self.abstract_class = true\n  # 这里根据rails运行环境不同自动获取运行环境 转换为symbol类型   \n  establish_connection(\"#{Rails.env}_main_database\".to_sym)\n  #或者使用\n  #establish_connection(:development_main_database)\nend\n\n```\n\n* 这里有个小坑 在创建database_connection.rb文件的时候 最好不要创建一个文件夹然后把它放进去 这样可能会找不到这个文件\n\n##### 3、在需要连接另一个数据库的model中继承咱们写的这个类就行了\n\n```ruby\nclass AccountVerificationResult < DatabaseConnection\n\nend\n```\n\n","slug":"rails-连接多个数据库","published":1,"updated":"2020-12-01T09:25:43.729Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwm001t3ys26t87897o","content":"<h4 id=\"Rails项目中如何连接多个数据库\"><a href=\"#Rails项目中如何连接多个数据库\" class=\"headerlink\" title=\"Rails项目中如何连接多个数据库\"></a>Rails项目中如何连接多个数据库</h4><h5 id=\"1、修改config-database-yml文件\"><a href=\"#1、修改config-database-yml文件\" class=\"headerlink\" title=\"1、修改config/database.yml文件\"></a>1、修改config/database.yml文件</h5><pre class=\"line-numbers language-ruby\"><code class=\"language-ruby\">default<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span>default\n  adapter<span class=\"token punctuation\">:</span> mysql2\n  encoding<span class=\"token punctuation\">:</span> utf8\n  collation<span class=\"token punctuation\">:</span> utf8_general_ci\n  pool<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span>\n  host<span class=\"token punctuation\">:</span> localhost\n  username<span class=\"token punctuation\">:</span> root\n  password<span class=\"token punctuation\">:</span> <span class=\"token number\">123456</span>\n\n<span class=\"token comment\" spellcheck=\"true\">#原数据库</span>\ndevelopment<span class=\"token punctuation\">:</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">*</span>default\n  database<span class=\"token punctuation\">:</span> cadae\n\n<span class=\"token comment\" spellcheck=\"true\">#你想要连接的另一个数据库</span>\ndevelopment_main_database<span class=\"token punctuation\">:</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">*</span>default\n  database<span class=\"token punctuation\">:</span> cadae_copy\n\ntest<span class=\"token punctuation\">:</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">*</span>default\n  database<span class=\"token punctuation\">:</span> cadae_test\n\nproduction<span class=\"token punctuation\">:</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">*</span>default\n  url<span class=\"token punctuation\">:</span> <span class=\"token string\">'mysql2://root:666666@localhost:3306/coiex?pool=10&amp;timeout=3000'</span>\n  pool<span class=\"token punctuation\">:</span> <span class=\"token number\">10</span>\n  database<span class=\"token punctuation\">:</span> cadae\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h5 id=\"2、新建一个连接类继承-ActiveRecord-Base\"><a href=\"#2、新建一个连接类继承-ActiveRecord-Base\" class=\"headerlink\" title=\"2、新建一个连接类继承 ActiveRecord::Base\"></a>2、新建一个连接类继承 ActiveRecord::Base</h5><ul>\n<li>比如放在app/models/ 目录下 就叫做 database_connection.rb</li>\n</ul>\n<pre class=\"line-numbers language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">DatabaseConnection</span> <span class=\"token operator\">&lt;</span> <span class=\"token constant\">ActiveRecord</span><span class=\"token punctuation\">:</span><span class=\"token symbol\">:Base</span>\n  <span class=\"token comment\" spellcheck=\"true\">#共用连接池，减少数据库连接的消耗</span>\n  <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>abstract_class <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span>\n  <span class=\"token comment\" spellcheck=\"true\"># 这里根据rails运行环境不同自动获取运行环境 转换为symbol类型   </span>\n  <span class=\"token function\">establish_connection</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>Rails<span class=\"token punctuation\">.</span>env<span class=\"token delimiter tag\">}</span></span>_main_database\"</span><span class=\"token punctuation\">.</span>to_sym<span class=\"token punctuation\">)</span>\n  <span class=\"token comment\" spellcheck=\"true\">#或者使用</span>\n  <span class=\"token comment\" spellcheck=\"true\">#establish_connection(:development_main_database)</span>\n<span class=\"token keyword\">end</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<ul>\n<li>这里有个小坑 在创建database_connection.rb文件的时候 最好不要创建一个文件夹然后把它放进去 这样可能会找不到这个文件</li>\n</ul>\n<h5 id=\"3、在需要连接另一个数据库的model中继承咱们写的这个类就行了\"><a href=\"#3、在需要连接另一个数据库的model中继承咱们写的这个类就行了\" class=\"headerlink\" title=\"3、在需要连接另一个数据库的model中继承咱们写的这个类就行了\"></a>3、在需要连接另一个数据库的model中继承咱们写的这个类就行了</h5><pre class=\"line-numbers language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">AccountVerificationResult</span> <span class=\"token operator\">&lt;</span> <span class=\"token constant\">DatabaseConnection</span>\n\n<span class=\"token keyword\">end</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"Rails项目中如何连接多个数据库\"><a href=\"#Rails项目中如何连接多个数据库\" class=\"headerlink\" title=\"Rails项目中如何连接多个数据库\"></a>Rails项目中如何连接多个数据库</h4><h5 id=\"1、修改config-database-yml文件\"><a href=\"#1、修改config-database-yml文件\" class=\"headerlink\" title=\"1、修改config/database.yml文件\"></a>1、修改config/database.yml文件</h5><pre><code class=\"ruby\">default: &amp;default\n  adapter: mysql2\n  encoding: utf8\n  collation: utf8_general_ci\n  pool: 5\n  host: localhost\n  username: root\n  password: 123456\n\n#原数据库\ndevelopment:\n  &lt;&lt;: *default\n  database: cadae\n\n#你想要连接的另一个数据库\ndevelopment_main_database:\n  &lt;&lt;: *default\n  database: cadae_copy\n\ntest:\n  &lt;&lt;: *default\n  database: cadae_test\n\nproduction:\n  &lt;&lt;: *default\n  url: &#39;mysql2://root:666666@localhost:3306/coiex?pool=10&amp;timeout=3000&#39;\n  pool: 10\n  database: cadae\n</code></pre>\n<h5 id=\"2、新建一个连接类继承-ActiveRecord-Base\"><a href=\"#2、新建一个连接类继承-ActiveRecord-Base\" class=\"headerlink\" title=\"2、新建一个连接类继承 ActiveRecord::Base\"></a>2、新建一个连接类继承 ActiveRecord::Base</h5><ul>\n<li>比如放在app/models/ 目录下 就叫做 database_connection.rb</li>\n</ul>\n<pre><code class=\"ruby\">class DatabaseConnection &lt; ActiveRecord::Base\n  #共用连接池，减少数据库连接的消耗\n  self.abstract_class = true\n  # 这里根据rails运行环境不同自动获取运行环境 转换为symbol类型   \n  establish_connection(&quot;#&#123;Rails.env&#125;_main_database&quot;.to_sym)\n  #或者使用\n  #establish_connection(:development_main_database)\nend\n</code></pre>\n<ul>\n<li>这里有个小坑 在创建database_connection.rb文件的时候 最好不要创建一个文件夹然后把它放进去 这样可能会找不到这个文件</li>\n</ul>\n<h5 id=\"3、在需要连接另一个数据库的model中继承咱们写的这个类就行了\"><a href=\"#3、在需要连接另一个数据库的model中继承咱们写的这个类就行了\" class=\"headerlink\" title=\"3、在需要连接另一个数据库的model中继承咱们写的这个类就行了\"></a>3、在需要连接另一个数据库的model中继承咱们写的这个类就行了</h5><pre><code class=\"ruby\">class AccountVerificationResult &lt; DatabaseConnection\n\nend</code></pre>\n"},{"title":"recycleView去掉滑动边界阴影","date":"2021-04-27T01:10:31.000Z","_content":"\n#### RecycleView 去掉滑动边界的阴影\n\n```\n<android.support.v7.widget.RecyclerView\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    android:overScrollMode=\"never\" />\n```","source":"_posts/recycleView去掉滑动边界阴影.md","raw":"---\ntitle: recycleView去掉滑动边界阴影\ndate: 2021-04-27 09:10:31\ncategories:\n- Android\ntags:\n- RecycleView\n---\n\n#### RecycleView 去掉滑动边界的阴影\n\n```\n<android.support.v7.widget.RecyclerView\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    android:overScrollMode=\"never\" />\n```","slug":"recycleView去掉滑动边界阴影","published":1,"updated":"2021-10-15T01:50:15.333Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwn001y3ys2gx1i2caz","content":"<h4 id=\"RecycleView-去掉滑动边界的阴影\"><a href=\"#RecycleView-去掉滑动边界的阴影\" class=\"headerlink\" title=\"RecycleView 去掉滑动边界的阴影\"></a>RecycleView 去掉滑动边界的阴影</h4><pre><code>&lt;android.support.v7.widget.RecyclerView\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    android:overScrollMode=\"never\" /&gt;</code></pre>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"RecycleView-去掉滑动边界的阴影\"><a href=\"#RecycleView-去掉滑动边界的阴影\" class=\"headerlink\" title=\"RecycleView 去掉滑动边界的阴影\"></a>RecycleView 去掉滑动边界的阴影</h4><pre><code>&lt;android.support.v7.widget.RecyclerView\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;match_parent&quot;\n    android:overScrollMode=&quot;never&quot; /&gt;</code></pre>\n"},{"title":"redis使用心得","date":"2020-12-02T04:09:05.000Z","_content":"\n### Redis 使用\n\n#### 1、在本地使用\n\n进入到redis的src目录中\n\n```\n./redis-cli \n```\n\n* 一些常规操作\n\n```\nLPUSH 是把新的元素从右侧插入到数组中\nLPUSH fruits apple   # => [\"apple\"]   把元素从左边插入到数组中\n> LPUSH  fruits banana   # => [\"banana\", \"apple\"]  \n\nRPUSH 是把新的元素从右侧插入到数组中\n> LINDEX fruits 0     # => \"banana\"\n> LINDEX fruits 1    # =>  \"apple\"\n> LRANGE fruits 0 1  #=> ['banana', 'apple']   ， 注意只有lrange, 没有 rrange. \n```\n\n* 获取所有的key\n\n```\nkeys *   这个*号是匹配所有的key 可以拼接 比如 fruits*\n```\n\n```\n127.0.0.1:6379> keys *\n1) \"fruits\"\n```\n\n* 查看某个key下的值:\n\n```\nlrange fruits 0 -1\n```\n\n```\n127.0.0.1:6379> lrange fruits 0 -1\n1) \"def\"\n2) \"abc\"\n3) \"banana\"\n4) \"apple\"\n```\n\n* 截断 保留trim中参数部分\n\n```\nltrim fruits 0 2\n```\n\n```\n我们看到 这里只保留了0-2剩下的都删除了\n127.0.0.1:6379> lrange fruits 0 -1\n1) \"def\"\n2) \"abc\"\n3) \"banana\"\n```\n \n","source":"_posts/redis使用心得.md","raw":"---\ntitle: redis使用心得\ndate: 2020-12-02 12:09:05\ncategories:\n- Redis\ntags:\n- Redis\n- Mac\n---\n\n### Redis 使用\n\n#### 1、在本地使用\n\n进入到redis的src目录中\n\n```\n./redis-cli \n```\n\n* 一些常规操作\n\n```\nLPUSH 是把新的元素从右侧插入到数组中\nLPUSH fruits apple   # => [\"apple\"]   把元素从左边插入到数组中\n> LPUSH  fruits banana   # => [\"banana\", \"apple\"]  \n\nRPUSH 是把新的元素从右侧插入到数组中\n> LINDEX fruits 0     # => \"banana\"\n> LINDEX fruits 1    # =>  \"apple\"\n> LRANGE fruits 0 1  #=> ['banana', 'apple']   ， 注意只有lrange, 没有 rrange. \n```\n\n* 获取所有的key\n\n```\nkeys *   这个*号是匹配所有的key 可以拼接 比如 fruits*\n```\n\n```\n127.0.0.1:6379> keys *\n1) \"fruits\"\n```\n\n* 查看某个key下的值:\n\n```\nlrange fruits 0 -1\n```\n\n```\n127.0.0.1:6379> lrange fruits 0 -1\n1) \"def\"\n2) \"abc\"\n3) \"banana\"\n4) \"apple\"\n```\n\n* 截断 保留trim中参数部分\n\n```\nltrim fruits 0 2\n```\n\n```\n我们看到 这里只保留了0-2剩下的都删除了\n127.0.0.1:6379> lrange fruits 0 -1\n1) \"def\"\n2) \"abc\"\n3) \"banana\"\n```\n \n","slug":"redis使用心得","published":1,"updated":"2020-12-08T09:13:21.886Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwo001z3ys2526v0ck4","content":"<h3 id=\"Redis-使用\"><a href=\"#Redis-使用\" class=\"headerlink\" title=\"Redis 使用\"></a>Redis 使用</h3><h4 id=\"1、在本地使用\"><a href=\"#1、在本地使用\" class=\"headerlink\" title=\"1、在本地使用\"></a>1、在本地使用</h4><p>进入到redis的src目录中</p>\n<pre><code>./redis-cli </code></pre>\n<ul>\n<li>一些常规操作</li>\n</ul>\n<pre><code>LPUSH 是把新的元素从右侧插入到数组中\nLPUSH fruits apple   # =&gt; [\"apple\"]   把元素从左边插入到数组中\n&gt; LPUSH  fruits banana   # =&gt; [\"banana\", \"apple\"]  \n\nRPUSH 是把新的元素从右侧插入到数组中\n&gt; LINDEX fruits 0     # =&gt; \"banana\"\n&gt; LINDEX fruits 1    # =&gt;  \"apple\"\n&gt; LRANGE fruits 0 1  #=&gt; ['banana', 'apple']   ， 注意只有lrange, 没有 rrange. </code></pre>\n<ul>\n<li>获取所有的key</li>\n</ul>\n<pre><code>keys *   这个*号是匹配所有的key 可以拼接 比如 fruits*</code></pre>\n<pre><code>127.0.0.1:6379&gt; keys *\n1) \"fruits\"</code></pre>\n<ul>\n<li>查看某个key下的值:</li>\n</ul>\n<pre><code>lrange fruits 0 -1</code></pre>\n<pre><code>127.0.0.1:6379&gt; lrange fruits 0 -1\n1) \"def\"\n2) \"abc\"\n3) \"banana\"\n4) \"apple\"</code></pre>\n<ul>\n<li>截断 保留trim中参数部分</li>\n</ul>\n<pre><code>ltrim fruits 0 2</code></pre>\n<pre><code>我们看到 这里只保留了0-2剩下的都删除了\n127.0.0.1:6379&gt; lrange fruits 0 -1\n1) \"def\"\n2) \"abc\"\n3) \"banana\"</code></pre>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"Redis-使用\"><a href=\"#Redis-使用\" class=\"headerlink\" title=\"Redis 使用\"></a>Redis 使用</h3><h4 id=\"1、在本地使用\"><a href=\"#1、在本地使用\" class=\"headerlink\" title=\"1、在本地使用\"></a>1、在本地使用</h4><p>进入到redis的src目录中</p>\n<pre><code>./redis-cli </code></pre>\n<ul>\n<li>一些常规操作</li>\n</ul>\n<pre><code>LPUSH 是把新的元素从右侧插入到数组中\nLPUSH fruits apple   # =&gt; [&quot;apple&quot;]   把元素从左边插入到数组中\n&gt; LPUSH  fruits banana   # =&gt; [&quot;banana&quot;, &quot;apple&quot;]  \n\nRPUSH 是把新的元素从右侧插入到数组中\n&gt; LINDEX fruits 0     # =&gt; &quot;banana&quot;\n&gt; LINDEX fruits 1    # =&gt;  &quot;apple&quot;\n&gt; LRANGE fruits 0 1  #=&gt; [&#39;banana&#39;, &#39;apple&#39;]   ， 注意只有lrange, 没有 rrange. </code></pre>\n<ul>\n<li>获取所有的key</li>\n</ul>\n<pre><code>keys *   这个*号是匹配所有的key 可以拼接 比如 fruits*</code></pre>\n<pre><code>127.0.0.1:6379&gt; keys *\n1) &quot;fruits&quot;</code></pre>\n<ul>\n<li>查看某个key下的值:</li>\n</ul>\n<pre><code>lrange fruits 0 -1</code></pre>\n<pre><code>127.0.0.1:6379&gt; lrange fruits 0 -1\n1) &quot;def&quot;\n2) &quot;abc&quot;\n3) &quot;banana&quot;\n4) &quot;apple&quot;</code></pre>\n<ul>\n<li>截断 保留trim中参数部分</li>\n</ul>\n<pre><code>ltrim fruits 0 2</code></pre>\n<pre><code>我们看到 这里只保留了0-2剩下的都删除了\n127.0.0.1:6379&gt; lrange fruits 0 -1\n1) &quot;def&quot;\n2) &quot;abc&quot;\n3) &quot;banana&quot;</code></pre>\n"},{"title":"ubuntu下安装mysql","date":"2021-02-02T03:05:08.000Z","_content":"\n#### ubuntu下安装mysql\n\n> MySQL 的安装比较简单，只需要简单的几步就可以搞定，但它的一些配置却比较繁琐。下面以 Ubuntu 18.04（其他版本类似）为例，详细介绍 MySQL 数据库的安装和配置。\n\n##### 1、安装mysql\n\n在 Ubuntu 中，默认只有最新版本的 MySQL 包含在 APT 软件包存储库中。\n\n要安装它，需要使用 apt 更新服务器上的软件包索引：\n\n``` linux\n$ sudo apt update\n```\n\n然后安装默认的 MySQL 软件包：\n\n``` \n$ sudo apt install mysql-server\n```\n\n这一步不会进行一些配置相关的提示（例如：设置密码），因为会使 MySQL 的安装不安全，我们将在下一步解决该问题。\n\n##### 2、配置mysql\n\n在安装完 MySQL 之后，应该运行一下包含的安全脚本：\n\n```\nsudo mysql_secure_installation\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202115006.png)\n\n重点说一下第一个提示，这会询问我们是否愿意设置验证密码插件，该插件可用于测试 MySQL 密码的强度。\n\n##### 3、更改用户验证方式\n\n虽然上面设置了 root 用户的密码，但当通过 MySQL 终端登录时，并不能通过密码进行认证：\n\n```\n$ mysql -u root -p\nEnter password:\nERROR 1698 (28000): Access denied for user 'root'@'localhost'\n```\n\n这是因为在 MySQL 5.7 及之后的版本中，root 用户被默认设置为通过 auth_socket 插件（而非密码）认证，其主要原因是出于对数据库的安全性考虑。\n\n话虽如此，但偶尔也需要外部程序来访问，这时就会很麻烦了。为了使 root 用户能通过密码方式连接 MySQL，先通过终端打开 MySQL 的提示符：\n\n```\nsudo mysql\n```\n\n然后通过如下命令，检查 MySQL 中每个用户的认证方式：\n\n```\nmysql> SELECT user, authentication_string, plugin, host FROM mysql.user;\n+------------------+-------------------------------------------+-----------------------+-----------+\n| user             | authentication_string                     | plugin                | host      |\n+------------------+-------------------------------------------+-----------------------+-----------+\n| root             |                                           | auth_socket           | localhost |\n| mysql.session    | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | mysql_native_password | localhost |\n| mysql.sys        | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | mysql_native_password | localhost |\n| debian-sys-maint | *ABA968D18E3A0B6DEB02F9D5FBDA21415A86977B | mysql_native_password | localhost |\n+------------------+-------------------------------------------+-----------------------+-----------+\n4 rows in set (0.00 sec)\n```\n\n显而易见，root 用户的认证方式是 auth_socket。现在运行如下命令，将认证方式更改为密码认证（即：mysql_native_password）：\n\n```\nALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '123456';\n```\n\n可以看到，已经修改成功了，现在退出数据库：\n\n```\nmysql> exit\n```\n\n再来尝试一下，让 root 用户以密码形式登录：\n\n```\n$ mysql -u root -p\nEnter password:\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 7\nServer version: 5.7.29-0ubuntu0.18.04.1 (Ubuntu)\n \nCopyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.\n \nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n \nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n \nmysql>\n```\n\n##### 4、配置远程访问\n\n默认情况下，MySQL 只监听本地主机（localhost）的连接。若要启用远程连接，需要进行以下配置。\n\n1. 编辑 MySQL 的 mysqld.cnf 配置文件：\n\n```\nsudo vim /etc/mysql/mysql.conf.d/mysqld.cnf\n```\n\n注释掉下面这行配置并保存退出：\n\n```\nbind-address          = 127.0.0.1\n```\n\n2. 更改 user 表中的 host 项，将“localhost”改称“%”（表示所有用户都可以访问），并给 root 用户授权：\n\n```\n\n$ mysql -u root -p\n \nmysql> use mysql;\nmysql>\nmysql> update user set host = '%' where user = 'root';\nmysql>\nmysql> grant all on *.* to root@'%' identified by '123456' with grant option;\nmysql>\nmysql> flush privileges;  # 刷新权限\nmysql>\nmysql> exit\n\n```\n\n3. 执行如下命令，重启 mysql 服务：\n\n```\n$ sudo systemctl restart mysql\n```\n\n现在，就可以远程连接（下图为 Navicat 截图） MySQl 数据库了：\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202120829.png)\n","source":"_posts/ubuntu下安装mysql.md","raw":"---\ntitle: ubuntu下安装mysql\ndate: 2021-02-02 11:05:08\ncategories:\n- mysql\ntags:\n- ubuntu\n---\n\n#### ubuntu下安装mysql\n\n> MySQL 的安装比较简单，只需要简单的几步就可以搞定，但它的一些配置却比较繁琐。下面以 Ubuntu 18.04（其他版本类似）为例，详细介绍 MySQL 数据库的安装和配置。\n\n##### 1、安装mysql\n\n在 Ubuntu 中，默认只有最新版本的 MySQL 包含在 APT 软件包存储库中。\n\n要安装它，需要使用 apt 更新服务器上的软件包索引：\n\n``` linux\n$ sudo apt update\n```\n\n然后安装默认的 MySQL 软件包：\n\n``` \n$ sudo apt install mysql-server\n```\n\n这一步不会进行一些配置相关的提示（例如：设置密码），因为会使 MySQL 的安装不安全，我们将在下一步解决该问题。\n\n##### 2、配置mysql\n\n在安装完 MySQL 之后，应该运行一下包含的安全脚本：\n\n```\nsudo mysql_secure_installation\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202115006.png)\n\n重点说一下第一个提示，这会询问我们是否愿意设置验证密码插件，该插件可用于测试 MySQL 密码的强度。\n\n##### 3、更改用户验证方式\n\n虽然上面设置了 root 用户的密码，但当通过 MySQL 终端登录时，并不能通过密码进行认证：\n\n```\n$ mysql -u root -p\nEnter password:\nERROR 1698 (28000): Access denied for user 'root'@'localhost'\n```\n\n这是因为在 MySQL 5.7 及之后的版本中，root 用户被默认设置为通过 auth_socket 插件（而非密码）认证，其主要原因是出于对数据库的安全性考虑。\n\n话虽如此，但偶尔也需要外部程序来访问，这时就会很麻烦了。为了使 root 用户能通过密码方式连接 MySQL，先通过终端打开 MySQL 的提示符：\n\n```\nsudo mysql\n```\n\n然后通过如下命令，检查 MySQL 中每个用户的认证方式：\n\n```\nmysql> SELECT user, authentication_string, plugin, host FROM mysql.user;\n+------------------+-------------------------------------------+-----------------------+-----------+\n| user             | authentication_string                     | plugin                | host      |\n+------------------+-------------------------------------------+-----------------------+-----------+\n| root             |                                           | auth_socket           | localhost |\n| mysql.session    | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | mysql_native_password | localhost |\n| mysql.sys        | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | mysql_native_password | localhost |\n| debian-sys-maint | *ABA968D18E3A0B6DEB02F9D5FBDA21415A86977B | mysql_native_password | localhost |\n+------------------+-------------------------------------------+-----------------------+-----------+\n4 rows in set (0.00 sec)\n```\n\n显而易见，root 用户的认证方式是 auth_socket。现在运行如下命令，将认证方式更改为密码认证（即：mysql_native_password）：\n\n```\nALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '123456';\n```\n\n可以看到，已经修改成功了，现在退出数据库：\n\n```\nmysql> exit\n```\n\n再来尝试一下，让 root 用户以密码形式登录：\n\n```\n$ mysql -u root -p\nEnter password:\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 7\nServer version: 5.7.29-0ubuntu0.18.04.1 (Ubuntu)\n \nCopyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.\n \nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n \nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n \nmysql>\n```\n\n##### 4、配置远程访问\n\n默认情况下，MySQL 只监听本地主机（localhost）的连接。若要启用远程连接，需要进行以下配置。\n\n1. 编辑 MySQL 的 mysqld.cnf 配置文件：\n\n```\nsudo vim /etc/mysql/mysql.conf.d/mysqld.cnf\n```\n\n注释掉下面这行配置并保存退出：\n\n```\nbind-address          = 127.0.0.1\n```\n\n2. 更改 user 表中的 host 项，将“localhost”改称“%”（表示所有用户都可以访问），并给 root 用户授权：\n\n```\n\n$ mysql -u root -p\n \nmysql> use mysql;\nmysql>\nmysql> update user set host = '%' where user = 'root';\nmysql>\nmysql> grant all on *.* to root@'%' identified by '123456' with grant option;\nmysql>\nmysql> flush privileges;  # 刷新权限\nmysql>\nmysql> exit\n\n```\n\n3. 执行如下命令，重启 mysql 服务：\n\n```\n$ sudo systemctl restart mysql\n```\n\n现在，就可以远程连接（下图为 Navicat 截图） MySQl 数据库了：\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202120829.png)\n","slug":"ubuntu下安装mysql","published":1,"updated":"2021-02-02T04:09:20.759Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwp00243ys23byffojb","content":"<h4 id=\"ubuntu下安装mysql\"><a href=\"#ubuntu下安装mysql\" class=\"headerlink\" title=\"ubuntu下安装mysql\"></a>ubuntu下安装mysql</h4><blockquote>\n<p>MySQL 的安装比较简单，只需要简单的几步就可以搞定，但它的一些配置却比较繁琐。下面以 Ubuntu 18.04（其他版本类似）为例，详细介绍 MySQL 数据库的安装和配置。</p>\n</blockquote>\n<h5 id=\"1、安装mysql\"><a href=\"#1、安装mysql\" class=\"headerlink\" title=\"1、安装mysql\"></a>1、安装mysql</h5><p>在 Ubuntu 中，默认只有最新版本的 MySQL 包含在 APT 软件包存储库中。</p>\n<p>要安装它，需要使用 apt 更新服务器上的软件包索引：</p>\n<pre class=\"line-numbers language-linux\"><code class=\"language-linux\">$ sudo apt update<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>然后安装默认的 MySQL 软件包：</p>\n<pre><code>$ sudo apt install mysql-server</code></pre>\n<p>这一步不会进行一些配置相关的提示（例如：设置密码），因为会使 MySQL 的安装不安全，我们将在下一步解决该问题。</p>\n<h5 id=\"2、配置mysql\"><a href=\"#2、配置mysql\" class=\"headerlink\" title=\"2、配置mysql\"></a>2、配置mysql</h5><p>在安装完 MySQL 之后，应该运行一下包含的安全脚本：</p>\n<pre><code>sudo mysql_secure_installation</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202115006.png\"></p>\n<p>重点说一下第一个提示，这会询问我们是否愿意设置验证密码插件，该插件可用于测试 MySQL 密码的强度。</p>\n<h5 id=\"3、更改用户验证方式\"><a href=\"#3、更改用户验证方式\" class=\"headerlink\" title=\"3、更改用户验证方式\"></a>3、更改用户验证方式</h5><p>虽然上面设置了 root 用户的密码，但当通过 MySQL 终端登录时，并不能通过密码进行认证：</p>\n<pre><code>$ mysql -u root -p\nEnter password:\nERROR 1698 (28000): Access denied for user 'root'@'localhost'</code></pre>\n<p>这是因为在 MySQL 5.7 及之后的版本中，root 用户被默认设置为通过 auth_socket 插件（而非密码）认证，其主要原因是出于对数据库的安全性考虑。</p>\n<p>话虽如此，但偶尔也需要外部程序来访问，这时就会很麻烦了。为了使 root 用户能通过密码方式连接 MySQL，先通过终端打开 MySQL 的提示符：</p>\n<pre><code>sudo mysql</code></pre>\n<p>然后通过如下命令，检查 MySQL 中每个用户的认证方式：</p>\n<pre><code>mysql&gt; SELECT user, authentication_string, plugin, host FROM mysql.user;\n+------------------+-------------------------------------------+-----------------------+-----------+\n| user             | authentication_string                     | plugin                | host      |\n+------------------+-------------------------------------------+-----------------------+-----------+\n| root             |                                           | auth_socket           | localhost |\n| mysql.session    | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | mysql_native_password | localhost |\n| mysql.sys        | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | mysql_native_password | localhost |\n| debian-sys-maint | *ABA968D18E3A0B6DEB02F9D5FBDA21415A86977B | mysql_native_password | localhost |\n+------------------+-------------------------------------------+-----------------------+-----------+\n4 rows in set (0.00 sec)</code></pre>\n<p>显而易见，root 用户的认证方式是 auth_socket。现在运行如下命令，将认证方式更改为密码认证（即：mysql_native_password）：</p>\n<pre><code>ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '123456';</code></pre>\n<p>可以看到，已经修改成功了，现在退出数据库：</p>\n<pre><code>mysql&gt; exit</code></pre>\n<p>再来尝试一下，让 root 用户以密码形式登录：</p>\n<pre><code>$ mysql -u root -p\nEnter password:\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 7\nServer version: 5.7.29-0ubuntu0.18.04.1 (Ubuntu)\n\nCopyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql&gt;</code></pre>\n<h5 id=\"4、配置远程访问\"><a href=\"#4、配置远程访问\" class=\"headerlink\" title=\"4、配置远程访问\"></a>4、配置远程访问</h5><p>默认情况下，MySQL 只监听本地主机（localhost）的连接。若要启用远程连接，需要进行以下配置。</p>\n<ol>\n<li>编辑 MySQL 的 mysqld.cnf 配置文件：</li>\n</ol>\n<pre><code>sudo vim /etc/mysql/mysql.conf.d/mysqld.cnf</code></pre>\n<p>注释掉下面这行配置并保存退出：</p>\n<pre><code>bind-address          = 127.0.0.1</code></pre>\n<ol start=\"2\">\n<li>更改 user 表中的 host 项，将“localhost”改称“%”（表示所有用户都可以访问），并给 root 用户授权：</li>\n</ol>\n<pre><code>\n$ mysql -u root -p\n\nmysql&gt; use mysql;\nmysql&gt;\nmysql&gt; update user set host = '%' where user = 'root';\nmysql&gt;\nmysql&gt; grant all on *.* to root@'%' identified by '123456' with grant option;\nmysql&gt;\nmysql&gt; flush privileges;  # 刷新权限\nmysql&gt;\nmysql&gt; exit\n</code></pre>\n<ol start=\"3\">\n<li>执行如下命令，重启 mysql 服务：</li>\n</ol>\n<pre><code>$ sudo systemctl restart mysql</code></pre>\n<p>现在，就可以远程连接（下图为 Navicat 截图） MySQl 数据库了：</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202120829.png\"></p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"ubuntu下安装mysql\"><a href=\"#ubuntu下安装mysql\" class=\"headerlink\" title=\"ubuntu下安装mysql\"></a>ubuntu下安装mysql</h4><blockquote>\n<p>MySQL 的安装比较简单，只需要简单的几步就可以搞定，但它的一些配置却比较繁琐。下面以 Ubuntu 18.04（其他版本类似）为例，详细介绍 MySQL 数据库的安装和配置。</p>\n</blockquote>\n<h5 id=\"1、安装mysql\"><a href=\"#1、安装mysql\" class=\"headerlink\" title=\"1、安装mysql\"></a>1、安装mysql</h5><p>在 Ubuntu 中，默认只有最新版本的 MySQL 包含在 APT 软件包存储库中。</p>\n<p>要安装它，需要使用 apt 更新服务器上的软件包索引：</p>\n<pre><code class=\"linux\">$ sudo apt update</code></pre>\n<p>然后安装默认的 MySQL 软件包：</p>\n<pre><code>$ sudo apt install mysql-server</code></pre>\n<p>这一步不会进行一些配置相关的提示（例如：设置密码），因为会使 MySQL 的安装不安全，我们将在下一步解决该问题。</p>\n<h5 id=\"2、配置mysql\"><a href=\"#2、配置mysql\" class=\"headerlink\" title=\"2、配置mysql\"></a>2、配置mysql</h5><p>在安装完 MySQL 之后，应该运行一下包含的安全脚本：</p>\n<pre><code>sudo mysql_secure_installation</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202115006.png\"></p>\n<p>重点说一下第一个提示，这会询问我们是否愿意设置验证密码插件，该插件可用于测试 MySQL 密码的强度。</p>\n<h5 id=\"3、更改用户验证方式\"><a href=\"#3、更改用户验证方式\" class=\"headerlink\" title=\"3、更改用户验证方式\"></a>3、更改用户验证方式</h5><p>虽然上面设置了 root 用户的密码，但当通过 MySQL 终端登录时，并不能通过密码进行认证：</p>\n<pre><code>$ mysql -u root -p\nEnter password:\nERROR 1698 (28000): Access denied for user &#39;root&#39;@&#39;localhost&#39;</code></pre>\n<p>这是因为在 MySQL 5.7 及之后的版本中，root 用户被默认设置为通过 auth_socket 插件（而非密码）认证，其主要原因是出于对数据库的安全性考虑。</p>\n<p>话虽如此，但偶尔也需要外部程序来访问，这时就会很麻烦了。为了使 root 用户能通过密码方式连接 MySQL，先通过终端打开 MySQL 的提示符：</p>\n<pre><code>sudo mysql</code></pre>\n<p>然后通过如下命令，检查 MySQL 中每个用户的认证方式：</p>\n<pre><code>mysql&gt; SELECT user, authentication_string, plugin, host FROM mysql.user;\n+------------------+-------------------------------------------+-----------------------+-----------+\n| user             | authentication_string                     | plugin                | host      |\n+------------------+-------------------------------------------+-----------------------+-----------+\n| root             |                                           | auth_socket           | localhost |\n| mysql.session    | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | mysql_native_password | localhost |\n| mysql.sys        | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | mysql_native_password | localhost |\n| debian-sys-maint | *ABA968D18E3A0B6DEB02F9D5FBDA21415A86977B | mysql_native_password | localhost |\n+------------------+-------------------------------------------+-----------------------+-----------+\n4 rows in set (0.00 sec)</code></pre>\n<p>显而易见，root 用户的认证方式是 auth_socket。现在运行如下命令，将认证方式更改为密码认证（即：mysql_native_password）：</p>\n<pre><code>ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED WITH mysql_native_password BY &#39;123456&#39;;</code></pre>\n<p>可以看到，已经修改成功了，现在退出数据库：</p>\n<pre><code>mysql&gt; exit</code></pre>\n<p>再来尝试一下，让 root 用户以密码形式登录：</p>\n<pre><code>$ mysql -u root -p\nEnter password:\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 7\nServer version: 5.7.29-0ubuntu0.18.04.1 (Ubuntu)\n\nCopyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType &#39;help;&#39; or &#39;\\h&#39; for help. Type &#39;\\c&#39; to clear the current input statement.\n\nmysql&gt;</code></pre>\n<h5 id=\"4、配置远程访问\"><a href=\"#4、配置远程访问\" class=\"headerlink\" title=\"4、配置远程访问\"></a>4、配置远程访问</h5><p>默认情况下，MySQL 只监听本地主机（localhost）的连接。若要启用远程连接，需要进行以下配置。</p>\n<ol>\n<li>编辑 MySQL 的 mysqld.cnf 配置文件：</li>\n</ol>\n<pre><code>sudo vim /etc/mysql/mysql.conf.d/mysqld.cnf</code></pre>\n<p>注释掉下面这行配置并保存退出：</p>\n<pre><code>bind-address          = 127.0.0.1</code></pre>\n<ol start=\"2\">\n<li>更改 user 表中的 host 项，将“localhost”改称“%”（表示所有用户都可以访问），并给 root 用户授权：</li>\n</ol>\n<pre><code>\n$ mysql -u root -p\n\nmysql&gt; use mysql;\nmysql&gt;\nmysql&gt; update user set host = &#39;%&#39; where user = &#39;root&#39;;\nmysql&gt;\nmysql&gt; grant all on *.* to root@&#39;%&#39; identified by &#39;123456&#39; with grant option;\nmysql&gt;\nmysql&gt; flush privileges;  # 刷新权限\nmysql&gt;\nmysql&gt; exit\n</code></pre>\n<ol start=\"3\">\n<li>执行如下命令，重启 mysql 服务：</li>\n</ol>\n<pre><code>$ sudo systemctl restart mysql</code></pre>\n<p>现在，就可以远程连接（下图为 Navicat 截图） MySQl 数据库了：</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202120829.png\"></p>\n"},{"title":"rust 0u8在rust中是什么意思","date":"2020-10-19T03:00:27.000Z","_content":"\n#### rust 0u8在rust中是什么意思  \n###### 当我在学习[Rust 编程语言](https://learnku.com/docs/rust-lang/2018/ch06-03-if-let/4515)  \n* 遇到了如下这种问题：  \n``` rust\nlet some_u8_value = Some(0u8);\nmatch some_u8_value {\n    Some(3) => println!(\"three\"),\n    _ => (),\n}\n```\n0u8 是什么意思，在我的印象中应该是这么写    \n``` rust\nlet some_u8_value = Some(0 :u8)\n```  \n然而并没有这种写法，直到我在 [rust_by_example](https://rustwiki.org/zh-CN/rust-by-example/types/literals.html) 中看到了答案，\n\n### 字面量\n\n* 对数值字面量，只要把类型作为后缀加上去，就完成了类型说明。比如指定字面量 42 的 类型是 i32，只需要写 42i32。\n\n* 无后缀的数值字面量，其类型取决于怎样使用它们。如果没有限制，编译器会对整数使用 i32，对浮点数使用 f64。\n\n``` rust\nfn main() {\n    // 带后缀的字面量，其类型在初始化时已经知道了。\n    let x = 1u8;\n    let y = 2u32;\n    let z = 3f32;\n\n    // 无后缀的字面量，其类型取决于如何使用它们。\n    let i = 1;\n    let f = 1.0;\n\n    // `size_of_val` 返回一个变量所占的字节数\n    println!(\"size of `x` in bytes: {}\", std::mem::size_of_val(&x));\n    println!(\"size of `y` in bytes: {}\", std::mem::size_of_val(&y));\n    println!(\"size of `z` in bytes: {}\", std::mem::size_of_val(&z));\n    println!(\"size of `i` in bytes: {}\", std::mem::size_of_val(&i));\n    println!(\"size of `f` in bytes: {}\", std::mem::size_of_val(&f));\n}\n```\n\n","source":"_posts/rust-0u8在rust中是什么意思.md","raw":"---\ntitle: rust 0u8在rust中是什么意思\ndate: 2020-10-19 11:00:27\ncategories:\n- Rust\ntags:\n- Rust\n- 0u8\n- 字面量\n---\n\n#### rust 0u8在rust中是什么意思  \n###### 当我在学习[Rust 编程语言](https://learnku.com/docs/rust-lang/2018/ch06-03-if-let/4515)  \n* 遇到了如下这种问题：  \n``` rust\nlet some_u8_value = Some(0u8);\nmatch some_u8_value {\n    Some(3) => println!(\"three\"),\n    _ => (),\n}\n```\n0u8 是什么意思，在我的印象中应该是这么写    \n``` rust\nlet some_u8_value = Some(0 :u8)\n```  \n然而并没有这种写法，直到我在 [rust_by_example](https://rustwiki.org/zh-CN/rust-by-example/types/literals.html) 中看到了答案，\n\n### 字面量\n\n* 对数值字面量，只要把类型作为后缀加上去，就完成了类型说明。比如指定字面量 42 的 类型是 i32，只需要写 42i32。\n\n* 无后缀的数值字面量，其类型取决于怎样使用它们。如果没有限制，编译器会对整数使用 i32，对浮点数使用 f64。\n\n``` rust\nfn main() {\n    // 带后缀的字面量，其类型在初始化时已经知道了。\n    let x = 1u8;\n    let y = 2u32;\n    let z = 3f32;\n\n    // 无后缀的字面量，其类型取决于如何使用它们。\n    let i = 1;\n    let f = 1.0;\n\n    // `size_of_val` 返回一个变量所占的字节数\n    println!(\"size of `x` in bytes: {}\", std::mem::size_of_val(&x));\n    println!(\"size of `y` in bytes: {}\", std::mem::size_of_val(&y));\n    println!(\"size of `z` in bytes: {}\", std::mem::size_of_val(&z));\n    println!(\"size of `i` in bytes: {}\", std::mem::size_of_val(&i));\n    println!(\"size of `f` in bytes: {}\", std::mem::size_of_val(&f));\n}\n```\n\n","slug":"rust-0u8在rust中是什么意思","published":1,"updated":"2020-10-21T03:15:43.974Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwp00263ys233x635pj","content":"<h4 id=\"rust-0u8在rust中是什么意思\"><a href=\"#rust-0u8在rust中是什么意思\" class=\"headerlink\" title=\"rust 0u8在rust中是什么意思\"></a>rust 0u8在rust中是什么意思</h4><h6 id=\"当我在学习Rust-编程语言\"><a href=\"#当我在学习Rust-编程语言\" class=\"headerlink\" title=\"当我在学习Rust 编程语言\"></a>当我在学习<a href=\"https://learnku.com/docs/rust-lang/2018/ch06-03-if-let/4515\">Rust 编程语言</a></h6><ul>\n<li>遇到了如下这种问题：  <pre class=\"line-numbers language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">let</span> some_u8_value <span class=\"token operator\">=</span> <span class=\"token function\">Some</span><span class=\"token punctuation\">(</span><span class=\"token number\">0u8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">match</span> some_u8_value <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">Some</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token function\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"three\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  _ <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n0u8 是什么意思，在我的印象中应该是这么写    <pre class=\"line-numbers language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">let</span> some_u8_value <span class=\"token operator\">=</span> <span class=\"token function\">Some</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token punctuation\">:</span>u8<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n然而并没有这种写法，直到我在 <a href=\"https://rustwiki.org/zh-CN/rust-by-example/types/literals.html\">rust_by_example</a> 中看到了答案，</li>\n</ul>\n<h3 id=\"字面量\"><a href=\"#字面量\" class=\"headerlink\" title=\"字面量\"></a>字面量</h3><ul>\n<li><p>对数值字面量，只要把类型作为后缀加上去，就完成了类型说明。比如指定字面量 42 的 类型是 i32，只需要写 42i32。</p>\n</li>\n<li><p>无后缀的数值字面量，其类型取决于怎样使用它们。如果没有限制，编译器会对整数使用 i32，对浮点数使用 f64。</p>\n</li>\n</ul>\n<pre class=\"line-numbers language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">fn</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\" spellcheck=\"true\">// 带后缀的字面量，其类型在初始化时已经知道了。</span>\n    <span class=\"token keyword\">let</span> x <span class=\"token operator\">=</span> <span class=\"token number\">1u8</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> y <span class=\"token operator\">=</span> <span class=\"token number\">2u32</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> z <span class=\"token operator\">=</span> <span class=\"token number\">3f32</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// 无后缀的字面量，其类型取决于如何使用它们。</span>\n    <span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> f <span class=\"token operator\">=</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">// `size_of_val` 返回一个变量所占的字节数</span>\n    <span class=\"token function\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"size of `x` in bytes: {}\"</span><span class=\"token punctuation\">,</span> std<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>mem<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">size_of_val</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"size of `y` in bytes: {}\"</span><span class=\"token punctuation\">,</span> std<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>mem<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">size_of_val</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"size of `z` in bytes: {}\"</span><span class=\"token punctuation\">,</span> std<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>mem<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">size_of_val</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"size of `i` in bytes: {}\"</span><span class=\"token punctuation\">,</span> std<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>mem<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">size_of_val</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"size of `f` in bytes: {}\"</span><span class=\"token punctuation\">,</span> std<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>mem<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">size_of_val</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"rust-0u8在rust中是什么意思\"><a href=\"#rust-0u8在rust中是什么意思\" class=\"headerlink\" title=\"rust 0u8在rust中是什么意思\"></a>rust 0u8在rust中是什么意思</h4><h6 id=\"当我在学习Rust-编程语言\"><a href=\"#当我在学习Rust-编程语言\" class=\"headerlink\" title=\"当我在学习Rust 编程语言\"></a>当我在学习<a href=\"https://learnku.com/docs/rust-lang/2018/ch06-03-if-let/4515\">Rust 编程语言</a></h6><ul>\n<li>遇到了如下这种问题：  <pre><code class=\"rust\">let some_u8_value = Some(0u8);\nmatch some_u8_value &#123;\n  Some(3) =&gt; println!(&quot;three&quot;),\n  _ =&gt; (),\n&#125;</code></pre>\n0u8 是什么意思，在我的印象中应该是这么写    <pre><code class=\"rust\">let some_u8_value = Some(0 :u8)</code></pre>\n然而并没有这种写法，直到我在 <a href=\"https://rustwiki.org/zh-CN/rust-by-example/types/literals.html\">rust_by_example</a> 中看到了答案，</li>\n</ul>\n<h3 id=\"字面量\"><a href=\"#字面量\" class=\"headerlink\" title=\"字面量\"></a>字面量</h3><ul>\n<li><p>对数值字面量，只要把类型作为后缀加上去，就完成了类型说明。比如指定字面量 42 的 类型是 i32，只需要写 42i32。</p>\n</li>\n<li><p>无后缀的数值字面量，其类型取决于怎样使用它们。如果没有限制，编译器会对整数使用 i32，对浮点数使用 f64。</p>\n</li>\n</ul>\n<pre><code class=\"rust\">fn main() &#123;\n    // 带后缀的字面量，其类型在初始化时已经知道了。\n    let x = 1u8;\n    let y = 2u32;\n    let z = 3f32;\n\n    // 无后缀的字面量，其类型取决于如何使用它们。\n    let i = 1;\n    let f = 1.0;\n\n    // `size_of_val` 返回一个变量所占的字节数\n    println!(&quot;size of `x` in bytes: &#123;&#125;&quot;, std::mem::size_of_val(&amp;x));\n    println!(&quot;size of `y` in bytes: &#123;&#125;&quot;, std::mem::size_of_val(&amp;y));\n    println!(&quot;size of `z` in bytes: &#123;&#125;&quot;, std::mem::size_of_val(&amp;z));\n    println!(&quot;size of `i` in bytes: &#123;&#125;&quot;, std::mem::size_of_val(&amp;i));\n    println!(&quot;size of `f` in bytes: &#123;&#125;&quot;, std::mem::size_of_val(&amp;f));\n&#125;</code></pre>\n"},{"title":"ubuntu下安装redis","date":"2021-02-02T05:57:48.000Z","_content":"\n#### ubuntu下安装redis\n\n##### 1、使用apt安装\n\n在 Ubuntu 系统安装 Redi 可以使用以下命令:\n\n```\n$sudo apt-get update\n$sudo apt-get install redis-server\n```\n\n##### 2、启动redis\n\n```\n$ redis-server\n```\n\n##### 3、查看 redis 是否启动？\n\n```\n$ redis-cli\n```\n\n以上命令将打开以下终端：\n\n```\nredis 127.0.0.1:6379>\n```\n\n127.0.0.1 是本机 IP ，6379 是 redis 服务端口。现在我们输入 PING 命令。\n\n```\nredis 127.0.0.1:6379> ping PONG\n```\n","source":"_posts/ubuntu下安装redis.md","raw":"---\ntitle: ubuntu下安装redis\ndate: 2021-02-02 13:57:48\ncategories:\n- redis\ntags:\n- linux\n- ubuntu\n---\n\n#### ubuntu下安装redis\n\n##### 1、使用apt安装\n\n在 Ubuntu 系统安装 Redi 可以使用以下命令:\n\n```\n$sudo apt-get update\n$sudo apt-get install redis-server\n```\n\n##### 2、启动redis\n\n```\n$ redis-server\n```\n\n##### 3、查看 redis 是否启动？\n\n```\n$ redis-cli\n```\n\n以上命令将打开以下终端：\n\n```\nredis 127.0.0.1:6379>\n```\n\n127.0.0.1 是本机 IP ，6379 是 redis 服务端口。现在我们输入 PING 命令。\n\n```\nredis 127.0.0.1:6379> ping PONG\n```\n","slug":"ubuntu下安装redis","published":1,"updated":"2021-02-02T06:03:00.728Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwq00293ys2aci35ps6","content":"<h4 id=\"ubuntu下安装redis\"><a href=\"#ubuntu下安装redis\" class=\"headerlink\" title=\"ubuntu下安装redis\"></a>ubuntu下安装redis</h4><h5 id=\"1、使用apt安装\"><a href=\"#1、使用apt安装\" class=\"headerlink\" title=\"1、使用apt安装\"></a>1、使用apt安装</h5><p>在 Ubuntu 系统安装 Redi 可以使用以下命令:</p>\n<pre><code>$sudo apt-get update\n$sudo apt-get install redis-server</code></pre>\n<h5 id=\"2、启动redis\"><a href=\"#2、启动redis\" class=\"headerlink\" title=\"2、启动redis\"></a>2、启动redis</h5><pre><code>$ redis-server</code></pre>\n<h5 id=\"3、查看-redis-是否启动？\"><a href=\"#3、查看-redis-是否启动？\" class=\"headerlink\" title=\"3、查看 redis 是否启动？\"></a>3、查看 redis 是否启动？</h5><pre><code>$ redis-cli</code></pre>\n<p>以上命令将打开以下终端：</p>\n<pre><code>redis 127.0.0.1:6379&gt;</code></pre>\n<p>127.0.0.1 是本机 IP ，6379 是 redis 服务端口。现在我们输入 PING 命令。</p>\n<pre><code>redis 127.0.0.1:6379&gt; ping PONG</code></pre>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"ubuntu下安装redis\"><a href=\"#ubuntu下安装redis\" class=\"headerlink\" title=\"ubuntu下安装redis\"></a>ubuntu下安装redis</h4><h5 id=\"1、使用apt安装\"><a href=\"#1、使用apt安装\" class=\"headerlink\" title=\"1、使用apt安装\"></a>1、使用apt安装</h5><p>在 Ubuntu 系统安装 Redi 可以使用以下命令:</p>\n<pre><code>$sudo apt-get update\n$sudo apt-get install redis-server</code></pre>\n<h5 id=\"2、启动redis\"><a href=\"#2、启动redis\" class=\"headerlink\" title=\"2、启动redis\"></a>2、启动redis</h5><pre><code>$ redis-server</code></pre>\n<h5 id=\"3、查看-redis-是否启动？\"><a href=\"#3、查看-redis-是否启动？\" class=\"headerlink\" title=\"3、查看 redis 是否启动？\"></a>3、查看 redis 是否启动？</h5><pre><code>$ redis-cli</code></pre>\n<p>以上命令将打开以下终端：</p>\n<pre><code>redis 127.0.0.1:6379&gt;</code></pre>\n<p>127.0.0.1 是本机 IP ，6379 是 redis 服务端口。现在我们输入 PING 命令。</p>\n<pre><code>redis 127.0.0.1:6379&gt; ping PONG</code></pre>\n"},{"title":"ubuntu下彻底卸载mysql","date":"2021-02-02T01:26:49.000Z","_content":"\n#### Ubuntu下彻底卸载mysql\n\n> 采用sudo apt install mysql-server命令的方式默认安装的是MySQL5.7，MySQL5.7版本最高只适配到Ubuntu17.04，\n> 不支持Ubuntu18.04，MySQL8.0可适配到Ubuntu18.04故如果系统使用的Ubuntu18.04，\n> 只能安装MySQL8.0，而且加密方式需要选择5.x的加密，因为有兼容性问题，如果你已经执行了上边的命令，安装了MySQL5.7，需要先卸载。\n\n\n##### 1、首先在系统终端中查看MySQL的依赖项，运行命令：`dpkg --list|grep mysql`\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093257.png)\n\n##### 2、卸载 `sudo apt-get remove mysql-common`\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093512.png)\n\n卸载 `sudo apt-get autoremove --purge mysql-server-5.7`\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093713.png)\n\n#### 3、清除残留数据，运行命令：`dpkg -l|grep ^rc|awk '{print$2}'|sudo xargs dpkg -P`\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093832.png)\n\n#### 4、再次查看MySQL的剩余依赖项，运行命令：`dpkg --list|grep mysql`\n\n>  如果还有依赖项 就继续删除剩余依赖项，比如：sudo apt-get autoremove --purge mysql-apt-config\n>  如果没有那就表示删除干净了","source":"_posts/ubuntu下彻底卸载mysql.md","raw":"---\ntitle: ubuntu下彻底卸载mysql\ndate: 2021-02-02 09:26:49\ncategories:\n- Ubuntu\ntags:\n- mysql\n---\n\n#### Ubuntu下彻底卸载mysql\n\n> 采用sudo apt install mysql-server命令的方式默认安装的是MySQL5.7，MySQL5.7版本最高只适配到Ubuntu17.04，\n> 不支持Ubuntu18.04，MySQL8.0可适配到Ubuntu18.04故如果系统使用的Ubuntu18.04，\n> 只能安装MySQL8.0，而且加密方式需要选择5.x的加密，因为有兼容性问题，如果你已经执行了上边的命令，安装了MySQL5.7，需要先卸载。\n\n\n##### 1、首先在系统终端中查看MySQL的依赖项，运行命令：`dpkg --list|grep mysql`\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093257.png)\n\n##### 2、卸载 `sudo apt-get remove mysql-common`\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093512.png)\n\n卸载 `sudo apt-get autoremove --purge mysql-server-5.7`\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093713.png)\n\n#### 3、清除残留数据，运行命令：`dpkg -l|grep ^rc|awk '{print$2}'|sudo xargs dpkg -P`\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093832.png)\n\n#### 4、再次查看MySQL的剩余依赖项，运行命令：`dpkg --list|grep mysql`\n\n>  如果还有依赖项 就继续删除剩余依赖项，比如：sudo apt-get autoremove --purge mysql-apt-config\n>  如果没有那就表示删除干净了","slug":"ubuntu下彻底卸载mysql","published":1,"updated":"2021-02-02T01:41:42.679Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwr002d3ys297cn3uxf","content":"<h4 id=\"Ubuntu下彻底卸载mysql\"><a href=\"#Ubuntu下彻底卸载mysql\" class=\"headerlink\" title=\"Ubuntu下彻底卸载mysql\"></a>Ubuntu下彻底卸载mysql</h4><blockquote>\n<p>采用sudo apt install mysql-server命令的方式默认安装的是MySQL5.7，MySQL5.7版本最高只适配到Ubuntu17.04，<br>不支持Ubuntu18.04，MySQL8.0可适配到Ubuntu18.04故如果系统使用的Ubuntu18.04，<br>只能安装MySQL8.0，而且加密方式需要选择5.x的加密，因为有兼容性问题，如果你已经执行了上边的命令，安装了MySQL5.7，需要先卸载。</p>\n</blockquote>\n<h5 id=\"1、首先在系统终端中查看MySQL的依赖项，运行命令：dpkg-list-grep-mysql\"><a href=\"#1、首先在系统终端中查看MySQL的依赖项，运行命令：dpkg-list-grep-mysql\" class=\"headerlink\" title=\"1、首先在系统终端中查看MySQL的依赖项，运行命令：dpkg --list|grep mysql\"></a>1、首先在系统终端中查看MySQL的依赖项，运行命令：<code>dpkg --list|grep mysql</code></h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093257.png\"></p>\n<h5 id=\"2、卸载-sudo-apt-get-remove-mysql-common\"><a href=\"#2、卸载-sudo-apt-get-remove-mysql-common\" class=\"headerlink\" title=\"2、卸载 sudo apt-get remove mysql-common\"></a>2、卸载 <code>sudo apt-get remove mysql-common</code></h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093512.png\"></p>\n<p>卸载 <code>sudo apt-get autoremove --purge mysql-server-5.7</code></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093713.png\"></p>\n<h4 id=\"3、清除残留数据，运行命令：dpkg-l-grep-rc-awk-39-print-2-39-sudo-xargs-dpkg-P\"><a href=\"#3、清除残留数据，运行命令：dpkg-l-grep-rc-awk-39-print-2-39-sudo-xargs-dpkg-P\" class=\"headerlink\" title=\"3、清除残留数据，运行命令：dpkg -l|grep ^rc|awk '{print$2}'|sudo xargs dpkg -P\"></a>3、清除残留数据，运行命令：<code>dpkg -l|grep ^rc|awk '{print$2}'|sudo xargs dpkg -P</code></h4><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093832.png\"></p>\n<h4 id=\"4、再次查看MySQL的剩余依赖项，运行命令：dpkg-list-grep-mysql\"><a href=\"#4、再次查看MySQL的剩余依赖项，运行命令：dpkg-list-grep-mysql\" class=\"headerlink\" title=\"4、再次查看MySQL的剩余依赖项，运行命令：dpkg --list|grep mysql\"></a>4、再次查看MySQL的剩余依赖项，运行命令：<code>dpkg --list|grep mysql</code></h4><blockquote>\n<p> 如果还有依赖项 就继续删除剩余依赖项，比如：sudo apt-get autoremove –purge mysql-apt-config<br> 如果没有那就表示删除干净了</p>\n</blockquote>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"Ubuntu下彻底卸载mysql\"><a href=\"#Ubuntu下彻底卸载mysql\" class=\"headerlink\" title=\"Ubuntu下彻底卸载mysql\"></a>Ubuntu下彻底卸载mysql</h4><blockquote>\n<p>采用sudo apt install mysql-server命令的方式默认安装的是MySQL5.7，MySQL5.7版本最高只适配到Ubuntu17.04，<br>不支持Ubuntu18.04，MySQL8.0可适配到Ubuntu18.04故如果系统使用的Ubuntu18.04，<br>只能安装MySQL8.0，而且加密方式需要选择5.x的加密，因为有兼容性问题，如果你已经执行了上边的命令，安装了MySQL5.7，需要先卸载。</p>\n</blockquote>\n<h5 id=\"1、首先在系统终端中查看MySQL的依赖项，运行命令：dpkg-list-grep-mysql\"><a href=\"#1、首先在系统终端中查看MySQL的依赖项，运行命令：dpkg-list-grep-mysql\" class=\"headerlink\" title=\"1、首先在系统终端中查看MySQL的依赖项，运行命令：dpkg --list|grep mysql\"></a>1、首先在系统终端中查看MySQL的依赖项，运行命令：<code>dpkg --list|grep mysql</code></h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093257.png\"></p>\n<h5 id=\"2、卸载-sudo-apt-get-remove-mysql-common\"><a href=\"#2、卸载-sudo-apt-get-remove-mysql-common\" class=\"headerlink\" title=\"2、卸载 sudo apt-get remove mysql-common\"></a>2、卸载 <code>sudo apt-get remove mysql-common</code></h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093512.png\"></p>\n<p>卸载 <code>sudo apt-get autoremove --purge mysql-server-5.7</code></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093713.png\"></p>\n<h4 id=\"3、清除残留数据，运行命令：dpkg-l-grep-rc-awk-39-print-2-39-sudo-xargs-dpkg-P\"><a href=\"#3、清除残留数据，运行命令：dpkg-l-grep-rc-awk-39-print-2-39-sudo-xargs-dpkg-P\" class=\"headerlink\" title=\"3、清除残留数据，运行命令：dpkg -l|grep ^rc|awk &#39;{print$2}&#39;|sudo xargs dpkg -P\"></a>3、清除残留数据，运行命令：<code>dpkg -l|grep ^rc|awk &#39;&#123;print$2&#125;&#39;|sudo xargs dpkg -P</code></h4><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210202093832.png\"></p>\n<h4 id=\"4、再次查看MySQL的剩余依赖项，运行命令：dpkg-list-grep-mysql\"><a href=\"#4、再次查看MySQL的剩余依赖项，运行命令：dpkg-list-grep-mysql\" class=\"headerlink\" title=\"4、再次查看MySQL的剩余依赖项，运行命令：dpkg --list|grep mysql\"></a>4、再次查看MySQL的剩余依赖项，运行命令：<code>dpkg --list|grep mysql</code></h4><blockquote>\n<p> 如果还有依赖项 就继续删除剩余依赖项，比如：sudo apt-get autoremove –purge mysql-apt-config<br> 如果没有那就表示删除干净了</p>\n</blockquote>\n"},{"title":"zsh: permission denied: 解决办法","date":"2020-11-18T09:40:48.000Z","_content":"\n### 1、出现原因\n``` java\n用户没有权限，所以才出现了这个错误，所以只需要用chmod修改一下权限\n```\n\n### 2、解决办法\n```\nchmod u+x *.sh\n```\n\n### 3、说明\n\n```\nchmod是权限管理命令change the permissions mode of a file的缩写。\nu代表所有者。x代表执行权限。’+’ 表示增加权限。\nchmod u+x file.sh 就表示对当前目录下的file.sh文件的所有者增加可执行权限。\n```","source":"_posts/zsh-permission-denied-解决办法.md","raw":"---\ntitle: 'zsh: permission denied: 解决办法'\ndate: 2020-11-18 17:40:48\ncategories:\n- Mac\ntags:\n- zsh\n- chmod\n---\n\n### 1、出现原因\n``` java\n用户没有权限，所以才出现了这个错误，所以只需要用chmod修改一下权限\n```\n\n### 2、解决办法\n```\nchmod u+x *.sh\n```\n\n### 3、说明\n\n```\nchmod是权限管理命令change the permissions mode of a file的缩写。\nu代表所有者。x代表执行权限。’+’ 表示增加权限。\nchmod u+x file.sh 就表示对当前目录下的file.sh文件的所有者增加可执行权限。\n```","slug":"zsh-permission-denied-解决办法","published":1,"updated":"2020-11-18T09:44:26.503Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmws002f3ys2bcao34t0","content":"<h3 id=\"1、出现原因\"><a href=\"#1、出现原因\" class=\"headerlink\" title=\"1、出现原因\"></a>1、出现原因</h3><pre class=\"line-numbers language-java\"><code class=\"language-java\">用户没有权限，所以才出现了这个错误，所以只需要用chmod修改一下权限<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h3 id=\"2、解决办法\"><a href=\"#2、解决办法\" class=\"headerlink\" title=\"2、解决办法\"></a>2、解决办法</h3><pre><code>chmod u+x *.sh</code></pre>\n<h3 id=\"3、说明\"><a href=\"#3、说明\" class=\"headerlink\" title=\"3、说明\"></a>3、说明</h3><pre><code>chmod是权限管理命令change the permissions mode of a file的缩写。\nu代表所有者。x代表执行权限。’+’ 表示增加权限。\nchmod u+x file.sh 就表示对当前目录下的file.sh文件的所有者增加可执行权限。</code></pre>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"1、出现原因\"><a href=\"#1、出现原因\" class=\"headerlink\" title=\"1、出现原因\"></a>1、出现原因</h3><pre><code class=\"java\">用户没有权限，所以才出现了这个错误，所以只需要用chmod修改一下权限</code></pre>\n<h3 id=\"2、解决办法\"><a href=\"#2、解决办法\" class=\"headerlink\" title=\"2、解决办法\"></a>2、解决办法</h3><pre><code>chmod u+x *.sh</code></pre>\n<h3 id=\"3、说明\"><a href=\"#3、说明\" class=\"headerlink\" title=\"3、说明\"></a>3、说明</h3><pre><code>chmod是权限管理命令change the permissions mode of a file的缩写。\nu代表所有者。x代表执行权限。’+’ 表示增加权限。\nchmod u+x file.sh 就表示对当前目录下的file.sh文件的所有者增加可执行权限。</code></pre>\n"},{"title":"什么是运行时(Runtime)","date":"2020-10-20T07:41:33.000Z","_content":"\n### 什么是运行时（Runtime）\n\n任何语言要运行都需要自己的运行时，Java 程序的运行时叫 Java Runtime，Android 程序的运行时叫 Android Runtime，而具体 Runtime 是个什么东西呢，\n就是说一个程序要在一个硬件或者平台上跑，就必须要有一个中间层用来把程序语言转换为机器能听懂的机器语言。\n\nJava Runtime 的左右就是如此，如我们编写好了 Java 的 Hello World 程序.\n\n``` java\npublic class HelloWorld{\n    public static void  main(String[] args){\n        System.out.println(\"hello world\");\n    }\n}\n```\n\n代码我们认识，作用就是输出一个 “hello world”，但是要在一个冷冰冰的机器上，让机器能读懂并运行这段代码，就需要一个 Java 语言的运行时环境，只有这个环境才能读懂它，并能让代码更机器进行打交道。\n\n到这里我们已经明白，**如果一个电脑要能运行 Java 程序就必须安装有 Java Runtime**。对于其他语言也是如此，要在平台上运行就必须要有对应平台上的 Runtime 组件，这也是开发一个新语言必须要做的事。\n\n说道 Runtime，在 Java 发展的过程中，Java 一下子火了有一个很重要原因，就是在 90 年代，微软的 IE 浏览器为了打败网景浏览器，曾经就在 IE 中默认安装 Java 运行时，再加上 IE 浏览器内置在 Windows 操作系统中，使得 IE 装机量特别大，同样这对 Java 也是一个非常大的促进作用。由于 IE 内置 Java Runtime，使得在 IE 浏览器中开发 Java 程序变得更加简单。如出名的 Java Applet（Java 小程序）开发。\n\n后来因为 Sun 跟 微软之间诉讼等事情，这个合作也没多久，现在 IE 已经默认禁用了 Java Applet。\n\n说道 **Java Runtime（简称 JRE）** ，曾经在一开始开发 Java 程序时，经常把 JRE 跟 JDK 搞混。\n\nJRE 是一个独立的东西，就是 Java 程序的运行环境，其中包含一个 JAVA 虚拟机（JVM）以及一些标准的函数类库。\n\n而 JDK 是 Sun 公司专门给开发人员准备的 Java 开发工具集。它其中就包含了 JRE，所以配置好 JDK，自然就可以在电脑上运行 Java 程序了。除此之外，JDK 还包含了源码、API 文档、编译工具等等。","source":"_posts/什么是运行时-Runtime.md","raw":"---\ntitle: 什么是运行时(Runtime)\ndate: 2020-10-20 15:41:33\ncategories:\n- Java\ntags:\n- Runtime\n- Java\n---\n\n### 什么是运行时（Runtime）\n\n任何语言要运行都需要自己的运行时，Java 程序的运行时叫 Java Runtime，Android 程序的运行时叫 Android Runtime，而具体 Runtime 是个什么东西呢，\n就是说一个程序要在一个硬件或者平台上跑，就必须要有一个中间层用来把程序语言转换为机器能听懂的机器语言。\n\nJava Runtime 的左右就是如此，如我们编写好了 Java 的 Hello World 程序.\n\n``` java\npublic class HelloWorld{\n    public static void  main(String[] args){\n        System.out.println(\"hello world\");\n    }\n}\n```\n\n代码我们认识，作用就是输出一个 “hello world”，但是要在一个冷冰冰的机器上，让机器能读懂并运行这段代码，就需要一个 Java 语言的运行时环境，只有这个环境才能读懂它，并能让代码更机器进行打交道。\n\n到这里我们已经明白，**如果一个电脑要能运行 Java 程序就必须安装有 Java Runtime**。对于其他语言也是如此，要在平台上运行就必须要有对应平台上的 Runtime 组件，这也是开发一个新语言必须要做的事。\n\n说道 Runtime，在 Java 发展的过程中，Java 一下子火了有一个很重要原因，就是在 90 年代，微软的 IE 浏览器为了打败网景浏览器，曾经就在 IE 中默认安装 Java 运行时，再加上 IE 浏览器内置在 Windows 操作系统中，使得 IE 装机量特别大，同样这对 Java 也是一个非常大的促进作用。由于 IE 内置 Java Runtime，使得在 IE 浏览器中开发 Java 程序变得更加简单。如出名的 Java Applet（Java 小程序）开发。\n\n后来因为 Sun 跟 微软之间诉讼等事情，这个合作也没多久，现在 IE 已经默认禁用了 Java Applet。\n\n说道 **Java Runtime（简称 JRE）** ，曾经在一开始开发 Java 程序时，经常把 JRE 跟 JDK 搞混。\n\nJRE 是一个独立的东西，就是 Java 程序的运行环境，其中包含一个 JAVA 虚拟机（JVM）以及一些标准的函数类库。\n\n而 JDK 是 Sun 公司专门给开发人员准备的 Java 开发工具集。它其中就包含了 JRE，所以配置好 JDK，自然就可以在电脑上运行 Java 程序了。除此之外，JDK 还包含了源码、API 文档、编译工具等等。","slug":"什么是运行时-Runtime","published":1,"updated":"2020-10-21T03:15:43.970Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmws002i3ys24qhx5sec","content":"<h3 id=\"什么是运行时（Runtime）\"><a href=\"#什么是运行时（Runtime）\" class=\"headerlink\" title=\"什么是运行时（Runtime）\"></a>什么是运行时（Runtime）</h3><p>任何语言要运行都需要自己的运行时，Java 程序的运行时叫 Java Runtime，Android 程序的运行时叫 Android Runtime，而具体 Runtime 是个什么东西呢，<br>就是说一个程序要在一个硬件或者平台上跑，就必须要有一个中间层用来把程序语言转换为机器能听懂的机器语言。</p>\n<p>Java Runtime 的左右就是如此，如我们编写好了 Java 的 Hello World 程序.</p>\n<pre class=\"line-numbers language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HelloWorld</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span>  <span class=\"token function\">main</span><span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        System<span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hello world\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>代码我们认识，作用就是输出一个 “hello world”，但是要在一个冷冰冰的机器上，让机器能读懂并运行这段代码，就需要一个 Java 语言的运行时环境，只有这个环境才能读懂它，并能让代码更机器进行打交道。</p>\n<p>到这里我们已经明白，<strong>如果一个电脑要能运行 Java 程序就必须安装有 Java Runtime</strong>。对于其他语言也是如此，要在平台上运行就必须要有对应平台上的 Runtime 组件，这也是开发一个新语言必须要做的事。</p>\n<p>说道 Runtime，在 Java 发展的过程中，Java 一下子火了有一个很重要原因，就是在 90 年代，微软的 IE 浏览器为了打败网景浏览器，曾经就在 IE 中默认安装 Java 运行时，再加上 IE 浏览器内置在 Windows 操作系统中，使得 IE 装机量特别大，同样这对 Java 也是一个非常大的促进作用。由于 IE 内置 Java Runtime，使得在 IE 浏览器中开发 Java 程序变得更加简单。如出名的 Java Applet（Java 小程序）开发。</p>\n<p>后来因为 Sun 跟 微软之间诉讼等事情，这个合作也没多久，现在 IE 已经默认禁用了 Java Applet。</p>\n<p>说道 <strong>Java Runtime（简称 JRE）</strong> ，曾经在一开始开发 Java 程序时，经常把 JRE 跟 JDK 搞混。</p>\n<p>JRE 是一个独立的东西，就是 Java 程序的运行环境，其中包含一个 JAVA 虚拟机（JVM）以及一些标准的函数类库。</p>\n<p>而 JDK 是 Sun 公司专门给开发人员准备的 Java 开发工具集。它其中就包含了 JRE，所以配置好 JDK，自然就可以在电脑上运行 Java 程序了。除此之外，JDK 还包含了源码、API 文档、编译工具等等。</p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"什么是运行时（Runtime）\"><a href=\"#什么是运行时（Runtime）\" class=\"headerlink\" title=\"什么是运行时（Runtime）\"></a>什么是运行时（Runtime）</h3><p>任何语言要运行都需要自己的运行时，Java 程序的运行时叫 Java Runtime，Android 程序的运行时叫 Android Runtime，而具体 Runtime 是个什么东西呢，<br>就是说一个程序要在一个硬件或者平台上跑，就必须要有一个中间层用来把程序语言转换为机器能听懂的机器语言。</p>\n<p>Java Runtime 的左右就是如此，如我们编写好了 Java 的 Hello World 程序.</p>\n<pre><code class=\"java\">public class HelloWorld&#123;\n    public static void  main(String[] args)&#123;\n        System.out.println(&quot;hello world&quot;);\n    &#125;\n&#125;</code></pre>\n<p>代码我们认识，作用就是输出一个 “hello world”，但是要在一个冷冰冰的机器上，让机器能读懂并运行这段代码，就需要一个 Java 语言的运行时环境，只有这个环境才能读懂它，并能让代码更机器进行打交道。</p>\n<p>到这里我们已经明白，<strong>如果一个电脑要能运行 Java 程序就必须安装有 Java Runtime</strong>。对于其他语言也是如此，要在平台上运行就必须要有对应平台上的 Runtime 组件，这也是开发一个新语言必须要做的事。</p>\n<p>说道 Runtime，在 Java 发展的过程中，Java 一下子火了有一个很重要原因，就是在 90 年代，微软的 IE 浏览器为了打败网景浏览器，曾经就在 IE 中默认安装 Java 运行时，再加上 IE 浏览器内置在 Windows 操作系统中，使得 IE 装机量特别大，同样这对 Java 也是一个非常大的促进作用。由于 IE 内置 Java Runtime，使得在 IE 浏览器中开发 Java 程序变得更加简单。如出名的 Java Applet（Java 小程序）开发。</p>\n<p>后来因为 Sun 跟 微软之间诉讼等事情，这个合作也没多久，现在 IE 已经默认禁用了 Java Applet。</p>\n<p>说道 <strong>Java Runtime（简称 JRE）</strong> ，曾经在一开始开发 Java 程序时，经常把 JRE 跟 JDK 搞混。</p>\n<p>JRE 是一个独立的东西，就是 Java 程序的运行环境，其中包含一个 JAVA 虚拟机（JVM）以及一些标准的函数类库。</p>\n<p>而 JDK 是 Sun 公司专门给开发人员准备的 Java 开发工具集。它其中就包含了 JRE，所以配置好 JDK，自然就可以在电脑上运行 Java 程序了。除此之外，JDK 还包含了源码、API 文档、编译工具等等。</p>\n"},{"title":"在linux服务器上安装Ruby_On_Rails","date":"2021-02-02T10:21:58.000Z","_content":"\n#### 在linux服务器上安装Ruby On Rails\n\n##### 1、安装rbenv\n\n先安装git\n\n```\n# mac\nbrew install git\n# centos\nyum install git\n# ubuntu\napt-get install git\n```\n\n然后安装rbenv\n\n```\n# 安装rbenv到~/.rbenv目录\ngit clone git://github.com/sstephenson/rbenv.git ~/.rbenv\n```\n\n下面安装一下rbenv的插件\n\n```\n# 用来编译安装 ruby\ngit clone git://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build\n\n# 用来管理 gemset, 可选, 因为有 bundler 也没什么必要\ngit clone git://github.com/jamis/rbenv-gemset.git  ~/.rbenv/plugins/rbenv-gemset\n\n# 通过 gem 命令安装完 gem 后无需手动输入 rbenv rehash 命令, 推荐\ngit clone git://github.com/sstephenson/rbenv-gem-rehash.git ~/.rbenv/plugins/rbenv-gem-rehash\n\n# 通过 rbenv update 命令来更新 rbenv 以及所有插件, 推荐\ngit clone git://github.com/rkh/rbenv-update.git ~/.rbenv/plugins/rbenv-update\n\n# 使用 Ruby China 的镜像安装 Ruby, 国内用户推荐\ngit clone git://github.com/AndorChen/rbenv-china-mirror.git ~/.rbenv/plugins/rbenv-china-mirror\n```\n\n然后需要将下面两句代码放在bash的配置文件中：\n\n```\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\n```\n\nlinux是一般是放在~/.bashrc中，mac是放在~/.bash_profile中\n\n修改完成后，执行下面的命令使其生效\n\n```\n# linux\nsource ~/.bashrc\n# mac\nsource ~/.bash_profile\n```\n\n#### 2、安装ruby\n\nrbenv install --list  # 列出所有 ruby 版本\n\n例如安装2.7.2\n\n```\nrbenv install 2.7.2\n```\n\n设置使用的ruby版本, 有以下三种设置方式\n\n```\nrbenv global 2.3.3      # 默认使用2.3.3\nrbenv shell 2.3.3       # 当前的 shell 使用2.3.3, 会设置一个 `RBENV_VERSION` 环境变量\nrbenv local 2.3.3      # 当前目录使用2.3.3, 会生成一个 `.rbenv-version` 文件\n```\n\n#### 3. 安装rails\n\n设置ruby版本后，安装rails：\n\n```\n# 在当前的ruby版本中安装rails\ngem install rails\n```\n\n好了，这样就完成了rails的安装，rails已经可以使用了，但是为了更好的使用，请继续看后面的教程。\n\n### 配置RubyGems镜像\n\ngem是ruby管理依赖包的工具，而RubyGems的默认地址因为万恶的墙的关系很难访问到，因此需要配置RubyGems 镜像。这里使用的是[Ruby China](https://gems.ruby-china.com/)的镜像地址\n\n命令行输入\n\n```\ngem sources --add https://gems.ruby-china.com/ --remove https://rubygems.org/\n```\n\n可以通过下面这个命令查看设置的结果是不是https://gems.ruby-china.com：\n\n```\ngem sources -l\n```\n\n### 修改bundle的源地址\n\nbundler是rails管理gem依赖的工具，同样的，也需要修改其地址为ruby china的镜像\n\n命令行输入\n\n```\nbundle config mirror.https://rubygems.org https://gems.ruby-china.com\n```","source":"_posts/在linux服务器上安装Ruby-On-Rails.md","raw":"---\ntitle: 在linux服务器上安装Ruby_On_Rails\ndate: 2021-02-02 18:21:58\ncategories:\n- rails\ntags:\n- ruby\n- ubuntu\n---\n\n#### 在linux服务器上安装Ruby On Rails\n\n##### 1、安装rbenv\n\n先安装git\n\n```\n# mac\nbrew install git\n# centos\nyum install git\n# ubuntu\napt-get install git\n```\n\n然后安装rbenv\n\n```\n# 安装rbenv到~/.rbenv目录\ngit clone git://github.com/sstephenson/rbenv.git ~/.rbenv\n```\n\n下面安装一下rbenv的插件\n\n```\n# 用来编译安装 ruby\ngit clone git://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build\n\n# 用来管理 gemset, 可选, 因为有 bundler 也没什么必要\ngit clone git://github.com/jamis/rbenv-gemset.git  ~/.rbenv/plugins/rbenv-gemset\n\n# 通过 gem 命令安装完 gem 后无需手动输入 rbenv rehash 命令, 推荐\ngit clone git://github.com/sstephenson/rbenv-gem-rehash.git ~/.rbenv/plugins/rbenv-gem-rehash\n\n# 通过 rbenv update 命令来更新 rbenv 以及所有插件, 推荐\ngit clone git://github.com/rkh/rbenv-update.git ~/.rbenv/plugins/rbenv-update\n\n# 使用 Ruby China 的镜像安装 Ruby, 国内用户推荐\ngit clone git://github.com/AndorChen/rbenv-china-mirror.git ~/.rbenv/plugins/rbenv-china-mirror\n```\n\n然后需要将下面两句代码放在bash的配置文件中：\n\n```\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\n```\n\nlinux是一般是放在~/.bashrc中，mac是放在~/.bash_profile中\n\n修改完成后，执行下面的命令使其生效\n\n```\n# linux\nsource ~/.bashrc\n# mac\nsource ~/.bash_profile\n```\n\n#### 2、安装ruby\n\nrbenv install --list  # 列出所有 ruby 版本\n\n例如安装2.7.2\n\n```\nrbenv install 2.7.2\n```\n\n设置使用的ruby版本, 有以下三种设置方式\n\n```\nrbenv global 2.3.3      # 默认使用2.3.3\nrbenv shell 2.3.3       # 当前的 shell 使用2.3.3, 会设置一个 `RBENV_VERSION` 环境变量\nrbenv local 2.3.3      # 当前目录使用2.3.3, 会生成一个 `.rbenv-version` 文件\n```\n\n#### 3. 安装rails\n\n设置ruby版本后，安装rails：\n\n```\n# 在当前的ruby版本中安装rails\ngem install rails\n```\n\n好了，这样就完成了rails的安装，rails已经可以使用了，但是为了更好的使用，请继续看后面的教程。\n\n### 配置RubyGems镜像\n\ngem是ruby管理依赖包的工具，而RubyGems的默认地址因为万恶的墙的关系很难访问到，因此需要配置RubyGems 镜像。这里使用的是[Ruby China](https://gems.ruby-china.com/)的镜像地址\n\n命令行输入\n\n```\ngem sources --add https://gems.ruby-china.com/ --remove https://rubygems.org/\n```\n\n可以通过下面这个命令查看设置的结果是不是https://gems.ruby-china.com：\n\n```\ngem sources -l\n```\n\n### 修改bundle的源地址\n\nbundler是rails管理gem依赖的工具，同样的，也需要修改其地址为ruby china的镜像\n\n命令行输入\n\n```\nbundle config mirror.https://rubygems.org https://gems.ruby-china.com\n```","slug":"在linux服务器上安装Ruby-On-Rails","published":1,"updated":"2021-10-15T01:48:14.550Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwt002k3ys2d7sh1gxp","content":"<h4 id=\"在linux服务器上安装Ruby-On-Rails\"><a href=\"#在linux服务器上安装Ruby-On-Rails\" class=\"headerlink\" title=\"在linux服务器上安装Ruby On Rails\"></a>在linux服务器上安装Ruby On Rails</h4><h5 id=\"1、安装rbenv\"><a href=\"#1、安装rbenv\" class=\"headerlink\" title=\"1、安装rbenv\"></a>1、安装rbenv</h5><p>先安装git</p>\n<pre><code># mac\nbrew install git\n# centos\nyum install git\n# ubuntu\napt-get install git</code></pre>\n<p>然后安装rbenv</p>\n<pre><code># 安装rbenv到~/.rbenv目录\ngit clone git://github.com/sstephenson/rbenv.git ~/.rbenv</code></pre>\n<p>下面安装一下rbenv的插件</p>\n<pre><code># 用来编译安装 ruby\ngit clone git://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build\n\n# 用来管理 gemset, 可选, 因为有 bundler 也没什么必要\ngit clone git://github.com/jamis/rbenv-gemset.git  ~/.rbenv/plugins/rbenv-gemset\n\n# 通过 gem 命令安装完 gem 后无需手动输入 rbenv rehash 命令, 推荐\ngit clone git://github.com/sstephenson/rbenv-gem-rehash.git ~/.rbenv/plugins/rbenv-gem-rehash\n\n# 通过 rbenv update 命令来更新 rbenv 以及所有插件, 推荐\ngit clone git://github.com/rkh/rbenv-update.git ~/.rbenv/plugins/rbenv-update\n\n# 使用 Ruby China 的镜像安装 Ruby, 国内用户推荐\ngit clone git://github.com/AndorChen/rbenv-china-mirror.git ~/.rbenv/plugins/rbenv-china-mirror</code></pre>\n<p>然后需要将下面两句代码放在bash的配置文件中：</p>\n<pre><code>export PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"</code></pre>\n<p>linux是一般是放在<del>/.bashrc中，mac是放在</del>/.bash_profile中</p>\n<p>修改完成后，执行下面的命令使其生效</p>\n<pre><code># linux\nsource ~/.bashrc\n# mac\nsource ~/.bash_profile</code></pre>\n<h4 id=\"2、安装ruby\"><a href=\"#2、安装ruby\" class=\"headerlink\" title=\"2、安装ruby\"></a>2、安装ruby</h4><p>rbenv install –list  # 列出所有 ruby 版本</p>\n<p>例如安装2.7.2</p>\n<pre><code>rbenv install 2.7.2</code></pre>\n<p>设置使用的ruby版本, 有以下三种设置方式</p>\n<pre><code>rbenv global 2.3.3      # 默认使用2.3.3\nrbenv shell 2.3.3       # 当前的 shell 使用2.3.3, 会设置一个 `RBENV_VERSION` 环境变量\nrbenv local 2.3.3      # 当前目录使用2.3.3, 会生成一个 `.rbenv-version` 文件</code></pre>\n<h4 id=\"3-安装rails\"><a href=\"#3-安装rails\" class=\"headerlink\" title=\"3. 安装rails\"></a>3. 安装rails</h4><p>设置ruby版本后，安装rails：</p>\n<pre><code># 在当前的ruby版本中安装rails\ngem install rails</code></pre>\n<p>好了，这样就完成了rails的安装，rails已经可以使用了，但是为了更好的使用，请继续看后面的教程。</p>\n<h3 id=\"配置RubyGems镜像\"><a href=\"#配置RubyGems镜像\" class=\"headerlink\" title=\"配置RubyGems镜像\"></a>配置RubyGems镜像</h3><p>gem是ruby管理依赖包的工具，而RubyGems的默认地址因为万恶的墙的关系很难访问到，因此需要配置RubyGems 镜像。这里使用的是<a href=\"https://gems.ruby-china.com/\">Ruby China</a>的镜像地址</p>\n<p>命令行输入</p>\n<pre><code>gem sources --add https://gems.ruby-china.com/ --remove https://rubygems.org/</code></pre>\n<p>可以通过下面这个命令查看设置的结果是不是<a href=\"https://gems.ruby-china.com：\">https://gems.ruby-china.com：</a></p>\n<pre><code>gem sources -l</code></pre>\n<h3 id=\"修改bundle的源地址\"><a href=\"#修改bundle的源地址\" class=\"headerlink\" title=\"修改bundle的源地址\"></a>修改bundle的源地址</h3><p>bundler是rails管理gem依赖的工具，同样的，也需要修改其地址为ruby china的镜像</p>\n<p>命令行输入</p>\n<pre><code>bundle config mirror.https://rubygems.org https://gems.ruby-china.com</code></pre>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"在linux服务器上安装Ruby-On-Rails\"><a href=\"#在linux服务器上安装Ruby-On-Rails\" class=\"headerlink\" title=\"在linux服务器上安装Ruby On Rails\"></a>在linux服务器上安装Ruby On Rails</h4><h5 id=\"1、安装rbenv\"><a href=\"#1、安装rbenv\" class=\"headerlink\" title=\"1、安装rbenv\"></a>1、安装rbenv</h5><p>先安装git</p>\n<pre><code># mac\nbrew install git\n# centos\nyum install git\n# ubuntu\napt-get install git</code></pre>\n<p>然后安装rbenv</p>\n<pre><code># 安装rbenv到~/.rbenv目录\ngit clone git://github.com/sstephenson/rbenv.git ~/.rbenv</code></pre>\n<p>下面安装一下rbenv的插件</p>\n<pre><code># 用来编译安装 ruby\ngit clone git://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build\n\n# 用来管理 gemset, 可选, 因为有 bundler 也没什么必要\ngit clone git://github.com/jamis/rbenv-gemset.git  ~/.rbenv/plugins/rbenv-gemset\n\n# 通过 gem 命令安装完 gem 后无需手动输入 rbenv rehash 命令, 推荐\ngit clone git://github.com/sstephenson/rbenv-gem-rehash.git ~/.rbenv/plugins/rbenv-gem-rehash\n\n# 通过 rbenv update 命令来更新 rbenv 以及所有插件, 推荐\ngit clone git://github.com/rkh/rbenv-update.git ~/.rbenv/plugins/rbenv-update\n\n# 使用 Ruby China 的镜像安装 Ruby, 国内用户推荐\ngit clone git://github.com/AndorChen/rbenv-china-mirror.git ~/.rbenv/plugins/rbenv-china-mirror</code></pre>\n<p>然后需要将下面两句代码放在bash的配置文件中：</p>\n<pre><code>export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;\neval &quot;$(rbenv init -)&quot;</code></pre>\n<p>linux是一般是放在<del>/.bashrc中，mac是放在</del>/.bash_profile中</p>\n<p>修改完成后，执行下面的命令使其生效</p>\n<pre><code># linux\nsource ~/.bashrc\n# mac\nsource ~/.bash_profile</code></pre>\n<h4 id=\"2、安装ruby\"><a href=\"#2、安装ruby\" class=\"headerlink\" title=\"2、安装ruby\"></a>2、安装ruby</h4><p>rbenv install –list  # 列出所有 ruby 版本</p>\n<p>例如安装2.7.2</p>\n<pre><code>rbenv install 2.7.2</code></pre>\n<p>设置使用的ruby版本, 有以下三种设置方式</p>\n<pre><code>rbenv global 2.3.3      # 默认使用2.3.3\nrbenv shell 2.3.3       # 当前的 shell 使用2.3.3, 会设置一个 `RBENV_VERSION` 环境变量\nrbenv local 2.3.3      # 当前目录使用2.3.3, 会生成一个 `.rbenv-version` 文件</code></pre>\n<h4 id=\"3-安装rails\"><a href=\"#3-安装rails\" class=\"headerlink\" title=\"3. 安装rails\"></a>3. 安装rails</h4><p>设置ruby版本后，安装rails：</p>\n<pre><code># 在当前的ruby版本中安装rails\ngem install rails</code></pre>\n<p>好了，这样就完成了rails的安装，rails已经可以使用了，但是为了更好的使用，请继续看后面的教程。</p>\n<h3 id=\"配置RubyGems镜像\"><a href=\"#配置RubyGems镜像\" class=\"headerlink\" title=\"配置RubyGems镜像\"></a>配置RubyGems镜像</h3><p>gem是ruby管理依赖包的工具，而RubyGems的默认地址因为万恶的墙的关系很难访问到，因此需要配置RubyGems 镜像。这里使用的是<a href=\"https://gems.ruby-china.com/\">Ruby China</a>的镜像地址</p>\n<p>命令行输入</p>\n<pre><code>gem sources --add https://gems.ruby-china.com/ --remove https://rubygems.org/</code></pre>\n<p>可以通过下面这个命令查看设置的结果是不是<a href=\"https://gems.ruby-china.com：\">https://gems.ruby-china.com：</a></p>\n<pre><code>gem sources -l</code></pre>\n<h3 id=\"修改bundle的源地址\"><a href=\"#修改bundle的源地址\" class=\"headerlink\" title=\"修改bundle的源地址\"></a>修改bundle的源地址</h3><p>bundler是rails管理gem依赖的工具，同样的，也需要修改其地址为ruby china的镜像</p>\n<p>命令行输入</p>\n<pre><code>bundle config mirror.https://rubygems.org https://gems.ruby-china.com</code></pre>\n"},{"title":"常用命令","date":"2020-10-21T02:59:14.000Z","_content":"\n### 下面总结一下常用的命令\n\n* 1、Mac系统查看端口占用和杀死进程\n\n``` \nlsof -i tcp:8080\n```\n该命令会显示8080端口的占用情况，有pid，可以根据pid关掉该进程\n``` \nkill -9 pid号\n```\n* 2、\n","source":"_posts/常用命令.md","raw":"---\ntitle: 常用命令\ndate: 2020-10-21 10:59:14\ncategories:\n- Mac\ntags:\n- 常用命令\n- Linux\n- MacOs\n---\n\n### 下面总结一下常用的命令\n\n* 1、Mac系统查看端口占用和杀死进程\n\n``` \nlsof -i tcp:8080\n```\n该命令会显示8080端口的占用情况，有pid，可以根据pid关掉该进程\n``` \nkill -9 pid号\n```\n* 2、\n","slug":"常用命令","published":1,"updated":"2020-10-21T03:15:43.978Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmwz002p3ys26wlfctui","content":"<h3 id=\"下面总结一下常用的命令\"><a href=\"#下面总结一下常用的命令\" class=\"headerlink\" title=\"下面总结一下常用的命令\"></a>下面总结一下常用的命令</h3><ul>\n<li>1、Mac系统查看端口占用和杀死进程</li>\n</ul>\n<pre><code>lsof -i tcp:8080</code></pre>\n<p>该命令会显示8080端口的占用情况，有pid，可以根据pid关掉该进程</p>\n<pre><code>kill -9 pid号</code></pre>\n<ul>\n<li>2、</li>\n</ul>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"下面总结一下常用的命令\"><a href=\"#下面总结一下常用的命令\" class=\"headerlink\" title=\"下面总结一下常用的命令\"></a>下面总结一下常用的命令</h3><ul>\n<li>1、Mac系统查看端口占用和杀死进程</li>\n</ul>\n<pre><code>lsof -i tcp:8080</code></pre>\n<p>该命令会显示8080端口的占用情况，有pid，可以根据pid关掉该进程</p>\n<pre><code>kill -9 pid号</code></pre>\n<ul>\n<li>2、</li>\n</ul>\n"},{"title":"在linux服务器上安装vim","date":"2020-12-08T08:56:02.000Z","_content":"\n#### 在Linux服务器上 安装 vim 及 vundle ( install vim and vundle)\n\n##### 1、 直接下载 [这个文件](http://siwei.me/system/resources/W1siZiIsIjIwMTQvMTAvMjEvMDlfNTdfMDdfODA3X2RvdF92aW1fZm9sZGVyLnppcCJdXQ/dot_vim_folder.zip) ,  并且解压,成为 home目录下的 .vim 即可.\n\n##### 2、 下载  [vimrc](http://siwei.me/system/resources/BAhbBlsHOgZmSSIjMjAxNC8wMS8xOS8wNV81MV8zOF82NjVfLnZpbXJjBjoGRVQ/.vimrc), 保存到 home目录下。 \n\n\n接下来使用scp 命令将下载的两个文件传到Linux服务器上\n\n```\nscp ~/Downloads/dot_vim_folder.zip ubuntu@85.136.62.11:~\nscp ~/Downloads/vimrc ubuntu@85.136.62.11:~\n```\n\n传上去后进入到Linux服务器 这个 ~ 目录 \n\n```\ncd ~\nunzip dot_vim_folder.zip\n``` \n\n然后将vimrc文件重命令一下 改为.vimrc 就好了\n\n```\nmv vimrc .vimrc\n```\n\n#### .conf文件代码不高亮  这里做一下配置 按照下面的命令进行配置就行\n\n```\n#!/bin/bash\n#\n# Highligh Nginx config file in Vim\n\n# Download syntax highlight\nmkdir -p ~/.vim/syntax/\nwget http://www.vim.org/scripts/download_script.php?src_id=19394 -O ~/.vim/syntax/nginx.vim\n\n# Set location of Nginx config file\ncat > ~/.vim/filetype.vim <<EOF\nau BufRead,BufNewFile /etc/nginx/*,/etc/nginx/conf.d/*,/usr/local/nginx/conf/* if &ft == '' | setfiletype nginx | endif\nEOF\n```","source":"_posts/在linux服务器上安装vim.md","raw":"---\ntitle: 在linux服务器上安装vim\ndate: 2020-12-08 16:56:02\ncategories:\n- Linux\ntags:\n- Vim\n- Linux\n---\n\n#### 在Linux服务器上 安装 vim 及 vundle ( install vim and vundle)\n\n##### 1、 直接下载 [这个文件](http://siwei.me/system/resources/W1siZiIsIjIwMTQvMTAvMjEvMDlfNTdfMDdfODA3X2RvdF92aW1fZm9sZGVyLnppcCJdXQ/dot_vim_folder.zip) ,  并且解压,成为 home目录下的 .vim 即可.\n\n##### 2、 下载  [vimrc](http://siwei.me/system/resources/BAhbBlsHOgZmSSIjMjAxNC8wMS8xOS8wNV81MV8zOF82NjVfLnZpbXJjBjoGRVQ/.vimrc), 保存到 home目录下。 \n\n\n接下来使用scp 命令将下载的两个文件传到Linux服务器上\n\n```\nscp ~/Downloads/dot_vim_folder.zip ubuntu@85.136.62.11:~\nscp ~/Downloads/vimrc ubuntu@85.136.62.11:~\n```\n\n传上去后进入到Linux服务器 这个 ~ 目录 \n\n```\ncd ~\nunzip dot_vim_folder.zip\n``` \n\n然后将vimrc文件重命令一下 改为.vimrc 就好了\n\n```\nmv vimrc .vimrc\n```\n\n#### .conf文件代码不高亮  这里做一下配置 按照下面的命令进行配置就行\n\n```\n#!/bin/bash\n#\n# Highligh Nginx config file in Vim\n\n# Download syntax highlight\nmkdir -p ~/.vim/syntax/\nwget http://www.vim.org/scripts/download_script.php?src_id=19394 -O ~/.vim/syntax/nginx.vim\n\n# Set location of Nginx config file\ncat > ~/.vim/filetype.vim <<EOF\nau BufRead,BufNewFile /etc/nginx/*,/etc/nginx/conf.d/*,/usr/local/nginx/conf/* if &ft == '' | setfiletype nginx | endif\nEOF\n```","slug":"在linux服务器上安装vim","published":1,"updated":"2021-03-26T09:56:29.078Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmx0002r3ys26t9ahkqy","content":"<h4 id=\"在Linux服务器上-安装-vim-及-vundle-install-vim-and-vundle\"><a href=\"#在Linux服务器上-安装-vim-及-vundle-install-vim-and-vundle\" class=\"headerlink\" title=\"在Linux服务器上 安装 vim 及 vundle ( install vim and vundle)\"></a>在Linux服务器上 安装 vim 及 vundle ( install vim and vundle)</h4><h5 id=\"1、-直接下载-这个文件-并且解压-成为-home目录下的-vim-即可\"><a href=\"#1、-直接下载-这个文件-并且解压-成为-home目录下的-vim-即可\" class=\"headerlink\" title=\"1、 直接下载 这个文件 ,  并且解压,成为 home目录下的 .vim 即可.\"></a>1、 直接下载 <a href=\"http://siwei.me/system/resources/W1siZiIsIjIwMTQvMTAvMjEvMDlfNTdfMDdfODA3X2RvdF92aW1fZm9sZGVyLnppcCJdXQ/dot_vim_folder.zip\">这个文件</a> ,  并且解压,成为 home目录下的 .vim 即可.</h5><h5 id=\"2、-下载-vimrc-保存到-home目录下。\"><a href=\"#2、-下载-vimrc-保存到-home目录下。\" class=\"headerlink\" title=\"2、 下载  vimrc, 保存到 home目录下。\"></a>2、 下载  <a href=\"http://siwei.me/system/resources/BAhbBlsHOgZmSSIjMjAxNC8wMS8xOS8wNV81MV8zOF82NjVfLnZpbXJjBjoGRVQ/.vimrc\">vimrc</a>, 保存到 home目录下。</h5><p>接下来使用scp 命令将下载的两个文件传到Linux服务器上</p>\n<pre><code>scp ~/Downloads/dot_vim_folder.zip ubuntu@85.136.62.11:~\nscp ~/Downloads/vimrc ubuntu@85.136.62.11:~</code></pre>\n<p>传上去后进入到Linux服务器 这个 ~ 目录 </p>\n<pre><code>cd ~\nunzip dot_vim_folder.zip</code></pre>\n<p>然后将vimrc文件重命令一下 改为.vimrc 就好了</p>\n<pre><code>mv vimrc .vimrc</code></pre>\n<h4 id=\"conf文件代码不高亮-这里做一下配置-按照下面的命令进行配置就行\"><a href=\"#conf文件代码不高亮-这里做一下配置-按照下面的命令进行配置就行\" class=\"headerlink\" title=\".conf文件代码不高亮  这里做一下配置 按照下面的命令进行配置就行\"></a>.conf文件代码不高亮  这里做一下配置 按照下面的命令进行配置就行</h4><pre><code>#!/bin/bash\n#\n# Highligh Nginx config file in Vim\n\n# Download syntax highlight\nmkdir -p ~/.vim/syntax/\nwget http://www.vim.org/scripts/download_script.php?src_id=19394 -O ~/.vim/syntax/nginx.vim\n\n# Set location of Nginx config file\ncat &gt; ~/.vim/filetype.vim &lt;&lt;EOF\nau BufRead,BufNewFile /etc/nginx/*,/etc/nginx/conf.d/*,/usr/local/nginx/conf/* if &amp;ft == '' | setfiletype nginx | endif\nEOF</code></pre>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"在Linux服务器上-安装-vim-及-vundle-install-vim-and-vundle\"><a href=\"#在Linux服务器上-安装-vim-及-vundle-install-vim-and-vundle\" class=\"headerlink\" title=\"在Linux服务器上 安装 vim 及 vundle ( install vim and vundle)\"></a>在Linux服务器上 安装 vim 及 vundle ( install vim and vundle)</h4><h5 id=\"1、-直接下载-这个文件-并且解压-成为-home目录下的-vim-即可\"><a href=\"#1、-直接下载-这个文件-并且解压-成为-home目录下的-vim-即可\" class=\"headerlink\" title=\"1、 直接下载 这个文件 ,  并且解压,成为 home目录下的 .vim 即可.\"></a>1、 直接下载 <a href=\"http://siwei.me/system/resources/W1siZiIsIjIwMTQvMTAvMjEvMDlfNTdfMDdfODA3X2RvdF92aW1fZm9sZGVyLnppcCJdXQ/dot_vim_folder.zip\">这个文件</a> ,  并且解压,成为 home目录下的 .vim 即可.</h5><h5 id=\"2、-下载-vimrc-保存到-home目录下。\"><a href=\"#2、-下载-vimrc-保存到-home目录下。\" class=\"headerlink\" title=\"2、 下载  vimrc, 保存到 home目录下。\"></a>2、 下载  <a href=\"http://siwei.me/system/resources/BAhbBlsHOgZmSSIjMjAxNC8wMS8xOS8wNV81MV8zOF82NjVfLnZpbXJjBjoGRVQ/.vimrc\">vimrc</a>, 保存到 home目录下。</h5><p>接下来使用scp 命令将下载的两个文件传到Linux服务器上</p>\n<pre><code>scp ~/Downloads/dot_vim_folder.zip ubuntu@85.136.62.11:~\nscp ~/Downloads/vimrc ubuntu@85.136.62.11:~</code></pre>\n<p>传上去后进入到Linux服务器 这个 ~ 目录 </p>\n<pre><code>cd ~\nunzip dot_vim_folder.zip</code></pre>\n<p>然后将vimrc文件重命令一下 改为.vimrc 就好了</p>\n<pre><code>mv vimrc .vimrc</code></pre>\n<h4 id=\"conf文件代码不高亮-这里做一下配置-按照下面的命令进行配置就行\"><a href=\"#conf文件代码不高亮-这里做一下配置-按照下面的命令进行配置就行\" class=\"headerlink\" title=\".conf文件代码不高亮  这里做一下配置 按照下面的命令进行配置就行\"></a>.conf文件代码不高亮  这里做一下配置 按照下面的命令进行配置就行</h4><pre><code>#!/bin/bash\n#\n# Highligh Nginx config file in Vim\n\n# Download syntax highlight\nmkdir -p ~/.vim/syntax/\nwget http://www.vim.org/scripts/download_script.php?src_id=19394 -O ~/.vim/syntax/nginx.vim\n\n# Set location of Nginx config file\ncat &gt; ~/.vim/filetype.vim &lt;&lt;EOF\nau BufRead,BufNewFile /etc/nginx/*,/etc/nginx/conf.d/*,/usr/local/nginx/conf/* if &amp;ft == &#39;&#39; | setfiletype nginx | endif\nEOF</code></pre>\n"},{"title":"搭建服务器ubuntu系统","date":"2020-12-30T07:59:35.000Z","_content":"\n#### 购买完服务器后应该做哪些配置\n\n##### 一 、安装apache\n\n```\nsudo apt-get install apche2 apche2-doc\n```\n\n如果你已经安装完了nginx，你需要安装一个这个东西，当你在浏览器地址栏输入服务器公网ip的时候就会出现一个nginx的默认页面 就像这样的\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201230160621.png)\n\n##### 二、安装mysql\n\n```\nsudo apt-get install mysql-server mysql-client\n```\n\n在安装mysql的时候可能会提醒设置root账户密码\n\n#####  三、更改默认python版本：\n\n修改软连接\n\n1、进入到usr/bin目录下\n\n```\ncd /usr/bin\n```\n\n2、查看该目录下与python有关的项\n\n```\nls -altrh | grep python\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201230174310.png)\n\n3、删除软连接并指向新的版本\n\n```\nsudo rm python\nsudo ln -s python3.6 python\n```\n\n4、最后结果\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201230174848.png)\n\n\n\n\n","source":"_posts/搭建服务器ubuntu系统.md","raw":"---\ntitle: 搭建服务器ubuntu系统\ndate: 2020-12-30 15:59:35\ncategories:\n- Linux\ntags:\n- ubuntu\n- 服务器搭建\n---\n\n#### 购买完服务器后应该做哪些配置\n\n##### 一 、安装apache\n\n```\nsudo apt-get install apche2 apche2-doc\n```\n\n如果你已经安装完了nginx，你需要安装一个这个东西，当你在浏览器地址栏输入服务器公网ip的时候就会出现一个nginx的默认页面 就像这样的\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201230160621.png)\n\n##### 二、安装mysql\n\n```\nsudo apt-get install mysql-server mysql-client\n```\n\n在安装mysql的时候可能会提醒设置root账户密码\n\n#####  三、更改默认python版本：\n\n修改软连接\n\n1、进入到usr/bin目录下\n\n```\ncd /usr/bin\n```\n\n2、查看该目录下与python有关的项\n\n```\nls -altrh | grep python\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201230174310.png)\n\n3、删除软连接并指向新的版本\n\n```\nsudo rm python\nsudo ln -s python3.6 python\n```\n\n4、最后结果\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201230174848.png)\n\n\n\n\n","slug":"搭建服务器ubuntu系统","published":1,"updated":"2020-12-30T10:07:45.957Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmx1002v3ys2c1c00swh","content":"<h4 id=\"购买完服务器后应该做哪些配置\"><a href=\"#购买完服务器后应该做哪些配置\" class=\"headerlink\" title=\"购买完服务器后应该做哪些配置\"></a>购买完服务器后应该做哪些配置</h4><h5 id=\"一-、安装apache\"><a href=\"#一-、安装apache\" class=\"headerlink\" title=\"一 、安装apache\"></a>一 、安装apache</h5><pre><code>sudo apt-get install apche2 apche2-doc</code></pre>\n<p>如果你已经安装完了nginx，你需要安装一个这个东西，当你在浏览器地址栏输入服务器公网ip的时候就会出现一个nginx的默认页面 就像这样的</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201230160621.png\"></p>\n<h5 id=\"二、安装mysql\"><a href=\"#二、安装mysql\" class=\"headerlink\" title=\"二、安装mysql\"></a>二、安装mysql</h5><pre><code>sudo apt-get install mysql-server mysql-client</code></pre>\n<p>在安装mysql的时候可能会提醒设置root账户密码</p>\n<h5 id=\"三、更改默认python版本：\"><a href=\"#三、更改默认python版本：\" class=\"headerlink\" title=\"三、更改默认python版本：\"></a>三、更改默认python版本：</h5><p>修改软连接</p>\n<p>1、进入到usr/bin目录下</p>\n<pre><code>cd /usr/bin</code></pre>\n<p>2、查看该目录下与python有关的项</p>\n<pre><code>ls -altrh | grep python</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201230174310.png\"></p>\n<p>3、删除软连接并指向新的版本</p>\n<pre><code>sudo rm python\nsudo ln -s python3.6 python</code></pre>\n<p>4、最后结果</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201230174848.png\"></p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"购买完服务器后应该做哪些配置\"><a href=\"#购买完服务器后应该做哪些配置\" class=\"headerlink\" title=\"购买完服务器后应该做哪些配置\"></a>购买完服务器后应该做哪些配置</h4><h5 id=\"一-、安装apache\"><a href=\"#一-、安装apache\" class=\"headerlink\" title=\"一 、安装apache\"></a>一 、安装apache</h5><pre><code>sudo apt-get install apche2 apche2-doc</code></pre>\n<p>如果你已经安装完了nginx，你需要安装一个这个东西，当你在浏览器地址栏输入服务器公网ip的时候就会出现一个nginx的默认页面 就像这样的</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201230160621.png\"></p>\n<h5 id=\"二、安装mysql\"><a href=\"#二、安装mysql\" class=\"headerlink\" title=\"二、安装mysql\"></a>二、安装mysql</h5><pre><code>sudo apt-get install mysql-server mysql-client</code></pre>\n<p>在安装mysql的时候可能会提醒设置root账户密码</p>\n<h5 id=\"三、更改默认python版本：\"><a href=\"#三、更改默认python版本：\" class=\"headerlink\" title=\"三、更改默认python版本：\"></a>三、更改默认python版本：</h5><p>修改软连接</p>\n<p>1、进入到usr/bin目录下</p>\n<pre><code>cd /usr/bin</code></pre>\n<p>2、查看该目录下与python有关的项</p>\n<pre><code>ls -altrh | grep python</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201230174310.png\"></p>\n<p>3、删除软连接并指向新的版本</p>\n<pre><code>sudo rm python\nsudo ln -s python3.6 python</code></pre>\n<p>4、最后结果</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201230174848.png\"></p>\n"},{"title":"服务器安装oh_my_zsh","date":"2021-03-29T01:58:30.000Z","_content":"\n### 给自己的服务器安装 oh my zsh\n\n#### 1、安装zsh\n\n`oh my zsh` 需要先安装`zsh` 所以如果你没有装`zsh`的话需要先装一下\n\n\n```\ncd ~\nsudo apt install zsh\n```\n\n### 2、安装git\n\n需要安装`git`因为在装`oh my zsh`的时候会去clone它的仓库，所以需要装个`git`\n\n```\nsudo apt install git\n```\n\n### 3、安装`oh my zsh`\n\n这个过程中可能会出现无法连接github的问题，我之前的博客也有解决方案 可以搜一下关键字 `解决服务器连不上github的问题`\n\n```\nsh -c \"$(wget -O- https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\"\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210329100744.png)\n\n\n在安装的过程中会问你是否设为默认终端 选择`y`就行了\n\n\n### 4、更换主题\n\n```\ncd ~\nsudo vim .zshrc\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210329101040.png)\n\n这里去改一下主题名称，保存并退出  然后 `source .zshrc` 就可以了\n\n\n\n\n\n\n\n","source":"_posts/服务器安装oh-my-zsh.md","raw":"---\ntitle: 服务器安装oh_my_zsh\ndate: 2021-03-29 09:58:30\ncategories:\n- oh my zsh\ntags:\n- linux\n- ubuntu\n---\n\n### 给自己的服务器安装 oh my zsh\n\n#### 1、安装zsh\n\n`oh my zsh` 需要先安装`zsh` 所以如果你没有装`zsh`的话需要先装一下\n\n\n```\ncd ~\nsudo apt install zsh\n```\n\n### 2、安装git\n\n需要安装`git`因为在装`oh my zsh`的时候会去clone它的仓库，所以需要装个`git`\n\n```\nsudo apt install git\n```\n\n### 3、安装`oh my zsh`\n\n这个过程中可能会出现无法连接github的问题，我之前的博客也有解决方案 可以搜一下关键字 `解决服务器连不上github的问题`\n\n```\nsh -c \"$(wget -O- https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\"\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210329100744.png)\n\n\n在安装的过程中会问你是否设为默认终端 选择`y`就行了\n\n\n### 4、更换主题\n\n```\ncd ~\nsudo vim .zshrc\n```\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210329101040.png)\n\n这里去改一下主题名称，保存并退出  然后 `source .zshrc` 就可以了\n\n\n\n\n\n\n\n","slug":"服务器安装oh-my-zsh","published":1,"updated":"2021-03-29T02:12:22.479Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmx2002w3ys24jns29gt","content":"<h3 id=\"给自己的服务器安装-oh-my-zsh\"><a href=\"#给自己的服务器安装-oh-my-zsh\" class=\"headerlink\" title=\"给自己的服务器安装 oh my zsh\"></a>给自己的服务器安装 oh my zsh</h3><h4 id=\"1、安装zsh\"><a href=\"#1、安装zsh\" class=\"headerlink\" title=\"1、安装zsh\"></a>1、安装zsh</h4><p><code>oh my zsh</code> 需要先安装<code>zsh</code> 所以如果你没有装<code>zsh</code>的话需要先装一下</p>\n<pre><code>cd ~\nsudo apt install zsh</code></pre>\n<h3 id=\"2、安装git\"><a href=\"#2、安装git\" class=\"headerlink\" title=\"2、安装git\"></a>2、安装git</h3><p>需要安装<code>git</code>因为在装<code>oh my zsh</code>的时候会去clone它的仓库，所以需要装个<code>git</code></p>\n<pre><code>sudo apt install git</code></pre>\n<h3 id=\"3、安装oh-my-zsh\"><a href=\"#3、安装oh-my-zsh\" class=\"headerlink\" title=\"3、安装oh my zsh\"></a>3、安装<code>oh my zsh</code></h3><p>这个过程中可能会出现无法连接github的问题，我之前的博客也有解决方案 可以搜一下关键字 <code>解决服务器连不上github的问题</code></p>\n<pre><code>sh -c \"$(wget -O- https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\"</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210329100744.png\"></p>\n<p>在安装的过程中会问你是否设为默认终端 选择<code>y</code>就行了</p>\n<h3 id=\"4、更换主题\"><a href=\"#4、更换主题\" class=\"headerlink\" title=\"4、更换主题\"></a>4、更换主题</h3><pre><code>cd ~\nsudo vim .zshrc</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210329101040.png\"></p>\n<p>这里去改一下主题名称，保存并退出  然后 <code>source .zshrc</code> 就可以了</p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"给自己的服务器安装-oh-my-zsh\"><a href=\"#给自己的服务器安装-oh-my-zsh\" class=\"headerlink\" title=\"给自己的服务器安装 oh my zsh\"></a>给自己的服务器安装 oh my zsh</h3><h4 id=\"1、安装zsh\"><a href=\"#1、安装zsh\" class=\"headerlink\" title=\"1、安装zsh\"></a>1、安装zsh</h4><p><code>oh my zsh</code> 需要先安装<code>zsh</code> 所以如果你没有装<code>zsh</code>的话需要先装一下</p>\n<pre><code>cd ~\nsudo apt install zsh</code></pre>\n<h3 id=\"2、安装git\"><a href=\"#2、安装git\" class=\"headerlink\" title=\"2、安装git\"></a>2、安装git</h3><p>需要安装<code>git</code>因为在装<code>oh my zsh</code>的时候会去clone它的仓库，所以需要装个<code>git</code></p>\n<pre><code>sudo apt install git</code></pre>\n<h3 id=\"3、安装oh-my-zsh\"><a href=\"#3、安装oh-my-zsh\" class=\"headerlink\" title=\"3、安装oh my zsh\"></a>3、安装<code>oh my zsh</code></h3><p>这个过程中可能会出现无法连接github的问题，我之前的博客也有解决方案 可以搜一下关键字 <code>解决服务器连不上github的问题</code></p>\n<pre><code>sh -c &quot;$(wget -O- https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&quot;</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210329100744.png\"></p>\n<p>在安装的过程中会问你是否设为默认终端 选择<code>y</code>就行了</p>\n<h3 id=\"4、更换主题\"><a href=\"#4、更换主题\" class=\"headerlink\" title=\"4、更换主题\"></a>4、更换主题</h3><pre><code>cd ~\nsudo vim .zshrc</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210329101040.png\"></p>\n<p>这里去改一下主题名称，保存并退出  然后 <code>source .zshrc</code> 就可以了</p>\n"},{"title":"给Linux安装nginx","date":"2020-12-09T06:25:33.000Z","_content":"\n#### 给Linux(ubuntu)服务器安装nginx\n\n##### 1：检查80端口是否被占用。\n##### 2：安装nginx\n\n给nginx配置安装目录,就是nginx存放的目录\n\n我一般安装软件都是安装在/usr/local下面的\n\n```\nmkdir /usr/local/nginx\n```\n\n进入nginx目录`cd /usr/local/nginx`\n\n使用wget命令下载nginx资源包\n\n```\nwget http://nginx.org/download/nginx-1.12.2.tar.gz\n```\n\n解压\n\n```yaml\ntar -zxvf nginx-1.5.9.tar.gz\n```\n\n\n执行` ./configure命令`\n\n```\ncd nginx-1.5.9\nsudo ./configure\n```\n\n执行`./configure`可能会存在一下错误,如果出现请执行一下命令\n\n>错误1\n>\n>/configure: error: the HTTP rewrite module requires the PCRE library.\n\n解决方法\n\n安装pcre-devel解决问题\n\n```\nsudo apt-get update\nsudo apt-get install libpcre3 libpcre3-dev\n```\n\n>错误2\n>\n>./configure: error: the HTTP cache module requires md5 functions\nfrom OpenSSL library. You can either disable the module by using\n--without-http-cache option, or install the OpenSSL library into the system,\nor build the OpenSSL library statically from the source with nginx by using\n>--with-http_ssl_module --with-openssl=<path> options.\n\n解决办法：\n\n```\nsudo apt-get install openssl libssl-dev\n```\n\n>错误3 （如果出现这种检查不通过，则说明缺少某些依赖。）\n>\n> ubuntu@VM-0-16-ubuntu:/usr/local/nginx/nginx-1.12.2$ sudo ./configure \n> checking for OS\n>\n> Linux 4.15.0-118-generic x86_64\n> checking for C compiler ... not found\n>\n> ./configure: error: C compiler cc is not found\n\n解决办法：\n\n```yaml\nsudo apt-get install build-essential\n```\n\n>错误4\n>\n>error: the HTTP gzip module requires the zlib library.\n\n解决办法：\n\n```\napt-get install zlib1g-dev\n```\n\n\n然后在执行` ./configure命令`\n\n```\ncd nginx-1.5.9\nsudo ./configure\n```\n\n##### 3.编译\n\n`make` 编译 （make的过程是把各种语言写的源码文件，变成可执行文件和各种库文件）\n\n```\ncd /usr/local/nginx/nginx-1.5.9\nsudo make\n```\n\n##### 4.make install安装\n\n`make install` 安装 （`make install`是把这些编译出来的可执行文件和库文件复制到合适的地方）\n\n```\nsudo make install\n```\n\n##### 5.启动nginx服务\n\n```\ncd /usr/local/nginx/sbin\nsudo ./nginx\n```\n##### 6.看nginx服务是否启动\n\n```\nubuntu@VM-0-16-ubuntu:/usr/local/nginx/sbin$ ps -ef | grep nginx\nroot      7183     1  0 14:53 ?        00:00:00 nginx: master process ./nginx\nnobody    7184  7183  0 14:53 ?        00:00:00 nginx: worker process\nubuntu    7252 23084  0 14:53 pts/1    00:00:00 grep --color=auto nginx\n```\n\n我们看到服务已经起来了,输入ip即可访问我们nginx目录下面的html文件夹下面的index.html文件\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201209145642.png)\n\n===================华丽的分割线======================\n\n`nginx -s reload `：修改配置后重新加载生效\n\n`nginx -s reopen` ：重新打开日志文件\n\n关闭nginx：\n\n`nginx -s stop` :快速停止nginx\n\n`quit `：完整有序的停止nginx\n","source":"_posts/给Linux安装nginx.md","raw":"---\ntitle: 给Linux安装nginx\ndate: 2020-12-09 14:25:33\ncategories:\n- nginx\ntags:\n- nginx\n- linux\n- ubuntu\n---\n\n#### 给Linux(ubuntu)服务器安装nginx\n\n##### 1：检查80端口是否被占用。\n##### 2：安装nginx\n\n给nginx配置安装目录,就是nginx存放的目录\n\n我一般安装软件都是安装在/usr/local下面的\n\n```\nmkdir /usr/local/nginx\n```\n\n进入nginx目录`cd /usr/local/nginx`\n\n使用wget命令下载nginx资源包\n\n```\nwget http://nginx.org/download/nginx-1.12.2.tar.gz\n```\n\n解压\n\n```yaml\ntar -zxvf nginx-1.5.9.tar.gz\n```\n\n\n执行` ./configure命令`\n\n```\ncd nginx-1.5.9\nsudo ./configure\n```\n\n执行`./configure`可能会存在一下错误,如果出现请执行一下命令\n\n>错误1\n>\n>/configure: error: the HTTP rewrite module requires the PCRE library.\n\n解决方法\n\n安装pcre-devel解决问题\n\n```\nsudo apt-get update\nsudo apt-get install libpcre3 libpcre3-dev\n```\n\n>错误2\n>\n>./configure: error: the HTTP cache module requires md5 functions\nfrom OpenSSL library. You can either disable the module by using\n--without-http-cache option, or install the OpenSSL library into the system,\nor build the OpenSSL library statically from the source with nginx by using\n>--with-http_ssl_module --with-openssl=<path> options.\n\n解决办法：\n\n```\nsudo apt-get install openssl libssl-dev\n```\n\n>错误3 （如果出现这种检查不通过，则说明缺少某些依赖。）\n>\n> ubuntu@VM-0-16-ubuntu:/usr/local/nginx/nginx-1.12.2$ sudo ./configure \n> checking for OS\n>\n> Linux 4.15.0-118-generic x86_64\n> checking for C compiler ... not found\n>\n> ./configure: error: C compiler cc is not found\n\n解决办法：\n\n```yaml\nsudo apt-get install build-essential\n```\n\n>错误4\n>\n>error: the HTTP gzip module requires the zlib library.\n\n解决办法：\n\n```\napt-get install zlib1g-dev\n```\n\n\n然后在执行` ./configure命令`\n\n```\ncd nginx-1.5.9\nsudo ./configure\n```\n\n##### 3.编译\n\n`make` 编译 （make的过程是把各种语言写的源码文件，变成可执行文件和各种库文件）\n\n```\ncd /usr/local/nginx/nginx-1.5.9\nsudo make\n```\n\n##### 4.make install安装\n\n`make install` 安装 （`make install`是把这些编译出来的可执行文件和库文件复制到合适的地方）\n\n```\nsudo make install\n```\n\n##### 5.启动nginx服务\n\n```\ncd /usr/local/nginx/sbin\nsudo ./nginx\n```\n##### 6.看nginx服务是否启动\n\n```\nubuntu@VM-0-16-ubuntu:/usr/local/nginx/sbin$ ps -ef | grep nginx\nroot      7183     1  0 14:53 ?        00:00:00 nginx: master process ./nginx\nnobody    7184  7183  0 14:53 ?        00:00:00 nginx: worker process\nubuntu    7252 23084  0 14:53 pts/1    00:00:00 grep --color=auto nginx\n```\n\n我们看到服务已经起来了,输入ip即可访问我们nginx目录下面的html文件夹下面的index.html文件\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201209145642.png)\n\n===================华丽的分割线======================\n\n`nginx -s reload `：修改配置后重新加载生效\n\n`nginx -s reopen` ：重新打开日志文件\n\n关闭nginx：\n\n`nginx -s stop` :快速停止nginx\n\n`quit `：完整有序的停止nginx\n","slug":"给Linux安装nginx","published":1,"updated":"2020-12-09T06:59:14.719Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmx2002z3ys25ai5buo6","content":"<h4 id=\"给Linux-ubuntu-服务器安装nginx\"><a href=\"#给Linux-ubuntu-服务器安装nginx\" class=\"headerlink\" title=\"给Linux(ubuntu)服务器安装nginx\"></a>给Linux(ubuntu)服务器安装nginx</h4><h5 id=\"1：检查80端口是否被占用。\"><a href=\"#1：检查80端口是否被占用。\" class=\"headerlink\" title=\"1：检查80端口是否被占用。\"></a>1：检查80端口是否被占用。</h5><h5 id=\"2：安装nginx\"><a href=\"#2：安装nginx\" class=\"headerlink\" title=\"2：安装nginx\"></a>2：安装nginx</h5><p>给nginx配置安装目录,就是nginx存放的目录</p>\n<p>我一般安装软件都是安装在/usr/local下面的</p>\n<pre><code>mkdir /usr/local/nginx</code></pre>\n<p>进入nginx目录<code>cd /usr/local/nginx</code></p>\n<p>使用wget命令下载nginx资源包</p>\n<pre><code>wget http://nginx.org/download/nginx-1.12.2.tar.gz</code></pre>\n<p>解压</p>\n<pre class=\"line-numbers language-yaml\"><code class=\"language-yaml\">tar <span class=\"token punctuation\">-</span>zxvf nginx<span class=\"token punctuation\">-</span>1.5.9.tar.gz<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>执行<code> ./configure命令</code></p>\n<pre><code>cd nginx-1.5.9\nsudo ./configure</code></pre>\n<p>执行<code>./configure</code>可能会存在一下错误,如果出现请执行一下命令</p>\n<blockquote>\n<p>错误1</p>\n<p>/configure: error: the HTTP rewrite module requires the PCRE library.</p>\n</blockquote>\n<p>解决方法</p>\n<p>安装pcre-devel解决问题</p>\n<pre><code>sudo apt-get update\nsudo apt-get install libpcre3 libpcre3-dev</code></pre>\n<blockquote>\n<p>错误2</p>\n<p>./configure: error: the HTTP cache module requires md5 functions<br>from OpenSSL library. You can either disable the module by using<br>–without-http-cache option, or install the OpenSSL library into the system,<br>or build the OpenSSL library statically from the source with nginx by using<br>–with-http_ssl_module –with-openssl=<path> options.</path></p>\n</blockquote>\n<p>解决办法：</p>\n<pre><code>sudo apt-get install openssl libssl-dev</code></pre>\n<blockquote>\n<p>错误3 （如果出现这种检查不通过，则说明缺少某些依赖。）</p>\n<p>ubuntu@VM-0-16-ubuntu:/usr/local/nginx/nginx-1.12.2$ sudo ./configure<br>checking for OS</p>\n<p>Linux 4.15.0-118-generic x86_64<br>checking for C compiler … not found</p>\n<p>./configure: error: C compiler cc is not found</p>\n</blockquote>\n<p>解决办法：</p>\n<pre class=\"line-numbers language-yaml\"><code class=\"language-yaml\">sudo apt<span class=\"token punctuation\">-</span>get install build<span class=\"token punctuation\">-</span>essential<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<blockquote>\n<p>错误4</p>\n<p>error: the HTTP gzip module requires the zlib library.</p>\n</blockquote>\n<p>解决办法：</p>\n<pre><code>apt-get install zlib1g-dev</code></pre>\n<p>然后在执行<code> ./configure命令</code></p>\n<pre><code>cd nginx-1.5.9\nsudo ./configure</code></pre>\n<h5 id=\"3-编译\"><a href=\"#3-编译\" class=\"headerlink\" title=\"3.编译\"></a>3.编译</h5><p><code>make</code> 编译 （make的过程是把各种语言写的源码文件，变成可执行文件和各种库文件）</p>\n<pre><code>cd /usr/local/nginx/nginx-1.5.9\nsudo make</code></pre>\n<h5 id=\"4-make-install安装\"><a href=\"#4-make-install安装\" class=\"headerlink\" title=\"4.make install安装\"></a>4.make install安装</h5><p><code>make install</code> 安装 （<code>make install</code>是把这些编译出来的可执行文件和库文件复制到合适的地方）</p>\n<pre><code>sudo make install</code></pre>\n<h5 id=\"5-启动nginx服务\"><a href=\"#5-启动nginx服务\" class=\"headerlink\" title=\"5.启动nginx服务\"></a>5.启动nginx服务</h5><pre><code>cd /usr/local/nginx/sbin\nsudo ./nginx</code></pre>\n<h5 id=\"6-看nginx服务是否启动\"><a href=\"#6-看nginx服务是否启动\" class=\"headerlink\" title=\"6.看nginx服务是否启动\"></a>6.看nginx服务是否启动</h5><pre><code>ubuntu@VM-0-16-ubuntu:/usr/local/nginx/sbin$ ps -ef | grep nginx\nroot      7183     1  0 14:53 ?        00:00:00 nginx: master process ./nginx\nnobody    7184  7183  0 14:53 ?        00:00:00 nginx: worker process\nubuntu    7252 23084  0 14:53 pts/1    00:00:00 grep --color=auto nginx</code></pre>\n<p>我们看到服务已经起来了,输入ip即可访问我们nginx目录下面的html文件夹下面的index.html文件</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201209145642.png\"></p>\n<p>===================华丽的分割线======================</p>\n<p><code>nginx -s reload </code>：修改配置后重新加载生效</p>\n<p><code>nginx -s reopen</code> ：重新打开日志文件</p>\n<p>关闭nginx：</p>\n<p><code>nginx -s stop</code> :快速停止nginx</p>\n<p><code>quit </code>：完整有序的停止nginx</p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"给Linux-ubuntu-服务器安装nginx\"><a href=\"#给Linux-ubuntu-服务器安装nginx\" class=\"headerlink\" title=\"给Linux(ubuntu)服务器安装nginx\"></a>给Linux(ubuntu)服务器安装nginx</h4><h5 id=\"1：检查80端口是否被占用。\"><a href=\"#1：检查80端口是否被占用。\" class=\"headerlink\" title=\"1：检查80端口是否被占用。\"></a>1：检查80端口是否被占用。</h5><h5 id=\"2：安装nginx\"><a href=\"#2：安装nginx\" class=\"headerlink\" title=\"2：安装nginx\"></a>2：安装nginx</h5><p>给nginx配置安装目录,就是nginx存放的目录</p>\n<p>我一般安装软件都是安装在/usr/local下面的</p>\n<pre><code>mkdir /usr/local/nginx</code></pre>\n<p>进入nginx目录<code>cd /usr/local/nginx</code></p>\n<p>使用wget命令下载nginx资源包</p>\n<pre><code>wget http://nginx.org/download/nginx-1.12.2.tar.gz</code></pre>\n<p>解压</p>\n<pre><code class=\"yaml\">tar -zxvf nginx-1.5.9.tar.gz</code></pre>\n<p>执行<code> ./configure命令</code></p>\n<pre><code>cd nginx-1.5.9\nsudo ./configure</code></pre>\n<p>执行<code>./configure</code>可能会存在一下错误,如果出现请执行一下命令</p>\n<blockquote>\n<p>错误1</p>\n<p>/configure: error: the HTTP rewrite module requires the PCRE library.</p>\n</blockquote>\n<p>解决方法</p>\n<p>安装pcre-devel解决问题</p>\n<pre><code>sudo apt-get update\nsudo apt-get install libpcre3 libpcre3-dev</code></pre>\n<blockquote>\n<p>错误2</p>\n<p>./configure: error: the HTTP cache module requires md5 functions<br>from OpenSSL library. You can either disable the module by using<br>–without-http-cache option, or install the OpenSSL library into the system,<br>or build the OpenSSL library statically from the source with nginx by using<br>–with-http_ssl_module –with-openssl=<path> options.</p>\n</blockquote>\n<p>解决办法：</p>\n<pre><code>sudo apt-get install openssl libssl-dev</code></pre>\n<blockquote>\n<p>错误3 （如果出现这种检查不通过，则说明缺少某些依赖。）</p>\n<p>ubuntu@VM-0-16-ubuntu:/usr/local/nginx/nginx-1.12.2$ sudo ./configure<br>checking for OS</p>\n<p>Linux 4.15.0-118-generic x86_64<br>checking for C compiler … not found</p>\n<p>./configure: error: C compiler cc is not found</p>\n</blockquote>\n<p>解决办法：</p>\n<pre><code class=\"yaml\">sudo apt-get install build-essential</code></pre>\n<blockquote>\n<p>错误4</p>\n<p>error: the HTTP gzip module requires the zlib library.</p>\n</blockquote>\n<p>解决办法：</p>\n<pre><code>apt-get install zlib1g-dev</code></pre>\n<p>然后在执行<code> ./configure命令</code></p>\n<pre><code>cd nginx-1.5.9\nsudo ./configure</code></pre>\n<h5 id=\"3-编译\"><a href=\"#3-编译\" class=\"headerlink\" title=\"3.编译\"></a>3.编译</h5><p><code>make</code> 编译 （make的过程是把各种语言写的源码文件，变成可执行文件和各种库文件）</p>\n<pre><code>cd /usr/local/nginx/nginx-1.5.9\nsudo make</code></pre>\n<h5 id=\"4-make-install安装\"><a href=\"#4-make-install安装\" class=\"headerlink\" title=\"4.make install安装\"></a>4.make install安装</h5><p><code>make install</code> 安装 （<code>make install</code>是把这些编译出来的可执行文件和库文件复制到合适的地方）</p>\n<pre><code>sudo make install</code></pre>\n<h5 id=\"5-启动nginx服务\"><a href=\"#5-启动nginx服务\" class=\"headerlink\" title=\"5.启动nginx服务\"></a>5.启动nginx服务</h5><pre><code>cd /usr/local/nginx/sbin\nsudo ./nginx</code></pre>\n<h5 id=\"6-看nginx服务是否启动\"><a href=\"#6-看nginx服务是否启动\" class=\"headerlink\" title=\"6.看nginx服务是否启动\"></a>6.看nginx服务是否启动</h5><pre><code>ubuntu@VM-0-16-ubuntu:/usr/local/nginx/sbin$ ps -ef | grep nginx\nroot      7183     1  0 14:53 ?        00:00:00 nginx: master process ./nginx\nnobody    7184  7183  0 14:53 ?        00:00:00 nginx: worker process\nubuntu    7252 23084  0 14:53 pts/1    00:00:00 grep --color=auto nginx</code></pre>\n<p>我们看到服务已经起来了,输入ip即可访问我们nginx目录下面的html文件夹下面的index.html文件</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201209145642.png\"></p>\n<p>===================华丽的分割线======================</p>\n<p><code>nginx -s reload </code>：修改配置后重新加载生效</p>\n<p><code>nginx -s reopen</code> ：重新打开日志文件</p>\n<p>关闭nginx：</p>\n<p><code>nginx -s stop</code> :快速停止nginx</p>\n<p><code>quit </code>：完整有序的停止nginx</p>\n"},{"title":"给Linux服务器设置登录提示","date":"2020-12-08T10:06:02.000Z","_content":"\n##### 1、给Linux设置登录提示\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201208180823.png)\n\n```\nsudo vim /etc/motd\n```\n\n然后把你想要的内用拷贝进去 退出服务器,重新登录就可以看到了\n\n```\n< Hi, How are you >\n -----------------\n        \\   ^__^\n         \\  (oo)\\_______\n            (__)\\       )\\/\\\n                ||----w |\n                ||     ||  \n\n```\n\n##### 2、给Linux设置彩色界面\n\n##### 查看当前终端支持集中颜色\n\n使用`tput colors`命令即可查看当前终端支持几种颜色\n\n##### 查看当前终端类型\n\n`$TERM`变量代表当前终端类型，可使用`echo $TERM`命令查看。\n\n##### 输出当前支持的颜色\n\n运行以下命令，若输出了完整的256种颜色，就说明当前终端支持256色：\n\n```\n(x=`tput op` y=`printf %76s`;for i in {0..256};do o=00$i;echo -e ${o:${#o}-3:3} `tput setaf $i;tput setab $i`${y// /=}$x;done)\n```\n\n若只有前8种颜色，说明当前配置是8色模式，默认情况下，Ubuntu中的Gnome-Terminal就只开启了8色支持。此时可通过修改`~/.bashrc`文件将其改为256色，在`.bashrc`文件最后中加入以下代码即可：\n\n```\nexport TERM=vte-256color\n```\n\n如果没有`.bashrc`文件 可以选择`sudo vim .bashrc` 创建一个 也可以使用`sudo cp /etc/skel/.bashrc ./` 命令拷贝到home目录下\n\n最后输入命令source ~/.bashrc，一定要输入，不然配置文件无法生效(虽然source了但是退出登录进来后有没有了颜色)\n\n##### 解决.bashrc文件每次打开终端都需要source的问题\n\n`sudo vim ~/.bash_profile`在文件内部输入\n\n```\n# 加载.bashrc文件\nif test -f .bashrc ; then\nsource .bashrc \nfi\n```\n","source":"_posts/给Linux服务器设置登录提示.md","raw":"---\ntitle: 给Linux服务器设置登录提示\ndate: 2020-12-08 18:06:02\ncategories:\n- Linux\ntags:\n- Linux\n---\n\n##### 1、给Linux设置登录提示\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201208180823.png)\n\n```\nsudo vim /etc/motd\n```\n\n然后把你想要的内用拷贝进去 退出服务器,重新登录就可以看到了\n\n```\n< Hi, How are you >\n -----------------\n        \\   ^__^\n         \\  (oo)\\_______\n            (__)\\       )\\/\\\n                ||----w |\n                ||     ||  \n\n```\n\n##### 2、给Linux设置彩色界面\n\n##### 查看当前终端支持集中颜色\n\n使用`tput colors`命令即可查看当前终端支持几种颜色\n\n##### 查看当前终端类型\n\n`$TERM`变量代表当前终端类型，可使用`echo $TERM`命令查看。\n\n##### 输出当前支持的颜色\n\n运行以下命令，若输出了完整的256种颜色，就说明当前终端支持256色：\n\n```\n(x=`tput op` y=`printf %76s`;for i in {0..256};do o=00$i;echo -e ${o:${#o}-3:3} `tput setaf $i;tput setab $i`${y// /=}$x;done)\n```\n\n若只有前8种颜色，说明当前配置是8色模式，默认情况下，Ubuntu中的Gnome-Terminal就只开启了8色支持。此时可通过修改`~/.bashrc`文件将其改为256色，在`.bashrc`文件最后中加入以下代码即可：\n\n```\nexport TERM=vte-256color\n```\n\n如果没有`.bashrc`文件 可以选择`sudo vim .bashrc` 创建一个 也可以使用`sudo cp /etc/skel/.bashrc ./` 命令拷贝到home目录下\n\n最后输入命令source ~/.bashrc，一定要输入，不然配置文件无法生效(虽然source了但是退出登录进来后有没有了颜色)\n\n##### 解决.bashrc文件每次打开终端都需要source的问题\n\n`sudo vim ~/.bash_profile`在文件内部输入\n\n```\n# 加载.bashrc文件\nif test -f .bashrc ; then\nsource .bashrc \nfi\n```\n","slug":"给Linux服务器设置登录提示","published":1,"updated":"2020-12-08T10:52:52.700Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmx300323ys2afvkh8kt","content":"<h5 id=\"1、给Linux设置登录提示\"><a href=\"#1、给Linux设置登录提示\" class=\"headerlink\" title=\"1、给Linux设置登录提示\"></a>1、给Linux设置登录提示</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201208180823.png\"></p>\n<pre><code>sudo vim /etc/motd</code></pre>\n<p>然后把你想要的内用拷贝进去 退出服务器,重新登录就可以看到了</p>\n<pre><code>&lt; Hi, How are you &gt;\n -----------------\n        \\   ^__^\n         \\  (oo)\\_______\n            (__)\\       )\\/\\\n                ||----w |\n                ||     ||  \n</code></pre>\n<h5 id=\"2、给Linux设置彩色界面\"><a href=\"#2、给Linux设置彩色界面\" class=\"headerlink\" title=\"2、给Linux设置彩色界面\"></a>2、给Linux设置彩色界面</h5><h5 id=\"查看当前终端支持集中颜色\"><a href=\"#查看当前终端支持集中颜色\" class=\"headerlink\" title=\"查看当前终端支持集中颜色\"></a>查看当前终端支持集中颜色</h5><p>使用<code>tput colors</code>命令即可查看当前终端支持几种颜色</p>\n<h5 id=\"查看当前终端类型\"><a href=\"#查看当前终端类型\" class=\"headerlink\" title=\"查看当前终端类型\"></a>查看当前终端类型</h5><p><code>$TERM</code>变量代表当前终端类型，可使用<code>echo $TERM</code>命令查看。</p>\n<h5 id=\"输出当前支持的颜色\"><a href=\"#输出当前支持的颜色\" class=\"headerlink\" title=\"输出当前支持的颜色\"></a>输出当前支持的颜色</h5><p>运行以下命令，若输出了完整的256种颜色，就说明当前终端支持256色：</p>\n<pre><code>(x=`tput op` y=`printf %76s`;for i in {0..256};do o=00$i;echo -e ${o:${#o}-3:3} `tput setaf $i;tput setab $i`${y// /=}$x;done)</code></pre>\n<p>若只有前8种颜色，说明当前配置是8色模式，默认情况下，Ubuntu中的Gnome-Terminal就只开启了8色支持。此时可通过修改<code>~/.bashrc</code>文件将其改为256色，在<code>.bashrc</code>文件最后中加入以下代码即可：</p>\n<pre><code>export TERM=vte-256color</code></pre>\n<p>如果没有<code>.bashrc</code>文件 可以选择<code>sudo vim .bashrc</code> 创建一个 也可以使用<code>sudo cp /etc/skel/.bashrc ./</code> 命令拷贝到home目录下</p>\n<p>最后输入命令source ~/.bashrc，一定要输入，不然配置文件无法生效(虽然source了但是退出登录进来后有没有了颜色)</p>\n<h5 id=\"解决-bashrc文件每次打开终端都需要source的问题\"><a href=\"#解决-bashrc文件每次打开终端都需要source的问题\" class=\"headerlink\" title=\"解决.bashrc文件每次打开终端都需要source的问题\"></a>解决.bashrc文件每次打开终端都需要source的问题</h5><p><code>sudo vim ~/.bash_profile</code>在文件内部输入</p>\n<pre><code># 加载.bashrc文件\nif test -f .bashrc ; then\nsource .bashrc \nfi</code></pre>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h5 id=\"1、给Linux设置登录提示\"><a href=\"#1、给Linux设置登录提示\" class=\"headerlink\" title=\"1、给Linux设置登录提示\"></a>1、给Linux设置登录提示</h5><p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20201208180823.png\"></p>\n<pre><code>sudo vim /etc/motd</code></pre>\n<p>然后把你想要的内用拷贝进去 退出服务器,重新登录就可以看到了</p>\n<pre><code>&lt; Hi, How are you &gt;\n -----------------\n        \\   ^__^\n         \\  (oo)\\_______\n            (__)\\       )\\/\\\n                ||----w |\n                ||     ||  \n</code></pre>\n<h5 id=\"2、给Linux设置彩色界面\"><a href=\"#2、给Linux设置彩色界面\" class=\"headerlink\" title=\"2、给Linux设置彩色界面\"></a>2、给Linux设置彩色界面</h5><h5 id=\"查看当前终端支持集中颜色\"><a href=\"#查看当前终端支持集中颜色\" class=\"headerlink\" title=\"查看当前终端支持集中颜色\"></a>查看当前终端支持集中颜色</h5><p>使用<code>tput colors</code>命令即可查看当前终端支持几种颜色</p>\n<h5 id=\"查看当前终端类型\"><a href=\"#查看当前终端类型\" class=\"headerlink\" title=\"查看当前终端类型\"></a>查看当前终端类型</h5><p><code>$TERM</code>变量代表当前终端类型，可使用<code>echo $TERM</code>命令查看。</p>\n<h5 id=\"输出当前支持的颜色\"><a href=\"#输出当前支持的颜色\" class=\"headerlink\" title=\"输出当前支持的颜色\"></a>输出当前支持的颜色</h5><p>运行以下命令，若输出了完整的256种颜色，就说明当前终端支持256色：</p>\n<pre><code>(x=`tput op` y=`printf %76s`;for i in &#123;0..256&#125;;do o=00$i;echo -e $&#123;o:$&#123;#o&#125;-3:3&#125; `tput setaf $i;tput setab $i`$&#123;y// /=&#125;$x;done)</code></pre>\n<p>若只有前8种颜色，说明当前配置是8色模式，默认情况下，Ubuntu中的Gnome-Terminal就只开启了8色支持。此时可通过修改<code>~/.bashrc</code>文件将其改为256色，在<code>.bashrc</code>文件最后中加入以下代码即可：</p>\n<pre><code>export TERM=vte-256color</code></pre>\n<p>如果没有<code>.bashrc</code>文件 可以选择<code>sudo vim .bashrc</code> 创建一个 也可以使用<code>sudo cp /etc/skel/.bashrc ./</code> 命令拷贝到home目录下</p>\n<p>最后输入命令source ~/.bashrc，一定要输入，不然配置文件无法生效(虽然source了但是退出登录进来后有没有了颜色)</p>\n<h5 id=\"解决-bashrc文件每次打开终端都需要source的问题\"><a href=\"#解决-bashrc文件每次打开终端都需要source的问题\" class=\"headerlink\" title=\"解决.bashrc文件每次打开终端都需要source的问题\"></a>解决.bashrc文件每次打开终端都需要source的问题</h5><p><code>sudo vim ~/.bash_profile</code>在文件内部输入</p>\n<pre><code># 加载.bashrc文件\nif test -f .bashrc ; then\nsource .bashrc \nfi</code></pre>\n"},{"title":"给服务器设置ssh免密码登录","date":"2020-12-09T01:25:02.000Z","_content":"\n\n#### 给服务器设置ssh免密码登录\n\n#### SSH是什么？\n\n> SSH 为 Secure Shell 的缩写，由IETF的网络工作小组（Network Working Group）所制定；SSH为建立在应用层和传输层基础上的安全协议。\nSSH是目前较可靠，专为远程登录会话和其他网络服务提供安全性的协议。利用SSH协议可以有效防止远程管理过程中的信息泄露问题。\nSSH最初是UNIX系统上的一个程序，后来又迅速扩展到其他操作平台。SSH在正确使用时可弥补网络中的漏洞。SSH客户端适用于多种平台。\n几乎所有UNIX平台—包括HP-UX、Linux、AIX、Solaris、Digital UNIX、Irix，以及其他平台，都可运行SSH。\n\n* 简单来理解，就是我拥有一台服务器，我现在想要登录上去做一些事情，那就得使用ssh登录到远程的服务器上，才能在上面进行操作。\n\n#### SSH 服务端以及客户端配置\n\n##### 启动 sshd 服务\n\n>一开始在远程服务器上面，需要查看一下他的sshd服务启动了没有，如果没有启动，任何客户端主机是连接不上来的，一般如果是自己在云厂商处购买了主机，主机启动的时候就会把sshd服务启动起来。但有可能自己在测试环境搭建机器的时候，是没有默认启动的，这时候就需要在测试机器的终端看一下，命令如下\n\n```\nubuntu@VM-0-16-ubuntu:~$ ps -ef | grep sshd\nroot      1221     1  0 Dec07 ?        00:00:00 /usr/sbin/sshd -D\nroot     15649  1221  0 09:21 ?        00:00:00 sshd: ubuntu [priv]\nubuntu   15740 15649  0 09:21 ?        00:00:00 sshd: ubuntu@pts/0\nubuntu   24863 15741  0 10:24 pts/0    00:00:00 grep --color=auto sshd\n```\n\n>这里看到第一行,sshd已经启动起来了,进程号是 1221\n\n* 如果没有启动的话,那就启动一下,命令如下\n\n```\nubuntu@VM-0-16-ubuntu:~$ service sshd start\n```\n\n#### 登录服务器主机的方式\n\n#### 1、客户端使用密码的方式登录目标主机\n\n```\n➜  ~ ssh root@192.168.0.187\nroot@192.168.0.187's password:\n```\n输入密码即可\n\n#### 2、客户端使用密钥方式登录目标主机(免密码)\n\n>使用场景：\n>\n>1、如果某个运维人员临时需要登录一台机器，但是机器的管理员并不想把密码暴露给他，所以会让这个运维人员发一个自己的公钥给自己，帮他添加进去，这个运维人员就可以顺利的登录机器了。在运维做完了自己的事情之后，机器的管理员会把他从公钥列表中删掉，这样一来整个过程，密码没有暴露，运维也在这段时间内登上了机器，很完美。\n>\n>2、因为自己懒，不想敲密码,想直接使用自己在电脑上配置的ssh_xxx来登录\n\n#### 使用ssh-keygen生成密匙对\n\n```\n➜  ~ cd .ssh \n➜  .ssh \n➜  .ssh ssh-keygen -t rsa\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/Users/zhaochao/.ssh/id_rsa): id_rsa\nEnter passphrase (empty for no passphrase):\n```\n\n回车以后，询问是否要输入一个密码来保护这个密匙，为了方便起见，我就不输入了，不然每次使用这个密匙文件还要输一遍密码,直接一路回车就ok\n\n到了这里，可以看到我们已经创建好了密匙对\n\n```\n➜  .ssh ls\nid_rsa      id_rsa.pub  known_hosts\n```\n我们可以使用`cat`命令来获取这个id_rsa.pub\n\n```\n➜  .ssh cat id_rsa.pub \nssh-rsa AAAAB3NDzaC1yc2EAFADAADAQFcPFT++P8rOkltuIGDSle45yEyDXtDGcCVcHmHAa8TH3/1G+cGusuvREewaJWdxS95fopdi7iumedN+bOJsCIyDsskuLJtt9FaT1MlEg8C3DH+VTkVTKadOYtFF0cwSediRadqjhMQqTOq6gH1g6zTkr4eGEIPp5RaPFDLZmeGiOeYvIS+d8eIdpHckO90KWL0T0bOcjifHlle+5ia0tSo4ZP5ekp0CxTlu0McorQIU7C1cjW/Iz5xQHpYFOdkKYImQob0H0bletwGY8K4A48ioEG9bfiBwbhmCrt93SGcp40G4e6KsuqLMe+5JUqqRcOg7TqvmD/FnftFbjDz2VTGJ/WlEJ4P3HXvAR8CdKPc/DJMmTV3oxwlmdgtDLFpqW7BkydkF2wSkO1+QP4p5ua3Ned7VLlNb16JKafBXD59q1yhwtsvhDxcgmk0tL5O3H4KPCHMZ6tePcWF2wPf+K/zLqV5DF2KXjat+PMveQf6NWAP+KK2jlG8AyV2+BBTI4nC5TdRZMXGmnVOvoc/eGbBB0NohoxZbFnjIVmpLUJcXrUXmXPojjauXQ0z37Ve/uOarVCkDTMimL+GZ4HrOx2s7FR1XM0cpw== 123456@qq.com\n```\n\n#### 将公钥文件放进authorized_keys中\n\n目标主机上如果没有.ssh文件夹，就自己创建一个，创建好之后,再创建一个authorized_keys文件。如果有的话就不用了。\n\n```\nroot@wzt-dev2-PC:~/.ssh# ll\ntotal 8\ndrwxr-xr-x  2 root root 4096 7月  17 19:49 ./\ndrwx------ 10 root root 4096 7月  17 19:49 ../\n-rw-r--r--  1 root root    0 7月  17 19:49 authorized_keys\n```\n\n```\nvim authorized_keys\n```\n\n将刚才的id_rsa.pub的内容放进去保存一下就可以\n\n#### 这里需要注意\n\n>authorized_keys 文件对权限有哟求，必须是600(-rw——-)或者644\n.ssh目录 必须是700(drwx——),否则一会儿登录不成功\n弄完之后检查一下权限，如果不是的话，改成响应的权限就ok了\n\n#### 准备就绪，在客户端上登录目标主机\n\n在登录之前，要确认一下目标主机是否允许密匙对登录，一般都是打开的，如果没有打开就自己打开\n\n>(查看 /etc/ssh/sshd_config 文件内容 中的 PubkeyAuthentication 这一项是否为 yes,如果不是就自己修改成yes之后重启sshd服务 )\n>\n\n```\nwzy@wzt-dev2-PC:~$ cat /etc/ssh/sshd_config\n# Package generated configuration file\n# See the sshd_config(5) manpage for details\n\n# What ports, IPs and protocols we listen for\nPort 22\n# Use these options to restrict which interfaces/protocols sshd will bind to\n#ListenAddress ::\n#ListenAddress 0.0.0.0\nProtocol 2\n# HostKeys for protocol version 2\nHostKey /etc/ssh/ssh_host_rsa_key\nHostKey /etc/ssh/ssh_host_dsa_key\nHostKey /etc/ssh/ssh_host_ecdsa_key\nHostKey /etc/ssh/ssh_host_ed25519_key\n#Privilege Separation is turned on for security\nUsePrivilegeSeparation yes\n\n# Lifetime and size of ephemeral version 1 server key\nKeyRegenerationInterval 3600\nServerKeyBits 1024\n\n# Logging\nSyslogFacility AUTH\nLogLevel INFO\n\n# Authentication:\nLoginGraceTime 120\nPermitRootLogin yes\nStrictModes yes\n\nRSAAuthentication yes\nPubkeyAuthentication yes   <---------------  在这里\n#AuthorizedKeysFile %h/.ssh/authorized_keys\n\n```\n\n到此我们就配置完了。 (不用输入密码就可以登录了)\n\n```\n➜  ~ ./ssh_my_tencent \nWelcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-118-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Wed Dec  9 10:45:26 CST 2020\n\n  System load:  0.0               Processes:           89\n  Usage of /:   5.0% of 49.15GB   Users logged in:     0\n  Memory usage: 12%               IP address for eth0: 172.21.0.16\n  Swap usage:   0%\n\n * Introducing self-healing high availability clusters in MicroK8s.\n   Simple, hardened, Kubernetes for production, from RaspberryPi to DC.\n\n     https://microk8s.io/high-availability\n\n * Canonical Livepatch is available for installation.\n   - Reduce system reboots and improve kernel security. Activate at:\n     https://ubuntu.com/livepatch\nNew release '20.04.1 LTS' available.\nRun 'do-release-upgrade' to upgrade to it.\n\n\n< Hi, How are you >\n -----------------\n        \\   ^__^\n         \\  (oo)\\_______\n            (__)\\       )\\/\\\n                ||----w |\n                ||     ||\nLast login: Wed Dec  9 09:21:16 2020 from 124.126.1.181\n```","source":"_posts/给服务器设置ssh免密码登录.md","raw":"---\ntitle: 给服务器设置ssh免密码登录\ndate: 2020-12-09 09:25:02\ncategories:\n- Linux\ntags:\n- SSH\n- Linux\n---\n\n\n#### 给服务器设置ssh免密码登录\n\n#### SSH是什么？\n\n> SSH 为 Secure Shell 的缩写，由IETF的网络工作小组（Network Working Group）所制定；SSH为建立在应用层和传输层基础上的安全协议。\nSSH是目前较可靠，专为远程登录会话和其他网络服务提供安全性的协议。利用SSH协议可以有效防止远程管理过程中的信息泄露问题。\nSSH最初是UNIX系统上的一个程序，后来又迅速扩展到其他操作平台。SSH在正确使用时可弥补网络中的漏洞。SSH客户端适用于多种平台。\n几乎所有UNIX平台—包括HP-UX、Linux、AIX、Solaris、Digital UNIX、Irix，以及其他平台，都可运行SSH。\n\n* 简单来理解，就是我拥有一台服务器，我现在想要登录上去做一些事情，那就得使用ssh登录到远程的服务器上，才能在上面进行操作。\n\n#### SSH 服务端以及客户端配置\n\n##### 启动 sshd 服务\n\n>一开始在远程服务器上面，需要查看一下他的sshd服务启动了没有，如果没有启动，任何客户端主机是连接不上来的，一般如果是自己在云厂商处购买了主机，主机启动的时候就会把sshd服务启动起来。但有可能自己在测试环境搭建机器的时候，是没有默认启动的，这时候就需要在测试机器的终端看一下，命令如下\n\n```\nubuntu@VM-0-16-ubuntu:~$ ps -ef | grep sshd\nroot      1221     1  0 Dec07 ?        00:00:00 /usr/sbin/sshd -D\nroot     15649  1221  0 09:21 ?        00:00:00 sshd: ubuntu [priv]\nubuntu   15740 15649  0 09:21 ?        00:00:00 sshd: ubuntu@pts/0\nubuntu   24863 15741  0 10:24 pts/0    00:00:00 grep --color=auto sshd\n```\n\n>这里看到第一行,sshd已经启动起来了,进程号是 1221\n\n* 如果没有启动的话,那就启动一下,命令如下\n\n```\nubuntu@VM-0-16-ubuntu:~$ service sshd start\n```\n\n#### 登录服务器主机的方式\n\n#### 1、客户端使用密码的方式登录目标主机\n\n```\n➜  ~ ssh root@192.168.0.187\nroot@192.168.0.187's password:\n```\n输入密码即可\n\n#### 2、客户端使用密钥方式登录目标主机(免密码)\n\n>使用场景：\n>\n>1、如果某个运维人员临时需要登录一台机器，但是机器的管理员并不想把密码暴露给他，所以会让这个运维人员发一个自己的公钥给自己，帮他添加进去，这个运维人员就可以顺利的登录机器了。在运维做完了自己的事情之后，机器的管理员会把他从公钥列表中删掉，这样一来整个过程，密码没有暴露，运维也在这段时间内登上了机器，很完美。\n>\n>2、因为自己懒，不想敲密码,想直接使用自己在电脑上配置的ssh_xxx来登录\n\n#### 使用ssh-keygen生成密匙对\n\n```\n➜  ~ cd .ssh \n➜  .ssh \n➜  .ssh ssh-keygen -t rsa\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/Users/zhaochao/.ssh/id_rsa): id_rsa\nEnter passphrase (empty for no passphrase):\n```\n\n回车以后，询问是否要输入一个密码来保护这个密匙，为了方便起见，我就不输入了，不然每次使用这个密匙文件还要输一遍密码,直接一路回车就ok\n\n到了这里，可以看到我们已经创建好了密匙对\n\n```\n➜  .ssh ls\nid_rsa      id_rsa.pub  known_hosts\n```\n我们可以使用`cat`命令来获取这个id_rsa.pub\n\n```\n➜  .ssh cat id_rsa.pub \nssh-rsa AAAAB3NDzaC1yc2EAFADAADAQFcPFT++P8rOkltuIGDSle45yEyDXtDGcCVcHmHAa8TH3/1G+cGusuvREewaJWdxS95fopdi7iumedN+bOJsCIyDsskuLJtt9FaT1MlEg8C3DH+VTkVTKadOYtFF0cwSediRadqjhMQqTOq6gH1g6zTkr4eGEIPp5RaPFDLZmeGiOeYvIS+d8eIdpHckO90KWL0T0bOcjifHlle+5ia0tSo4ZP5ekp0CxTlu0McorQIU7C1cjW/Iz5xQHpYFOdkKYImQob0H0bletwGY8K4A48ioEG9bfiBwbhmCrt93SGcp40G4e6KsuqLMe+5JUqqRcOg7TqvmD/FnftFbjDz2VTGJ/WlEJ4P3HXvAR8CdKPc/DJMmTV3oxwlmdgtDLFpqW7BkydkF2wSkO1+QP4p5ua3Ned7VLlNb16JKafBXD59q1yhwtsvhDxcgmk0tL5O3H4KPCHMZ6tePcWF2wPf+K/zLqV5DF2KXjat+PMveQf6NWAP+KK2jlG8AyV2+BBTI4nC5TdRZMXGmnVOvoc/eGbBB0NohoxZbFnjIVmpLUJcXrUXmXPojjauXQ0z37Ve/uOarVCkDTMimL+GZ4HrOx2s7FR1XM0cpw== 123456@qq.com\n```\n\n#### 将公钥文件放进authorized_keys中\n\n目标主机上如果没有.ssh文件夹，就自己创建一个，创建好之后,再创建一个authorized_keys文件。如果有的话就不用了。\n\n```\nroot@wzt-dev2-PC:~/.ssh# ll\ntotal 8\ndrwxr-xr-x  2 root root 4096 7月  17 19:49 ./\ndrwx------ 10 root root 4096 7月  17 19:49 ../\n-rw-r--r--  1 root root    0 7月  17 19:49 authorized_keys\n```\n\n```\nvim authorized_keys\n```\n\n将刚才的id_rsa.pub的内容放进去保存一下就可以\n\n#### 这里需要注意\n\n>authorized_keys 文件对权限有哟求，必须是600(-rw——-)或者644\n.ssh目录 必须是700(drwx——),否则一会儿登录不成功\n弄完之后检查一下权限，如果不是的话，改成响应的权限就ok了\n\n#### 准备就绪，在客户端上登录目标主机\n\n在登录之前，要确认一下目标主机是否允许密匙对登录，一般都是打开的，如果没有打开就自己打开\n\n>(查看 /etc/ssh/sshd_config 文件内容 中的 PubkeyAuthentication 这一项是否为 yes,如果不是就自己修改成yes之后重启sshd服务 )\n>\n\n```\nwzy@wzt-dev2-PC:~$ cat /etc/ssh/sshd_config\n# Package generated configuration file\n# See the sshd_config(5) manpage for details\n\n# What ports, IPs and protocols we listen for\nPort 22\n# Use these options to restrict which interfaces/protocols sshd will bind to\n#ListenAddress ::\n#ListenAddress 0.0.0.0\nProtocol 2\n# HostKeys for protocol version 2\nHostKey /etc/ssh/ssh_host_rsa_key\nHostKey /etc/ssh/ssh_host_dsa_key\nHostKey /etc/ssh/ssh_host_ecdsa_key\nHostKey /etc/ssh/ssh_host_ed25519_key\n#Privilege Separation is turned on for security\nUsePrivilegeSeparation yes\n\n# Lifetime and size of ephemeral version 1 server key\nKeyRegenerationInterval 3600\nServerKeyBits 1024\n\n# Logging\nSyslogFacility AUTH\nLogLevel INFO\n\n# Authentication:\nLoginGraceTime 120\nPermitRootLogin yes\nStrictModes yes\n\nRSAAuthentication yes\nPubkeyAuthentication yes   <---------------  在这里\n#AuthorizedKeysFile %h/.ssh/authorized_keys\n\n```\n\n到此我们就配置完了。 (不用输入密码就可以登录了)\n\n```\n➜  ~ ./ssh_my_tencent \nWelcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-118-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Wed Dec  9 10:45:26 CST 2020\n\n  System load:  0.0               Processes:           89\n  Usage of /:   5.0% of 49.15GB   Users logged in:     0\n  Memory usage: 12%               IP address for eth0: 172.21.0.16\n  Swap usage:   0%\n\n * Introducing self-healing high availability clusters in MicroK8s.\n   Simple, hardened, Kubernetes for production, from RaspberryPi to DC.\n\n     https://microk8s.io/high-availability\n\n * Canonical Livepatch is available for installation.\n   - Reduce system reboots and improve kernel security. Activate at:\n     https://ubuntu.com/livepatch\nNew release '20.04.1 LTS' available.\nRun 'do-release-upgrade' to upgrade to it.\n\n\n< Hi, How are you >\n -----------------\n        \\   ^__^\n         \\  (oo)\\_______\n            (__)\\       )\\/\\\n                ||----w |\n                ||     ||\nLast login: Wed Dec  9 09:21:16 2020 from 124.126.1.181\n```","slug":"给服务器设置ssh免密码登录","published":1,"updated":"2020-12-09T02:47:18.624Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmx300353ys24pgmcaxw","content":"<h4 id=\"给服务器设置ssh免密码登录\"><a href=\"#给服务器设置ssh免密码登录\" class=\"headerlink\" title=\"给服务器设置ssh免密码登录\"></a>给服务器设置ssh免密码登录</h4><h4 id=\"SSH是什么？\"><a href=\"#SSH是什么？\" class=\"headerlink\" title=\"SSH是什么？\"></a>SSH是什么？</h4><blockquote>\n<p>SSH 为 Secure Shell 的缩写，由IETF的网络工作小组（Network Working Group）所制定；SSH为建立在应用层和传输层基础上的安全协议。<br>SSH是目前较可靠，专为远程登录会话和其他网络服务提供安全性的协议。利用SSH协议可以有效防止远程管理过程中的信息泄露问题。<br>SSH最初是UNIX系统上的一个程序，后来又迅速扩展到其他操作平台。SSH在正确使用时可弥补网络中的漏洞。SSH客户端适用于多种平台。<br>几乎所有UNIX平台—包括HP-UX、Linux、AIX、Solaris、Digital UNIX、Irix，以及其他平台，都可运行SSH。</p>\n</blockquote>\n<ul>\n<li>简单来理解，就是我拥有一台服务器，我现在想要登录上去做一些事情，那就得使用ssh登录到远程的服务器上，才能在上面进行操作。</li>\n</ul>\n<h4 id=\"SSH-服务端以及客户端配置\"><a href=\"#SSH-服务端以及客户端配置\" class=\"headerlink\" title=\"SSH 服务端以及客户端配置\"></a>SSH 服务端以及客户端配置</h4><h5 id=\"启动-sshd-服务\"><a href=\"#启动-sshd-服务\" class=\"headerlink\" title=\"启动 sshd 服务\"></a>启动 sshd 服务</h5><blockquote>\n<p>一开始在远程服务器上面，需要查看一下他的sshd服务启动了没有，如果没有启动，任何客户端主机是连接不上来的，一般如果是自己在云厂商处购买了主机，主机启动的时候就会把sshd服务启动起来。但有可能自己在测试环境搭建机器的时候，是没有默认启动的，这时候就需要在测试机器的终端看一下，命令如下</p>\n</blockquote>\n<pre><code>ubuntu@VM-0-16-ubuntu:~$ ps -ef | grep sshd\nroot      1221     1  0 Dec07 ?        00:00:00 /usr/sbin/sshd -D\nroot     15649  1221  0 09:21 ?        00:00:00 sshd: ubuntu [priv]\nubuntu   15740 15649  0 09:21 ?        00:00:00 sshd: ubuntu@pts/0\nubuntu   24863 15741  0 10:24 pts/0    00:00:00 grep --color=auto sshd</code></pre>\n<blockquote>\n<p>这里看到第一行,sshd已经启动起来了,进程号是 1221</p>\n</blockquote>\n<ul>\n<li>如果没有启动的话,那就启动一下,命令如下</li>\n</ul>\n<pre><code>ubuntu@VM-0-16-ubuntu:~$ service sshd start</code></pre>\n<h4 id=\"登录服务器主机的方式\"><a href=\"#登录服务器主机的方式\" class=\"headerlink\" title=\"登录服务器主机的方式\"></a>登录服务器主机的方式</h4><h4 id=\"1、客户端使用密码的方式登录目标主机\"><a href=\"#1、客户端使用密码的方式登录目标主机\" class=\"headerlink\" title=\"1、客户端使用密码的方式登录目标主机\"></a>1、客户端使用密码的方式登录目标主机</h4><pre><code>➜  ~ ssh root@192.168.0.187\nroot@192.168.0.187's password:</code></pre>\n<p>输入密码即可</p>\n<h4 id=\"2、客户端使用密钥方式登录目标主机-免密码\"><a href=\"#2、客户端使用密钥方式登录目标主机-免密码\" class=\"headerlink\" title=\"2、客户端使用密钥方式登录目标主机(免密码)\"></a>2、客户端使用密钥方式登录目标主机(免密码)</h4><blockquote>\n<p>使用场景：</p>\n<p>1、如果某个运维人员临时需要登录一台机器，但是机器的管理员并不想把密码暴露给他，所以会让这个运维人员发一个自己的公钥给自己，帮他添加进去，这个运维人员就可以顺利的登录机器了。在运维做完了自己的事情之后，机器的管理员会把他从公钥列表中删掉，这样一来整个过程，密码没有暴露，运维也在这段时间内登上了机器，很完美。</p>\n<p>2、因为自己懒，不想敲密码,想直接使用自己在电脑上配置的ssh_xxx来登录</p>\n</blockquote>\n<h4 id=\"使用ssh-keygen生成密匙对\"><a href=\"#使用ssh-keygen生成密匙对\" class=\"headerlink\" title=\"使用ssh-keygen生成密匙对\"></a>使用ssh-keygen生成密匙对</h4><pre><code>➜  ~ cd .ssh \n➜  .ssh \n➜  .ssh ssh-keygen -t rsa\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/Users/zhaochao/.ssh/id_rsa): id_rsa\nEnter passphrase (empty for no passphrase):</code></pre>\n<p>回车以后，询问是否要输入一个密码来保护这个密匙，为了方便起见，我就不输入了，不然每次使用这个密匙文件还要输一遍密码,直接一路回车就ok</p>\n<p>到了这里，可以看到我们已经创建好了密匙对</p>\n<pre><code>➜  .ssh ls\nid_rsa      id_rsa.pub  known_hosts</code></pre>\n<p>我们可以使用<code>cat</code>命令来获取这个id_rsa.pub</p>\n<pre><code>➜  .ssh cat id_rsa.pub \nssh-rsa AAAAB3NDzaC1yc2EAFADAADAQFcPFT++P8rOkltuIGDSle45yEyDXtDGcCVcHmHAa8TH3/1G+cGusuvREewaJWdxS95fopdi7iumedN+bOJsCIyDsskuLJtt9FaT1MlEg8C3DH+VTkVTKadOYtFF0cwSediRadqjhMQqTOq6gH1g6zTkr4eGEIPp5RaPFDLZmeGiOeYvIS+d8eIdpHckO90KWL0T0bOcjifHlle+5ia0tSo4ZP5ekp0CxTlu0McorQIU7C1cjW/Iz5xQHpYFOdkKYImQob0H0bletwGY8K4A48ioEG9bfiBwbhmCrt93SGcp40G4e6KsuqLMe+5JUqqRcOg7TqvmD/FnftFbjDz2VTGJ/WlEJ4P3HXvAR8CdKPc/DJMmTV3oxwlmdgtDLFpqW7BkydkF2wSkO1+QP4p5ua3Ned7VLlNb16JKafBXD59q1yhwtsvhDxcgmk0tL5O3H4KPCHMZ6tePcWF2wPf+K/zLqV5DF2KXjat+PMveQf6NWAP+KK2jlG8AyV2+BBTI4nC5TdRZMXGmnVOvoc/eGbBB0NohoxZbFnjIVmpLUJcXrUXmXPojjauXQ0z37Ve/uOarVCkDTMimL+GZ4HrOx2s7FR1XM0cpw== 123456@qq.com</code></pre>\n<h4 id=\"将公钥文件放进authorized-keys中\"><a href=\"#将公钥文件放进authorized-keys中\" class=\"headerlink\" title=\"将公钥文件放进authorized_keys中\"></a>将公钥文件放进authorized_keys中</h4><p>目标主机上如果没有.ssh文件夹，就自己创建一个，创建好之后,再创建一个authorized_keys文件。如果有的话就不用了。</p>\n<pre><code>root@wzt-dev2-PC:~/.ssh# ll\ntotal 8\ndrwxr-xr-x  2 root root 4096 7月  17 19:49 ./\ndrwx------ 10 root root 4096 7月  17 19:49 ../\n-rw-r--r--  1 root root    0 7月  17 19:49 authorized_keys</code></pre>\n<pre><code>vim authorized_keys</code></pre>\n<p>将刚才的id_rsa.pub的内容放进去保存一下就可以</p>\n<h4 id=\"这里需要注意\"><a href=\"#这里需要注意\" class=\"headerlink\" title=\"这里需要注意\"></a>这里需要注意</h4><blockquote>\n<p>authorized_keys 文件对权限有哟求，必须是600(-rw——-)或者644<br>.ssh目录 必须是700(drwx——),否则一会儿登录不成功<br>弄完之后检查一下权限，如果不是的话，改成响应的权限就ok了</p>\n</blockquote>\n<h4 id=\"准备就绪，在客户端上登录目标主机\"><a href=\"#准备就绪，在客户端上登录目标主机\" class=\"headerlink\" title=\"准备就绪，在客户端上登录目标主机\"></a>准备就绪，在客户端上登录目标主机</h4><p>在登录之前，要确认一下目标主机是否允许密匙对登录，一般都是打开的，如果没有打开就自己打开</p>\n<blockquote>\n<p>(查看 /etc/ssh/sshd_config 文件内容 中的 PubkeyAuthentication 这一项是否为 yes,如果不是就自己修改成yes之后重启sshd服务 )</p>\n</blockquote>\n<pre><code>wzy@wzt-dev2-PC:~$ cat /etc/ssh/sshd_config\n# Package generated configuration file\n# See the sshd_config(5) manpage for details\n\n# What ports, IPs and protocols we listen for\nPort 22\n# Use these options to restrict which interfaces/protocols sshd will bind to\n#ListenAddress ::\n#ListenAddress 0.0.0.0\nProtocol 2\n# HostKeys for protocol version 2\nHostKey /etc/ssh/ssh_host_rsa_key\nHostKey /etc/ssh/ssh_host_dsa_key\nHostKey /etc/ssh/ssh_host_ecdsa_key\nHostKey /etc/ssh/ssh_host_ed25519_key\n#Privilege Separation is turned on for security\nUsePrivilegeSeparation yes\n\n# Lifetime and size of ephemeral version 1 server key\nKeyRegenerationInterval 3600\nServerKeyBits 1024\n\n# Logging\nSyslogFacility AUTH\nLogLevel INFO\n\n# Authentication:\nLoginGraceTime 120\nPermitRootLogin yes\nStrictModes yes\n\nRSAAuthentication yes\nPubkeyAuthentication yes   &lt;---------------  在这里\n#AuthorizedKeysFile %h/.ssh/authorized_keys\n</code></pre>\n<p>到此我们就配置完了。 (不用输入密码就可以登录了)</p>\n<pre><code>➜  ~ ./ssh_my_tencent \nWelcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-118-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Wed Dec  9 10:45:26 CST 2020\n\n  System load:  0.0               Processes:           89\n  Usage of /:   5.0% of 49.15GB   Users logged in:     0\n  Memory usage: 12%               IP address for eth0: 172.21.0.16\n  Swap usage:   0%\n\n * Introducing self-healing high availability clusters in MicroK8s.\n   Simple, hardened, Kubernetes for production, from RaspberryPi to DC.\n\n     https://microk8s.io/high-availability\n\n * Canonical Livepatch is available for installation.\n   - Reduce system reboots and improve kernel security. Activate at:\n     https://ubuntu.com/livepatch\nNew release '20.04.1 LTS' available.\nRun 'do-release-upgrade' to upgrade to it.\n\n\n&lt; Hi, How are you &gt;\n -----------------\n        \\   ^__^\n         \\  (oo)\\_______\n            (__)\\       )\\/\\\n                ||----w |\n                ||     ||\nLast login: Wed Dec  9 09:21:16 2020 from 124.126.1.181</code></pre>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"给服务器设置ssh免密码登录\"><a href=\"#给服务器设置ssh免密码登录\" class=\"headerlink\" title=\"给服务器设置ssh免密码登录\"></a>给服务器设置ssh免密码登录</h4><h4 id=\"SSH是什么？\"><a href=\"#SSH是什么？\" class=\"headerlink\" title=\"SSH是什么？\"></a>SSH是什么？</h4><blockquote>\n<p>SSH 为 Secure Shell 的缩写，由IETF的网络工作小组（Network Working Group）所制定；SSH为建立在应用层和传输层基础上的安全协议。<br>SSH是目前较可靠，专为远程登录会话和其他网络服务提供安全性的协议。利用SSH协议可以有效防止远程管理过程中的信息泄露问题。<br>SSH最初是UNIX系统上的一个程序，后来又迅速扩展到其他操作平台。SSH在正确使用时可弥补网络中的漏洞。SSH客户端适用于多种平台。<br>几乎所有UNIX平台—包括HP-UX、Linux、AIX、Solaris、Digital UNIX、Irix，以及其他平台，都可运行SSH。</p>\n</blockquote>\n<ul>\n<li>简单来理解，就是我拥有一台服务器，我现在想要登录上去做一些事情，那就得使用ssh登录到远程的服务器上，才能在上面进行操作。</li>\n</ul>\n<h4 id=\"SSH-服务端以及客户端配置\"><a href=\"#SSH-服务端以及客户端配置\" class=\"headerlink\" title=\"SSH 服务端以及客户端配置\"></a>SSH 服务端以及客户端配置</h4><h5 id=\"启动-sshd-服务\"><a href=\"#启动-sshd-服务\" class=\"headerlink\" title=\"启动 sshd 服务\"></a>启动 sshd 服务</h5><blockquote>\n<p>一开始在远程服务器上面，需要查看一下他的sshd服务启动了没有，如果没有启动，任何客户端主机是连接不上来的，一般如果是自己在云厂商处购买了主机，主机启动的时候就会把sshd服务启动起来。但有可能自己在测试环境搭建机器的时候，是没有默认启动的，这时候就需要在测试机器的终端看一下，命令如下</p>\n</blockquote>\n<pre><code>ubuntu@VM-0-16-ubuntu:~$ ps -ef | grep sshd\nroot      1221     1  0 Dec07 ?        00:00:00 /usr/sbin/sshd -D\nroot     15649  1221  0 09:21 ?        00:00:00 sshd: ubuntu [priv]\nubuntu   15740 15649  0 09:21 ?        00:00:00 sshd: ubuntu@pts/0\nubuntu   24863 15741  0 10:24 pts/0    00:00:00 grep --color=auto sshd</code></pre>\n<blockquote>\n<p>这里看到第一行,sshd已经启动起来了,进程号是 1221</p>\n</blockquote>\n<ul>\n<li>如果没有启动的话,那就启动一下,命令如下</li>\n</ul>\n<pre><code>ubuntu@VM-0-16-ubuntu:~$ service sshd start</code></pre>\n<h4 id=\"登录服务器主机的方式\"><a href=\"#登录服务器主机的方式\" class=\"headerlink\" title=\"登录服务器主机的方式\"></a>登录服务器主机的方式</h4><h4 id=\"1、客户端使用密码的方式登录目标主机\"><a href=\"#1、客户端使用密码的方式登录目标主机\" class=\"headerlink\" title=\"1、客户端使用密码的方式登录目标主机\"></a>1、客户端使用密码的方式登录目标主机</h4><pre><code>➜  ~ ssh root@192.168.0.187\nroot@192.168.0.187&#39;s password:</code></pre>\n<p>输入密码即可</p>\n<h4 id=\"2、客户端使用密钥方式登录目标主机-免密码\"><a href=\"#2、客户端使用密钥方式登录目标主机-免密码\" class=\"headerlink\" title=\"2、客户端使用密钥方式登录目标主机(免密码)\"></a>2、客户端使用密钥方式登录目标主机(免密码)</h4><blockquote>\n<p>使用场景：</p>\n<p>1、如果某个运维人员临时需要登录一台机器，但是机器的管理员并不想把密码暴露给他，所以会让这个运维人员发一个自己的公钥给自己，帮他添加进去，这个运维人员就可以顺利的登录机器了。在运维做完了自己的事情之后，机器的管理员会把他从公钥列表中删掉，这样一来整个过程，密码没有暴露，运维也在这段时间内登上了机器，很完美。</p>\n<p>2、因为自己懒，不想敲密码,想直接使用自己在电脑上配置的ssh_xxx来登录</p>\n</blockquote>\n<h4 id=\"使用ssh-keygen生成密匙对\"><a href=\"#使用ssh-keygen生成密匙对\" class=\"headerlink\" title=\"使用ssh-keygen生成密匙对\"></a>使用ssh-keygen生成密匙对</h4><pre><code>➜  ~ cd .ssh \n➜  .ssh \n➜  .ssh ssh-keygen -t rsa\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/Users/zhaochao/.ssh/id_rsa): id_rsa\nEnter passphrase (empty for no passphrase):</code></pre>\n<p>回车以后，询问是否要输入一个密码来保护这个密匙，为了方便起见，我就不输入了，不然每次使用这个密匙文件还要输一遍密码,直接一路回车就ok</p>\n<p>到了这里，可以看到我们已经创建好了密匙对</p>\n<pre><code>➜  .ssh ls\nid_rsa      id_rsa.pub  known_hosts</code></pre>\n<p>我们可以使用<code>cat</code>命令来获取这个id_rsa.pub</p>\n<pre><code>➜  .ssh cat id_rsa.pub \nssh-rsa AAAAB3NDzaC1yc2EAFADAADAQFcPFT++P8rOkltuIGDSle45yEyDXtDGcCVcHmHAa8TH3/1G+cGusuvREewaJWdxS95fopdi7iumedN+bOJsCIyDsskuLJtt9FaT1MlEg8C3DH+VTkVTKadOYtFF0cwSediRadqjhMQqTOq6gH1g6zTkr4eGEIPp5RaPFDLZmeGiOeYvIS+d8eIdpHckO90KWL0T0bOcjifHlle+5ia0tSo4ZP5ekp0CxTlu0McorQIU7C1cjW/Iz5xQHpYFOdkKYImQob0H0bletwGY8K4A48ioEG9bfiBwbhmCrt93SGcp40G4e6KsuqLMe+5JUqqRcOg7TqvmD/FnftFbjDz2VTGJ/WlEJ4P3HXvAR8CdKPc/DJMmTV3oxwlmdgtDLFpqW7BkydkF2wSkO1+QP4p5ua3Ned7VLlNb16JKafBXD59q1yhwtsvhDxcgmk0tL5O3H4KPCHMZ6tePcWF2wPf+K/zLqV5DF2KXjat+PMveQf6NWAP+KK2jlG8AyV2+BBTI4nC5TdRZMXGmnVOvoc/eGbBB0NohoxZbFnjIVmpLUJcXrUXmXPojjauXQ0z37Ve/uOarVCkDTMimL+GZ4HrOx2s7FR1XM0cpw== 123456@qq.com</code></pre>\n<h4 id=\"将公钥文件放进authorized-keys中\"><a href=\"#将公钥文件放进authorized-keys中\" class=\"headerlink\" title=\"将公钥文件放进authorized_keys中\"></a>将公钥文件放进authorized_keys中</h4><p>目标主机上如果没有.ssh文件夹，就自己创建一个，创建好之后,再创建一个authorized_keys文件。如果有的话就不用了。</p>\n<pre><code>root@wzt-dev2-PC:~/.ssh# ll\ntotal 8\ndrwxr-xr-x  2 root root 4096 7月  17 19:49 ./\ndrwx------ 10 root root 4096 7月  17 19:49 ../\n-rw-r--r--  1 root root    0 7月  17 19:49 authorized_keys</code></pre>\n<pre><code>vim authorized_keys</code></pre>\n<p>将刚才的id_rsa.pub的内容放进去保存一下就可以</p>\n<h4 id=\"这里需要注意\"><a href=\"#这里需要注意\" class=\"headerlink\" title=\"这里需要注意\"></a>这里需要注意</h4><blockquote>\n<p>authorized_keys 文件对权限有哟求，必须是600(-rw——-)或者644<br>.ssh目录 必须是700(drwx——),否则一会儿登录不成功<br>弄完之后检查一下权限，如果不是的话，改成响应的权限就ok了</p>\n</blockquote>\n<h4 id=\"准备就绪，在客户端上登录目标主机\"><a href=\"#准备就绪，在客户端上登录目标主机\" class=\"headerlink\" title=\"准备就绪，在客户端上登录目标主机\"></a>准备就绪，在客户端上登录目标主机</h4><p>在登录之前，要确认一下目标主机是否允许密匙对登录，一般都是打开的，如果没有打开就自己打开</p>\n<blockquote>\n<p>(查看 /etc/ssh/sshd_config 文件内容 中的 PubkeyAuthentication 这一项是否为 yes,如果不是就自己修改成yes之后重启sshd服务 )</p>\n</blockquote>\n<pre><code>wzy@wzt-dev2-PC:~$ cat /etc/ssh/sshd_config\n# Package generated configuration file\n# See the sshd_config(5) manpage for details\n\n# What ports, IPs and protocols we listen for\nPort 22\n# Use these options to restrict which interfaces/protocols sshd will bind to\n#ListenAddress ::\n#ListenAddress 0.0.0.0\nProtocol 2\n# HostKeys for protocol version 2\nHostKey /etc/ssh/ssh_host_rsa_key\nHostKey /etc/ssh/ssh_host_dsa_key\nHostKey /etc/ssh/ssh_host_ecdsa_key\nHostKey /etc/ssh/ssh_host_ed25519_key\n#Privilege Separation is turned on for security\nUsePrivilegeSeparation yes\n\n# Lifetime and size of ephemeral version 1 server key\nKeyRegenerationInterval 3600\nServerKeyBits 1024\n\n# Logging\nSyslogFacility AUTH\nLogLevel INFO\n\n# Authentication:\nLoginGraceTime 120\nPermitRootLogin yes\nStrictModes yes\n\nRSAAuthentication yes\nPubkeyAuthentication yes   &lt;---------------  在这里\n#AuthorizedKeysFile %h/.ssh/authorized_keys\n</code></pre>\n<p>到此我们就配置完了。 (不用输入密码就可以登录了)</p>\n<pre><code>➜  ~ ./ssh_my_tencent \nWelcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-118-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Wed Dec  9 10:45:26 CST 2020\n\n  System load:  0.0               Processes:           89\n  Usage of /:   5.0% of 49.15GB   Users logged in:     0\n  Memory usage: 12%               IP address for eth0: 172.21.0.16\n  Swap usage:   0%\n\n * Introducing self-healing high availability clusters in MicroK8s.\n   Simple, hardened, Kubernetes for production, from RaspberryPi to DC.\n\n     https://microk8s.io/high-availability\n\n * Canonical Livepatch is available for installation.\n   - Reduce system reboots and improve kernel security. Activate at:\n     https://ubuntu.com/livepatch\nNew release &#39;20.04.1 LTS&#39; available.\nRun &#39;do-release-upgrade&#39; to upgrade to it.\n\n\n&lt; Hi, How are you &gt;\n -----------------\n        \\   ^__^\n         \\  (oo)\\_______\n            (__)\\       )\\/\\\n                ||----w |\n                ||     ||\nLast login: Wed Dec  9 09:21:16 2020 from 124.126.1.181</code></pre>\n"},{"title":"记一次被钓鱼网站盗走eth的经历","date":"2021-07-01T01:51:52.000Z","_content":"\n#### 记一次被钓鱼网站盗走ETH的经历\n\n我本来是要研究`NFT`(非同质化代币)的, 在研究这个过程中 有几个在线的交易平台`Nifty Gateway`、`OpenSea`、`MakersPlace`等网站可以查看一些商品属性啥的，有助于了解到底啥是`NFT`\n\n我这边也是选择了 `OpenSea` \n\n之后就被盗走 0.05 个 `ETH` 700多块钱吧\n\n\n#### 钓鱼网站是怎样的\n\n于是我去 `Chrome` 浏览器 搜索 `OpenSea`\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100243.png)\n\n也是头晕眼花 没注意瞅 就选择了第一个搜索结果\n\n打开网站: \n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100549.png)\n\n注意看这里的域名是 `www-opensea.io` 这里看不出来有啥名堂 咱们继续往下走\n\n点击右上角小头像进行登录\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100814.png)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100904.png)\n\n到这里 感觉有点不一样了 我的小狐狸明明是已经登录的状态 这里然我输入密码解锁 我也没多想解锁就解锁呗,输入密码进行解锁\n\n解锁完之后 又让输入私钥 这网站咱也没登录过啊 可能就是需要私钥吧 我就继续输入了私钥\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701101043.png)\n\n输入完私钥后 账户里的`eth`就没了 这个账户最好不要在使用了 因为账号和私钥已经泄露 \n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701101449.png)\n\n钱已经被全部转走了 有多少划走多少 转到了`0xAf9dE309b54198E2e37C8DB3d367967Fc20EAa9D`这个账户 我们去查一下这个账户\n\n[骗子账户](https://etherscan.io/address/0xaf9de309b54198e2e37c8db3d367967fc20eaa9d)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701101815.png)\n\n这个账户在我写博客的时候 陆陆续续已经进账 1.9 个 `eth` 了  钱也找不回来了 放弃吧 !!!\n\n#### 正常网站应该是怎样的\n\n我们打开第二个 网站\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701102219.png)\n\n这里的域名是 `opensea.io`\n\n之后我们进行登录\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701102434.png)\n\n可以看到 正常网站 如果我们钱包是登录的状态 直接是授权连接 不需要我们输入密码的 甚至密钥  \n\n连接完之后 我们就登录进来了 \n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701102624.png)\n\n\n#### 总结\n\n正常网站在进行登录的时候 是不需要用户提供私钥的 如果让你输入解锁密码和私钥 那你可要小心了。\n\n如果让你提供密码和私钥才能进行登录的话 极有可能是 **钓鱼网站** 千万小心。\n\n一旦私钥泄漏 这个账号最好不要再使用 因为这个账号已经不属于你了 及时换账号吧！\n\n\n\n\n","source":"_posts/记一次被钓鱼网站盗走eth的经历.md","raw":"---\ntitle: 记一次被钓鱼网站盗走eth的经历\ndate: 2021-07-01 09:51:52\ncategory:\n- 钓鱼网站\n\ntags:\n- eth\n---\n\n#### 记一次被钓鱼网站盗走ETH的经历\n\n我本来是要研究`NFT`(非同质化代币)的, 在研究这个过程中 有几个在线的交易平台`Nifty Gateway`、`OpenSea`、`MakersPlace`等网站可以查看一些商品属性啥的，有助于了解到底啥是`NFT`\n\n我这边也是选择了 `OpenSea` \n\n之后就被盗走 0.05 个 `ETH` 700多块钱吧\n\n\n#### 钓鱼网站是怎样的\n\n于是我去 `Chrome` 浏览器 搜索 `OpenSea`\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100243.png)\n\n也是头晕眼花 没注意瞅 就选择了第一个搜索结果\n\n打开网站: \n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100549.png)\n\n注意看这里的域名是 `www-opensea.io` 这里看不出来有啥名堂 咱们继续往下走\n\n点击右上角小头像进行登录\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100814.png)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100904.png)\n\n到这里 感觉有点不一样了 我的小狐狸明明是已经登录的状态 这里然我输入密码解锁 我也没多想解锁就解锁呗,输入密码进行解锁\n\n解锁完之后 又让输入私钥 这网站咱也没登录过啊 可能就是需要私钥吧 我就继续输入了私钥\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701101043.png)\n\n输入完私钥后 账户里的`eth`就没了 这个账户最好不要在使用了 因为账号和私钥已经泄露 \n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701101449.png)\n\n钱已经被全部转走了 有多少划走多少 转到了`0xAf9dE309b54198E2e37C8DB3d367967Fc20EAa9D`这个账户 我们去查一下这个账户\n\n[骗子账户](https://etherscan.io/address/0xaf9de309b54198e2e37c8db3d367967fc20eaa9d)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701101815.png)\n\n这个账户在我写博客的时候 陆陆续续已经进账 1.9 个 `eth` 了  钱也找不回来了 放弃吧 !!!\n\n#### 正常网站应该是怎样的\n\n我们打开第二个 网站\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701102219.png)\n\n这里的域名是 `opensea.io`\n\n之后我们进行登录\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701102434.png)\n\n可以看到 正常网站 如果我们钱包是登录的状态 直接是授权连接 不需要我们输入密码的 甚至密钥  \n\n连接完之后 我们就登录进来了 \n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701102624.png)\n\n\n#### 总结\n\n正常网站在进行登录的时候 是不需要用户提供私钥的 如果让你输入解锁密码和私钥 那你可要小心了。\n\n如果让你提供密码和私钥才能进行登录的话 极有可能是 **钓鱼网站** 千万小心。\n\n一旦私钥泄漏 这个账号最好不要再使用 因为这个账号已经不属于你了 及时换账号吧！\n\n\n\n\n","slug":"记一次被钓鱼网站盗走eth的经历","published":1,"updated":"2021-07-01T02:34:47.606Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmx400383ys28b9m5dzy","content":"<h4 id=\"记一次被钓鱼网站盗走ETH的经历\"><a href=\"#记一次被钓鱼网站盗走ETH的经历\" class=\"headerlink\" title=\"记一次被钓鱼网站盗走ETH的经历\"></a>记一次被钓鱼网站盗走ETH的经历</h4><p>我本来是要研究<code>NFT</code>(非同质化代币)的, 在研究这个过程中 有几个在线的交易平台<code>Nifty Gateway</code>、<code>OpenSea</code>、<code>MakersPlace</code>等网站可以查看一些商品属性啥的，有助于了解到底啥是<code>NFT</code></p>\n<p>我这边也是选择了 <code>OpenSea</code> </p>\n<p>之后就被盗走 0.05 个 <code>ETH</code> 700多块钱吧</p>\n<h4 id=\"钓鱼网站是怎样的\"><a href=\"#钓鱼网站是怎样的\" class=\"headerlink\" title=\"钓鱼网站是怎样的\"></a>钓鱼网站是怎样的</h4><p>于是我去 <code>Chrome</code> 浏览器 搜索 <code>OpenSea</code></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100243.png\"></p>\n<p>也是头晕眼花 没注意瞅 就选择了第一个搜索结果</p>\n<p>打开网站: </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100549.png\"></p>\n<p>注意看这里的域名是 <code>www-opensea.io</code> 这里看不出来有啥名堂 咱们继续往下走</p>\n<p>点击右上角小头像进行登录</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100814.png\"></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100904.png\"></p>\n<p>到这里 感觉有点不一样了 我的小狐狸明明是已经登录的状态 这里然我输入密码解锁 我也没多想解锁就解锁呗,输入密码进行解锁</p>\n<p>解锁完之后 又让输入私钥 这网站咱也没登录过啊 可能就是需要私钥吧 我就继续输入了私钥</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701101043.png\"></p>\n<p>输入完私钥后 账户里的<code>eth</code>就没了 这个账户最好不要在使用了 因为账号和私钥已经泄露 </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701101449.png\"></p>\n<p>钱已经被全部转走了 有多少划走多少 转到了<code>0xAf9dE309b54198E2e37C8DB3d367967Fc20EAa9D</code>这个账户 我们去查一下这个账户</p>\n<p><a href=\"https://etherscan.io/address/0xaf9de309b54198e2e37c8db3d367967fc20eaa9d\">骗子账户</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701101815.png\"></p>\n<p>这个账户在我写博客的时候 陆陆续续已经进账 1.9 个 <code>eth</code> 了  钱也找不回来了 放弃吧 !!!</p>\n<h4 id=\"正常网站应该是怎样的\"><a href=\"#正常网站应该是怎样的\" class=\"headerlink\" title=\"正常网站应该是怎样的\"></a>正常网站应该是怎样的</h4><p>我们打开第二个 网站</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701102219.png\"></p>\n<p>这里的域名是 <code>opensea.io</code></p>\n<p>之后我们进行登录</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701102434.png\"></p>\n<p>可以看到 正常网站 如果我们钱包是登录的状态 直接是授权连接 不需要我们输入密码的 甚至密钥  </p>\n<p>连接完之后 我们就登录进来了 </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701102624.png\"></p>\n<h4 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h4><p>正常网站在进行登录的时候 是不需要用户提供私钥的 如果让你输入解锁密码和私钥 那你可要小心了。</p>\n<p>如果让你提供密码和私钥才能进行登录的话 极有可能是 <strong>钓鱼网站</strong> 千万小心。</p>\n<p>一旦私钥泄漏 这个账号最好不要再使用 因为这个账号已经不属于你了 及时换账号吧！</p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h4 id=\"记一次被钓鱼网站盗走ETH的经历\"><a href=\"#记一次被钓鱼网站盗走ETH的经历\" class=\"headerlink\" title=\"记一次被钓鱼网站盗走ETH的经历\"></a>记一次被钓鱼网站盗走ETH的经历</h4><p>我本来是要研究<code>NFT</code>(非同质化代币)的, 在研究这个过程中 有几个在线的交易平台<code>Nifty Gateway</code>、<code>OpenSea</code>、<code>MakersPlace</code>等网站可以查看一些商品属性啥的，有助于了解到底啥是<code>NFT</code></p>\n<p>我这边也是选择了 <code>OpenSea</code> </p>\n<p>之后就被盗走 0.05 个 <code>ETH</code> 700多块钱吧</p>\n<h4 id=\"钓鱼网站是怎样的\"><a href=\"#钓鱼网站是怎样的\" class=\"headerlink\" title=\"钓鱼网站是怎样的\"></a>钓鱼网站是怎样的</h4><p>于是我去 <code>Chrome</code> 浏览器 搜索 <code>OpenSea</code></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100243.png\"></p>\n<p>也是头晕眼花 没注意瞅 就选择了第一个搜索结果</p>\n<p>打开网站: </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100549.png\"></p>\n<p>注意看这里的域名是 <code>www-opensea.io</code> 这里看不出来有啥名堂 咱们继续往下走</p>\n<p>点击右上角小头像进行登录</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100814.png\"></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701100904.png\"></p>\n<p>到这里 感觉有点不一样了 我的小狐狸明明是已经登录的状态 这里然我输入密码解锁 我也没多想解锁就解锁呗,输入密码进行解锁</p>\n<p>解锁完之后 又让输入私钥 这网站咱也没登录过啊 可能就是需要私钥吧 我就继续输入了私钥</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701101043.png\"></p>\n<p>输入完私钥后 账户里的<code>eth</code>就没了 这个账户最好不要在使用了 因为账号和私钥已经泄露 </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701101449.png\"></p>\n<p>钱已经被全部转走了 有多少划走多少 转到了<code>0xAf9dE309b54198E2e37C8DB3d367967Fc20EAa9D</code>这个账户 我们去查一下这个账户</p>\n<p><a href=\"https://etherscan.io/address/0xaf9de309b54198e2e37c8db3d367967fc20eaa9d\">骗子账户</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701101815.png\"></p>\n<p>这个账户在我写博客的时候 陆陆续续已经进账 1.9 个 <code>eth</code> 了  钱也找不回来了 放弃吧 !!!</p>\n<h4 id=\"正常网站应该是怎样的\"><a href=\"#正常网站应该是怎样的\" class=\"headerlink\" title=\"正常网站应该是怎样的\"></a>正常网站应该是怎样的</h4><p>我们打开第二个 网站</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701102219.png\"></p>\n<p>这里的域名是 <code>opensea.io</code></p>\n<p>之后我们进行登录</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701102434.png\"></p>\n<p>可以看到 正常网站 如果我们钱包是登录的状态 直接是授权连接 不需要我们输入密码的 甚至密钥  </p>\n<p>连接完之后 我们就登录进来了 </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210701102624.png\"></p>\n<h4 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h4><p>正常网站在进行登录的时候 是不需要用户提供私钥的 如果让你输入解锁密码和私钥 那你可要小心了。</p>\n<p>如果让你提供密码和私钥才能进行登录的话 极有可能是 <strong>钓鱼网站</strong> 千万小心。</p>\n<p>一旦私钥泄漏 这个账号最好不要再使用 因为这个账号已经不属于你了 及时换账号吧！</p>\n"},{"title":"解决服务器连不上github的问题","date":"2021-03-29T01:24:26.000Z","_content":"\n### 解决服务器连不上github的问题\n\n报错信息:\n```\nfatal: unable to access 'https://github.com/ohmyzsh/ohmyzsh.git/': Empty reply from server\nError: git clone of oh-my-zsh repo failed\n```\n\n本来想改变一下服务器终端的主题，一直都是黑白色 有些单调，就想着安装一个 `on my zsh` 结果死活连不上`github`\n\n一向贫穷的我怎么买的起香港的服务器当跳板呢，所以绞尽脑汁看各种资料 终于还是发现了\n\n具体步骤如下:\n\n1、首先我们去查一下`github.com`的ip地址\n\n[https://www.ipaddress.com/ip-lookup](https://www.ipaddress.com/ip-lookup)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210329093225.png)\n\n2、我们进入自己的服务器的`/etc` 目录下\n\n```\ncd /etc\nsudo vim hosts\n```\n\n在`hosts`文件最后一行 加上下面这行，并保存退出服务器 重新进一下\n\n```\nGitHub的IP   github.com\n```\n\nGitHub的IP 是我们刚才查到的\n\n发现可以连上了。","source":"_posts/解决服务器连不上github的问题.md","raw":"---\ntitle: 解决服务器连不上github的问题\ndate: 2021-03-29 09:24:26\ncategories:\n- github\ntags:\n- 腾讯云服务器\n---\n\n### 解决服务器连不上github的问题\n\n报错信息:\n```\nfatal: unable to access 'https://github.com/ohmyzsh/ohmyzsh.git/': Empty reply from server\nError: git clone of oh-my-zsh repo failed\n```\n\n本来想改变一下服务器终端的主题，一直都是黑白色 有些单调，就想着安装一个 `on my zsh` 结果死活连不上`github`\n\n一向贫穷的我怎么买的起香港的服务器当跳板呢，所以绞尽脑汁看各种资料 终于还是发现了\n\n具体步骤如下:\n\n1、首先我们去查一下`github.com`的ip地址\n\n[https://www.ipaddress.com/ip-lookup](https://www.ipaddress.com/ip-lookup)\n\n![](https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210329093225.png)\n\n2、我们进入自己的服务器的`/etc` 目录下\n\n```\ncd /etc\nsudo vim hosts\n```\n\n在`hosts`文件最后一行 加上下面这行，并保存退出服务器 重新进一下\n\n```\nGitHub的IP   github.com\n```\n\nGitHub的IP 是我们刚才查到的\n\n发现可以连上了。","slug":"解决服务器连不上github的问题","published":1,"updated":"2021-03-29T01:37:05.099Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cly6nqmx5003a3ys21qrz9b3y","content":"<h3 id=\"解决服务器连不上github的问题\"><a href=\"#解决服务器连不上github的问题\" class=\"headerlink\" title=\"解决服务器连不上github的问题\"></a>解决服务器连不上github的问题</h3><p>报错信息:</p>\n<pre><code>fatal: unable to access 'https://github.com/ohmyzsh/ohmyzsh.git/': Empty reply from server\nError: git clone of oh-my-zsh repo failed</code></pre>\n<p>本来想改变一下服务器终端的主题，一直都是黑白色 有些单调，就想着安装一个 <code>on my zsh</code> 结果死活连不上<code>github</code></p>\n<p>一向贫穷的我怎么买的起香港的服务器当跳板呢，所以绞尽脑汁看各种资料 终于还是发现了</p>\n<p>具体步骤如下:</p>\n<p>1、首先我们去查一下<code>github.com</code>的ip地址</p>\n<p><a href=\"https://www.ipaddress.com/ip-lookup\">https://www.ipaddress.com/ip-lookup</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210329093225.png\"></p>\n<p>2、我们进入自己的服务器的<code>/etc</code> 目录下</p>\n<pre><code>cd /etc\nsudo vim hosts</code></pre>\n<p>在<code>hosts</code>文件最后一行 加上下面这行，并保存退出服务器 重新进一下</p>\n<pre><code>GitHub的IP   github.com</code></pre>\n<p>GitHub的IP 是我们刚才查到的</p>\n<p>发现可以连上了。</p>\n","site":{"data":{"friends":[{"avatar":"http://image.luokangyuan.com/1_qq_27922023.jpg","name":"码酱","introduction":"我不是大佬，只是在追寻大佬的脚步","url":"http://luokangyuan.com/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/4027734.jpeg","name":"闪烁之狐","introduction":"编程界大佬，技术牛，人还特别好，不懂的都可以请教大佬","url":"https://blinkfox.github.io/","title":"前去学习"},{"avatar":"http://image.luokangyuan.com/avatar.jpg","name":"ja_rome","introduction":"平凡的脚步也可以走出伟大的行程","url":"https://me.csdn.net/jlh912008548","title":"前去学习"}],"musics":[{"name":"五月雨变奏电音","artist":"AnimeVibe","url":"http://xxx.com/music1.mp3","cover":"http://xxx.com/music-cover1.png"},{"name":"Take me hand","artist":"DAISHI DANCE,Cecile Corbel","url":"/medias/music/music2.mp3","cover":"/medias/music/cover2.png"},{"name":"Shape of You","artist":"J.Fla","url":"http://xxx.com/music3.mp3","cover":"http://xxx.com/music-cover3.png"}]}},"excerpt":"","more":"<h3 id=\"解决服务器连不上github的问题\"><a href=\"#解决服务器连不上github的问题\" class=\"headerlink\" title=\"解决服务器连不上github的问题\"></a>解决服务器连不上github的问题</h3><p>报错信息:</p>\n<pre><code>fatal: unable to access &#39;https://github.com/ohmyzsh/ohmyzsh.git/&#39;: Empty reply from server\nError: git clone of oh-my-zsh repo failed</code></pre>\n<p>本来想改变一下服务器终端的主题，一直都是黑白色 有些单调，就想着安装一个 <code>on my zsh</code> 结果死活连不上<code>github</code></p>\n<p>一向贫穷的我怎么买的起香港的服务器当跳板呢，所以绞尽脑汁看各种资料 终于还是发现了</p>\n<p>具体步骤如下:</p>\n<p>1、首先我们去查一下<code>github.com</code>的ip地址</p>\n<p><a href=\"https://www.ipaddress.com/ip-lookup\">https://www.ipaddress.com/ip-lookup</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Naruto-1996/picture/images/20210329093225.png\"></p>\n<p>2、我们进入自己的服务器的<code>/etc</code> 目录下</p>\n<pre><code>cd /etc\nsudo vim hosts</code></pre>\n<p>在<code>hosts</code>文件最后一行 加上下面这行，并保存退出服务器 重新进一下</p>\n<pre><code>GitHub的IP   github.com</code></pre>\n<p>GitHub的IP 是我们刚才查到的</p>\n<p>发现可以连上了。</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cly6nqmw300093ys2033kgtt8","category_id":"cly6nqmw000043ys2dp0zgsg4","_id":"cly6nqmw9000h3ys2d6u76f3b"},{"post_id":"cly6nqmvv00013ys26whn8m25","category_id":"cly6nqmw000043ys2dp0zgsg4","_id":"cly6nqmwa000l3ys2a4cf36ss"},{"post_id":"cly6nqmw5000b3ys26jyt7yf8","category_id":"cly6nqmw000043ys2dp0zgsg4","_id":"cly6nqmwb000n3ys2ftpsfy4m"},{"post_id":"cly6nqmw7000f3ys250pk94x8","category_id":"cly6nqmw000043ys2dp0zgsg4","_id":"cly6nqmwc000q3ys26xlg13ny"},{"post_id":"cly6nqmvy00033ys25pwt3tds","category_id":"cly6nqmw000043ys2dp0zgsg4","_id":"cly6nqmwd000t3ys2d5u1696a"},{"post_id":"cly6nqmw8000g3ys2e99sgcll","category_id":"cly6nqmw000043ys2dp0zgsg4","_id":"cly6nqmwe000x3ys2cpaq5wsd"},{"post_id":"cly6nqmwa000k3ys23dyr12br","category_id":"cly6nqmw000043ys2dp0zgsg4","_id":"cly6nqmwf00103ys235303hdj"},{"post_id":"cly6nqmw200073ys277550de6","category_id":"cly6nqmw000043ys2dp0zgsg4","_id":"cly6nqmwf00123ys25der5kvc"},{"post_id":"cly6nqmwb000m3ys20fli3zpr","category_id":"cly6nqmw000043ys2dp0zgsg4","_id":"cly6nqmwg00163ys253wjf0m1"},{"post_id":"cly6nqmwc000p3ys20fm4en1w","category_id":"cly6nqmw000043ys2dp0zgsg4","_id":"cly6nqmwh00183ys20wd95l26"},{"post_id":"cly6nqmwd000s3ys28j7adx9g","category_id":"cly6nqmwe000y3ys2hk48fzxz","_id":"cly6nqmwi001b3ys2evxndqdn"},{"post_id":"cly6nqmwe000w3ys2bv7u6671","category_id":"cly6nqmwg00153ys257fo3dv0","_id":"cly6nqmwj001j3ys29q89htss"},{"post_id":"cly6nqmwe000z3ys29l42gh36","category_id":"cly6nqmwi001d3ys26b0t7kjk","_id":"cly6nqmwl001o3ys2g39u3yyk"},{"post_id":"cly6nqmwf00113ys2a6xjgg65","category_id":"cly6nqmwj001k3ys2bd4i2fwt","_id":"cly6nqmwn001w3ys2ey876xsv"},{"post_id":"cly6nqmwg00143ys2dd2q6a65","category_id":"cly6nqmwj001k3ys2bd4i2fwt","_id":"cly6nqmwp00233ys29r4ih4qp"},{"post_id":"cly6nqmwn001y3ys2gx1i2caz","category_id":"cly6nqmw000043ys2dp0zgsg4","_id":"cly6nqmwq00273ys21iuw9435"},{"post_id":"cly6nqmwh00173ys2d3vp0fwo","category_id":"cly6nqmwi001d3ys26b0t7kjk","_id":"cly6nqmwr002a3ys230uh7bg3"},{"post_id":"cly6nqmwp00263ys233x635pj","category_id":"cly6nqmwj001k3ys2bd4i2fwt","_id":"cly6nqmws002g3ys29ih1cfd7"},{"post_id":"cly6nqmwh001a3ys2g8ywb8y8","category_id":"cly6nqmwo00223ys2fnul95cz","_id":"cly6nqmwt002j3ys225tg7q2u"},{"post_id":"cly6nqmwi001e3ys24ueshkqi","category_id":"cly6nqmwr002b3ys22mao9rka","_id":"cly6nqmwu002m3ys288vwhfyg"},{"post_id":"cly6nqmwj001h3ys27gtlbaos","category_id":"cly6nqmws002h3ys233qg9f4w","_id":"cly6nqmx1002t3ys29vtz7hcd"},{"post_id":"cly6nqmwz002p3ys26wlfctui","category_id":"cly6nqmwy002n3ys23n8c4tnx","_id":"cly6nqmx2002x3ys27m141g8x"},{"post_id":"cly6nqmwk001l3ys22zazgtm1","category_id":"cly6nqmwy002n3ys23n8c4tnx","_id":"cly6nqmx300303ys2ex1ic530"},{"post_id":"cly6nqmx0002r3ys26t9ahkqy","category_id":"cly6nqmwi001d3ys26b0t7kjk","_id":"cly6nqmx300333ys2hjl0gw62"},{"post_id":"cly6nqmx1002v3ys2c1c00swh","category_id":"cly6nqmwi001d3ys26b0t7kjk","_id":"cly6nqmx400363ys2d6b89os0"},{"post_id":"cly6nqmwk001n3ys26y9d0xlo","category_id":"cly6nqmx1002u3ys24ioxhja1","_id":"cly6nqmx400393ys26hsfbqx7"},{"post_id":"cly6nqmx300323ys2afvkh8kt","category_id":"cly6nqmwi001d3ys26b0t7kjk","_id":"cly6nqmx5003b3ys2dt574bc9"},{"post_id":"cly6nqmwl001r3ys24w7heu76","category_id":"cly6nqmx300313ys20qhvhhv2","_id":"cly6nqmx5003f3ys2a7bf11cc"},{"post_id":"cly6nqmx300353ys24pgmcaxw","category_id":"cly6nqmwi001d3ys26b0t7kjk","_id":"cly6nqmx6003h3ys2ci1n0lc0"},{"post_id":"cly6nqmwm001t3ys26t87897o","category_id":"cly6nqmx400373ys2c3zt8w5c","_id":"cly6nqmx6003l3ys2dajl29y0"},{"post_id":"cly6nqmwo001z3ys2526v0ck4","category_id":"cly6nqmx5003d3ys26xl5fso4","_id":"cly6nqmx6003o3ys2h1kleq04"},{"post_id":"cly6nqmwp00243ys23byffojb","category_id":"cly6nqmx6003j3ys2h4a51o25","_id":"cly6nqmx6003r3ys23y8j331x"},{"post_id":"cly6nqmwq00293ys2aci35ps6","category_id":"cly6nqmx6003p3ys2ff9n7gv3","_id":"cly6nqmx7003w3ys2bvh60po8"},{"post_id":"cly6nqmwr002d3ys297cn3uxf","category_id":"cly6nqmx7003s3ys26pdr9tce","_id":"cly6nqmx700413ys2fen7htmb"},{"post_id":"cly6nqmws002f3ys2bcao34t0","category_id":"cly6nqmwy002n3ys23n8c4tnx","_id":"cly6nqmx800453ys261ya27mz"},{"post_id":"cly6nqmws002i3ys24qhx5sec","category_id":"cly6nqmx700403ys2fqk31v04","_id":"cly6nqmx8004a3ys27ogp24rl"},{"post_id":"cly6nqmwt002k3ys2d7sh1gxp","category_id":"cly6nqmx400373ys2c3zt8w5c","_id":"cly6nqmx8004b3ys26oh1gxba"},{"post_id":"cly6nqmx2002w3ys24jns29gt","category_id":"cly6nqmx800493ys23q9vdl70","_id":"cly6nqmx9004e3ys24drxazqn"},{"post_id":"cly6nqmx2002z3ys25ai5buo6","category_id":"cly6nqmx8004d3ys20a0jhsct","_id":"cly6nqmx9004j3ys2f4r5ceid"},{"post_id":"cly6nqmx400383ys28b9m5dzy","category_id":"cly6nqmx9004g3ys27j2sg4en","_id":"cly6nqmx9004o3ys23aq3b2k3"},{"post_id":"cly6nqmx5003a3ys21qrz9b3y","category_id":"cly6nqmx9004l3ys2gdrpces9","_id":"cly6nqmx9004q3ys2am3mfnbo"}],"PostTag":[{"post_id":"cly6nqmvv00013ys26whn8m25","tag_id":"cly6nqmw100053ys2d2n666ua","_id":"cly6nqmw7000e3ys217rr69o5"},{"post_id":"cly6nqmvy00033ys25pwt3tds","tag_id":"cly6nqmw5000d3ys28sj9fhiy","_id":"cly6nqmwd000r3ys292pbc3n2"},{"post_id":"cly6nqmvy00033ys25pwt3tds","tag_id":"cly6nqmw9000j3ys2dhkt0m83","_id":"cly6nqmwd000u3ys23lwf3sex"},{"post_id":"cly6nqmw200073ys277550de6","tag_id":"cly6nqmwb000o3ys22rvrf36e","_id":"cly6nqmwi001c3ys2anv2fkyr"},{"post_id":"cly6nqmw200073ys277550de6","tag_id":"cly6nqmwd000v3ys26uop9g9e","_id":"cly6nqmwi001f3ys24mv402zc"},{"post_id":"cly6nqmw200073ys277550de6","tag_id":"cly6nqmwf00133ys27gbvany0","_id":"cly6nqmwj001i3ys2ha549dfk"},{"post_id":"cly6nqmw300093ys2033kgtt8","tag_id":"cly6nqmwh00193ys2b6lbfm6x","_id":"cly6nqmwl001p3ys21fzn5kqg"},{"post_id":"cly6nqmw300093ys2033kgtt8","tag_id":"cly6nqmwj001g3ys2cgl84975","_id":"cly6nqmwm001s3ys2gycf5wzx"},{"post_id":"cly6nqmw5000b3ys26jyt7yf8","tag_id":"cly6nqmwk001m3ys2as0hatev","_id":"cly6nqmwn001x3ys22jd2digg"},{"post_id":"cly6nqmwn001y3ys2gx1i2caz","tag_id":"cly6nqmw9000j3ys2dhkt0m83","_id":"cly6nqmwo00213ys29509ehne"},{"post_id":"cly6nqmw7000f3ys250pk94x8","tag_id":"cly6nqmwn001u3ys233nnf39k","_id":"cly6nqmwp00253ys2fkr04xvh"},{"post_id":"cly6nqmw8000g3ys2e99sgcll","tag_id":"cly6nqmwo00203ys28m93ek0y","_id":"cly6nqmwr002c3ys235lt80wx"},{"post_id":"cly6nqmwa000k3ys23dyr12br","tag_id":"cly6nqmwq00283ys2734n5ngi","_id":"cly6nqmwz002o3ys20473c9td"},{"post_id":"cly6nqmwa000k3ys23dyr12br","tag_id":"cly6nqmws002e3ys2feem3w92","_id":"cly6nqmx0002q3ys25gpdafnm"},{"post_id":"cly6nqmwb000m3ys20fli3zpr","tag_id":"cly6nqmwu002l3ys2b99rez8t","_id":"cly6nqmx5003e3ys23jc17rpn"},{"post_id":"cly6nqmwb000m3ys20fli3zpr","tag_id":"cly6nqmx1002s3ys23c5z3tfs","_id":"cly6nqmx6003g3ys21k3kg1zl"},{"post_id":"cly6nqmwb000m3ys20fli3zpr","tag_id":"cly6nqmx2002y3ys25k2i013y","_id":"cly6nqmx6003k3ys2eljwb2bg"},{"post_id":"cly6nqmwb000m3ys20fli3zpr","tag_id":"cly6nqmx300343ys23phvbmwh","_id":"cly6nqmx6003m3ys25kl49zyo"},{"post_id":"cly6nqmwc000p3ys20fm4en1w","tag_id":"cly6nqmx5003c3ys29bjvhr21","_id":"cly6nqmx7003t3ys2haohex3r"},{"post_id":"cly6nqmwc000p3ys20fm4en1w","tag_id":"cly6nqmx6003i3ys2egg7acvm","_id":"cly6nqmx7003u3ys26wjk5jjs"},{"post_id":"cly6nqmwc000p3ys20fm4en1w","tag_id":"cly6nqmx6003n3ys26s9cdpik","_id":"cly6nqmx7003y3ys203xfbzrc"},{"post_id":"cly6nqmwd000s3ys28j7adx9g","tag_id":"cly6nqmws002e3ys2feem3w92","_id":"cly6nqmx700423ys2bvmxd0re"},{"post_id":"cly6nqmwd000s3ys28j7adx9g","tag_id":"cly6nqmx7003v3ys28fl17o7s","_id":"cly6nqmx800433ys22gyacvho"},{"post_id":"cly6nqmwe000w3ys2bv7u6671","tag_id":"cly6nqmx7003z3ys2bg8dcy3j","_id":"cly6nqmx800473ys280uj2xxe"},{"post_id":"cly6nqmwe000z3ys29l42gh36","tag_id":"cly6nqmx800443ys221nbhsqj","_id":"cly6nqmx9004h3ys26elo9nee"},{"post_id":"cly6nqmwe000z3ys29l42gh36","tag_id":"cly6nqmx800483ys279ku0le4","_id":"cly6nqmx9004i3ys29bighn46"},{"post_id":"cly6nqmwe000z3ys29l42gh36","tag_id":"cly6nqmx8004c3ys2fro5aiky","_id":"cly6nqmx9004m3ys260mxff8b"},{"post_id":"cly6nqmwf00113ys2a6xjgg65","tag_id":"cly6nqmx9004f3ys27bpwfne6","_id":"cly6nqmx9004n3ys22ugtgvj4"},{"post_id":"cly6nqmwg00143ys2dd2q6a65","tag_id":"cly6nqmx9004k3ys26qok4psl","_id":"cly6nqmxa004t3ys253p7cre4"},{"post_id":"cly6nqmwg00143ys2dd2q6a65","tag_id":"cly6nqmx9004p3ys21qku6su4","_id":"cly6nqmxa004u3ys2aryzhf3o"},{"post_id":"cly6nqmwg00143ys2dd2q6a65","tag_id":"cly6nqmxa004r3ys2higyasmz","_id":"cly6nqmxa004w3ys2g6htcp8r"},{"post_id":"cly6nqmwh00173ys2d3vp0fwo","tag_id":"cly6nqmxa004s3ys2dcdbcpjt","_id":"cly6nqmxa004x3ys2c1ri7nko"},{"post_id":"cly6nqmwh001a3ys2g8ywb8y8","tag_id":"cly6nqmwn001u3ys233nnf39k","_id":"cly6nqmxb00513ys24x504gh5"},{"post_id":"cly6nqmwh001a3ys2g8ywb8y8","tag_id":"cly6nqmws002e3ys2feem3w92","_id":"cly6nqmxb00523ys228b7g6q2"},{"post_id":"cly6nqmwh001a3ys2g8ywb8y8","tag_id":"cly6nqmxa004z3ys2gtmtep94","_id":"cly6nqmxb00543ys25rpp7rs9"},{"post_id":"cly6nqmwi001e3ys24ueshkqi","tag_id":"cly6nqmxa00503ys2blztgebm","_id":"cly6nqmxb00563ys22bvq58nt"},{"post_id":"cly6nqmwi001e3ys24ueshkqi","tag_id":"cly6nqmxb00533ys23j9bhr7r","_id":"cly6nqmxb00573ys24teq5sdh"},{"post_id":"cly6nqmwj001h3ys27gtlbaos","tag_id":"cly6nqmxb00553ys22zmffh3h","_id":"cly6nqmxb005b3ys2begs32rm"},{"post_id":"cly6nqmwj001h3ys27gtlbaos","tag_id":"cly6nqmxb00583ys2ary8243e","_id":"cly6nqmxc005c3ys2brx59v6y"},{"post_id":"cly6nqmwj001h3ys27gtlbaos","tag_id":"cly6nqmxb00593ys223ac80l4","_id":"cly6nqmxc005e3ys28fgu7p3u"},{"post_id":"cly6nqmwk001l3ys22zazgtm1","tag_id":"cly6nqmxb005a3ys20hhpdh04","_id":"cly6nqmxc005g3ys2bori8y24"},{"post_id":"cly6nqmwk001l3ys22zazgtm1","tag_id":"cly6nqmxc005d3ys2g2m36ya6","_id":"cly6nqmxc005h3ys2dphdcw4t"},{"post_id":"cly6nqmwk001n3ys26y9d0xlo","tag_id":"cly6nqmxc005f3ys2fidlbpdv","_id":"cly6nqmxc005k3ys25rkqc28y"},{"post_id":"cly6nqmwk001n3ys26y9d0xlo","tag_id":"cly6nqmxa004s3ys2dcdbcpjt","_id":"cly6nqmxc005l3ys255eqdjkr"},{"post_id":"cly6nqmwl001r3ys24w7heu76","tag_id":"cly6nqmxc005d3ys2g2m36ya6","_id":"cly6nqmxd005p3ys2908n5qzb"},{"post_id":"cly6nqmwl001r3ys24w7heu76","tag_id":"cly6nqmxc005m3ys2dy3iez7y","_id":"cly6nqmxd005q3ys29jhaa0nu"},{"post_id":"cly6nqmwl001r3ys24w7heu76","tag_id":"cly6nqmxd005n3ys28aoi4bx1","_id":"cly6nqmxd005s3ys2aplr9618"},{"post_id":"cly6nqmwm001t3ys26t87897o","tag_id":"cly6nqmxd005o3ys28z3o3h4c","_id":"cly6nqmxd005u3ys2bmddhzxi"},{"post_id":"cly6nqmwm001t3ys26t87897o","tag_id":"cly6nqmxd005r3ys2e6u0d5el","_id":"cly6nqmxd005v3ys211tsb0ie"},{"post_id":"cly6nqmwo001z3ys2526v0ck4","tag_id":"cly6nqmxd005t3ys2enrhcp7v","_id":"cly6nqmxe005y3ys26lps30kh"},{"post_id":"cly6nqmwo001z3ys2526v0ck4","tag_id":"cly6nqmws002e3ys2feem3w92","_id":"cly6nqmxe005z3ys2byg0dxpo"},{"post_id":"cly6nqmwp00243ys23byffojb","tag_id":"cly6nqmxa004s3ys2dcdbcpjt","_id":"cly6nqmxe00613ys22i655h0i"},{"post_id":"cly6nqmwp00263ys233x635pj","tag_id":"cly6nqmx9004f3ys27bpwfne6","_id":"cly6nqmxf00653ys21u3ofzsy"},{"post_id":"cly6nqmwp00263ys233x635pj","tag_id":"cly6nqmxe00623ys223en0xhq","_id":"cly6nqmxf00663ys2fbmed6e1"},{"post_id":"cly6nqmwp00263ys233x635pj","tag_id":"cly6nqmxe00633ys20u0c8e72","_id":"cly6nqmxf00683ys21kog4vie"},{"post_id":"cly6nqmwq00293ys2aci35ps6","tag_id":"cly6nqmxf00643ys27sozdnue","_id":"cly6nqmxf006a3ys28qwn5tzd"},{"post_id":"cly6nqmwq00293ys2aci35ps6","tag_id":"cly6nqmxa004s3ys2dcdbcpjt","_id":"cly6nqmxf006b3ys28zns1z14"},{"post_id":"cly6nqmwr002d3ys297cn3uxf","tag_id":"cly6nqmxd005o3ys28z3o3h4c","_id":"cly6nqmxf006d3ys2h08266rf"},{"post_id":"cly6nqmws002f3ys2bcao34t0","tag_id":"cly6nqmxf006c3ys233521spj","_id":"cly6nqmxg006g3ys2atvf5max"},{"post_id":"cly6nqmws002f3ys2bcao34t0","tag_id":"cly6nqmxg006e3ys2290hb61x","_id":"cly6nqmxg006h3ys24puudssd"},{"post_id":"cly6nqmws002i3ys24qhx5sec","tag_id":"cly6nqmxg006f3ys23ka184rj","_id":"cly6nqmxg006k3ys2b4krgaj3"},{"post_id":"cly6nqmws002i3ys24qhx5sec","tag_id":"cly6nqmwu002l3ys2b99rez8t","_id":"cly6nqmxg006l3ys24j625l2k"},{"post_id":"cly6nqmwt002k3ys2d7sh1gxp","tag_id":"cly6nqmxg006j3ys2dyztf7pg","_id":"cly6nqmxh006o3ys201rcc273"},{"post_id":"cly6nqmwt002k3ys2d7sh1gxp","tag_id":"cly6nqmxa004s3ys2dcdbcpjt","_id":"cly6nqmxh006p3ys2aojtgyb2"},{"post_id":"cly6nqmwz002p3ys26wlfctui","tag_id":"cly6nqmxh006n3ys2051b0kz6","_id":"cly6nqmxh006t3ys23ya9dr13"},{"post_id":"cly6nqmwz002p3ys26wlfctui","tag_id":"cly6nqmxc005f3ys2fidlbpdv","_id":"cly6nqmxh006u3ys2fv6g46lc"},{"post_id":"cly6nqmwz002p3ys26wlfctui","tag_id":"cly6nqmxh006r3ys2d66c2gda","_id":"cly6nqmxh006w3ys2346iegd3"},{"post_id":"cly6nqmx0002r3ys26t9ahkqy","tag_id":"cly6nqmxh006s3ys250i3gp73","_id":"cly6nqmxi006y3ys237ww6310"},{"post_id":"cly6nqmx0002r3ys26t9ahkqy","tag_id":"cly6nqmxc005f3ys2fidlbpdv","_id":"cly6nqmxi006z3ys26qvldvdr"},{"post_id":"cly6nqmx1002v3ys2c1c00swh","tag_id":"cly6nqmxa004s3ys2dcdbcpjt","_id":"cly6nqmxi00723ys275ak79qd"},{"post_id":"cly6nqmx1002v3ys2c1c00swh","tag_id":"cly6nqmxi00703ys2apl9gac2","_id":"cly6nqmxi00733ys27rs7assj"},{"post_id":"cly6nqmx2002w3ys24jns29gt","tag_id":"cly6nqmxf00643ys27sozdnue","_id":"cly6nqmxj00763ys2bg69befc"},{"post_id":"cly6nqmx2002w3ys24jns29gt","tag_id":"cly6nqmxa004s3ys2dcdbcpjt","_id":"cly6nqmxj00773ys25osh2ohb"},{"post_id":"cly6nqmx2002z3ys25ai5buo6","tag_id":"cly6nqmxj00753ys26zopc4zu","_id":"cly6nqmxj007b3ys2733wg4u9"},{"post_id":"cly6nqmx2002z3ys25ai5buo6","tag_id":"cly6nqmxf00643ys27sozdnue","_id":"cly6nqmxj007c3ys2137j2xq5"},{"post_id":"cly6nqmx2002z3ys25ai5buo6","tag_id":"cly6nqmxa004s3ys2dcdbcpjt","_id":"cly6nqmxj007e3ys2bjxp5ujv"},{"post_id":"cly6nqmx300323ys2afvkh8kt","tag_id":"cly6nqmxc005f3ys2fidlbpdv","_id":"cly6nqmxk007f3ys2bym6dsl3"},{"post_id":"cly6nqmx300353ys24pgmcaxw","tag_id":"cly6nqmxj007d3ys27ba88r40","_id":"cly6nqmxk007i3ys29bb7fdbg"},{"post_id":"cly6nqmx300353ys24pgmcaxw","tag_id":"cly6nqmxc005f3ys2fidlbpdv","_id":"cly6nqmxk007j3ys24gb7hwu0"},{"post_id":"cly6nqmx400383ys28b9m5dzy","tag_id":"cly6nqmxa00503ys2blztgebm","_id":"cly6nqmxk007l3ys219n3f748"},{"post_id":"cly6nqmx5003a3ys21qrz9b3y","tag_id":"cly6nqmxk007k3ys281yohk7y","_id":"cly6nqmxk007m3ys2hz7t3ylk"}],"Tag":[{"name":"ImageView","_id":"cly6nqmw100053ys2d2n666ua"},{"name":"安卓开发","_id":"cly6nqmw5000d3ys28sj9fhiy"},{"name":"RecycleView","_id":"cly6nqmw9000j3ys2dhkt0m83"},{"name":"tabLayout","_id":"cly6nqmwb000o3ys22rvrf36e"},{"name":"viewPager2","_id":"cly6nqmwd000v3ys26uop9g9e"},{"name":"fragment","_id":"cly6nqmwf00133ys27gbvany0"},{"name":"Intent","_id":"cly6nqmwh00193ys2b6lbfm6x"},{"name":"setFlags","_id":"cly6nqmwj001g3ys2cgl84975"},{"name":"单例模式","_id":"cly6nqmwk001m3ys2as0hatev"},{"name":"Android","_id":"cly6nqmwn001u3ys233nnf39k"},{"name":"总结","_id":"cly6nqmwo00203ys28m93ek0y"},{"name":"逆向工程","_id":"cly6nqmwq00283ys2734n5ngi"},{"name":"Mac","_id":"cly6nqmws002e3ys2feem3w92"},{"name":"Java","_id":"cly6nqmwu002l3ys2b99rez8t"},{"name":"背景图","_id":"cly6nqmx1002s3ys23c5z3tfs"},{"name":"Drawable","_id":"cly6nqmx2002y3ys25k2i013y"},{"name":"xml","_id":"cly6nqmx300343ys23phvbmwh"},{"name":"EditText","_id":"cly6nqmx5003c3ys29bjvhr21"},{"name":"密文","_id":"cly6nqmx6003i3ys2egg7acvm"},{"name":"一键清除","_id":"cly6nqmx6003n3ys26s9cdpik"},{"name":"Solidity","_id":"cly6nqmx7003v3ys28fl17o7s"},{"name":"IDEA","_id":"cly6nqmx7003z3ys2bg8dcy3j"},{"name":"运维","_id":"cly6nqmx800443ys221nbhsqj"},{"name":"防火墙","_id":"cly6nqmx800483ys279ku0le4"},{"name":"Linux命令","_id":"cly6nqmx8004c3ys2fro5aiky"},{"name":"Rust","_id":"cly6nqmx9004f3ys27bpwfne6"},{"name":"closure","_id":"cly6nqmx9004k3ys26qok4psl"},{"name":"函数式编程","_id":"cly6nqmx9004p3ys21qku6su4"},{"name":"Rust 编程","_id":"cly6nqmxa004r3ys2higyasmz"},{"name":"ubuntu","_id":"cly6nqmxa004s3ys2dcdbcpjt"},{"name":"自动化测试","_id":"cly6nqmxa004z3ys2gtmtep94"},{"name":"eth","_id":"cly6nqmxa00503ys2blztgebm"},{"name":"NFT","_id":"cly6nqmxb00533ys23j9bhr7r"},{"name":"jQuery","_id":"cly6nqmxb00553ys22zmffh3h"},{"name":"表格","_id":"cly6nqmxb00583ys2ary8243e"},{"name":"表单验证","_id":"cly6nqmxb00593ys223ac80l4"},{"name":"hexo","_id":"cly6nqmxb005a3ys20hhpdh04"},{"name":"github","_id":"cly6nqmxc005d3ys2g2m36ya6"},{"name":"Linux","_id":"cly6nqmxc005f3ys2fidlbpdv"},{"name":"jsDelivr","_id":"cly6nqmxc005m3ys2dy3iez7y"},{"name":"PicGo","_id":"cly6nqmxd005n3ys28aoi4bx1"},{"name":"mysql","_id":"cly6nqmxd005o3ys28z3o3h4c"},{"name":"rails","_id":"cly6nqmxd005r3ys2e6u0d5el"},{"name":"Redis","_id":"cly6nqmxd005t3ys2enrhcp7v"},{"name":"0u8","_id":"cly6nqmxe00623ys223en0xhq"},{"name":"字面量","_id":"cly6nqmxe00633ys20u0c8e72"},{"name":"linux","_id":"cly6nqmxf00643ys27sozdnue"},{"name":"zsh","_id":"cly6nqmxf006c3ys233521spj"},{"name":"chmod","_id":"cly6nqmxg006e3ys2290hb61x"},{"name":"Runtime","_id":"cly6nqmxg006f3ys23ka184rj"},{"name":"ruby","_id":"cly6nqmxg006j3ys2dyztf7pg"},{"name":"常用命令","_id":"cly6nqmxh006n3ys2051b0kz6"},{"name":"MacOs","_id":"cly6nqmxh006r3ys2d66c2gda"},{"name":"Vim","_id":"cly6nqmxh006s3ys250i3gp73"},{"name":"服务器搭建","_id":"cly6nqmxi00703ys2apl9gac2"},{"name":"nginx","_id":"cly6nqmxj00753ys26zopc4zu"},{"name":"SSH","_id":"cly6nqmxj007d3ys27ba88r40"},{"name":"腾讯云服务器","_id":"cly6nqmxk007k3ys281yohk7y"}]}}